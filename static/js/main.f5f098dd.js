/*! For license information please see main.f5f098dd.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,s)=>{e.exports=s(202)},153:(e,t,s)=>{var n=s(43),a=Symbol.for("react.element"),r=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,l=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,s){var n,r={},c=null,d=null;for(n in void 0!==s&&(c=""+s),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,n)&&!o.hasOwnProperty(n)&&(r[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===r[n]&&(r[n]=t[n]);return{$$typeof:a,type:e,key:c,ref:d,props:r,_owner:l.current}}t.Fragment=r,t.jsx=c,t.jsxs=c},202:(e,t)=>{var s=Symbol.for("react.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function v(e,t,s){this.props=e,this.context=t,this.refs=g,this.updater=s||f}function y(){}function x(e,t,s){this.props=e,this.context=t,this.refs=g,this.updater=s||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var b=x.prototype=new y;b.constructor=x,p(b,v.prototype),b.isPureReactComponent=!0;var j=Array.isArray,w=Object.prototype.hasOwnProperty,N={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,n){var a,r={},i=null,l=null;if(null!=t)for(a in void 0!==t.ref&&(l=t.ref),void 0!==t.key&&(i=""+t.key),t)w.call(t,a)&&!S.hasOwnProperty(a)&&(r[a]=t[a]);var o=arguments.length-2;if(1===o)r.children=n;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];r.children=c}if(e&&e.defaultProps)for(a in o=e.defaultProps)void 0===r[a]&&(r[a]=o[a]);return{$$typeof:s,type:e,key:i,ref:l,props:r,_owner:N.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===s}var _=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function T(e,t,a,r,i){var l=typeof e;"undefined"!==l&&"boolean"!==l||(e=null);var o=!1;if(null===e)o=!0;else switch(l){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case s:case n:o=!0}}if(o)return i=i(o=e),e=""===r?"."+E(o,0):r,j(i)?(a="",null!=e&&(a=e.replace(_,"$&/")+"/"),T(i,t,a,"",function(e){return e})):null!=i&&(C(i)&&(i=function(e,t){return{$$typeof:s,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,a+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(_,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=""===r?".":r+":",j(e))for(var c=0;c<e.length;c++){var d=r+E(l=e[c],c);o+=T(l,t,a,d,i)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=m&&e[m]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(l=e.next()).done;)o+=T(l=l.value,t,a,d=r+E(l,c++),i);else if("object"===l)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function P(e,t,s){if(null==e)return e;var n=[],a=0;return T(e,n,"","",function(e){return t.call(s,e,a++)}),n}function O(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},A={transition:null},I={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:A,ReactCurrentOwner:N};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:P,forEach:function(e,t,s){P(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=i,t.PureComponent=x,t.StrictMode=r,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I,t.act=L,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=p({},e.props),r=e.key,i=e.ref,l=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,l=N.current),void 0!==t.key&&(r=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)w.call(t,c)&&!S.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==o?o[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=n;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];a.children=o}return{$$typeof:s,type:e.type,key:r,ref:i,props:a,_owner:l}},t.createContext=function(e){return(e={$$typeof:o,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:l,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=A.transition;A.transition={};try{e()}finally{A.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,s){return R.current.useImperativeHandle(e,t,s)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,s){return R.current.useReducer(e,t,s)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,s){return R.current.useSyncExternalStore(e,t,s)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},210:function(e,t,s){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(s(829)),r=n(s(736));class i{constructor(e){let{headers:t={},schema:s,fetch:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=new Headers(t),this.schemaName=s,this.fetch=n}from(e){const t=new URL("".concat(this.url,"/").concat(e));return new a.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new i(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:s=!1,get:n=!1,count:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i;let l;const o=new URL("".concat(this.url,"/rpc/").concat(e));let c;s||n?(l=s?"HEAD":"GET",Object.entries(t).filter(e=>{let[t,s]=e;return void 0!==s}).map(e=>{let[t,s]=e;return[t,Array.isArray(s)?"{".concat(s.join(","),"}"):"".concat(s)]}).forEach(e=>{let[t,s]=e;o.searchParams.append(t,s)})):(l="POST",c=t);const d=new Headers(this.headers);return a&&d.set("Prefer","count=".concat(a)),new r.default({method:l,url:o,headers:d,schema:this.schemaName,body:c,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}}t.default=i},234:(e,t)=>{function s(e,t){var s=e.length;e.push(t);e:for(;0<s;){var n=s-1>>>1,a=e[n];if(!(0<r(a,t)))break e;e[n]=t,e[s]=a,s=n}}function n(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],s=e.pop();if(s!==t){e[0]=s;e:for(var n=0,a=e.length,i=a>>>1;n<i;){var l=2*(n+1)-1,o=e[l],c=l+1,d=e[c];if(0>r(o,s))c<a&&0>r(d,o)?(e[n]=d,e[c]=s,n=c):(e[n]=o,e[l]=s,n=l);else{if(!(c<a&&0>r(d,s)))break e;e[n]=d,e[c]=s,n=c}}}return t}function r(e,t){var s=e.sortIndex-t.sortIndex;return 0!==s?s:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();t.unstable_now=function(){return l.now()-o}}var c=[],d=[],u=1,h=null,m=3,f=!1,p=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=n(d);null!==t;){if(null===t.callback)a(d);else{if(!(t.startTime<=e))break;a(d),t.sortIndex=t.expirationTime,s(c,t)}t=n(d)}}function j(e){if(g=!1,b(e),!p)if(null!==n(c))p=!0,A(w);else{var t=n(d);null!==t&&I(j,t.startTime-e)}}function w(e,s){p=!1,g&&(g=!1,y(C),C=-1),f=!0;var r=m;try{for(b(s),h=n(c);null!==h&&(!(h.expirationTime>s)||e&&!T());){var i=h.callback;if("function"===typeof i){h.callback=null,m=h.priorityLevel;var l=i(h.expirationTime<=s);s=t.unstable_now(),"function"===typeof l?h.callback=l:h===n(c)&&a(c),b(s)}else a(c);h=n(c)}if(null!==h)var o=!0;else{var u=n(d);null!==u&&I(j,u.startTime-s),o=!1}return o}finally{h=null,m=r,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,S=!1,k=null,C=-1,_=5,E=-1;function T(){return!(t.unstable_now()-E<_)}function P(){if(null!==k){var e=t.unstable_now();E=e;var s=!0;try{s=k(!0,e)}finally{s?N():(S=!1,k=null)}}else S=!1}if("function"===typeof x)N=function(){x(P)};else if("undefined"!==typeof MessageChannel){var O=new MessageChannel,R=O.port2;O.port1.onmessage=P,N=function(){R.postMessage(null)}}else N=function(){v(P,0)};function A(e){k=e,S||(S=!0,N())}function I(e,s){C=v(function(){e(t.unstable_now())},s)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,A(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var s=m;m=t;try{return e()}finally{m=s}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var s=m;m=e;try{return t()}finally{m=s}},t.unstable_scheduleCallback=function(e,a,r){var i=t.unstable_now();switch("object"===typeof r&&null!==r?r="number"===typeof(r=r.delay)&&0<r?i+r:i:r=i,e){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return e={id:u++,callback:a,priorityLevel:e,startTime:r,expirationTime:l=r+l,sortIndex:-1},r>i?(e.sortIndex=r,s(d,e),null===n(c)&&e===n(d)&&(g?(y(C),C=-1):g=!0,I(j,r-i))):(e.sortIndex=l,s(c,e),p||f||(p=!0,A(w))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=m;return function(){var s=m;m=t;try{return e.apply(this,arguments)}finally{m=s}}}},286:function(e,t,s){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(s(630)),r=n(s(611));t.default=class{constructor(e){var t,s;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(s=e.isMaybeSingle)&&void 0!==s&&s,e.fetch?this.fetch=e.fetch:"undefined"===typeof fetch?this.fetch=a.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,s,n,a;let i=null,l=null,o=null,c=e.status,d=e.statusText;if(e.ok){if("HEAD"!==this.method){const s=await e.text();""===s||(l="text/csv"===this.headers.get("Accept")||this.headers.get("Accept")&&(null===(t=this.headers.get("Accept"))||void 0===t?void 0:t.includes("application/vnd.pgrst.plan+text"))?s:JSON.parse(s))}const a=null===(s=this.headers.get("Prefer"))||void 0===s?void 0:s.match(/count=(exact|planned|estimated)/),r=null===(n=e.headers.get("content-range"))||void 0===n?void 0:n.split("/");a&&r&&r.length>1&&(o=parseInt(r[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(l)&&(l.length>1?(i={code:"PGRST116",details:"Results contain ".concat(l.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,o=null,c=406,d="Not Acceptable"):l=1===l.length?l[0]:null)}else{const t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(l=[],i=null,c=200,d="OK")}catch(u){404===e.status&&""===t?(c=204,d="No Content"):i={message:t}}if(i&&this.isMaybeSingle&&(null===(a=null===i||void 0===i?void 0:i.details)||void 0===a?void 0:a.includes("0 rows"))&&(i=null,c=200,d="OK"),i&&this.shouldThrowOnError)throw new r.default(i)}return{error:i,data:l,count:o,status:c,statusText:d}});return this.shouldThrowOnError||(s=s.catch(e=>{var t,s,n;return{error:{message:"".concat(null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),details:"".concat(null!==(s=null===e||void 0===e?void 0:e.stack)&&void 0!==s?s:""),hint:"",code:"".concat(null!==(n=null===e||void 0===e?void 0:e.code)&&void 0!==n?n:"")},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}}},374:function(e,t,s){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(s(286));class r extends a.default{select(e){let t=!1;const s=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(e){let{ascending:t=!0,nullsFirst:s,foreignTable:n,referencedTable:a=n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=a?"".concat(a,".order"):"order",i=this.url.searchParams.get(r);return this.url.searchParams.set(r,"".concat(i?"".concat(i,","):"").concat(e,".").concat(t?"asc":"desc").concat(void 0===s?"":s?".nullsfirst":".nullslast")),this}limit(e){let{foreignTable:t,referencedTable:s=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n="undefined"===typeof s?"limit":"".concat(s,".limit");return this.url.searchParams.set(n,"".concat(e)),this}range(e,t){let{foreignTable:s,referencedTable:n=s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a="undefined"===typeof n?"offset":"".concat(n,".offset"),r="undefined"===typeof n?"limit":"".concat(n,".limit");return this.url.searchParams.set(a,"".concat(e)),this.url.searchParams.set(r,"".concat(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain(){let{analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:n=!1,wal:a=!1,format:r="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var i;const l=[e?"analyze":null,t?"verbose":null,s?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),o=null!==(i=this.headers.get("Accept"))&&void 0!==i?i:"application/json";return this.headers.set("Accept","application/vnd.pgrst.plan+".concat(r,'; for="').concat(o,'"; options=').concat(l,";")),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer","max-affected=".concat(e)),this}}t.default=r},391:(e,t,s)=>{var n=s(950);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},611:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class s extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=s},630:(e,t,s)=>{s.r(t),s.d(t,{Headers:()=>i,Request:()=>l,Response:()=>o,default:()=>r,fetch:()=>a});var n=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof s.g)return s.g;throw new Error("unable to locate global object")}();const a=n.fetch,r=n.fetch.bind(n),i=n.Headers,l=n.Request,o=n.Response},730:(e,t,s)=>{var n=s(43),a=s(853);function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,l={};function o(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(l[e]=t,e=0;e<t.length;e++)i.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},f={};function p(e,t,s,n,a,r,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=r,this.removeEmptyString=i}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new p(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new p(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new p(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new p(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new p(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new p(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function x(e,t,s,n){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,s,n){if(null===t||"undefined"===typeof t||function(e,t,s,n){if(null!==s&&0===s.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==s?!s.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,s,n))return!0;if(n)return!1;if(null!==s)switch(s.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,s,a,n)&&(s=null),n||null===a?function(e){return!!u.call(f,e)||!u.call(m,e)&&(h.test(e)?f[e]=!0:(m[e]=!0,!1))}(t)&&(null===s?e.removeAttribute(t):e.setAttribute(t,""+s)):a.mustUseProperty?e[a.propertyName]=null===s?3!==a.type&&"":s:(t=a.attributeName,n=a.attributeNamespace,null===s?e.removeAttribute(t):(s=3===(a=a.type)||4===a&&!0===s?"":""+s,n?e.setAttributeNS(n,t,s):e.setAttribute(t,s))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new p(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);g[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)});var b=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,j=Symbol.for("react.element"),w=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),_=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var A=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var I=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=I&&e[I]||e["@@iterator"])?e:null}var D,B=Object.assign;function U(e){if(void 0===D)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var F=!1;function z(e,t){if(!e||F)return"";F=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),r=n.stack.split("\n"),i=a.length-1,l=r.length-1;1<=i&&0<=l&&a[i]!==r[l];)l--;for(;1<=i&&0<=l;i--,l--)if(a[i]!==r[l]){if(1!==i||1!==l)do{if(i--,0>--l||a[i]!==r[l]){var o="\n"+a[i].replace(" at new "," at ");return e.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",e.displayName)),o}}while(1<=i&&0<=l);break}}}finally{F=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?U(e):""}function M(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function W(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case w:return"Portal";case k:return"Profiler";case S:return"StrictMode";case T:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case _:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case O:return null!==(t=e.displayName||null)?t:W(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return W(e(t))}catch(s){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function V(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=V(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof s&&"function"===typeof s.get&&"function"===typeof s.set){var a=s.get,r=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){n=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function $(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),n="";return e&&(n=V(e)?e.checked?"true":"false":e.value),(e=n)!==s&&(t.setValue(e),!0)}function J(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function G(e,t){var s=t.checked;return B({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=s?s:e._wrapperState.initialChecked})}function Q(e,t){var s=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;s=H(null!=t.value?t.value:s),e._wrapperState={initialChecked:n,initialValue:s,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&x(e,"checked",t,!1)}function X(e,t){Y(e,t);var s=H(t.value),n=t.type;if(null!=s)"number"===n?(0===s&&""===e.value||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,s):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}""!==(s=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==s&&(e.name=s)}function ee(e,t,s){"number"===t&&J(e.ownerDocument)===e||(null==s?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var te=Array.isArray;function se(e,t,s,n){if(e=e.options,t){t={};for(var a=0;a<s.length;a++)t["$"+s[a]]=!0;for(s=0;s<e.length;s++)a=t.hasOwnProperty("$"+e[s].value),e[s].selected!==a&&(e[s].selected=a),a&&n&&(e[s].defaultSelected=!0)}else{for(s=""+H(s),t=null,a=0;a<e.length;a++){if(e[a].value===s)return e[a].selected=!0,void(n&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(r(91));return B({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var s=t.value;if(null==s){if(s=t.children,t=t.defaultValue,null!=s){if(null!=t)throw Error(r(92));if(te(s)){if(1<s.length)throw Error(r(93));s=s[0]}t=s}null==t&&(t=""),s=t}e._wrapperState={initialValue:H(s)}}function re(e,t){var s=H(t.value),n=H(t.defaultValue);null!=s&&((s=""+s)!==e.value&&(e.value=s),null==t.defaultValue&&e.defaultValue!==s&&(e.defaultValue=s)),null!=n&&(e.defaultValue=""+n)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function le(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function oe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?le(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,s,n){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function he(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&3===s.nodeType)return void(s.nodeValue=t)}e.textContent=t}var me={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function pe(e,t,s){return null==t||"boolean"===typeof t||""===t?"":s||"number"!==typeof t||0===t||me.hasOwnProperty(e)&&me[e]?(""+t).trim():t+"px"}function ge(e,t){for(var s in e=e.style,t)if(t.hasOwnProperty(s)){var n=0===s.indexOf("--"),a=pe(s,t[s],n);"float"===s&&(s="cssFloat"),n?e.setProperty(s,a):e[s]=a}}Object.keys(me).forEach(function(e){fe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),me[t]=me[e]})});var ve=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(r(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(r(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(r(62))}}function xe(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function je(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Ne=null,Se=null;function ke(e){if(e=xa(e)){if("function"!==typeof we)throw Error(r(280));var t=e.stateNode;t&&(t=ja(t),we(e.stateNode,e.type,t))}}function Ce(e){Ne?Se?Se.push(e):Se=[e]:Ne=e}function _e(){if(Ne){var e=Ne,t=Se;if(Se=Ne=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function Ee(e,t){return e(t)}function Te(){}var Pe=!1;function Oe(e,t,s){if(Pe)return e(t,s);Pe=!0;try{return Ee(e,t,s)}finally{Pe=!1,(null!==Ne||null!==Se)&&(Te(),_e())}}function Re(e,t){var s=e.stateNode;if(null===s)return null;var n=ja(s);if(null===n)return null;s=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(s&&"function"!==typeof s)throw Error(r(231,t,typeof s));return s}var Ae=!1;if(d)try{var Ie={};Object.defineProperty(Ie,"passive",{get:function(){Ae=!0}}),window.addEventListener("test",Ie,Ie),window.removeEventListener("test",Ie,Ie)}catch(de){Ae=!1}function Le(e,t,s,n,a,r,i,l,o){var c=Array.prototype.slice.call(arguments,3);try{t.apply(s,c)}catch(d){this.onError(d)}}var De=!1,Be=null,Ue=!1,Fe=null,ze={onError:function(e){De=!0,Be=e}};function Me(e,t,s,n,a,r,i,l,o){De=!1,Be=null,Le.apply(ze,arguments)}function We(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(s=t.return),e=t.return}while(e)}return 3===t.tag?s:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(We(e)!==e)throw Error(r(188))}function Ve(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=We(e)))throw Error(r(188));return t!==e?null:e}for(var s=e,n=t;;){var a=s.return;if(null===a)break;var i=a.alternate;if(null===i){if(null!==(n=a.return)){s=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===s)return He(a),e;if(i===n)return He(a),t;i=i.sibling}throw Error(r(188))}if(s.return!==n.return)s=a,n=i;else{for(var l=!1,o=a.child;o;){if(o===s){l=!0,s=a,n=i;break}if(o===n){l=!0,n=a,s=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===s){l=!0,s=i,n=a;break}if(o===n){l=!0,n=i,s=a;break}o=o.sibling}if(!l)throw Error(r(189))}}if(s.alternate!==n)throw Error(r(190))}if(3!==s.tag)throw Error(r(188));return s.stateNode.current===s?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var $e=a.unstable_scheduleCallback,Je=a.unstable_cancelCallback,Ge=a.unstable_shouldYield,Qe=a.unstable_requestPaint,Ye=a.unstable_now,Xe=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,st=a.unstable_LowPriority,nt=a.unstable_IdlePriority,at=null,rt=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(lt(e)/ot|0)|0},lt=Math.log,ot=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var s=e.pendingLanes;if(0===s)return 0;var n=0,a=e.suspendedLanes,r=e.pingedLanes,i=268435455&s;if(0!==i){var l=i&~a;0!==l?n=ut(l):0!==(r&=i)&&(n=ut(r))}else 0!==(i=s&~a)?n=ut(i):0!==r&&(n=ut(r));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&a)&&((a=n&-n)>=(r=t&-t)||16===a&&0!==(4194240&r)))return t;if(0!==(4&n)&&(n|=16&s),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)a=1<<(s=31-it(t)),n|=e[s],t&=~a;return n}function mt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function vt(e,t,s){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=s}function yt(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var n=31-it(s),a=1<<n;a&t|e[n]&t&&(e[n]|=t),s&=~a}}var xt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var jt,wt,Nt,St,kt,Ct=!1,_t=[],Et=null,Tt=null,Pt=null,Ot=new Map,Rt=new Map,At=[],It="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":Ot.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Dt(e,t,s,n,a,r){return null===e||e.nativeEvent!==r?(e={blockedOn:t,domEventName:s,eventSystemFlags:n,nativeEvent:r,targetContainers:[a]},null!==t&&(null!==(t=xa(t))&&wt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Bt(e){var t=ya(e.target);if(null!==t){var s=We(t);if(null!==s)if(13===(t=s.tag)){if(null!==(t=qe(s)))return e.blockedOn=t,void kt(e.priority,function(){Nt(s)})}else if(3===t&&s.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===s.tag?s.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var s=Gt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==s)return null!==(t=xa(s))&&wt(t),e.blockedOn=s,!1;var n=new(s=e.nativeEvent).constructor(s.type,s);be=n,s.target.dispatchEvent(n),be=null,t.shift()}return!0}function Ft(e,t,s){Ut(e)&&s.delete(t)}function zt(){Ct=!1,null!==Et&&Ut(Et)&&(Et=null),null!==Tt&&Ut(Tt)&&(Tt=null),null!==Pt&&Ut(Pt)&&(Pt=null),Ot.forEach(Ft),Rt.forEach(Ft)}function Mt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,zt)))}function Wt(e){function t(t){return Mt(t,e)}if(0<_t.length){Mt(_t[0],e);for(var s=1;s<_t.length;s++){var n=_t[s];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Et&&Mt(Et,e),null!==Tt&&Mt(Tt,e),null!==Pt&&Mt(Pt,e),Ot.forEach(t),Rt.forEach(t),s=0;s<At.length;s++)(n=At[s]).blockedOn===e&&(n.blockedOn=null);for(;0<At.length&&null===(s=At[0]).blockedOn;)Bt(s),null===s.blockedOn&&At.shift()}var qt=b.ReactCurrentBatchConfig,Ht=!0;function Vt(e,t,s,n){var a=xt,r=qt.transition;qt.transition=null;try{xt=1,$t(e,t,s,n)}finally{xt=a,qt.transition=r}}function Kt(e,t,s,n){var a=xt,r=qt.transition;qt.transition=null;try{xt=4,$t(e,t,s,n)}finally{xt=a,qt.transition=r}}function $t(e,t,s,n){if(Ht){var a=Gt(e,t,s,n);if(null===a)Hn(e,t,n,Jt,s),Lt(e,n);else if(function(e,t,s,n,a){switch(t){case"focusin":return Et=Dt(Et,e,t,s,n,a),!0;case"dragenter":return Tt=Dt(Tt,e,t,s,n,a),!0;case"mouseover":return Pt=Dt(Pt,e,t,s,n,a),!0;case"pointerover":var r=a.pointerId;return Ot.set(r,Dt(Ot.get(r)||null,e,t,s,n,a)),!0;case"gotpointercapture":return r=a.pointerId,Rt.set(r,Dt(Rt.get(r)||null,e,t,s,n,a)),!0}return!1}(a,e,t,s,n))n.stopPropagation();else if(Lt(e,n),4&t&&-1<It.indexOf(e)){for(;null!==a;){var r=xa(a);if(null!==r&&jt(r),null===(r=Gt(e,t,s,n))&&Hn(e,t,n,Jt,s),r===a)break;a=r}null!==a&&n.stopPropagation()}else Hn(e,t,n,null,s)}}var Jt=null;function Gt(e,t,s,n){if(Jt=null,null!==(e=ya(e=je(n))))if(null===(t=We(e)))e=null;else if(13===(s=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===s){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case st:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Yt=null,Xt=null,Zt=null;function es(){if(Zt)return Zt;var e,t,s=Xt,n=s.length,a="value"in Yt?Yt.value:Yt.textContent,r=a.length;for(e=0;e<n&&s[e]===a[e];e++);var i=n-e;for(t=1;t<=i&&s[n-t]===a[r-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function ts(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ss(){return!0}function ns(){return!1}function as(e){function t(t,s,n,a,r){for(var i in this._reactName=t,this._targetInst=n,this.type=s,this.nativeEvent=a,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(a):a[i]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?ss:ns,this.isPropagationStopped=ns,this}return B(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ss)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ss)},persist:function(){},isPersistent:ss}),t}var rs,is,ls,os={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cs=as(os),ds=B({},os,{view:0,detail:0}),us=as(ds),hs=B({},ds,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ss,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ls&&(ls&&"mousemove"===e.type?(rs=e.screenX-ls.screenX,is=e.screenY-ls.screenY):is=rs=0,ls=e),rs)},movementY:function(e){return"movementY"in e?e.movementY:is}}),ms=as(hs),fs=as(B({},hs,{dataTransfer:0})),ps=as(B({},ds,{relatedTarget:0})),gs=as(B({},os,{animationName:0,elapsedTime:0,pseudoElement:0})),vs=B({},os,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ys=as(vs),xs=as(B({},os,{data:0})),bs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},js={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ws={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ns(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=ws[e])&&!!t[e]}function Ss(){return Ns}var ks=B({},ds,{key:function(e){if(e.key){var t=bs[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ts(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?js[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ss,charCode:function(e){return"keypress"===e.type?ts(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ts(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cs=as(ks),_s=as(B({},hs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Es=as(B({},ds,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ss})),Ts=as(B({},os,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ps=B({},hs,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Os=as(Ps),Rs=[9,13,27,32],As=d&&"CompositionEvent"in window,Is=null;d&&"documentMode"in document&&(Is=document.documentMode);var Ls=d&&"TextEvent"in window&&!Is,Ds=d&&(!As||Is&&8<Is&&11>=Is),Bs=String.fromCharCode(32),Us=!1;function Fs(e,t){switch(e){case"keyup":return-1!==Rs.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zs(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Ms=!1;var Ws={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qs(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ws[e.type]:"textarea"===t}function Hs(e,t,s,n){Ce(n),0<(t=Kn(t,"onChange")).length&&(s=new cs("onChange","change",null,s,n),e.push({event:s,listeners:t}))}var Vs=null,Ks=null;function $s(e){Un(e,0)}function Js(e){if($(ba(e)))return e}function Gs(e,t){if("change"===e)return t}var Qs=!1;if(d){var Ys;if(d){var Xs="oninput"in document;if(!Xs){var Zs=document.createElement("div");Zs.setAttribute("oninput","return;"),Xs="function"===typeof Zs.oninput}Ys=Xs}else Ys=!1;Qs=Ys&&(!document.documentMode||9<document.documentMode)}function en(){Vs&&(Vs.detachEvent("onpropertychange",tn),Ks=Vs=null)}function tn(e){if("value"===e.propertyName&&Js(Ks)){var t=[];Hs(t,Ks,e,je(e)),Oe($s,t)}}function sn(e,t,s){"focusin"===e?(en(),Ks=s,(Vs=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Js(Ks)}function an(e,t){if("click"===e)return Js(t)}function rn(e,t){if("input"===e||"change"===e)return Js(t)}var ln="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function on(e,t){if(ln(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var s=Object.keys(e),n=Object.keys(t);if(s.length!==n.length)return!1;for(n=0;n<s.length;n++){var a=s[n];if(!u.call(t,a)||!ln(e[a],t[a]))return!1}return!0}function cn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dn(e,t){var s,n=cn(e);for(e=0;n;){if(3===n.nodeType){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cn(n)}}function un(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?un(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hn(){for(var e=window,t=J();t instanceof e.HTMLIFrameElement;){try{var s="string"===typeof t.contentWindow.location.href}catch(n){s=!1}if(!s)break;t=J((e=t.contentWindow).document)}return t}function mn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fn(e){var t=hn(),s=e.focusedElem,n=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&un(s.ownerDocument.documentElement,s)){if(null!==n&&mn(s))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if((e=(t=s.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=s.textContent.length,r=Math.min(n.start,a);n=void 0===n.end?r:Math.min(n.end,a),!e.extend&&r>n&&(a=n,n=r,r=a),a=dn(s,r);var i=dn(s,n);a&&i&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),r>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=s;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof s.focus&&s.focus(),s=0;s<t.length;s++)(e=t[s]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pn=d&&"documentMode"in document&&11>=document.documentMode,gn=null,vn=null,yn=null,xn=!1;function bn(e,t,s){var n=s.window===s?s.document:9===s.nodeType?s:s.ownerDocument;xn||null==gn||gn!==J(n)||("selectionStart"in(n=gn)&&mn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},yn&&on(yn,n)||(yn=n,0<(n=Kn(vn,"onSelect")).length&&(t=new cs("onSelect","select",null,t,s),e.push({event:t,listeners:n}),t.target=gn)))}function jn(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var wn={animationend:jn("Animation","AnimationEnd"),animationiteration:jn("Animation","AnimationIteration"),animationstart:jn("Animation","AnimationStart"),transitionend:jn("Transition","TransitionEnd")},Nn={},Sn={};function kn(e){if(Nn[e])return Nn[e];if(!wn[e])return e;var t,s=wn[e];for(t in s)if(s.hasOwnProperty(t)&&t in Sn)return Nn[e]=s[t];return e}d&&(Sn=document.createElement("div").style,"AnimationEvent"in window||(delete wn.animationend.animation,delete wn.animationiteration.animation,delete wn.animationstart.animation),"TransitionEvent"in window||delete wn.transitionend.transition);var Cn=kn("animationend"),_n=kn("animationiteration"),En=kn("animationstart"),Tn=kn("transitionend"),Pn=new Map,On="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rn(e,t){Pn.set(e,t),o(t,[e])}for(var An=0;An<On.length;An++){var In=On[An];Rn(In.toLowerCase(),"on"+(In[0].toUpperCase()+In.slice(1)))}Rn(Cn,"onAnimationEnd"),Rn(_n,"onAnimationIteration"),Rn(En,"onAnimationStart"),Rn("dblclick","onDoubleClick"),Rn("focusin","onFocus"),Rn("focusout","onBlur"),Rn(Tn,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ln="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dn=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ln));function Bn(e,t,s){var n=e.type||"unknown-event";e.currentTarget=s,function(e,t,s,n,a,i,l,o,c){if(Me.apply(this,arguments),De){if(!De)throw Error(r(198));var d=Be;De=!1,Be=null,Ue||(Ue=!0,Fe=d)}}(n,t,void 0,e),e.currentTarget=null}function Un(e,t){t=0!==(4&t);for(var s=0;s<e.length;s++){var n=e[s],a=n.event;n=n.listeners;e:{var r=void 0;if(t)for(var i=n.length-1;0<=i;i--){var l=n[i],o=l.instance,c=l.currentTarget;if(l=l.listener,o!==r&&a.isPropagationStopped())break e;Bn(a,l,c),r=o}else for(i=0;i<n.length;i++){if(o=(l=n[i]).instance,c=l.currentTarget,l=l.listener,o!==r&&a.isPropagationStopped())break e;Bn(a,l,c),r=o}}}if(Ue)throw e=Fe,Ue=!1,Fe=null,e}function Fn(e,t){var s=t[pa];void 0===s&&(s=t[pa]=new Set);var n=e+"__bubble";s.has(n)||(qn(t,e,2,!1),s.add(n))}function zn(e,t,s){var n=0;t&&(n|=4),qn(s,e,n,t)}var Mn="_reactListening"+Math.random().toString(36).slice(2);function Wn(e){if(!e[Mn]){e[Mn]=!0,i.forEach(function(t){"selectionchange"!==t&&(Dn.has(t)||zn(t,!1,e),zn(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Mn]||(t[Mn]=!0,zn("selectionchange",!1,t))}}function qn(e,t,s,n){switch(Qt(t)){case 1:var a=Vt;break;case 4:a=Kt;break;default:a=$t}s=a.bind(null,t,s,e),a=void 0,!Ae||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),n?void 0!==a?e.addEventListener(t,s,{capture:!0,passive:a}):e.addEventListener(t,s,!0):void 0!==a?e.addEventListener(t,s,{passive:a}):e.addEventListener(t,s,!1)}function Hn(e,t,s,n,a){var r=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var i=n.tag;if(3===i||4===i){var l=n.stateNode.containerInfo;if(l===a||8===l.nodeType&&l.parentNode===a)break;if(4===i)for(i=n.return;null!==i;){var o=i.tag;if((3===o||4===o)&&((o=i.stateNode.containerInfo)===a||8===o.nodeType&&o.parentNode===a))return;i=i.return}for(;null!==l;){if(null===(i=ya(l)))return;if(5===(o=i.tag)||6===o){n=r=i;continue e}l=l.parentNode}}n=n.return}Oe(function(){var n=r,a=je(s),i=[];e:{var l=Pn.get(e);if(void 0!==l){var o=cs,c=e;switch(e){case"keypress":if(0===ts(s))break e;case"keydown":case"keyup":o=Cs;break;case"focusin":c="focus",o=ps;break;case"focusout":c="blur",o=ps;break;case"beforeblur":case"afterblur":o=ps;break;case"click":if(2===s.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":o=ms;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":o=fs;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":o=Es;break;case Cn:case _n:case En:o=gs;break;case Tn:o=Ts;break;case"scroll":o=us;break;case"wheel":o=Os;break;case"copy":case"cut":case"paste":o=ys;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":o=_s}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==l?l+"Capture":null:l;d=[];for(var m,f=n;null!==f;){var p=(m=f).stateNode;if(5===m.tag&&null!==p&&(m=p,null!==h&&(null!=(p=Re(f,h))&&d.push(Vn(f,p,m)))),u)break;f=f.return}0<d.length&&(l=new o(l,c,null,s,a),i.push({event:l,listeners:d}))}}if(0===(7&t)){if(o="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||s===be||!(c=s.relatedTarget||s.fromElement)||!ya(c)&&!c[fa])&&(o||l)&&(l=a.window===a?a:(l=a.ownerDocument)?l.defaultView||l.parentWindow:window,o?(o=n,null!==(c=(c=s.relatedTarget||s.toElement)?ya(c):null)&&(c!==(u=We(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(o=null,c=n),o!==c)){if(d=ms,p="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=_s,p="onPointerLeave",h="onPointerEnter",f="pointer"),u=null==o?l:ba(o),m=null==c?l:ba(c),(l=new d(p,f+"leave",o,s,a)).target=u,l.relatedTarget=m,p=null,ya(a)===n&&((d=new d(h,f+"enter",c,s,a)).target=m,d.relatedTarget=u,p=d),u=p,o&&c)e:{for(h=c,f=0,m=d=o;m;m=$n(m))f++;for(m=0,p=h;p;p=$n(p))m++;for(;0<f-m;)d=$n(d),f--;for(;0<m-f;)h=$n(h),m--;for(;f--;){if(d===h||null!==h&&d===h.alternate)break e;d=$n(d),h=$n(h)}d=null}else d=null;null!==o&&Jn(i,l,o,d,!1),null!==c&&null!==u&&Jn(i,u,c,d,!0)}if("select"===(o=(l=n?ba(n):window).nodeName&&l.nodeName.toLowerCase())||"input"===o&&"file"===l.type)var g=Gs;else if(qs(l))if(Qs)g=rn;else{g=nn;var v=sn}else(o=l.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===l.type||"radio"===l.type)&&(g=an);switch(g&&(g=g(e,n))?Hs(i,g,s,a):(v&&v(e,l,n),"focusout"===e&&(v=l._wrapperState)&&v.controlled&&"number"===l.type&&ee(l,"number",l.value)),v=n?ba(n):window,e){case"focusin":(qs(v)||"true"===v.contentEditable)&&(gn=v,vn=n,yn=null);break;case"focusout":yn=vn=gn=null;break;case"mousedown":xn=!0;break;case"contextmenu":case"mouseup":case"dragend":xn=!1,bn(i,s,a);break;case"selectionchange":if(pn)break;case"keydown":case"keyup":bn(i,s,a)}var y;if(As)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Ms?Fs(e,s)&&(x="onCompositionEnd"):"keydown"===e&&229===s.keyCode&&(x="onCompositionStart");x&&(Ds&&"ko"!==s.locale&&(Ms||"onCompositionStart"!==x?"onCompositionEnd"===x&&Ms&&(y=es()):(Xt="value"in(Yt=a)?Yt.value:Yt.textContent,Ms=!0)),0<(v=Kn(n,x)).length&&(x=new xs(x,e,null,s,a),i.push({event:x,listeners:v}),y?x.data=y:null!==(y=zs(s))&&(x.data=y))),(y=Ls?function(e,t){switch(e){case"compositionend":return zs(t);case"keypress":return 32!==t.which?null:(Us=!0,Bs);case"textInput":return(e=t.data)===Bs&&Us?null:e;default:return null}}(e,s):function(e,t){if(Ms)return"compositionend"===e||!As&&Fs(e,t)?(e=es(),Zt=Xt=Yt=null,Ms=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ds&&"ko"!==t.locale?null:t.data}}(e,s))&&(0<(n=Kn(n,"onBeforeInput")).length&&(a=new xs("onBeforeInput","beforeinput",null,s,a),i.push({event:a,listeners:n}),a.data=y))}Un(i,t)})}function Vn(e,t,s){return{instance:e,listener:t,currentTarget:s}}function Kn(e,t){for(var s=t+"Capture",n=[];null!==e;){var a=e,r=a.stateNode;5===a.tag&&null!==r&&(a=r,null!=(r=Re(e,s))&&n.unshift(Vn(e,r,a)),null!=(r=Re(e,t))&&n.push(Vn(e,r,a))),e=e.return}return n}function $n(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Jn(e,t,s,n,a){for(var r=t._reactName,i=[];null!==s&&s!==n;){var l=s,o=l.alternate,c=l.stateNode;if(null!==o&&o===n)break;5===l.tag&&null!==c&&(l=c,a?null!=(o=Re(s,r))&&i.unshift(Vn(s,o,l)):a||null!=(o=Re(s,r))&&i.push(Vn(s,o,l))),s=s.return}0!==i.length&&e.push({event:t,listeners:i})}var Gn=/\r\n?/g,Qn=/\u0000|\uFFFD/g;function Yn(e){return("string"===typeof e?e:""+e).replace(Gn,"\n").replace(Qn,"")}function Xn(e,t,s){if(t=Yn(t),Yn(e)!==t&&s)throw Error(r(425))}function Zn(){}var ea=null,ta=null;function sa(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var na="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ra="function"===typeof Promise?Promise:void 0,ia="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ra?function(e){return ra.resolve(null).then(e).catch(la)}:na;function la(e){setTimeout(function(){throw e})}function oa(e,t){var s=t,n=0;do{var a=s.nextSibling;if(e.removeChild(s),a&&8===a.nodeType)if("/$"===(s=a.data)){if(0===n)return e.removeChild(a),void Wt(t);n--}else"$"!==s&&"$?"!==s&&"$!"!==s||n++;s=a}while(s);Wt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function da(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var s=e.data;if("$"===s||"$!"===s||"$?"===s){if(0===t)return e;t--}else"/$"===s&&t++}e=e.previousSibling}return null}var ua=Math.random().toString(36).slice(2),ha="__reactFiber$"+ua,ma="__reactProps$"+ua,fa="__reactContainer$"+ua,pa="__reactEvents$"+ua,ga="__reactListeners$"+ua,va="__reactHandles$"+ua;function ya(e){var t=e[ha];if(t)return t;for(var s=e.parentNode;s;){if(t=s[fa]||s[ha]){if(s=t.alternate,null!==t.child||null!==s&&null!==s.child)for(e=da(e);null!==e;){if(s=e[ha])return s;e=da(e)}return t}s=(e=s).parentNode}return null}function xa(e){return!(e=e[ha]||e[fa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ba(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(r(33))}function ja(e){return e[ma]||null}var wa=[],Na=-1;function Sa(e){return{current:e}}function ka(e){0>Na||(e.current=wa[Na],wa[Na]=null,Na--)}function Ca(e,t){Na++,wa[Na]=e.current,e.current=t}var _a={},Ea=Sa(_a),Ta=Sa(!1),Pa=_a;function Oa(e,t){var s=e.type.contextTypes;if(!s)return _a;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a,r={};for(a in s)r[a]=t[a];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Ra(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Aa(){ka(Ta),ka(Ea)}function Ia(e,t,s){if(Ea.current!==_a)throw Error(r(168));Ca(Ea,t),Ca(Ta,s)}function La(e,t,s){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return s;for(var a in n=n.getChildContext())if(!(a in t))throw Error(r(108,q(e)||"Unknown",a));return B({},s,n)}function Da(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_a,Pa=Ea.current,Ca(Ea,e),Ca(Ta,Ta.current),!0}function Ba(e,t,s){var n=e.stateNode;if(!n)throw Error(r(169));s?(e=La(e,t,Pa),n.__reactInternalMemoizedMergedChildContext=e,ka(Ta),ka(Ea),Ca(Ea,e)):ka(Ta),Ca(Ta,s)}var Ua=null,Fa=!1,za=!1;function Ma(e){null===Ua?Ua=[e]:Ua.push(e)}function Wa(){if(!za&&null!==Ua){za=!0;var e=0,t=xt;try{var s=Ua;for(xt=1;e<s.length;e++){var n=s[e];do{n=n(!0)}while(null!==n)}Ua=null,Fa=!1}catch(a){throw null!==Ua&&(Ua=Ua.slice(e+1)),$e(Ze,Wa),a}finally{xt=t,za=!1}}return null}var qa=[],Ha=0,Va=null,Ka=0,$a=[],Ja=0,Ga=null,Qa=1,Ya="";function Xa(e,t){qa[Ha++]=Ka,qa[Ha++]=Va,Va=e,Ka=t}function Za(e,t,s){$a[Ja++]=Qa,$a[Ja++]=Ya,$a[Ja++]=Ga,Ga=e;var n=Qa;e=Ya;var a=32-it(n)-1;n&=~(1<<a),s+=1;var r=32-it(t)+a;if(30<r){var i=a-a%5;r=(n&(1<<i)-1).toString(32),n>>=i,a-=i,Qa=1<<32-it(t)+a|s<<a|n,Ya=r+e}else Qa=1<<r|s<<a|n,Ya=e}function er(e){null!==e.return&&(Xa(e,1),Za(e,1,0))}function tr(e){for(;e===Va;)Va=qa[--Ha],qa[Ha]=null,Ka=qa[--Ha],qa[Ha]=null;for(;e===Ga;)Ga=$a[--Ja],$a[Ja]=null,Ya=$a[--Ja],$a[Ja]=null,Qa=$a[--Ja],$a[Ja]=null}var sr=null,nr=null,ar=!1,rr=null;function ir(e,t){var s=Oc(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,null===(t=e.deletions)?(e.deletions=[s],e.flags|=16):t.push(s)}function lr(e,t){switch(e.tag){case 5:var s=e.type;return null!==(t=1!==t.nodeType||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,sr=e,nr=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,sr=e,nr=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(s=null!==Ga?{id:Qa,overflow:Ya}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},(s=Oc(18,null,null,0)).stateNode=t,s.return=e,e.child=s,sr=e,nr=null,!0);default:return!1}}function or(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cr(e){if(ar){var t=nr;if(t){var s=t;if(!lr(e,t)){if(or(e))throw Error(r(418));t=ca(s.nextSibling);var n=sr;t&&lr(e,t)?ir(n,s):(e.flags=-4097&e.flags|2,ar=!1,sr=e)}}else{if(or(e))throw Error(r(418));e.flags=-4097&e.flags|2,ar=!1,sr=e}}}function dr(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;sr=e}function ur(e){if(e!==sr)return!1;if(!ar)return dr(e),ar=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!sa(e.type,e.memoizedProps)),t&&(t=nr)){if(or(e))throw hr(),Error(r(418));for(;t;)ir(e,t),t=ca(t.nextSibling)}if(dr(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var s=e.data;if("/$"===s){if(0===t){nr=ca(e.nextSibling);break e}t--}else"$"!==s&&"$!"!==s&&"$?"!==s||t++}e=e.nextSibling}nr=null}}else nr=sr?ca(e.stateNode.nextSibling):null;return!0}function hr(){for(var e=nr;e;)e=ca(e.nextSibling)}function mr(){nr=sr=null,ar=!1}function fr(e){null===rr?rr=[e]:rr.push(e)}var pr=b.ReactCurrentBatchConfig;function gr(e,t,s){if(null!==(e=s.ref)&&"function"!==typeof e&&"object"!==typeof e){if(s._owner){if(s=s._owner){if(1!==s.tag)throw Error(r(309));var n=s.stateNode}if(!n)throw Error(r(147,e));var a=n,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=a.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(r(284));if(!s._owner)throw Error(r(290,e))}return e}function vr(e,t){throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yr(e){return(0,e._init)(e._payload)}function xr(e){function t(t,s){if(e){var n=t.deletions;null===n?(t.deletions=[s],t.flags|=16):n.push(s)}}function s(s,n){if(!e)return null;for(;null!==n;)t(s,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Ac(e,t)).index=0,e.sibling=null,e}function i(t,s,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<s?(t.flags|=2,s):n:(t.flags|=2,s):(t.flags|=1048576,s)}function l(t){return e&&null===t.alternate&&(t.flags|=2),t}function o(e,t,s,n){return null===t||6!==t.tag?((t=Bc(s,e.mode,n)).return=e,t):((t=a(t,s)).return=e,t)}function c(e,t,s,n){var r=s.type;return r===N?u(e,t,s.props.children,n,s.key):null!==t&&(t.elementType===r||"object"===typeof r&&null!==r&&r.$$typeof===R&&yr(r)===t.type)?((n=a(t,s.props)).ref=gr(e,t,s),n.return=e,n):((n=Ic(s.type,s.key,s.props,null,e.mode,n)).ref=gr(e,t,s),n.return=e,n)}function d(e,t,s,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==s.containerInfo||t.stateNode.implementation!==s.implementation?((t=Uc(s,e.mode,n)).return=e,t):((t=a(t,s.children||[])).return=e,t)}function u(e,t,s,n,r){return null===t||7!==t.tag?((t=Lc(s,e.mode,n,r)).return=e,t):((t=a(t,s)).return=e,t)}function h(e,t,s){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Bc(""+t,e.mode,s)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case j:return(s=Ic(t.type,t.key,t.props,null,e.mode,s)).ref=gr(e,null,t),s.return=e,s;case w:return(t=Uc(t,e.mode,s)).return=e,t;case R:return h(e,(0,t._init)(t._payload),s)}if(te(t)||L(t))return(t=Lc(t,e.mode,s,null)).return=e,t;vr(e,t)}return null}function m(e,t,s,n){var a=null!==t?t.key:null;if("string"===typeof s&&""!==s||"number"===typeof s)return null!==a?null:o(e,t,""+s,n);if("object"===typeof s&&null!==s){switch(s.$$typeof){case j:return s.key===a?c(e,t,s,n):null;case w:return s.key===a?d(e,t,s,n):null;case R:return m(e,t,(a=s._init)(s._payload),n)}if(te(s)||L(s))return null!==a?null:u(e,t,s,n,null);vr(e,s)}return null}function f(e,t,s,n,a){if("string"===typeof n&&""!==n||"number"===typeof n)return o(t,e=e.get(s)||null,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case j:return c(t,e=e.get(null===n.key?s:n.key)||null,n,a);case w:return d(t,e=e.get(null===n.key?s:n.key)||null,n,a);case R:return f(e,t,s,(0,n._init)(n._payload),a)}if(te(n)||L(n))return u(t,e=e.get(s)||null,n,a,null);vr(t,n)}return null}function p(a,r,l,o){for(var c=null,d=null,u=r,p=r=0,g=null;null!==u&&p<l.length;p++){u.index>p?(g=u,u=null):g=u.sibling;var v=m(a,u,l[p],o);if(null===v){null===u&&(u=g);break}e&&u&&null===v.alternate&&t(a,u),r=i(v,r,p),null===d?c=v:d.sibling=v,d=v,u=g}if(p===l.length)return s(a,u),ar&&Xa(a,p),c;if(null===u){for(;p<l.length;p++)null!==(u=h(a,l[p],o))&&(r=i(u,r,p),null===d?c=u:d.sibling=u,d=u);return ar&&Xa(a,p),c}for(u=n(a,u);p<l.length;p++)null!==(g=f(u,a,p,l[p],o))&&(e&&null!==g.alternate&&u.delete(null===g.key?p:g.key),r=i(g,r,p),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach(function(e){return t(a,e)}),ar&&Xa(a,p),c}function g(a,l,o,c){var d=L(o);if("function"!==typeof d)throw Error(r(150));if(null==(o=d.call(o)))throw Error(r(151));for(var u=d=null,p=l,g=l=0,v=null,y=o.next();null!==p&&!y.done;g++,y=o.next()){p.index>g?(v=p,p=null):v=p.sibling;var x=m(a,p,y.value,c);if(null===x){null===p&&(p=v);break}e&&p&&null===x.alternate&&t(a,p),l=i(x,l,g),null===u?d=x:u.sibling=x,u=x,p=v}if(y.done)return s(a,p),ar&&Xa(a,g),d;if(null===p){for(;!y.done;g++,y=o.next())null!==(y=h(a,y.value,c))&&(l=i(y,l,g),null===u?d=y:u.sibling=y,u=y);return ar&&Xa(a,g),d}for(p=n(a,p);!y.done;g++,y=o.next())null!==(y=f(p,a,g,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?g:y.key),l=i(y,l,g),null===u?d=y:u.sibling=y,u=y);return e&&p.forEach(function(e){return t(a,e)}),ar&&Xa(a,g),d}return function e(n,r,i,o){if("object"===typeof i&&null!==i&&i.type===N&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case j:e:{for(var c=i.key,d=r;null!==d;){if(d.key===c){if((c=i.type)===N){if(7===d.tag){s(n,d.sibling),(r=a(d,i.props.children)).return=n,n=r;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===R&&yr(c)===d.type){s(n,d.sibling),(r=a(d,i.props)).ref=gr(n,d,i),r.return=n,n=r;break e}s(n,d);break}t(n,d),d=d.sibling}i.type===N?((r=Lc(i.props.children,n.mode,o,i.key)).return=n,n=r):((o=Ic(i.type,i.key,i.props,null,n.mode,o)).ref=gr(n,r,i),o.return=n,n=o)}return l(n);case w:e:{for(d=i.key;null!==r;){if(r.key===d){if(4===r.tag&&r.stateNode.containerInfo===i.containerInfo&&r.stateNode.implementation===i.implementation){s(n,r.sibling),(r=a(r,i.children||[])).return=n,n=r;break e}s(n,r);break}t(n,r),r=r.sibling}(r=Uc(i,n.mode,o)).return=n,n=r}return l(n);case R:return e(n,r,(d=i._init)(i._payload),o)}if(te(i))return p(n,r,i,o);if(L(i))return g(n,r,i,o);vr(n,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==r&&6===r.tag?(s(n,r.sibling),(r=a(r,i)).return=n,n=r):(s(n,r),(r=Bc(i,n.mode,o)).return=n,n=r),l(n)):s(n,r)}}var br=xr(!0),jr=xr(!1),wr=Sa(null),Nr=null,Sr=null,kr=null;function Cr(){kr=Sr=Nr=null}function _r(e){var t=wr.current;ka(wr),e._currentValue=t}function Er(e,t,s){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===s)break;e=e.return}}function Tr(e,t){Nr=e,kr=Sr=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(yl=!0),e.firstContext=null)}function Pr(e){var t=e._currentValue;if(kr!==e)if(e={context:e,memoizedValue:t,next:null},null===Sr){if(null===Nr)throw Error(r(308));Sr=e,Nr.dependencies={lanes:0,firstContext:e}}else Sr=Sr.next=e;return t}var Or=null;function Rr(e){null===Or?Or=[e]:Or.push(e)}function Ar(e,t,s,n){var a=t.interleaved;return null===a?(s.next=s,Rr(t)):(s.next=a.next,a.next=s),t.interleaved=s,Ir(e,n)}function Ir(e,t){e.lanes|=t;var s=e.alternate;for(null!==s&&(s.lanes|=t),s=e,e=e.return;null!==e;)e.childLanes|=t,null!==(s=e.alternate)&&(s.childLanes|=t),s=e,e=e.return;return 3===s.tag?s.stateNode:null}var Lr=!1;function Dr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Br(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ur(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Fr(e,t,s){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Eo)){var a=n.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Ir(e,s)}return null===(a=n.interleaved)?(t.next=t,Rr(n)):(t.next=a.next,a.next=t),n.interleaved=t,Ir(e,s)}function zr(e,t,s){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&s))){var n=t.lanes;s|=n&=e.pendingLanes,t.lanes=s,yt(e,s)}}function Mr(e,t){var s=e.updateQueue,n=e.alternate;if(null!==n&&s===(n=n.updateQueue)){var a=null,r=null;if(null!==(s=s.firstBaseUpdate)){do{var i={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};null===r?a=r=i:r=r.next=i,s=s.next}while(null!==s);null===r?a=r=t:r=r.next=t}else a=r=t;return s={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:r,shared:n.shared,effects:n.effects},void(e.updateQueue=s)}null===(e=s.lastBaseUpdate)?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function Wr(e,t,s,n){var a=e.updateQueue;Lr=!1;var r=a.firstBaseUpdate,i=a.lastBaseUpdate,l=a.shared.pending;if(null!==l){a.shared.pending=null;var o=l,c=o.next;o.next=null,null===i?r=c:i.next=c,i=o;var d=e.alternate;null!==d&&((l=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===l?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=o))}if(null!==r){var u=a.baseState;for(i=0,d=c=o=null,l=r;;){var h=l.lane,m=l.eventTime;if((n&h)===h){null!==d&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var f=e,p=l;switch(h=t,m=s,p.tag){case 1:if("function"===typeof(f=p.payload)){u=f.call(m,u,h);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=p.payload)?f.call(m,u,h):f)||void 0===h)break e;u=B({},u,h);break e;case 2:Lr=!0}}null!==l.callback&&0!==l.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[l]:h.push(l))}else m={eventTime:m,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===d?(c=d=m,o=u):d=d.next=m,i|=h;if(null===(l=l.next)){if(null===(l=a.shared.pending))break;l=(h=l).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===d&&(o=u),a.baseState=o,a.firstBaseUpdate=c,a.lastBaseUpdate=d,null!==(t=a.shared.interleaved)){a=t;do{i|=a.lane,a=a.next}while(a!==t)}else null===r&&(a.shared.lanes=0);Do|=i,e.lanes=i,e.memoizedState=u}}function qr(e,t,s){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(null!==a){if(n.callback=null,n=s,"function"!==typeof a)throw Error(r(191,a));a.call(n)}}}var Hr={},Vr=Sa(Hr),Kr=Sa(Hr),$r=Sa(Hr);function Jr(e){if(e===Hr)throw Error(r(174));return e}function Gr(e,t){switch(Ca($r,t),Ca(Kr,e),Ca(Vr,Hr),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:oe(null,"");break;default:t=oe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ka(Vr),Ca(Vr,t)}function Qr(){ka(Vr),ka(Kr),ka($r)}function Yr(e){Jr($r.current);var t=Jr(Vr.current),s=oe(t,e.type);t!==s&&(Ca(Kr,e),Ca(Vr,s))}function Xr(e){Kr.current===e&&(ka(Vr),ka(Kr))}var Zr=Sa(0);function ei(e){for(var t=e;null!==t;){if(13===t.tag){var s=t.memoizedState;if(null!==s&&(null===(s=s.dehydrated)||"$?"===s.data||"$!"===s.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ti=[];function si(){for(var e=0;e<ti.length;e++)ti[e]._workInProgressVersionPrimary=null;ti.length=0}var ni=b.ReactCurrentDispatcher,ai=b.ReactCurrentBatchConfig,ri=0,ii=null,li=null,oi=null,ci=!1,di=!1,ui=0,hi=0;function mi(){throw Error(r(321))}function fi(e,t){if(null===t)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!ln(e[s],t[s]))return!1;return!0}function pi(e,t,s,n,a,i){if(ri=i,ii=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ni.current=null===e||null===e.memoizedState?Xi:Zi,e=s(n,a),di){i=0;do{if(di=!1,ui=0,25<=i)throw Error(r(301));i+=1,oi=li=null,t.updateQueue=null,ni.current=el,e=s(n,a)}while(di)}if(ni.current=Yi,t=null!==li&&null!==li.next,ri=0,oi=li=ii=null,ci=!1,t)throw Error(r(300));return e}function gi(){var e=0!==ui;return ui=0,e}function vi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===oi?ii.memoizedState=oi=e:oi=oi.next=e,oi}function yi(){if(null===li){var e=ii.alternate;e=null!==e?e.memoizedState:null}else e=li.next;var t=null===oi?ii.memoizedState:oi.next;if(null!==t)oi=t,li=e;else{if(null===e)throw Error(r(310));e={memoizedState:(li=e).memoizedState,baseState:li.baseState,baseQueue:li.baseQueue,queue:li.queue,next:null},null===oi?ii.memoizedState=oi=e:oi=oi.next=e}return oi}function xi(e,t){return"function"===typeof t?t(e):t}function bi(e){var t=yi(),s=t.queue;if(null===s)throw Error(r(311));s.lastRenderedReducer=e;var n=li,a=n.baseQueue,i=s.pending;if(null!==i){if(null!==a){var l=a.next;a.next=i.next,i.next=l}n.baseQueue=a=i,s.pending=null}if(null!==a){i=a.next,n=n.baseState;var o=l=null,c=null,d=i;do{var u=d.lane;if((ri&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(o=c=h,l=n):c=c.next=h,ii.lanes|=u,Do|=u}d=d.next}while(null!==d&&d!==i);null===c?l=n:c.next=o,ln(n,t.memoizedState)||(yl=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=c,s.lastRenderedState=n}if(null!==(e=s.interleaved)){a=e;do{i=a.lane,ii.lanes|=i,Do|=i,a=a.next}while(a!==e)}else null===a&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function ji(e){var t=yi(),s=t.queue;if(null===s)throw Error(r(311));s.lastRenderedReducer=e;var n=s.dispatch,a=s.pending,i=t.memoizedState;if(null!==a){s.pending=null;var l=a=a.next;do{i=e(i,l.action),l=l.next}while(l!==a);ln(i,t.memoizedState)||(yl=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),s.lastRenderedState=i}return[i,n]}function wi(){}function Ni(e,t){var s=ii,n=yi(),a=t(),i=!ln(n.memoizedState,a);if(i&&(n.memoizedState=a,yl=!0),n=n.queue,Li(Ci.bind(null,s,n,e),[e]),n.getSnapshot!==t||i||null!==oi&&1&oi.memoizedState.tag){if(s.flags|=2048,Pi(9,ki.bind(null,s,n,a,t),void 0,null),null===To)throw Error(r(349));0!==(30&ri)||Si(s,t,a)}return a}function Si(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.stores=[e]):null===(s=t.stores)?t.stores=[e]:s.push(e)}function ki(e,t,s,n){t.value=s,t.getSnapshot=n,_i(t)&&Ei(e)}function Ci(e,t,s){return s(function(){_i(t)&&Ei(e)})}function _i(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!ln(e,s)}catch(n){return!0}}function Ei(e){var t=Ir(e,1);null!==t&&sc(t,e,1,-1)}function Ti(e){var t=vi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xi,lastRenderedState:e},t.queue=e,e=e.dispatch=$i.bind(null,ii,e),[t.memoizedState,e]}function Pi(e,t,s,n){return e={tag:e,create:t,destroy:s,deps:n,next:null},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.lastEffect=e.next=e):null===(s=t.lastEffect)?t.lastEffect=e.next=e:(n=s.next,s.next=e,e.next=n,t.lastEffect=e),e}function Oi(){return yi().memoizedState}function Ri(e,t,s,n){var a=vi();ii.flags|=e,a.memoizedState=Pi(1|t,s,void 0,void 0===n?null:n)}function Ai(e,t,s,n){var a=yi();n=void 0===n?null:n;var r=void 0;if(null!==li){var i=li.memoizedState;if(r=i.destroy,null!==n&&fi(n,i.deps))return void(a.memoizedState=Pi(t,s,r,n))}ii.flags|=e,a.memoizedState=Pi(1|t,s,r,n)}function Ii(e,t){return Ri(8390656,8,e,t)}function Li(e,t){return Ai(2048,8,e,t)}function Di(e,t){return Ai(4,2,e,t)}function Bi(e,t){return Ai(4,4,e,t)}function Ui(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Fi(e,t,s){return s=null!==s&&void 0!==s?s.concat([e]):null,Ai(4,4,Ui.bind(null,t,e),s)}function zi(){}function Mi(e,t){var s=yi();t=void 0===t?null:t;var n=s.memoizedState;return null!==n&&null!==t&&fi(t,n[1])?n[0]:(s.memoizedState=[e,t],e)}function Wi(e,t){var s=yi();t=void 0===t?null:t;var n=s.memoizedState;return null!==n&&null!==t&&fi(t,n[1])?n[0]:(e=e(),s.memoizedState=[e,t],e)}function qi(e,t,s){return 0===(21&ri)?(e.baseState&&(e.baseState=!1,yl=!0),e.memoizedState=s):(ln(s,t)||(s=pt(),ii.lanes|=s,Do|=s,e.baseState=!0),t)}function Hi(e,t){var s=xt;xt=0!==s&&4>s?s:4,e(!0);var n=ai.transition;ai.transition={};try{e(!1),t()}finally{xt=s,ai.transition=n}}function Vi(){return yi().memoizedState}function Ki(e,t,s){var n=tc(e);if(s={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null},Ji(e))Gi(t,s);else if(null!==(s=Ar(e,t,s,n))){sc(s,e,n,ec()),Qi(s,t,n)}}function $i(e,t,s){var n=tc(e),a={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null};if(Ji(e))Gi(t,a);else{var r=e.alternate;if(0===e.lanes&&(null===r||0===r.lanes)&&null!==(r=t.lastRenderedReducer))try{var i=t.lastRenderedState,l=r(i,s);if(a.hasEagerState=!0,a.eagerState=l,ln(l,i)){var o=t.interleaved;return null===o?(a.next=a,Rr(t)):(a.next=o.next,o.next=a),void(t.interleaved=a)}}catch(c){}null!==(s=Ar(e,t,a,n))&&(sc(s,e,n,a=ec()),Qi(s,t,n))}}function Ji(e){var t=e.alternate;return e===ii||null!==t&&t===ii}function Gi(e,t){di=ci=!0;var s=e.pending;null===s?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function Qi(e,t,s){if(0!==(4194240&s)){var n=t.lanes;s|=n&=e.pendingLanes,t.lanes=s,yt(e,s)}}var Yi={readContext:Pr,useCallback:mi,useContext:mi,useEffect:mi,useImperativeHandle:mi,useInsertionEffect:mi,useLayoutEffect:mi,useMemo:mi,useReducer:mi,useRef:mi,useState:mi,useDebugValue:mi,useDeferredValue:mi,useTransition:mi,useMutableSource:mi,useSyncExternalStore:mi,useId:mi,unstable_isNewReconciler:!1},Xi={readContext:Pr,useCallback:function(e,t){return vi().memoizedState=[e,void 0===t?null:t],e},useContext:Pr,useEffect:Ii,useImperativeHandle:function(e,t,s){return s=null!==s&&void 0!==s?s.concat([e]):null,Ri(4194308,4,Ui.bind(null,t,e),s)},useLayoutEffect:function(e,t){return Ri(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ri(4,2,e,t)},useMemo:function(e,t){var s=vi();return t=void 0===t?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var n=vi();return t=void 0!==s?s(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Ki.bind(null,ii,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},vi().memoizedState=e},useState:Ti,useDebugValue:zi,useDeferredValue:function(e){return vi().memoizedState=e},useTransition:function(){var e=Ti(!1),t=e[0];return e=Hi.bind(null,e[1]),vi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var n=ii,a=vi();if(ar){if(void 0===s)throw Error(r(407));s=s()}else{if(s=t(),null===To)throw Error(r(349));0!==(30&ri)||Si(n,t,s)}a.memoizedState=s;var i={value:s,getSnapshot:t};return a.queue=i,Ii(Ci.bind(null,n,i,e),[e]),n.flags|=2048,Pi(9,ki.bind(null,n,i,s,t),void 0,null),s},useId:function(){var e=vi(),t=To.identifierPrefix;if(ar){var s=Ya;t=":"+t+"R"+(s=(Qa&~(1<<32-it(Qa)-1)).toString(32)+s),0<(s=ui++)&&(t+="H"+s.toString(32)),t+=":"}else t=":"+t+"r"+(s=hi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zi={readContext:Pr,useCallback:Mi,useContext:Pr,useEffect:Li,useImperativeHandle:Fi,useInsertionEffect:Di,useLayoutEffect:Bi,useMemo:Wi,useReducer:bi,useRef:Oi,useState:function(){return bi(xi)},useDebugValue:zi,useDeferredValue:function(e){return qi(yi(),li.memoizedState,e)},useTransition:function(){return[bi(xi)[0],yi().memoizedState]},useMutableSource:wi,useSyncExternalStore:Ni,useId:Vi,unstable_isNewReconciler:!1},el={readContext:Pr,useCallback:Mi,useContext:Pr,useEffect:Li,useImperativeHandle:Fi,useInsertionEffect:Di,useLayoutEffect:Bi,useMemo:Wi,useReducer:ji,useRef:Oi,useState:function(){return ji(xi)},useDebugValue:zi,useDeferredValue:function(e){var t=yi();return null===li?t.memoizedState=e:qi(t,li.memoizedState,e)},useTransition:function(){return[ji(xi)[0],yi().memoizedState]},useMutableSource:wi,useSyncExternalStore:Ni,useId:Vi,unstable_isNewReconciler:!1};function tl(e,t){if(e&&e.defaultProps){for(var s in t=B({},t),e=e.defaultProps)void 0===t[s]&&(t[s]=e[s]);return t}return t}function sl(e,t,s,n){s=null===(s=s(n,t=e.memoizedState))||void 0===s?t:B({},t,s),e.memoizedState=s,0===e.lanes&&(e.updateQueue.baseState=s)}var nl={isMounted:function(e){return!!(e=e._reactInternals)&&We(e)===e},enqueueSetState:function(e,t,s){e=e._reactInternals;var n=ec(),a=tc(e),r=Ur(n,a);r.payload=t,void 0!==s&&null!==s&&(r.callback=s),null!==(t=Fr(e,r,a))&&(sc(t,e,a,n),zr(t,e,a))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var n=ec(),a=tc(e),r=Ur(n,a);r.tag=1,r.payload=t,void 0!==s&&null!==s&&(r.callback=s),null!==(t=Fr(e,r,a))&&(sc(t,e,a,n),zr(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=ec(),n=tc(e),a=Ur(s,n);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Fr(e,a,n))&&(sc(t,e,n,s),zr(t,e,n))}};function al(e,t,s,n,a,r,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,r,i):!t.prototype||!t.prototype.isPureReactComponent||(!on(s,n)||!on(a,r))}function rl(e,t,s){var n=!1,a=_a,r=t.contextType;return"object"===typeof r&&null!==r?r=Pr(r):(a=Ra(t)?Pa:Ea.current,r=(n=null!==(n=t.contextTypes)&&void 0!==n)?Oa(e,a):_a),t=new t(s,r),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=nl,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=r),t}function il(e,t,s,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(s,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(s,n),t.state!==e&&nl.enqueueReplaceState(t,t.state,null)}function ll(e,t,s,n){var a=e.stateNode;a.props=s,a.state=e.memoizedState,a.refs={},Dr(e);var r=t.contextType;"object"===typeof r&&null!==r?a.context=Pr(r):(r=Ra(t)?Pa:Ea.current,a.context=Oa(e,r)),a.state=e.memoizedState,"function"===typeof(r=t.getDerivedStateFromProps)&&(sl(e,t,r,s),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&nl.enqueueReplaceState(a,a.state,null),Wr(e,s,a,n),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function ol(e,t){try{var s="",n=t;do{s+=M(n),n=n.return}while(n);var a=s}catch(r){a="\nError generating stack: "+r.message+"\n"+r.stack}return{value:e,source:t,stack:a,digest:null}}function cl(e,t,s){return{value:e,source:null,stack:null!=s?s:null,digest:null!=t?t:null}}function dl(e,t){try{console.error(t.value)}catch(s){setTimeout(function(){throw s})}}var ul="function"===typeof WeakMap?WeakMap:Map;function hl(e,t,s){(s=Ur(-1,s)).tag=3,s.payload={element:null};var n=t.value;return s.callback=function(){Ho||(Ho=!0,Vo=n),dl(0,t)},s}function ml(e,t,s){(s=Ur(-1,s)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var a=t.value;s.payload=function(){return n(a)},s.callback=function(){dl(0,t)}}var r=e.stateNode;return null!==r&&"function"===typeof r.componentDidCatch&&(s.callback=function(){dl(0,t),"function"!==typeof n&&(null===Ko?Ko=new Set([this]):Ko.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),s}function fl(e,t,s){var n=e.pingCache;if(null===n){n=e.pingCache=new ul;var a=new Set;n.set(t,a)}else void 0===(a=n.get(t))&&(a=new Set,n.set(t,a));a.has(s)||(a.add(s),e=kc.bind(null,e,t,s),t.then(e,e))}function pl(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function gl(e,t,s,n,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,1===s.tag&&(null===s.alternate?s.tag=17:((t=Ur(-1,1)).tag=2,Fr(s,t,1))),s.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var vl=b.ReactCurrentOwner,yl=!1;function xl(e,t,s,n){t.child=null===e?jr(t,null,s,n):br(t,e.child,s,n)}function bl(e,t,s,n,a){s=s.render;var r=t.ref;return Tr(t,a),n=pi(e,t,s,n,r,a),s=gi(),null===e||yl?(ar&&s&&er(t),t.flags|=1,xl(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ql(e,t,a))}function jl(e,t,s,n,a){if(null===e){var r=s.type;return"function"!==typeof r||Rc(r)||void 0!==r.defaultProps||null!==s.compare||void 0!==s.defaultProps?((e=Ic(s.type,null,n,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=r,wl(e,t,r,n,a))}if(r=e.child,0===(e.lanes&a)){var i=r.memoizedProps;if((s=null!==(s=s.compare)?s:on)(i,n)&&e.ref===t.ref)return ql(e,t,a)}return t.flags|=1,(e=Ac(r,n)).ref=t.ref,e.return=t,t.child=e}function wl(e,t,s,n,a){if(null!==e){var r=e.memoizedProps;if(on(r,n)&&e.ref===t.ref){if(yl=!1,t.pendingProps=n=r,0===(e.lanes&a))return t.lanes=e.lanes,ql(e,t,a);0!==(131072&e.flags)&&(yl=!0)}}return kl(e,t,s,n,a)}function Nl(e,t,s){var n=t.pendingProps,a=n.children,r=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ca(Ao,Ro),Ro|=s;else{if(0===(1073741824&s))return e=null!==r?r.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ca(Ao,Ro),Ro|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==r?r.baseLanes:s,Ca(Ao,Ro),Ro|=n}else null!==r?(n=r.baseLanes|s,t.memoizedState=null):n=s,Ca(Ao,Ro),Ro|=n;return xl(e,t,a,s),t.child}function Sl(e,t){var s=t.ref;(null===e&&null!==s||null!==e&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function kl(e,t,s,n,a){var r=Ra(s)?Pa:Ea.current;return r=Oa(t,r),Tr(t,a),s=pi(e,t,s,n,r,a),n=gi(),null===e||yl?(ar&&n&&er(t),t.flags|=1,xl(e,t,s,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ql(e,t,a))}function Cl(e,t,s,n,a){if(Ra(s)){var r=!0;Da(t)}else r=!1;if(Tr(t,a),null===t.stateNode)Wl(e,t),rl(t,s,n),ll(t,s,n,a),n=!0;else if(null===e){var i=t.stateNode,l=t.memoizedProps;i.props=l;var o=i.context,c=s.contextType;"object"===typeof c&&null!==c?c=Pr(c):c=Oa(t,c=Ra(s)?Pa:Ea.current);var d=s.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate;u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(l!==n||o!==c)&&il(t,i,n,c),Lr=!1;var h=t.memoizedState;i.state=h,Wr(t,n,i,a),o=t.memoizedState,l!==n||h!==o||Ta.current||Lr?("function"===typeof d&&(sl(t,s,d,n),o=t.memoizedState),(l=Lr||al(t,s,l,n,h,o,c))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=o),i.props=n,i.state=o,i.context=c,n=l):("function"===typeof i.componentDidMount&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,Br(e,t),l=t.memoizedProps,c=t.type===t.elementType?l:tl(t.type,l),i.props=c,u=t.pendingProps,h=i.context,"object"===typeof(o=s.contextType)&&null!==o?o=Pr(o):o=Oa(t,o=Ra(s)?Pa:Ea.current);var m=s.getDerivedStateFromProps;(d="function"===typeof m||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(l!==u||h!==o)&&il(t,i,n,o),Lr=!1,h=t.memoizedState,i.state=h,Wr(t,n,i,a);var f=t.memoizedState;l!==u||h!==f||Ta.current||Lr?("function"===typeof m&&(sl(t,s,m,n),f=t.memoizedState),(c=Lr||al(t,s,c,n,h,f,o)||!1)?(d||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(n,f,o),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(n,f,o)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),i.props=n,i.state=f,i.context=o,n=c):("function"!==typeof i.componentDidUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return _l(e,t,s,n,r,a)}function _l(e,t,s,n,a,r){Sl(e,t);var i=0!==(128&t.flags);if(!n&&!i)return a&&Ba(t,s,!1),ql(e,t,r);n=t.stateNode,vl.current=t;var l=i&&"function"!==typeof s.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&i?(t.child=br(t,e.child,null,r),t.child=br(t,null,l,r)):xl(e,t,l,r),t.memoizedState=n.state,a&&Ba(t,s,!0),t.child}function El(e){var t=e.stateNode;t.pendingContext?Ia(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ia(0,t.context,!1),Gr(e,t.containerInfo)}function Tl(e,t,s,n,a){return mr(),fr(a),t.flags|=256,xl(e,t,s,n),t.child}var Pl,Ol,Rl,Al,Il={dehydrated:null,treeContext:null,retryLane:0};function Ll(e){return{baseLanes:e,cachePool:null,transitions:null}}function Dl(e,t,s){var n,a=t.pendingProps,i=Zr.current,l=!1,o=0!==(128&t.flags);if((n=o)||(n=(null===e||null!==e.memoizedState)&&0!==(2&i)),n?(l=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Ca(Zr,1&i),null===e)return cr(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(o=a.children,e=a.fallback,l?(a=t.mode,l=t.child,o={mode:"hidden",children:o},0===(1&a)&&null!==l?(l.childLanes=0,l.pendingProps=o):l=Dc(o,a,0,null),e=Lc(e,a,s,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=Ll(s),t.memoizedState=Il,e):Bl(t,o));if(null!==(i=e.memoizedState)&&null!==(n=i.dehydrated))return function(e,t,s,n,a,i,l){if(s)return 256&t.flags?(t.flags&=-257,Ul(e,t,l,n=cl(Error(r(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Dc({mode:"visible",children:n.children},a,0,null),(i=Lc(i,a,l,null)).flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,0!==(1&t.mode)&&br(t,e.child,null,l),t.child.memoizedState=Ll(l),t.memoizedState=Il,i);if(0===(1&t.mode))return Ul(e,t,l,null);if("$!"===a.data){if(n=a.nextSibling&&a.nextSibling.dataset)var o=n.dgst;return n=o,Ul(e,t,l,n=cl(i=Error(r(419)),n,void 0))}if(o=0!==(l&e.childLanes),yl||o){if(null!==(n=To)){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(n.suspendedLanes|l))?0:a)&&a!==i.retryLane&&(i.retryLane=a,Ir(e,a),sc(n,e,a,-1))}return pc(),Ul(e,t,l,n=cl(Error(r(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=_c.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,nr=ca(a.nextSibling),sr=t,ar=!0,rr=null,null!==e&&($a[Ja++]=Qa,$a[Ja++]=Ya,$a[Ja++]=Ga,Qa=e.id,Ya=e.overflow,Ga=t),t=Bl(t,n.children),t.flags|=4096,t)}(e,t,o,a,n,i,s);if(l){l=a.fallback,o=t.mode,n=(i=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&o)&&t.child!==i?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Ac(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==n?l=Ac(n,l):(l=Lc(l,o,s,null)).flags|=2,l.return=t,a.return=t,a.sibling=l,t.child=a,a=l,l=t.child,o=null===(o=e.child.memoizedState)?Ll(s):{baseLanes:o.baseLanes|s,cachePool:null,transitions:o.transitions},l.memoizedState=o,l.childLanes=e.childLanes&~s,t.memoizedState=Il,a}return e=(l=e.child).sibling,a=Ac(l,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=s),a.return=t,a.sibling=null,null!==e&&(null===(s=t.deletions)?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=a,t.memoizedState=null,a}function Bl(e,t){return(t=Dc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ul(e,t,s,n){return null!==n&&fr(n),br(t,e.child,null,s),(e=Bl(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Fl(e,t,s){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Er(e.return,t,s)}function zl(e,t,s,n,a){var r=e.memoizedState;null===r?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:s,tailMode:a}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=n,r.tail=s,r.tailMode=a)}function Ml(e,t,s){var n=t.pendingProps,a=n.revealOrder,r=n.tail;if(xl(e,t,n.children,s),0!==(2&(n=Zr.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Fl(e,s,t);else if(19===e.tag)Fl(e,s,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ca(Zr,n),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(s=t.child,a=null;null!==s;)null!==(e=s.alternate)&&null===ei(e)&&(a=s),s=s.sibling;null===(s=a)?(a=t.child,t.child=null):(a=s.sibling,s.sibling=null),zl(t,!1,a,s,r);break;case"backwards":for(s=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===ei(e)){t.child=a;break}e=a.sibling,a.sibling=s,s=a,a=e}zl(t,!0,s,null,r);break;case"together":zl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wl(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ql(e,t,s){if(null!==e&&(t.dependencies=e.dependencies),Do|=t.lanes,0===(s&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(s=Ac(e=t.child,e.pendingProps),t.child=s,s.return=t;null!==e.sibling;)e=e.sibling,(s=s.sibling=Ac(e,e.pendingProps)).return=t;s.sibling=null}return t.child}function Hl(e,t){if(!ar)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;null!==t;)null!==t.alternate&&(s=t),t=t.sibling;null===s?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var n=null;null!==s;)null!==s.alternate&&(n=s),s=s.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Vl(e){var t=null!==e.alternate&&e.alternate.child===e.child,s=0,n=0;if(t)for(var a=e.child;null!==a;)s|=a.lanes|a.childLanes,n|=14680064&a.subtreeFlags,n|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)s|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=s,t}function Kl(e,t,s){var n=t.pendingProps;switch(tr(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vl(t),null;case 1:case 17:return Ra(t.type)&&Aa(),Vl(t),null;case 3:return n=t.stateNode,Qr(),ka(Ta),ka(Ea),si(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ur(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==rr&&(ic(rr),rr=null))),Ol(e,t),Vl(t),null;case 5:Xr(t);var a=Jr($r.current);if(s=t.type,null!==e&&null!=t.stateNode)Rl(e,t,s,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(r(166));return Vl(t),null}if(e=Jr(Vr.current),ur(t)){n=t.stateNode,s=t.type;var i=t.memoizedProps;switch(n[ha]=t,n[ma]=i,e=0!==(1&t.mode),s){case"dialog":Fn("cancel",n),Fn("close",n);break;case"iframe":case"object":case"embed":Fn("load",n);break;case"video":case"audio":for(a=0;a<Ln.length;a++)Fn(Ln[a],n);break;case"source":Fn("error",n);break;case"img":case"image":case"link":Fn("error",n),Fn("load",n);break;case"details":Fn("toggle",n);break;case"input":Q(n,i),Fn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Fn("invalid",n);break;case"textarea":ae(n,i),Fn("invalid",n)}for(var o in ye(s,i),a=null,i)if(i.hasOwnProperty(o)){var c=i[o];"children"===o?"string"===typeof c?n.textContent!==c&&(!0!==i.suppressHydrationWarning&&Xn(n.textContent,c,e),a=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Xn(n.textContent,c,e),a=["children",""+c]):l.hasOwnProperty(o)&&null!=c&&"onScroll"===o&&Fn("scroll",n)}switch(s){case"input":K(n),Z(n,i,!0);break;case"textarea":K(n),ie(n);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(n.onclick=Zn)}n=a,t.updateQueue=n,null!==n&&(t.flags|=4)}else{o=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=le(s)),"http://www.w3.org/1999/xhtml"===e?"script"===s?((e=o.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=o.createElement(s,{is:n.is}):(e=o.createElement(s),"select"===s&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,s),e[ha]=t,e[ma]=n,Pl(e,t,!1,!1),t.stateNode=e;e:{switch(o=xe(s,n),s){case"dialog":Fn("cancel",e),Fn("close",e),a=n;break;case"iframe":case"object":case"embed":Fn("load",e),a=n;break;case"video":case"audio":for(a=0;a<Ln.length;a++)Fn(Ln[a],e);a=n;break;case"source":Fn("error",e),a=n;break;case"img":case"image":case"link":Fn("error",e),Fn("load",e),a=n;break;case"details":Fn("toggle",e),a=n;break;case"input":Q(e,n),a=G(e,n),Fn("invalid",e);break;case"option":default:a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=B({},n,{value:void 0}),Fn("invalid",e);break;case"textarea":ae(e,n),a=ne(e,n),Fn("invalid",e)}for(i in ye(s,a),c=a)if(c.hasOwnProperty(i)){var d=c[i];"style"===i?ge(e,d):"dangerouslySetInnerHTML"===i?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===i?"string"===typeof d?("textarea"!==s||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(l.hasOwnProperty(i)?null!=d&&"onScroll"===i&&Fn("scroll",e):null!=d&&x(e,i,d,o))}switch(s){case"input":K(e),Z(e,n,!1);break;case"textarea":K(e),ie(e);break;case"option":null!=n.value&&e.setAttribute("value",""+H(n.value));break;case"select":e.multiple=!!n.multiple,null!=(i=n.value)?se(e,!!n.multiple,i,!1):null!=n.defaultValue&&se(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zn)}switch(s){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Vl(t),null;case 6:if(e&&null!=t.stateNode)Al(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(r(166));if(s=Jr($r.current),Jr(Vr.current),ur(t)){if(n=t.stateNode,s=t.memoizedProps,n[ha]=t,(i=n.nodeValue!==s)&&null!==(e=sr))switch(e.tag){case 3:Xn(n.nodeValue,s,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xn(n.nodeValue,s,0!==(1&e.mode))}i&&(t.flags|=4)}else(n=(9===s.nodeType?s:s.ownerDocument).createTextNode(n))[ha]=t,t.stateNode=n}return Vl(t),null;case 13:if(ka(Zr),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ar&&null!==nr&&0!==(1&t.mode)&&0===(128&t.flags))hr(),mr(),t.flags|=98560,i=!1;else if(i=ur(t),null!==n&&null!==n.dehydrated){if(null===e){if(!i)throw Error(r(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(r(317));i[ha]=t}else mr(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Vl(t),i=!1}else null!==rr&&(ic(rr),rr=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=s,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zr.current)?0===Io&&(Io=3):pc())),null!==t.updateQueue&&(t.flags|=4),Vl(t),null);case 4:return Qr(),Ol(e,t),null===e&&Wn(t.stateNode.containerInfo),Vl(t),null;case 10:return _r(t.type._context),Vl(t),null;case 19:if(ka(Zr),null===(i=t.memoizedState))return Vl(t),null;if(n=0!==(128&t.flags),null===(o=i.rendering))if(n)Hl(i,!1);else{if(0!==Io||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=ei(e))){for(t.flags|=128,Hl(i,!1),null!==(n=o.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=s,s=t.child;null!==s;)e=n,(i=s).flags&=14680066,null===(o=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return Ca(Zr,1&Zr.current|2),t.child}e=e.sibling}null!==i.tail&&Ye()>Wo&&(t.flags|=128,n=!0,Hl(i,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=ei(o))){if(t.flags|=128,n=!0,null!==(s=e.updateQueue)&&(t.updateQueue=s,t.flags|=4),Hl(i,!0),null===i.tail&&"hidden"===i.tailMode&&!o.alternate&&!ar)return Vl(t),null}else 2*Ye()-i.renderingStartTime>Wo&&1073741824!==s&&(t.flags|=128,n=!0,Hl(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(null!==(s=i.last)?s.sibling=o:t.child=o,i.last=o)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ye(),t.sibling=null,s=Zr.current,Ca(Zr,n?1&s|2:1&s),t):(Vl(t),null);case 22:case 23:return uc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Ro)&&(Vl(t),6&t.subtreeFlags&&(t.flags|=8192)):Vl(t),null;case 24:case 25:return null}throw Error(r(156,t.tag))}function $l(e,t){switch(tr(t),t.tag){case 1:return Ra(t.type)&&Aa(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Qr(),ka(Ta),ka(Ea),si(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xr(t),null;case 13:if(ka(Zr),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));mr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return ka(Zr),null;case 4:return Qr(),null;case 10:return _r(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Pl=function(e,t){for(var s=t.child;null!==s;){if(5===s.tag||6===s.tag)e.appendChild(s.stateNode);else if(4!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break;for(;null===s.sibling;){if(null===s.return||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}},Ol=function(){},Rl=function(e,t,s,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Jr(Vr.current);var r,i=null;switch(s){case"input":a=G(e,a),n=G(e,n),i=[];break;case"select":a=B({},a,{value:void 0}),n=B({},n,{value:void 0}),i=[];break;case"textarea":a=ne(e,a),n=ne(e,n),i=[];break;default:"function"!==typeof a.onClick&&"function"===typeof n.onClick&&(e.onclick=Zn)}for(d in ye(s,n),s=null,a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&null!=a[d])if("style"===d){var o=a[d];for(r in o)o.hasOwnProperty(r)&&(s||(s={}),s[r]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(l.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(o=null!=a?a[d]:void 0,n.hasOwnProperty(d)&&c!==o&&(null!=c||null!=o))if("style"===d)if(o){for(r in o)!o.hasOwnProperty(r)||c&&c.hasOwnProperty(r)||(s||(s={}),s[r]="");for(r in c)c.hasOwnProperty(r)&&o[r]!==c[r]&&(s||(s={}),s[r]=c[r])}else s||(i||(i=[]),i.push(d,s)),s=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,o=o?o.__html:void 0,null!=c&&o!==c&&(i=i||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(l.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Fn("scroll",e),i||o===c||(i=[])):(i=i||[]).push(d,c))}s&&(i=i||[]).push("style",s);var d=i;(t.updateQueue=d)&&(t.flags|=4)}},Al=function(e,t,s,n){s!==n&&(t.flags|=4)};var Jl=!1,Gl=!1,Ql="function"===typeof WeakSet?WeakSet:Set,Yl=null;function Xl(e,t){var s=e.ref;if(null!==s)if("function"===typeof s)try{s(null)}catch(n){Sc(e,t,n)}else s.current=null}function Zl(e,t,s){try{s()}catch(n){Sc(e,t,n)}}var eo=!1;function to(e,t,s){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var a=n=n.next;do{if((a.tag&e)===e){var r=a.destroy;a.destroy=void 0,void 0!==r&&Zl(t,s,r)}a=a.next}while(a!==n)}}function so(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var s=t=t.next;do{if((s.tag&e)===e){var n=s.create;s.destroy=n()}s=s.next}while(s!==t)}}function no(e){var t=e.ref;if(null!==t){var s=e.stateNode;e.tag,e=s,"function"===typeof t?t(e):t.current=e}}function ao(e){var t=e.alternate;null!==t&&(e.alternate=null,ao(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[ma],delete t[pa],delete t[ga],delete t[va])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ro(e){return 5===e.tag||3===e.tag||4===e.tag}function io(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ro(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function lo(e,t,s){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===s.nodeType?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(8===s.nodeType?(t=s.parentNode).insertBefore(e,s):(t=s).appendChild(e),null!==(s=s._reactRootContainer)&&void 0!==s||null!==t.onclick||(t.onclick=Zn));else if(4!==n&&null!==(e=e.child))for(lo(e,t,s),e=e.sibling;null!==e;)lo(e,t,s),e=e.sibling}function oo(e,t,s){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(4!==n&&null!==(e=e.child))for(oo(e,t,s),e=e.sibling;null!==e;)oo(e,t,s),e=e.sibling}var co=null,uo=!1;function ho(e,t,s){for(s=s.child;null!==s;)mo(e,t,s),s=s.sibling}function mo(e,t,s){if(rt&&"function"===typeof rt.onCommitFiberUnmount)try{rt.onCommitFiberUnmount(at,s)}catch(l){}switch(s.tag){case 5:Gl||Xl(s,t);case 6:var n=co,a=uo;co=null,ho(e,t,s),uo=a,null!==(co=n)&&(uo?(e=co,s=s.stateNode,8===e.nodeType?e.parentNode.removeChild(s):e.removeChild(s)):co.removeChild(s.stateNode));break;case 18:null!==co&&(uo?(e=co,s=s.stateNode,8===e.nodeType?oa(e.parentNode,s):1===e.nodeType&&oa(e,s),Wt(e)):oa(co,s.stateNode));break;case 4:n=co,a=uo,co=s.stateNode.containerInfo,uo=!0,ho(e,t,s),co=n,uo=a;break;case 0:case 11:case 14:case 15:if(!Gl&&(null!==(n=s.updateQueue)&&null!==(n=n.lastEffect))){a=n=n.next;do{var r=a,i=r.destroy;r=r.tag,void 0!==i&&(0!==(2&r)||0!==(4&r))&&Zl(s,t,i),a=a.next}while(a!==n)}ho(e,t,s);break;case 1:if(!Gl&&(Xl(s,t),"function"===typeof(n=s.stateNode).componentWillUnmount))try{n.props=s.memoizedProps,n.state=s.memoizedState,n.componentWillUnmount()}catch(l){Sc(s,t,l)}ho(e,t,s);break;case 21:ho(e,t,s);break;case 22:1&s.mode?(Gl=(n=Gl)||null!==s.memoizedState,ho(e,t,s),Gl=n):ho(e,t,s);break;default:ho(e,t,s)}}function fo(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var s=e.stateNode;null===s&&(s=e.stateNode=new Ql),t.forEach(function(t){var n=Ec.bind(null,e,t);s.has(t)||(s.add(t),t.then(n,n))})}}function po(e,t){var s=t.deletions;if(null!==s)for(var n=0;n<s.length;n++){var a=s[n];try{var i=e,l=t,o=l;e:for(;null!==o;){switch(o.tag){case 5:co=o.stateNode,uo=!1;break e;case 3:case 4:co=o.stateNode.containerInfo,uo=!0;break e}o=o.return}if(null===co)throw Error(r(160));mo(i,l,a),co=null,uo=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(d){Sc(a,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)go(t,e),t=t.sibling}function go(e,t){var s=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(po(t,e),vo(e),4&n){try{to(3,e,e.return),so(3,e)}catch(g){Sc(e,e.return,g)}try{to(5,e,e.return)}catch(g){Sc(e,e.return,g)}}break;case 1:po(t,e),vo(e),512&n&&null!==s&&Xl(s,s.return);break;case 5:if(po(t,e),vo(e),512&n&&null!==s&&Xl(s,s.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(g){Sc(e,e.return,g)}}if(4&n&&null!=(a=e.stateNode)){var i=e.memoizedProps,l=null!==s?s.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===o&&"radio"===i.type&&null!=i.name&&Y(a,i),xe(o,l);var d=xe(o,i);for(l=0;l<c.length;l+=2){var u=c[l],h=c[l+1];"style"===u?ge(a,h):"dangerouslySetInnerHTML"===u?ue(a,h):"children"===u?he(a,h):x(a,u,h,d)}switch(o){case"input":X(a,i);break;case"textarea":re(a,i);break;case"select":var m=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var f=i.value;null!=f?se(a,!!i.multiple,f,!1):m!==!!i.multiple&&(null!=i.defaultValue?se(a,!!i.multiple,i.defaultValue,!0):se(a,!!i.multiple,i.multiple?[]:"",!1))}a[ma]=i}catch(g){Sc(e,e.return,g)}}break;case 6:if(po(t,e),vo(e),4&n){if(null===e.stateNode)throw Error(r(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){Sc(e,e.return,g)}}break;case 3:if(po(t,e),vo(e),4&n&&null!==s&&s.memoizedState.isDehydrated)try{Wt(t.containerInfo)}catch(g){Sc(e,e.return,g)}break;case 4:default:po(t,e),vo(e);break;case 13:po(t,e),vo(e),8192&(a=e.child).flags&&(i=null!==a.memoizedState,a.stateNode.isHidden=i,!i||null!==a.alternate&&null!==a.alternate.memoizedState||(Mo=Ye())),4&n&&fo(e);break;case 22:if(u=null!==s&&null!==s.memoizedState,1&e.mode?(Gl=(d=Gl)||u,po(t,e),Gl=d):po(t,e),vo(e),8192&n){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Yl=e,u=e.child;null!==u;){for(h=Yl=u;null!==Yl;){switch(f=(m=Yl).child,m.tag){case 0:case 11:case 14:case 15:to(4,m,m.return);break;case 1:Xl(m,m.return);var p=m.stateNode;if("function"===typeof p.componentWillUnmount){n=m,s=m.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){Sc(n,s,g)}}break;case 5:Xl(m,m.return);break;case 22:if(null!==m.memoizedState){jo(h);continue}}null!==f?(f.return=m,Yl=f):jo(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{a=h.stateNode,d?"function"===typeof(i=a.style).setProperty?i.setProperty("display","none","important"):i.display="none":(o=h.stateNode,l=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,o.style.display=pe("display",l))}catch(g){Sc(e,e.return,g)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){Sc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:po(t,e),vo(e),4&n&&fo(e);case 21:}}function vo(e){var t=e.flags;if(2&t){try{e:{for(var s=e.return;null!==s;){if(ro(s)){var n=s;break e}s=s.return}throw Error(r(160))}switch(n.tag){case 5:var a=n.stateNode;32&n.flags&&(he(a,""),n.flags&=-33),oo(e,io(e),a);break;case 3:case 4:var i=n.stateNode.containerInfo;lo(e,io(e),i);break;default:throw Error(r(161))}}catch(l){Sc(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yo(e,t,s){Yl=e,xo(e,t,s)}function xo(e,t,s){for(var n=0!==(1&e.mode);null!==Yl;){var a=Yl,r=a.child;if(22===a.tag&&n){var i=null!==a.memoizedState||Jl;if(!i){var l=a.alternate,o=null!==l&&null!==l.memoizedState||Gl;l=Jl;var c=Gl;if(Jl=i,(Gl=o)&&!c)for(Yl=a;null!==Yl;)o=(i=Yl).child,22===i.tag&&null!==i.memoizedState?wo(a):null!==o?(o.return=i,Yl=o):wo(a);for(;null!==r;)Yl=r,xo(r,t,s),r=r.sibling;Yl=a,Jl=l,Gl=c}bo(e)}else 0!==(8772&a.subtreeFlags)&&null!==r?(r.return=a,Yl=r):bo(e)}}function bo(e){for(;null!==Yl;){var t=Yl;if(0!==(8772&t.flags)){var s=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Gl||so(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Gl)if(null===s)n.componentDidMount();else{var a=t.elementType===t.type?s.memoizedProps:tl(t.type,s.memoizedProps);n.componentDidUpdate(a,s.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&qr(t,i,n);break;case 3:var l=t.updateQueue;if(null!==l){if(s=null,null!==t.child)switch(t.child.tag){case 5:case 1:s=t.child.stateNode}qr(t,l,s)}break;case 5:var o=t.stateNode;if(null===s&&4&t.flags){s=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&s.focus();break;case"img":c.src&&(s.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Wt(h)}}}break;default:throw Error(r(163))}Gl||512&t.flags&&no(t)}catch(m){Sc(t,t.return,m)}}if(t===e){Yl=null;break}if(null!==(s=t.sibling)){s.return=t.return,Yl=s;break}Yl=t.return}}function jo(e){for(;null!==Yl;){var t=Yl;if(t===e){Yl=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Yl=s;break}Yl=t.return}}function wo(e){for(;null!==Yl;){var t=Yl;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{so(4,t)}catch(o){Sc(t,s,o)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var a=t.return;try{n.componentDidMount()}catch(o){Sc(t,a,o)}}var r=t.return;try{no(t)}catch(o){Sc(t,r,o)}break;case 5:var i=t.return;try{no(t)}catch(o){Sc(t,i,o)}}}catch(o){Sc(t,t.return,o)}if(t===e){Yl=null;break}var l=t.sibling;if(null!==l){l.return=t.return,Yl=l;break}Yl=t.return}}var No,So=Math.ceil,ko=b.ReactCurrentDispatcher,Co=b.ReactCurrentOwner,_o=b.ReactCurrentBatchConfig,Eo=0,To=null,Po=null,Oo=0,Ro=0,Ao=Sa(0),Io=0,Lo=null,Do=0,Bo=0,Uo=0,Fo=null,zo=null,Mo=0,Wo=1/0,qo=null,Ho=!1,Vo=null,Ko=null,$o=!1,Jo=null,Go=0,Qo=0,Yo=null,Xo=-1,Zo=0;function ec(){return 0!==(6&Eo)?Ye():-1!==Xo?Xo:Xo=Ye()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Eo)&&0!==Oo?Oo&-Oo:null!==pr.transition?(0===Zo&&(Zo=pt()),Zo):0!==(e=xt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function sc(e,t,s,n){if(50<Qo)throw Qo=0,Yo=null,Error(r(185));vt(e,s,n),0!==(2&Eo)&&e===To||(e===To&&(0===(2&Eo)&&(Bo|=s),4===Io&&lc(e,Oo)),nc(e,n),1===s&&0===Eo&&0===(1&t.mode)&&(Wo=Ye()+500,Fa&&Wa()))}function nc(e,t){var s=e.callbackNode;!function(e,t){for(var s=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,r=e.pendingLanes;0<r;){var i=31-it(r),l=1<<i,o=a[i];-1===o?0!==(l&s)&&0===(l&n)||(a[i]=mt(l,t)):o<=t&&(e.expiredLanes|=l),r&=~l}}(e,t);var n=ht(e,e===To?Oo:0);if(0===n)null!==s&&Je(s),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=s&&Je(s),1===t)0===e.tag?function(e){Fa=!0,Ma(e)}(oc.bind(null,e)):Ma(oc.bind(null,e)),ia(function(){0===(6&Eo)&&Wa()}),s=null;else{switch(bt(n)){case 1:s=Ze;break;case 4:s=et;break;case 16:default:s=tt;break;case 536870912:s=nt}s=Tc(s,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function ac(e,t){if(Xo=-1,Zo=0,0!==(6&Eo))throw Error(r(327));var s=e.callbackNode;if(wc()&&e.callbackNode!==s)return null;var n=ht(e,e===To?Oo:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=gc(e,n);else{t=n;var a=Eo;Eo|=2;var i=fc();for(To===e&&Oo===t||(qo=null,Wo=Ye()+500,hc(e,t));;)try{yc();break}catch(o){mc(e,o)}Cr(),ko.current=i,Eo=a,null!==Po?t=0:(To=null,Oo=0,t=Io)}if(0!==t){if(2===t&&(0!==(a=ft(e))&&(n=a,t=rc(e,a))),1===t)throw s=Lo,hc(e,0),lc(e,n),nc(e,Ye()),s;if(6===t)lc(e,n);else{if(a=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var s=t.updateQueue;if(null!==s&&null!==(s=s.stores))for(var n=0;n<s.length;n++){var a=s[n],r=a.getSnapshot;a=a.value;try{if(!ln(r(),a))return!1}catch(l){return!1}}}if(s=t.child,16384&t.subtreeFlags&&null!==s)s.return=t,t=s;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=gc(e,n))&&(0!==(i=ft(e))&&(n=i,t=rc(e,i))),1===t))throw s=Lo,hc(e,0),lc(e,n),nc(e,Ye()),s;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(r(345));case 2:case 5:jc(e,zo,qo);break;case 3:if(lc(e,n),(130023424&n)===n&&10<(t=Mo+500-Ye())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&n)!==n){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=na(jc.bind(null,e,zo,qo),t);break}jc(e,zo,qo);break;case 4:if(lc(e,n),(4194240&n)===n)break;for(t=e.eventTimes,a=-1;0<n;){var l=31-it(n);i=1<<l,(l=t[l])>a&&(a=l),n&=~i}if(n=a,10<(n=(120>(n=Ye()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*So(n/1960))-n)){e.timeoutHandle=na(jc.bind(null,e,zo,qo),n);break}jc(e,zo,qo);break;default:throw Error(r(329))}}}return nc(e,Ye()),e.callbackNode===s?ac.bind(null,e):null}function rc(e,t){var s=Fo;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=zo,zo=s,null!==t&&ic(t)),e}function ic(e){null===zo?zo=e:zo.push.apply(zo,e)}function lc(e,t){for(t&=~Uo,t&=~Bo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-it(t),n=1<<s;e[s]=-1,t&=~n}}function oc(e){if(0!==(6&Eo))throw Error(r(327));wc();var t=ht(e,0);if(0===(1&t))return nc(e,Ye()),null;var s=gc(e,t);if(0!==e.tag&&2===s){var n=ft(e);0!==n&&(t=n,s=rc(e,n))}if(1===s)throw s=Lo,hc(e,0),lc(e,t),nc(e,Ye()),s;if(6===s)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,jc(e,zo,qo),nc(e,Ye()),null}function cc(e,t){var s=Eo;Eo|=1;try{return e(t)}finally{0===(Eo=s)&&(Wo=Ye()+500,Fa&&Wa())}}function dc(e){null!==Jo&&0===Jo.tag&&0===(6&Eo)&&wc();var t=Eo;Eo|=1;var s=_o.transition,n=xt;try{if(_o.transition=null,xt=1,e)return e()}finally{xt=n,_o.transition=s,0===(6&(Eo=t))&&Wa()}}function uc(){Ro=Ao.current,ka(Ao)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(-1!==s&&(e.timeoutHandle=-1,aa(s)),null!==Po)for(s=Po.return;null!==s;){var n=s;switch(tr(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Aa();break;case 3:Qr(),ka(Ta),ka(Ea),si();break;case 5:Xr(n);break;case 4:Qr();break;case 13:case 19:ka(Zr);break;case 10:_r(n.type._context);break;case 22:case 23:uc()}s=s.return}if(To=e,Po=e=Ac(e.current,null),Oo=Ro=t,Io=0,Lo=null,Uo=Bo=Do=0,zo=Fo=null,null!==Or){for(t=0;t<Or.length;t++)if(null!==(n=(s=Or[t]).interleaved)){s.interleaved=null;var a=n.next,r=s.pending;if(null!==r){var i=r.next;r.next=a,n.next=i}s.pending=n}Or=null}return e}function mc(e,t){for(;;){var s=Po;try{if(Cr(),ni.current=Yi,ci){for(var n=ii.memoizedState;null!==n;){var a=n.queue;null!==a&&(a.pending=null),n=n.next}ci=!1}if(ri=0,oi=li=ii=null,di=!1,ui=0,Co.current=null,null===s||null===s.return){Io=1,Lo=t,Po=null;break}e:{var i=e,l=s.return,o=s,c=t;if(t=Oo,o.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=o,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=pl(l);if(null!==f){f.flags&=-257,gl(f,l,o,0,t),1&f.mode&&fl(i,d,t),c=d;var p=(t=f).updateQueue;if(null===p){var g=new Set;g.add(c),t.updateQueue=g}else p.add(c);break e}if(0===(1&t)){fl(i,d,t),pc();break e}c=Error(r(426))}else if(ar&&1&o.mode){var v=pl(l);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),gl(v,l,o,0,t),fr(ol(c,o));break e}}i=c=ol(c,o),4!==Io&&(Io=2),null===Fo?Fo=[i]:Fo.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Mr(i,hl(0,c,t));break e;case 1:o=c;var y=i.type,x=i.stateNode;if(0===(128&i.flags)&&("function"===typeof y.getDerivedStateFromError||null!==x&&"function"===typeof x.componentDidCatch&&(null===Ko||!Ko.has(x)))){i.flags|=65536,t&=-t,i.lanes|=t,Mr(i,ml(i,o,t));break e}}i=i.return}while(null!==i)}bc(s)}catch(b){t=b,Po===s&&null!==s&&(Po=s=s.return);continue}break}}function fc(){var e=ko.current;return ko.current=Yi,null===e?Yi:e}function pc(){0!==Io&&3!==Io&&2!==Io||(Io=4),null===To||0===(268435455&Do)&&0===(268435455&Bo)||lc(To,Oo)}function gc(e,t){var s=Eo;Eo|=2;var n=fc();for(To===e&&Oo===t||(qo=null,hc(e,t));;)try{vc();break}catch(a){mc(e,a)}if(Cr(),Eo=s,ko.current=n,null!==Po)throw Error(r(261));return To=null,Oo=0,Io}function vc(){for(;null!==Po;)xc(Po)}function yc(){for(;null!==Po&&!Ge();)xc(Po)}function xc(e){var t=No(e.alternate,e,Ro);e.memoizedProps=e.pendingProps,null===t?bc(e):Po=t,Co.current=null}function bc(e){var t=e;do{var s=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(s=Kl(s,t,Ro)))return void(Po=s)}else{if(null!==(s=$l(s,t)))return s.flags&=32767,void(Po=s);if(null===e)return Io=6,void(Po=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Po=t);Po=t=e}while(null!==t);0===Io&&(Io=5)}function jc(e,t,s){var n=xt,a=_o.transition;try{_o.transition=null,xt=1,function(e,t,s,n){do{wc()}while(null!==Jo);if(0!==(6&Eo))throw Error(r(327));s=e.finishedWork;var a=e.finishedLanes;if(null===s)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var i=s.lanes|s.childLanes;if(function(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<s;){var a=31-it(s),r=1<<a;t[a]=0,n[a]=-1,e[a]=-1,s&=~r}}(e,i),e===To&&(Po=To=null,Oo=0),0===(2064&s.subtreeFlags)&&0===(2064&s.flags)||$o||($o=!0,Tc(tt,function(){return wc(),null})),i=0!==(15990&s.flags),0!==(15990&s.subtreeFlags)||i){i=_o.transition,_o.transition=null;var l=xt;xt=1;var o=Eo;Eo|=4,Co.current=null,function(e,t){if(ea=Ht,mn(e=hn())){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(s=(s=e.ownerDocument)&&s.defaultView||window).getSelection&&s.getSelection();if(n&&0!==n.rangeCount){s=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{s.nodeType,i.nodeType}catch(j){s=null;break e}var l=0,o=-1,c=-1,d=0,u=0,h=e,m=null;t:for(;;){for(var f;h!==s||0!==a&&3!==h.nodeType||(o=l+a),h!==i||0!==n&&3!==h.nodeType||(c=l+n),3===h.nodeType&&(l+=h.nodeValue.length),null!==(f=h.firstChild);)m=h,h=f;for(;;){if(h===e)break t;if(m===s&&++d===a&&(o=l),m===i&&++u===n&&(c=l),null!==(f=h.nextSibling))break;m=(h=m).parentNode}h=f}s=-1===o||-1===c?null:{start:o,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(ta={focusedElem:e,selectionRange:s},Ht=!1,Yl=t;null!==Yl;)if(e=(t=Yl).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Yl=e;else for(;null!==Yl;){t=Yl;try{var p=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var g=p.memoizedProps,v=p.memoizedState,y=t.stateNode,x=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:tl(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(r(163))}}catch(j){Sc(t,t.return,j)}if(null!==(e=t.sibling)){e.return=t.return,Yl=e;break}Yl=t.return}p=eo,eo=!1}(e,s),go(s,e),fn(ta),Ht=!!ea,ta=ea=null,e.current=s,yo(s,e,a),Qe(),Eo=o,xt=l,_o.transition=i}else e.current=s;if($o&&($o=!1,Jo=e,Go=a),i=e.pendingLanes,0===i&&(Ko=null),function(e){if(rt&&"function"===typeof rt.onCommitFiberRoot)try{rt.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(s.stateNode),nc(e,Ye()),null!==t)for(n=e.onRecoverableError,s=0;s<t.length;s++)a=t[s],n(a.value,{componentStack:a.stack,digest:a.digest});if(Ho)throw Ho=!1,e=Vo,Vo=null,e;0!==(1&Go)&&0!==e.tag&&wc(),i=e.pendingLanes,0!==(1&i)?e===Yo?Qo++:(Qo=0,Yo=e):Qo=0,Wa()}(e,t,s,n)}finally{_o.transition=a,xt=n}return null}function wc(){if(null!==Jo){var e=bt(Go),t=_o.transition,s=xt;try{if(_o.transition=null,xt=16>e?16:e,null===Jo)var n=!1;else{if(e=Jo,Jo=null,Go=0,0!==(6&Eo))throw Error(r(331));var a=Eo;for(Eo|=4,Yl=e.current;null!==Yl;){var i=Yl,l=i.child;if(0!==(16&Yl.flags)){var o=i.deletions;if(null!==o){for(var c=0;c<o.length;c++){var d=o[c];for(Yl=d;null!==Yl;){var u=Yl;switch(u.tag){case 0:case 11:case 15:to(8,u,i)}var h=u.child;if(null!==h)h.return=u,Yl=h;else for(;null!==Yl;){var m=(u=Yl).sibling,f=u.return;if(ao(u),u===d){Yl=null;break}if(null!==m){m.return=f,Yl=m;break}Yl=f}}}var p=i.alternate;if(null!==p){var g=p.child;if(null!==g){p.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Yl=i}}if(0!==(2064&i.subtreeFlags)&&null!==l)l.return=i,Yl=l;else e:for(;null!==Yl;){if(0!==(2048&(i=Yl).flags))switch(i.tag){case 0:case 11:case 15:to(9,i,i.return)}var y=i.sibling;if(null!==y){y.return=i.return,Yl=y;break e}Yl=i.return}}var x=e.current;for(Yl=x;null!==Yl;){var b=(l=Yl).child;if(0!==(2064&l.subtreeFlags)&&null!==b)b.return=l,Yl=b;else e:for(l=x;null!==Yl;){if(0!==(2048&(o=Yl).flags))try{switch(o.tag){case 0:case 11:case 15:so(9,o)}}catch(w){Sc(o,o.return,w)}if(o===l){Yl=null;break e}var j=o.sibling;if(null!==j){j.return=o.return,Yl=j;break e}Yl=o.return}}if(Eo=a,Wa(),rt&&"function"===typeof rt.onPostCommitFiberRoot)try{rt.onPostCommitFiberRoot(at,e)}catch(w){}n=!0}return n}finally{xt=s,_o.transition=t}}return!1}function Nc(e,t,s){e=Fr(e,t=hl(0,t=ol(s,t),1),1),t=ec(),null!==e&&(vt(e,1,t),nc(e,t))}function Sc(e,t,s){if(3===e.tag)Nc(e,e,s);else for(;null!==t;){if(3===t.tag){Nc(t,e,s);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Ko||!Ko.has(n))){t=Fr(t,e=ml(t,e=ol(s,e),1),1),e=ec(),null!==t&&(vt(t,1,e),nc(t,e));break}}t=t.return}}function kc(e,t,s){var n=e.pingCache;null!==n&&n.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&s,To===e&&(Oo&s)===s&&(4===Io||3===Io&&(130023424&Oo)===Oo&&500>Ye()-Mo?hc(e,0):Uo|=s),nc(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var s=ec();null!==(e=Ir(e,t))&&(vt(e,t,s),nc(e,s))}function _c(e){var t=e.memoizedState,s=0;null!==t&&(s=t.retryLane),Cc(e,s)}function Ec(e,t){var s=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;null!==a&&(s=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(r(314))}null!==n&&n.delete(t),Cc(e,s)}function Tc(e,t){return $e(e,t)}function Pc(e,t,s,n){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oc(e,t,s,n){return new Pc(e,t,s,n)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ac(e,t){var s=e.alternate;return null===s?((s=Oc(e.tag,t,e.key,e.mode)).elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=14680064&e.flags,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Ic(e,t,s,n,a,i){var l=2;if(n=e,"function"===typeof e)Rc(e)&&(l=1);else if("string"===typeof e)l=5;else e:switch(e){case N:return Lc(s.children,a,i,t);case S:l=8,a|=8;break;case k:return(e=Oc(12,s,t,2|a)).elementType=k,e.lanes=i,e;case T:return(e=Oc(13,s,t,a)).elementType=T,e.lanes=i,e;case P:return(e=Oc(19,s,t,a)).elementType=P,e.lanes=i,e;case A:return Dc(s,a,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:l=10;break e;case _:l=9;break e;case E:l=11;break e;case O:l=14;break e;case R:l=16,n=null;break e}throw Error(r(130,null==e?e:typeof e,""))}return(t=Oc(l,s,t,a)).elementType=e,t.type=n,t.lanes=i,t}function Lc(e,t,s,n){return(e=Oc(7,e,n,t)).lanes=s,e}function Dc(e,t,s,n){return(e=Oc(22,e,n,t)).elementType=A,e.lanes=s,e.stateNode={isHidden:!1},e}function Bc(e,t,s){return(e=Oc(6,e,null,t)).lanes=s,e}function Uc(e,t,s){return(t=Oc(4,null!==e.children?e.children:[],e.key,t)).lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Fc(e,t,s,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function zc(e,t,s,n,a,r,i,l,o){return e=new Fc(e,t,s,l,o),1===t?(t=1,!0===r&&(t|=8)):t=0,r=Oc(3,null,null,t),e.current=r,r.stateNode=e,r.memoizedState={element:n,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dr(r),e}function Mc(e){if(!e)return _a;e:{if(We(e=e._reactInternals)!==e||1!==e.tag)throw Error(r(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ra(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(r(171))}if(1===e.tag){var s=e.type;if(Ra(s))return La(e,s,t)}return t}function Wc(e,t,s,n,a,r,i,l,o){return(e=zc(s,n,!0,e,0,r,0,l,o)).context=Mc(null),s=e.current,(r=Ur(n=ec(),a=tc(s))).callback=void 0!==t&&null!==t?t:null,Fr(s,r,a),e.current.lanes=a,vt(e,a,n),nc(e,n),e}function qc(e,t,s,n){var a=t.current,r=ec(),i=tc(a);return s=Mc(s),null===t.context?t.context=s:t.pendingContext=s,(t=Ur(r,i)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=Fr(a,t,i))&&(sc(e,a,i,r),zr(e,a,i)),i}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var s=e.retryLane;e.retryLane=0!==s&&s<t?s:t}}function Kc(e,t){Vc(e,t),(e=e.alternate)&&Vc(e,t)}No=function(e,t,s){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ta.current)yl=!0;else{if(0===(e.lanes&s)&&0===(128&t.flags))return yl=!1,function(e,t,s){switch(t.tag){case 3:El(t),mr();break;case 5:Yr(t);break;case 1:Ra(t.type)&&Da(t);break;case 4:Gr(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Ca(wr,n._currentValue),n._currentValue=a;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Ca(Zr,1&Zr.current),t.flags|=128,null):0!==(s&t.child.childLanes)?Dl(e,t,s):(Ca(Zr,1&Zr.current),null!==(e=ql(e,t,s))?e.sibling:null);Ca(Zr,1&Zr.current);break;case 19:if(n=0!==(s&t.childLanes),0!==(128&e.flags)){if(n)return Ml(e,t,s);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ca(Zr,Zr.current),n)break;return null;case 22:case 23:return t.lanes=0,Nl(e,t,s)}return ql(e,t,s)}(e,t,s);yl=0!==(131072&e.flags)}else yl=!1,ar&&0!==(1048576&t.flags)&&Za(t,Ka,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Wl(e,t),e=t.pendingProps;var a=Oa(t,Ea.current);Tr(t,s),a=pi(null,t,n,e,a,s);var i=gi();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ra(n)?(i=!0,Da(t)):i=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Dr(t),a.updater=nl,t.stateNode=a,a._reactInternals=t,ll(t,n,e,s),t=_l(null,t,n,!0,i,s)):(t.tag=0,ar&&i&&er(t),xl(null,t,a,s),t=t.child),t;case 16:n=t.elementType;e:{switch(Wl(e,t),e=t.pendingProps,n=(a=n._init)(n._payload),t.type=n,a=t.tag=function(e){if("function"===typeof e)return Rc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===O)return 14}return 2}(n),e=tl(n,e),a){case 0:t=kl(null,t,n,e,s);break e;case 1:t=Cl(null,t,n,e,s);break e;case 11:t=bl(null,t,n,e,s);break e;case 14:t=jl(null,t,n,tl(n.type,e),s);break e}throw Error(r(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,kl(e,t,n,a=t.elementType===n?a:tl(n,a),s);case 1:return n=t.type,a=t.pendingProps,Cl(e,t,n,a=t.elementType===n?a:tl(n,a),s);case 3:e:{if(El(t),null===e)throw Error(r(387));n=t.pendingProps,a=(i=t.memoizedState).element,Br(e,t),Wr(t,n,null,s);var l=t.memoizedState;if(n=l.element,i.isDehydrated){if(i={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Tl(e,t,n,s,a=ol(Error(r(423)),t));break e}if(n!==a){t=Tl(e,t,n,s,a=ol(Error(r(424)),t));break e}for(nr=ca(t.stateNode.containerInfo.firstChild),sr=t,ar=!0,rr=null,s=jr(t,null,n,s),t.child=s;s;)s.flags=-3&s.flags|4096,s=s.sibling}else{if(mr(),n===a){t=ql(e,t,s);break e}xl(e,t,n,s)}t=t.child}return t;case 5:return Yr(t),null===e&&cr(t),n=t.type,a=t.pendingProps,i=null!==e?e.memoizedProps:null,l=a.children,sa(n,a)?l=null:null!==i&&sa(n,i)&&(t.flags|=32),Sl(e,t),xl(e,t,l,s),t.child;case 6:return null===e&&cr(t),null;case 13:return Dl(e,t,s);case 4:return Gr(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=br(t,null,n,s):xl(e,t,n,s),t.child;case 11:return n=t.type,a=t.pendingProps,bl(e,t,n,a=t.elementType===n?a:tl(n,a),s);case 7:return xl(e,t,t.pendingProps,s),t.child;case 8:case 12:return xl(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,l=a.value,Ca(wr,n._currentValue),n._currentValue=l,null!==i)if(ln(i.value,l)){if(i.children===a.children&&!Ta.current){t=ql(e,t,s);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var o=i.dependencies;if(null!==o){l=i.child;for(var c=o.firstContext;null!==c;){if(c.context===n){if(1===i.tag){(c=Ur(-1,s&-s)).tag=2;var d=i.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=s,null!==(c=i.alternate)&&(c.lanes|=s),Er(i.return,s,t),o.lanes|=s;break}c=c.next}}else if(10===i.tag)l=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(l=i.return))throw Error(r(341));l.lanes|=s,null!==(o=l.alternate)&&(o.lanes|=s),Er(l,s,t),l=i.sibling}else l=i.child;if(null!==l)l.return=i;else for(l=i;null!==l;){if(l===t){l=null;break}if(null!==(i=l.sibling)){i.return=l.return,l=i;break}l=l.return}i=l}xl(e,t,a.children,s),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Tr(t,s),n=n(a=Pr(a)),t.flags|=1,xl(e,t,n,s),t.child;case 14:return a=tl(n=t.type,t.pendingProps),jl(e,t,n,a=tl(n.type,a),s);case 15:return wl(e,t,t.type,t.pendingProps,s);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:tl(n,a),Wl(e,t),t.tag=1,Ra(n)?(e=!0,Da(t)):e=!1,Tr(t,s),rl(t,n,a),ll(t,n,a,s),_l(null,t,n,!0,e,s);case 19:return Ml(e,t,s);case 22:return Nl(e,t,s)}throw Error(r(156,t.tag))};var $c="function"===typeof reportError?reportError:function(e){console.error(e)};function Jc(e){this._internalRoot=e}function Gc(e){this._internalRoot=e}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Zc(e,t,s,n,a){var r=s._reactRootContainer;if(r){var i=r;if("function"===typeof a){var l=a;a=function(){var e=Hc(i);l.call(e)}}qc(t,i,e,a)}else i=function(e,t,s,n,a){if(a){if("function"===typeof n){var r=n;n=function(){var e=Hc(i);r.call(e)}}var i=Wc(t,n,e,0,null,!1,0,"",Xc);return e._reactRootContainer=i,e[fa]=i.current,Wn(8===e.nodeType?e.parentNode:e),dc(),i}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof n){var l=n;n=function(){var e=Hc(o);l.call(e)}}var o=zc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=o,e[fa]=o.current,Wn(8===e.nodeType?e.parentNode:e),dc(function(){qc(t,o,s,n)}),o}(s,t,e,a,n);return Hc(i)}Gc.prototype.render=Jc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));qc(e,t,null,null)},Gc.prototype.unmount=Jc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc(function(){qc(null,e,null,null)}),t[fa]=null}},Gc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var s=0;s<At.length&&0!==t&&t<At[s].priority;s++);At.splice(s,0,e),0===s&&Bt(e)}},jt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=ut(t.pendingLanes);0!==s&&(yt(t,1|s),nc(t,Ye()),0===(6&Eo)&&(Wo=Ye()+500,Wa()))}break;case 13:dc(function(){var t=Ir(e,1);if(null!==t){var s=ec();sc(t,e,1,s)}}),Kc(e,1)}},wt=function(e){if(13===e.tag){var t=Ir(e,134217728);if(null!==t)sc(t,e,134217728,ec());Kc(e,134217728)}},Nt=function(e){if(13===e.tag){var t=tc(e),s=Ir(e,t);if(null!==s)sc(s,e,t,ec());Kc(e,t)}},St=function(){return xt},kt=function(e,t){var s=xt;try{return xt=e,t()}finally{xt=s}},we=function(e,t,s){switch(t){case"input":if(X(e,s),t=s.name,"radio"===s.type&&null!=t){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var n=s[t];if(n!==e&&n.form===e.form){var a=ja(n);if(!a)throw Error(r(90));$(n),X(n,a)}}}break;case"textarea":re(e,s);break;case"select":null!=(t=s.value)&&se(e,!!s.multiple,t,!1)}},Ee=cc,Te=dc;var ed={usingClientEntryPoint:!1,Events:[xa,ba,ja,Ce,_e,cc]},td={findFiberByHostInstance:ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ve(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nd.isDisabled&&nd.supportsFiber)try{at=nd.inject(sd),rt=nd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qc(t))throw Error(r(200));return function(e,t,s){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==n?null:""+n,children:e,containerInfo:t,implementation:s}}(e,t,null,s)},t.createRoot=function(e,t){if(!Qc(e))throw Error(r(299));var s=!1,n="",a=$c;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(s=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=zc(e,1,!1,null,0,s,0,n,a),e[fa]=t.current,Wn(8===e.nodeType?e.parentNode:e),new Jc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return e=null===(e=Ve(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,s){if(!Yc(t))throw Error(r(200));return Zc(null,e,t,!0,s)},t.hydrateRoot=function(e,t,s){if(!Qc(e))throw Error(r(405));var n=null!=s&&s.hydratedSources||null,a=!1,i="",l=$c;if(null!==s&&void 0!==s&&(!0===s.unstable_strictMode&&(a=!0),void 0!==s.identifierPrefix&&(i=s.identifierPrefix),void 0!==s.onRecoverableError&&(l=s.onRecoverableError)),t=Wc(t,null,e,1,null!=s?s:null,a,0,i,l),e[fa]=t.current,Wn(e),n)for(e=0;e<n.length;e++)a=(a=(s=n[e])._getVersion)(s._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[s,a]:t.mutableSourceEagerHydrationData.push(s,a);return new Gc(t)},t.render=function(e,t,s){if(!Yc(t))throw Error(r(200));return Zc(null,e,t,!1,s)},t.unmountComponentAtNode=function(e){if(!Yc(e))throw Error(r(40));return!!e._reactRootContainer&&(dc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[fa]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,s,n){if(!Yc(s))throw Error(r(200));if(null==e||void 0===e._reactInternals)throw Error(r(38));return Zc(e,t,s,!1,n)},t.version="18.3.1-next-f1338f8080-20240426"},736:function(e,t,s){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(s(374));class r extends a.default{eq(e,t){return this.url.searchParams.append(e,"eq.".concat(t)),this}neq(e,t){return this.url.searchParams.append(e,"neq.".concat(t)),this}gt(e,t){return this.url.searchParams.append(e,"gt.".concat(t)),this}gte(e,t){return this.url.searchParams.append(e,"gte.".concat(t)),this}lt(e,t){return this.url.searchParams.append(e,"lt.".concat(t)),this}lte(e,t){return this.url.searchParams.append(e,"lte.".concat(t)),this}like(e,t){return this.url.searchParams.append(e,"like.".concat(t)),this}likeAllOf(e,t){return this.url.searchParams.append(e,"like(all).{".concat(t.join(","),"}")),this}likeAnyOf(e,t){return this.url.searchParams.append(e,"like(any).{".concat(t.join(","),"}")),this}ilike(e,t){return this.url.searchParams.append(e,"ilike.".concat(t)),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,"ilike(all).{".concat(t.join(","),"}")),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,"ilike(any).{".concat(t.join(","),"}")),this}is(e,t){return this.url.searchParams.append(e,"is.".concat(t)),this}in(e,t){const s=Array.from(new Set(t)).map(e=>"string"===typeof e&&new RegExp("[,()]").test(e)?'"'.concat(e,'"'):"".concat(e)).join(",");return this.url.searchParams.append(e,"in.(".concat(s,")")),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cs.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cs.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cs.".concat(JSON.stringify(t))),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cd.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cd.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cd.".concat(JSON.stringify(t))),this}rangeGt(e,t){return this.url.searchParams.append(e,"sr.".concat(t)),this}rangeGte(e,t){return this.url.searchParams.append(e,"nxl.".concat(t)),this}rangeLt(e,t){return this.url.searchParams.append(e,"sl.".concat(t)),this}rangeLte(e,t){return this.url.searchParams.append(e,"nxr.".concat(t)),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,"adj.".concat(t)),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,"ov.".concat(t)):this.url.searchParams.append(e,"ov.{".concat(t.join(","),"}")),this}textSearch(e,t){let{config:s,type:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="";"plain"===n?a="pl":"phrase"===n?a="ph":"websearch"===n&&(a="w");const r=void 0===s?"":"(".concat(s,")");return this.url.searchParams.append(e,"".concat(a,"fts").concat(r,".").concat(t)),this}match(e){return Object.entries(e).forEach(e=>{let[t,s]=e;this.url.searchParams.append(t,"eq.".concat(s))}),this}not(e,t,s){return this.url.searchParams.append(e,"not.".concat(t,".").concat(s)),this}or(e){let{foreignTable:t,referencedTable:s=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=s?"".concat(s,".or"):"or";return this.url.searchParams.append(n,"(".concat(e,")")),this}filter(e,t,s){return this.url.searchParams.append(e,"".concat(t,".").concat(s)),this}}t.default=r},829:function(e,t,s){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(s(736));t.default=class{constructor(e,t){let{headers:s={},schema:n,fetch:a}=t;this.url=e,this.headers=new Headers(s),this.schema=n,this.fetch=a}select(e,t){const{head:s=!1,count:n}=null!==t&&void 0!==t?t:{},r=s?"HEAD":"GET";let i=!1;const l=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!i?"":('"'===e&&(i=!i),e)).join("");return this.url.searchParams.set("select",l),n&&this.headers.append("Prefer","count=".concat(n)),new a.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e){let{count:t,defaultToNull:s=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;if(t&&this.headers.append("Prefer","count=".concat(t)),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));this.url.searchParams.set("columns",e.join(","))}}return new a.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch})}upsert(e){let{onConflict:t,ignoreDuplicates:s=!1,count:n,defaultToNull:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var i;if(this.headers.append("Prefer","resolution=".concat(s?"ignore":"merge","-duplicates")),void 0!==t&&this.url.searchParams.set("on_conflict",t),n&&this.headers.append("Prefer","count=".concat(n)),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));this.url.searchParams.set("columns",e.join(","))}}return new a.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s;return t&&this.headers.append("Prefer","count=".concat(t)),new a.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;return e&&this.headers.append("Prefer","count=".concat(e)),new a.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})}}},853:(e,t,s)=>{e.exports=s(234)},950:(e,t,s)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=s(730)},960:(e,t,s)=>{e.exports=s(153)},980:function(e,t,s){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;const a=n(s(210));t.PostgrestClient=a.default;const r=n(s(829));t.PostgrestQueryBuilder=r.default;const i=n(s(736));t.PostgrestFilterBuilder=i.default;const l=n(s(374));t.PostgrestTransformBuilder=l.default;const o=n(s(286));t.PostgrestBuilder=o.default;const c=n(s(611));t.PostgrestError=c.default,t.default={PostgrestClient:a.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:l.default,PostgrestBuilder:o.default,PostgrestError:c.default}}},t={};function s(n){var a=t[n];if(void 0!==a)return a.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,s),r.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;s.t=function(n,a){if(1&a&&(n=this(n)),8&a)return n;if("object"===typeof n&&n){if(4&a&&n.__esModule)return n;if(16&a&&"function"===typeof n.then)return n}var r=Object.create(null);s.r(r);var i={};e=e||[null,t({}),t([]),t(t)];for(var l=2&a&&n;("object"==typeof l||"function"==typeof l)&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach(e=>i[e]=()=>n[e]);return i.default=()=>n,s.d(r,i),r}})(),s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n,a=s(43),r=s.t(a,2),i=s(391),l=s(950),o=s.t(l,2);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},c.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(n||(n={}));const d="popstate";function u(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function h(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(s){}}}function m(e,t){return{usr:e.state,key:e.key,idx:t}}function f(e,t,s,n){return void 0===s&&(s=null),c({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?g(t):t,{state:s,key:t&&t.key||n||Math.random().toString(36).substr(2,8)})}function p(e){let{pathname:t="/",search:s="",hash:n=""}=e;return s&&"?"!==s&&(t+="?"===s.charAt(0)?s:"?"+s),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function g(e){let t={};if(e){let s=e.indexOf("#");s>=0&&(t.hash=e.substr(s),e=e.substr(0,s));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function v(e,t,s,a){void 0===a&&(a={});let{window:r=document.defaultView,v5Compat:i=!1}=a,l=r.history,o=n.Pop,h=null,g=v();function v(){return(l.state||{idx:null}).idx}function y(){o=n.Pop;let e=v(),t=null==e?null:e-g;g=e,h&&h({action:o,location:b.location,delta:t})}function x(e){let t="null"!==r.location.origin?r.location.origin:r.location.href,s="string"===typeof e?e:p(e);return s=s.replace(/ $/,"%20"),u(t,"No window.location.(origin|href) available to create URL for href: "+s),new URL(s,t)}null==g&&(g=0,l.replaceState(c({},l.state,{idx:g}),""));let b={get action(){return o},get location(){return e(r,l)},listen(e){if(h)throw new Error("A history only accepts one active listener");return r.addEventListener(d,y),h=e,()=>{r.removeEventListener(d,y),h=null}},createHref:e=>t(r,e),createURL:x,encodeLocation(e){let t=x(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o=n.Push;let a=f(b.location,e,t);s&&s(a,e),g=v()+1;let c=m(a,g),d=b.createHref(a);try{l.pushState(c,"",d)}catch(u){if(u instanceof DOMException&&"DataCloneError"===u.name)throw u;r.location.assign(d)}i&&h&&h({action:o,location:b.location,delta:1})},replace:function(e,t){o=n.Replace;let a=f(b.location,e,t);s&&s(a,e),g=v();let r=m(a,g),c=b.createHref(a);l.replaceState(r,"",c),i&&h&&h({action:o,location:b.location,delta:0})},go:e=>l.go(e)};return b}var y;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(y||(y={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function x(e,t,s){return void 0===s&&(s="/"),b(e,t,s,!1)}function b(e,t,s,n){let a=I(("string"===typeof t?g(t):t).pathname||"/",s);if(null==a)return null;let r=j(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let s=e.length===t.length&&e.slice(0,-1).every((e,s)=>e===t[s]);return s?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(r);let i=null;for(let l=0;null==i&&l<r.length;++l){let e=A(a);i=O(r[l],e,n)}return i}function j(e,t,s,n){void 0===t&&(t=[]),void 0===s&&(s=[]),void 0===n&&(n="");let a=(e,a,r)=>{let i={relativePath:void 0===r?e.path||"":r,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};i.relativePath.startsWith("/")&&(u(i.relativePath.startsWith(n),'Absolute route path "'+i.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(n.length));let l=F([n,i.relativePath]),o=s.concat(i);e.children&&e.children.length>0&&(u(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+l+'".'),j(e.children,t,o,l)),(null!=e.path||e.index)&&t.push({path:l,score:P(l,e.index),routesMeta:o})};return e.forEach((e,t)=>{var s;if(""!==e.path&&null!=(s=e.path)&&s.includes("?"))for(let n of w(e.path))a(e,t,n);else a(e,t)}),t}function w(e){let t=e.split("/");if(0===t.length)return[];let[s,...n]=t,a=s.endsWith("?"),r=s.replace(/\?$/,"");if(0===n.length)return a?[r,""]:[r];let i=w(n.join("/")),l=[];return l.push(...i.map(e=>""===e?r:[r,e].join("/"))),a&&l.push(...i),l.map(t=>e.startsWith("/")&&""===t?"/":t)}const N=/^:[\w-]+$/,S=3,k=2,C=1,_=10,E=-2,T=e=>"*"===e;function P(e,t){let s=e.split("/"),n=s.length;return s.some(T)&&(n+=E),t&&(n+=k),s.filter(e=>!T(e)).reduce((e,t)=>e+(N.test(t)?S:""===t?C:_),n)}function O(e,t,s){void 0===s&&(s=!1);let{routesMeta:n}=e,a={},r="/",i=[];for(let l=0;l<n.length;++l){let e=n[l],o=l===n.length-1,c="/"===r?t:t.slice(r.length)||"/",d=R({path:e.relativePath,caseSensitive:e.caseSensitive,end:o},c),u=e.route;if(!d&&o&&s&&!n[n.length-1].route.index&&(d=R({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:F([r,d.pathname]),pathnameBase:z(F([r,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(r=F([r,d.pathnameBase]))}return i}function R(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[s,n]=function(e,t,s){void 0===t&&(t=!1);void 0===s&&(s=!0);h("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,s)=>(n.push({paramName:t,isOptional:null!=s}),s?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(n.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let r=new RegExp(a,t?void 0:"i");return[r,n]}(e.path,e.caseSensitive,e.end),a=t.match(s);if(!a)return null;let r=a[0],i=r.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((e,t,s)=>{let{paramName:n,isOptional:a}=t;if("*"===n){let e=l[s]||"";i=r.slice(0,r.length-e.length).replace(/(.)\/+$/,"$1")}const o=l[s];return e[n]=a&&!o?void 0:(o||"").replace(/%2F/g,"/"),e},{}),pathname:r,pathnameBase:i,pattern:e}}function A(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return h(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function I(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,n=e.charAt(s);return n&&"/"!==n?null:e.slice(s)||"/"}function L(e,t,s,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+s+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function D(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function B(e,t){let s=D(e);return t?s.map((e,t)=>t===s.length-1?e.pathname:e.pathnameBase):s.map(e=>e.pathnameBase)}function U(e,t,s,n){let a;void 0===n&&(n=!1),"string"===typeof e?a=g(e):(a=c({},e),u(!a.pathname||!a.pathname.includes("?"),L("?","pathname","search",a)),u(!a.pathname||!a.pathname.includes("#"),L("#","pathname","hash",a)),u(!a.search||!a.search.includes("#"),L("#","search","hash",a)));let r,i=""===e||""===a.pathname,l=i?"/":a.pathname;if(null==l)r=s;else{let e=t.length-1;if(!n&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}r=e>=0?t[e]:"/"}let o=function(e,t){void 0===t&&(t="/");let{pathname:s,search:n="",hash:a=""}="string"===typeof e?g(e):e,r=s?s.startsWith("/")?s:function(e,t){let s=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?s.length>1&&s.pop():"."!==e&&s.push(e)}),s.length>1?s.join("/"):"/"}(s,t):t;return{pathname:r,search:M(n),hash:W(a)}}(a,r),d=l&&"/"!==l&&l.endsWith("/"),h=(i||"."===l)&&s.endsWith("/");return o.pathname.endsWith("/")||!d&&!h||(o.pathname+="/"),o}const F=e=>e.join("/").replace(/\/\/+/g,"/"),z=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),M=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",W=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function q(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const H=["post","put","patch","delete"],V=(new Set(H),["get",...H]);new Set(V),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function K(){return K=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},K.apply(this,arguments)}const $=a.createContext(null);const J=a.createContext(null);const G=a.createContext(null);const Q=a.createContext(null);const Y=a.createContext({outlet:null,matches:[],isDataRoute:!1});const X=a.createContext(null);function Z(){return null!=a.useContext(Q)}function ee(){return Z()||u(!1),a.useContext(Q).location}function te(e){a.useContext(G).static||a.useLayoutEffect(e)}function se(){let{isDataRoute:e}=a.useContext(Y);return e?function(){let{router:e}=ue(ce.UseNavigateStable),t=me(de.UseNavigateStable),s=a.useRef(!1);return te(()=>{s.current=!0}),a.useCallback(function(n,a){void 0===a&&(a={}),s.current&&("number"===typeof n?e.navigate(n):e.navigate(n,K({fromRouteId:t},a)))},[e,t])}():function(){Z()||u(!1);let e=a.useContext($),{basename:t,future:s,navigator:n}=a.useContext(G),{matches:r}=a.useContext(Y),{pathname:i}=ee(),l=JSON.stringify(B(r,s.v7_relativeSplatPath)),o=a.useRef(!1);return te(()=>{o.current=!0}),a.useCallback(function(s,a){if(void 0===a&&(a={}),!o.current)return;if("number"===typeof s)return void n.go(s);let r=U(s,JSON.parse(l),i,"path"===a.relative);null==e&&"/"!==t&&(r.pathname="/"===r.pathname?t:F([t,r.pathname])),(a.replace?n.replace:n.push)(r,a.state,a)},[t,n,l,i,e])}()}function ne(e,t,s,r){Z()||u(!1);let{navigator:i}=a.useContext(G),{matches:l}=a.useContext(Y),o=l[l.length-1],c=o?o.params:{},d=(o&&o.pathname,o?o.pathnameBase:"/");o&&o.route;let h,m=ee();if(t){var f;let e="string"===typeof t?g(t):t;"/"===d||(null==(f=e.pathname)?void 0:f.startsWith(d))||u(!1),h=e}else h=m;let p=h.pathname||"/",v=p;if("/"!==d){let e=d.replace(/^\//,"").split("/");v="/"+p.replace(/^\//,"").split("/").slice(e.length).join("/")}let y=x(e,{pathname:v});let b=oe(y&&y.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:F([d,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:F([d,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),l,s,r);return t&&b?a.createElement(Q.Provider,{value:{location:K({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:n.Pop}},b):b}function ae(){let e=function(){var e;let t=a.useContext(X),s=he(de.UseRouteError),n=me(de.UseRouteError);if(void 0!==t)return t;return null==(e=s.errors)?void 0:e[n]}(),t=q(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:n};return a.createElement(a.Fragment,null,a.createElement("h2",null,"Unexpected Application Error!"),a.createElement("h3",{style:{fontStyle:"italic"}},t),s?a.createElement("pre",{style:r},s):null,null)}const re=a.createElement(ae,null);class ie extends a.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?a.createElement(Y.Provider,{value:this.props.routeContext},a.createElement(X.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function le(e){let{routeContext:t,match:s,children:n}=e,r=a.useContext($);return r&&r.static&&r.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=s.route.id),a.createElement(Y.Provider,{value:t},n)}function oe(e,t,s,n){var r;if(void 0===t&&(t=[]),void 0===s&&(s=null),void 0===n&&(n=null),null==e){var i;if(!s)return null;if(s.errors)e=s.matches;else{if(!(null!=(i=n)&&i.v7_partialHydration&&0===t.length&&!s.initialized&&s.matches.length>0))return null;e=s.matches}}let l=e,o=null==(r=s)?void 0:r.errors;if(null!=o){let e=l.findIndex(e=>e.route.id&&void 0!==(null==o?void 0:o[e.route.id]));e>=0||u(!1),l=l.slice(0,Math.min(l.length,e+1))}let c=!1,d=-1;if(s&&n&&n.v7_partialHydration)for(let a=0;a<l.length;a++){let e=l[a];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=a),e.route.id){let{loaderData:t,errors:n}=s,a=e.route.loader&&void 0===t[e.route.id]&&(!n||void 0===n[e.route.id]);if(e.route.lazy||a){c=!0,l=d>=0?l.slice(0,d+1):[l[0]];break}}}return l.reduceRight((e,n,r)=>{let i,u=!1,h=null,m=null;var f;s&&(i=o&&n.route.id?o[n.route.id]:void 0,h=n.route.errorElement||re,c&&(d<0&&0===r?(f="route-fallback",!1||fe[f]||(fe[f]=!0),u=!0,m=null):d===r&&(u=!0,m=n.route.hydrateFallbackElement||null)));let p=t.concat(l.slice(0,r+1)),g=()=>{let t;return t=i?h:u?m:n.route.Component?a.createElement(n.route.Component,null):n.route.element?n.route.element:e,a.createElement(le,{match:n,routeContext:{outlet:e,matches:p,isDataRoute:null!=s},children:t})};return s&&(n.route.ErrorBoundary||n.route.errorElement||0===r)?a.createElement(ie,{location:s.location,revalidation:s.revalidation,component:h,error:i,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()},null)}var ce=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ce||{}),de=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(de||{});function ue(e){let t=a.useContext($);return t||u(!1),t}function he(e){let t=a.useContext(J);return t||u(!1),t}function me(e){let t=function(){let e=a.useContext(Y);return e||u(!1),e}(),s=t.matches[t.matches.length-1];return s.route.id||u(!1),s.route.id}const fe={};function pe(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}r.startTransition;function ge(e){let{to:t,replace:s,state:n,relative:r}=e;Z()||u(!1);let{future:i,static:l}=a.useContext(G),{matches:o}=a.useContext(Y),{pathname:c}=ee(),d=se(),h=U(t,B(o,i.v7_relativeSplatPath),c,"path"===r),m=JSON.stringify(h);return a.useEffect(()=>d(JSON.parse(m),{replace:s,state:n,relative:r}),[d,m,r,s,n]),null}function ve(e){u(!1)}function ye(e){let{basename:t="/",children:s=null,location:r,navigationType:i=n.Pop,navigator:l,static:o=!1,future:c}=e;Z()&&u(!1);let d=t.replace(/^\/*/,"/"),h=a.useMemo(()=>({basename:d,navigator:l,static:o,future:K({v7_relativeSplatPath:!1},c)}),[d,c,l,o]);"string"===typeof r&&(r=g(r));let{pathname:m="/",search:f="",hash:p="",state:v=null,key:y="default"}=r,x=a.useMemo(()=>{let e=I(m,d);return null==e?null:{location:{pathname:e,search:f,hash:p,state:v,key:y},navigationType:i}},[d,m,f,p,v,y,i]);return null==x?null:a.createElement(G.Provider,{value:h},a.createElement(Q.Provider,{children:s,value:x}))}function xe(e){let{children:t,location:s}=e;return ne(be(t),s)}new Promise(()=>{});a.Component;function be(e,t){void 0===t&&(t=[]);let s=[];return a.Children.forEach(e,(e,n)=>{if(!a.isValidElement(e))return;let r=[...t,n];if(e.type===a.Fragment)return void s.push.apply(s,be(e.props.children,r));e.type!==ve&&u(!1),e.props.index&&e.props.children&&u(!1);let i={id:e.props.id||r.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=be(e.props.children,r)),s.push(i)}),s}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);try{window.__reactRouterVersion="6"}catch(Ca){}new Map;const je=r.startTransition;o.flushSync,r.useId;function we(e){let{basename:t,children:s,future:n,window:r}=e,i=a.useRef();var l;null==i.current&&(i.current=(void 0===(l={window:r,v5Compat:!0})&&(l={}),v(function(e,t){let{pathname:s="/",search:n="",hash:a=""}=g(e.location.hash.substr(1));return s.startsWith("/")||s.startsWith(".")||(s="/"+s),f("",{pathname:s,search:n,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){let s=e.document.querySelector("base"),n="";if(s&&s.getAttribute("href")){let t=e.location.href,s=t.indexOf("#");n=-1===s?t:t.slice(0,s)}return n+"#"+("string"===typeof t?t:p(t))},function(e,t){h("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push("+JSON.stringify(t)+")")},l)));let o=i.current,[c,d]=a.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},m=a.useCallback(e=>{u&&je?je(()=>d(e)):d(e)},[d,u]);return a.useLayoutEffect(()=>o.listen(m),[o,m]),a.useEffect(()=>pe(n),[n]),a.createElement(ye,{basename:t,children:s,location:c.location,navigationType:c.action,navigator:o,future:n})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var Ne,Se;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ne||(Ne={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Se||(Se={}));function ke(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;s[n]=e[n]}return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)s=r[n],-1===t.indexOf(s)&&{}.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}class Ce extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",s=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=s}}class _e extends Ce{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Ee extends Ce{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Te extends Ce{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Pe;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(Pe||(Pe={}));var Oe=function(e,t,s,n){return new(s||(s=Promise))(function(a,r){function i(e){try{o(n.next(e))}catch(Ca){r(Ca)}}function l(e){try{o(n.throw(e))}catch(Ca){r(Ca)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};class Re{constructor(e){let{headers:t={},customFetch:n,region:a=Pe.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=a,this.fetch=(e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(s.bind(s,630)).then(e=>{let{default:s}=e;return s(...t)})}:fetch),function(){return t(...arguments)}})(n)}setAuth(e){this.headers.Authorization="Bearer ".concat(e)}invoke(e){return Oe(this,arguments,void 0,function(e){var t=this;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){var n;try{const{headers:a,method:r,body:i,signal:l}=s;let o={},{region:c}=s;c||(c=t.region);const d=new URL("".concat(t.url,"/").concat(e));let u;c&&"any"!==c&&(o["x-region"]=c,d.searchParams.set("forceFunctionRegion",c)),i&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&("undefined"!==typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=i):"string"===typeof i?(o["Content-Type"]="text/plain",u=i):"undefined"!==typeof FormData&&i instanceof FormData?u=i:(o["Content-Type"]="application/json",u=JSON.stringify(i)));const h=yield t.fetch(d.toString(),{method:r||"POST",headers:Object.assign(Object.assign(Object.assign({},o),t.headers),a),body:u,signal:l}).catch(e=>{if("AbortError"===e.name)throw e;throw new _e(e)}),m=h.headers.get("x-relay-error");if(m&&"true"===m)throw new Ee(h);if(!h.ok)throw new Te(h);let f,p=(null!==(n=h.headers.get("Content-Type"))&&void 0!==n?n:"text/plain").split(";")[0].trim();return f="application/json"===p?yield h.json():"application/octet-stream"===p?yield h.blob():"text/event-stream"===p?h:"multipart/form-data"===p?yield h.formData():yield h.text(),{data:f,error:null,response:h}}catch(a){return a instanceof Error&&"AbortError"===a.name?{data:null,error:new _e(a)}:{data:null,error:a,response:a instanceof Te||a instanceof Ee?a.context:void 0}}}()})}}var Ae=s(980);const{PostgrestClient:Ie,PostgrestQueryBuilder:Le,PostgrestFilterBuilder:De,PostgrestTransformBuilder:Be,PostgrestBuilder:Ue,PostgrestError:Fe}=Ae;const ze=class{static detectEnvironment(){var e;if("undefined"!==typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!==typeof s.g&&"undefined"!==typeof s.g.WebSocket)return{type:"native",constructor:s.g.WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocketPair&&"undefined"===typeof globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!==typeof globalThis&&globalThis.EdgeRuntime||"undefined"!==typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!==typeof process){const e=process.versions;if(e&&e.node){const t=e.node,s=parseInt(t.replace(/^v/,"").split(".")[0]);return s>=22?"undefined"!==typeof globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:"Node.js ".concat(s," detected but native WebSocket not found."),workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:"Node.js ".concat(s," detected without native WebSocket support."),workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+="\n\nSuggested solution: ".concat(e.workaround)),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}},Me="realtime-js/".concat("2.74.0"),We=1e4;var qe,He,Ve,Ke,$e,Je;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(qe||(qe={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(He||(He={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(Ve||(Ve={})),function(e){e.websocket="websocket"}(Ke||(Ke={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}($e||($e={}));class Ge{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"===typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const n=t.getUint8(1),a=t.getUint8(2);let r=this.HEADER_LENGTH+2;const i=s.decode(e.slice(r,r+n));r+=n;const l=s.decode(e.slice(r,r+a));r+=a;return{ref:null,topic:i,event:l,payload:JSON.parse(s.decode(e.slice(r,e.byteLength)))}}}class Qe{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(Je||(Je={}));const Ye=function(e,t){var s;const n=null!==(s=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==s?s:[];return t?Object.keys(t).reduce((s,a)=>(s[a]=Xe(a,e,t,n),s),{}):{}},Xe=(e,t,s,n)=>{const a=t.find(t=>t.name===e),r=null===a||void 0===a?void 0:a.type,i=s[e];return r&&!n.includes(r)?Ze(r,i):et(i)},Ze=(e,t)=>{if("_"===e.charAt(0)){const s=e.slice(1,e.length);return at(t,s)}switch(e){case Je.bool:return tt(t);case Je.float4:case Je.float8:case Je.int2:case Je.int4:case Je.int8:case Je.numeric:case Je.oid:return st(t);case Je.json:case Je.jsonb:return nt(t);case Je.timestamp:return rt(t);case Je.abstime:case Je.date:case Je.daterange:case Je.int4range:case Je.int8range:case Je.money:case Je.reltime:case Je.text:case Je.time:case Je.timestamptz:case Je.timetz:case Je.tsrange:case Je.tstzrange:default:return et(t)}},et=e=>e,tt=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},st=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},nt=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return console.log("JSON parse error: ".concat(t)),e}return e},at=(e,t)=>{if("string"!==typeof e)return e;const s=e.length-1,n=e[s];if("{"===e[0]&&"}"===n){let n;const r=e.slice(1,s);try{n=JSON.parse("["+r+"]")}catch(a){n=r?r.split(","):[]}return n.map(e=>Ze(t,e))}return e},rt=e=>"string"===typeof e?e.replace(" ","T"):e,it=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class lt{constructor(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:We;this.channel=e,this.event=t,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t(null===(s=this.receivedResp)||void 0===s?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:s}=e;this.recHooks.filter(e=>e.status===t).forEach(e=>e.callback(s))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ot,ct,dt,ut;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(ot||(ot={}));class ht{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},e=>{const{onJoin:t,onLeave:s,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ht.syncState(this.state,e,t,s),this.pendingDiffs.forEach(e=>{this.state=ht.syncDiff(this.state,e,t,s)}),this.pendingDiffs=[],n()}),this.channel._on(s.diff,{},e=>{const{onJoin:t,onLeave:s,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=ht.syncDiff(this.state,e,t,s),n())}),this.onJoin((e,t,s)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:s})}),this.onLeave((e,t,s)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,n){const a=this.cloneDeep(e),r=this.transformState(t),i={},l={};return this.map(a,(e,t)=>{r[e]||(l[e]=t)}),this.map(r,(e,t)=>{const s=a[e];if(s){const n=t.map(e=>e.presence_ref),a=s.map(e=>e.presence_ref),r=t.filter(e=>a.indexOf(e.presence_ref)<0),o=s.filter(e=>n.indexOf(e.presence_ref)<0);r.length>0&&(i[e]=r),o.length>0&&(l[e]=o)}else i[e]=t}),this.syncDiff(a,{joins:i,leaves:l},s,n)}static syncDiff(e,t,s,n){const{joins:a,leaves:r}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(a,(t,n)=>{var a;const r=null!==(a=e[t])&&void 0!==a?a:[];if(e[t]=this.cloneDeep(n),r.length>0){const s=e[t].map(e=>e.presence_ref),n=r.filter(e=>s.indexOf(e.presence_ref)<0);e[t].unshift(...n)}s(t,r,n)}),this.map(r,(t,s)=>{let a=e[t];if(!a)return;const r=s.map(e=>e.presence_ref);a=a.filter(e=>r.indexOf(e.presence_ref)<0),e[t]=a,n(t,a,s),0===a.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const n=e[s];return t[s]="metas"in n?n.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(ct||(ct={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(dt||(dt={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(ut||(ut={}));class mt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},s=arguments.length>2?arguments[2]:void 0;var n,a;if(this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=He.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new lt(this,Ve.join,this.params,this.timeout),this.rejoinTimer=new Qe(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=He.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel","close ".concat(this.topic," ").concat(this._joinRef())),this.state=He.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=He.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel","timeout ".concat(this.topic),this.joinPush.timeout),this.state=He.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=He.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ve.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new ht(this),this.broadcastEndpointURL=it(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null===(a=null===(n=this.params.config)||void 0===n?void 0:n.broadcast)||void 0===a?void 0:a.replay))throw"tried to use replay on public channel '".concat(this.topic,"'. It must be a private channel.")}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var s,n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==He.closed){const{config:{broadcast:r,presence:i,private:l}}=this.params,o=null!==(n=null===(s=this.bindings.postgres_changes)||void 0===s?void 0:s.map(e=>e.filter))&&void 0!==n?n:[],c=!!this.bindings[dt.PRESENCE]&&this.bindings[dt.PRESENCE].length>0||!0===(null===(a=this.params.config.presence)||void 0===a?void 0:a.enabled),d={},u={broadcast:r,presence:Object.assign(Object.assign({},i),{enabled:c}),postgres_changes:o,private:l};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(t=>null===e||void 0===e?void 0:e(ut.CHANNEL_ERROR,t)),this._onClose(()=>null===e||void 0===e?void 0:e(ut.CLOSED)),this.updateJoinPayload(Object.assign({config:u},d)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async t=>{let{postgres_changes:s}=t;var n;if(this.socket.setAuth(),void 0!==s){const t=this.bindings.postgres_changes,a=null!==(n=null===t||void 0===t?void 0:t.length)&&void 0!==n?n:0,r=[];for(let n=0;n<a;n++){const a=t[n],{filter:{event:i,schema:l,table:o,filter:c}}=a,d=s&&s[n];if(!d||d.event!==i||d.schema!==l||d.table!==o||d.filter!==c)return this.unsubscribe(),this.state=He.errored,void(null===e||void 0===e||e(ut.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));r.push(Object.assign(Object.assign({},a),{id:d.id}))}return this.bindings.postgres_changes=r,void(e&&e(ut.SUBSCRIBED))}null===e||void 0===e||e(ut.SUBSCRIBED)}).receive("error",t=>{this.state=He.errored,null===e||void 0===e||e(ut.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null===e||void 0===e||e(ut.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===He.joined&&e===dt.PRESENCE&&(this.socket.log("channel","resubscribe to ".concat(this.topic," due to change in presence callbacks on joined channel")),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,s)}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s,n;if(this._canPush()||"broadcast"!==e.type)return new Promise(s=>{var n,a,r;const i=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(r=null===(a=null===(n=this.params)||void 0===n?void 0:n.config)||void 0===a?void 0:a.broadcast)||void 0===r?void 0:r.ack)||s("ok"),i.receive("ok",()=>s("ok")),i.receive("error",()=>s("error")),i.receive("timeout",()=>s("timed out"))});{const{event:r,payload:i}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?"Bearer ".concat(this.socket.accessTokenValue):"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:i,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,l,null!==(s=t.timeout)&&void 0!==s?s:this.timeout);return await(null===(n=e.body)||void 0===n?void 0:n.cancel()),e.ok?"ok":"error"}catch(a){return"AbortError"===a.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=He.leaving;const t=()=>{this.socket.log("channel","leave ".concat(this.topic)),this._trigger(Ve.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new lt(this,Ve.leave,{},e),s.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{null===s||void 0===s||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=He.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const n=new AbortController,a=setTimeout(()=>n.abort(),s),r=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(a),r}_push(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw"tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.subscribe() before pushing events");let n=new lt(this,e,t,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel","discarded push due to buffer overflow: ".concat(e.event),e.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var n,a;const r=e.toLocaleLowerCase(),{close:i,error:l,leave:o,join:c}=Ve;if(s&&[i,l,o,c].indexOf(r)>=0&&s!==this._joinRef())return;let d=this._onMessage(r,t,s);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(r)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter(e=>{var t,s,n;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(n=null===(s=e.filter)||void 0===s?void 0:s.event)||void 0===n?void 0:n.toLocaleLowerCase())===r}).map(e=>e.callback(d,s)):null===(a=this.bindings[r])||void 0===a||a.filter(e=>{var s,n,a,i,l,o;if(["broadcast","presence","postgres_changes"].includes(r)){if("id"in e){const r=e.id,i=null===(s=e.filter)||void 0===s?void 0:s.event;return r&&(null===(n=t.ids)||void 0===n?void 0:n.includes(r))&&("*"===i||(null===i||void 0===i?void 0:i.toLocaleLowerCase())===(null===(a=t.data)||void 0===a?void 0:a.type.toLocaleLowerCase()))}{const s=null===(l=null===(i=null===e||void 0===e?void 0:e.filter)||void 0===i?void 0:i.event)||void 0===l?void 0:l.toLocaleLowerCase();return"*"===s||s===(null===(o=null===t||void 0===t?void 0:t.event)||void 0===o?void 0:o.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===r}).map(e=>{if("object"===typeof d&&"ids"in d){const e=d.data,{schema:t,table:s,commit_timestamp:n,type:a,errors:r}=e,i={schema:t,table:s,commit_timestamp:n,eventType:a,new:{},old:{},errors:r};d=Object.assign(Object.assign({},i),this._getPayloadRecords(e))}e.callback(d,s)})}_isClosed(){return this.state===He.closed}_isJoined(){return this.state===He.joined}_isJoining(){return this.state===He.joining}_isLeaving(){return this.state===He.leaving}_replyEventName(e){return"chan_reply_".concat(e)}_on(e,t,s){const n=e.toLocaleLowerCase(),a={type:n,filter:t,callback:s};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(e=>{var n;return!((null===(n=e.type)||void 0===n?void 0:n.toLocaleLowerCase())===s&&mt.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ve.close,{},e)}_onError(e){this._on(Ve.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=He.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=Ye(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=Ye(e.columns,e.old_record)),t}}const ft=()=>{},pt=25e3,gt=10,vt=100,yt=[1e3,2e3,5e3,1e4];class xt{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=We,this.transport=null,this.heartbeatIntervalMs=pt,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ft,this.ref=0,this.reconnectTimer=null,this.logger=ft,this.conn=null,this.sendBuffer=[],this.serializer=new Ge,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(s.bind(s,630)).then(e=>{let{default:s}=e;return s(...t)}).catch(e=>{throw new Error("Failed to load @supabase/node-fetch: ".concat(e.message,". ")+"This is required for HTTP requests in Node.js environments without native fetch.")})}:fetch),function(){return t(...arguments)}},!(null===(n=null===t||void 0===t?void 0:t.params)||void 0===n?void 0:n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint="".concat(e,"/").concat(Ke.websocket),this.httpEndpoint=it(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ze.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error("".concat(t,"\n\n")+'To use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })');throw new Error("WebSocket not available: ".concat(t))}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case qe.connecting:return $e.Connecting;case qe.open:return $e.Open;case qe.closing:return $e.Closing;default:return $e.Closed}}isConnected(){return this.connectionState()===$e.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};const s="realtime:".concat(e),n=this.getChannels().find(e=>e.topic===s);if(n)return n;{const s=new mt("realtime:".concat(e),t,this);return this.channels.push(s),s}}push(e){const{topic:t,event:s,payload:n,ref:a}=e,r=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push","".concat(t," ").concat(s," (").concat(a,")"),n),this.isConnected()?r():this.sendBuffer.push(r)}async setAuth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(Ca){this.log("error","error in heartbeat callback",Ca)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},vt)}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(Ca){this.log("error","error in heartbeat callback",Ca)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(Ca){this.log("error","error in heartbeat callback",Ca)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",'leaving duplicate topic "'.concat(e,'"')),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event)try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error")}catch(Ca){this.log("error","error in heartbeat callback",Ca)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:t,event:s,payload:n,ref:a}=e,r=a?"(".concat(a,")"):"",i=n.status||"";this.log("receive","".concat(i," ").concat(t," ").concat(s," ").concat(r).trim(),n),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(s,n,a)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport","connected to ".concat(this.endpointURL())),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker","starting worker for from ".concat(this.workerUrl)):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport","".concat(e)),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ve.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return"".concat(e).concat(s).concat(n)}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e=t||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(t=>{const s={access_token:e,version:Me};e&&t.updateJoinPayload(s),t.joinedOnce&&t._isJoined()&&t._push(Ve.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"general";this.setAuth().catch(t=>{this.log("error","error setting auth in ".concat(e),t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(Ca){this.log("error","error in ".concat(e," callback"),Ca)}})}catch(Ca){this.log("error","error triggering ".concat(e," callbacks"),Ca)}}_setupReconnectionTimer(){this.reconnectTimer=new Qe(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},gt)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,n,a,r,i,l,o,c;if(this.transport=null!==(t=null===e||void 0===e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(s=null===e||void 0===e?void 0:e.timeout)&&void 0!==s?s:We,this.heartbeatIntervalMs=null!==(n=null===e||void 0===e?void 0:e.heartbeatIntervalMs)&&void 0!==n?n:pt,this.worker=null!==(a=null===e||void 0===e?void 0:e.worker)&&void 0!==a&&a,this.accessToken=null!==(r=null===e||void 0===e?void 0:e.accessToken)&&void 0!==r?r:null,this.heartbeatCallback=null!==(i=null===e||void 0===e?void 0:e.heartbeatCallback)&&void 0!==i?i:ft,(null===e||void 0===e?void 0:e.params)&&(this.params=e.params),(null===e||void 0===e?void 0:e.logger)&&(this.logger=e.logger),((null===e||void 0===e?void 0:e.logLevel)||(null===e||void 0===e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(l=null===e||void 0===e?void 0:e.reconnectAfterMs)&&void 0!==l?l:e=>yt[e-1]||1e4,this.encode=null!==(o=null===e||void 0===e?void 0:e.encode)&&void 0!==o?o:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(c=null===e||void 0===e?void 0:e.decode)&&void 0!==c?c:this.serializer.decode.bind(this.serializer),this.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null===e||void 0===e?void 0:e.workerUrl}}}class bt extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function jt(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}class wt extends bt{constructor(e,t,s){super(e),this.name="StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Nt extends bt{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var St=function(e,t,s,n){return new(s||(s=Promise))(function(a,r){function i(e){try{o(n.next(e))}catch(Ca){r(Ca)}}function l(e){try{o(n.throw(e))}catch(Ca){r(Ca)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};const kt=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(s.bind(s,630)).then(e=>{let{default:s}=e;return s(...t)})}:fetch),function(){return t(...arguments)}},Ct=e=>{if(Array.isArray(e))return e.map(e=>Ct(e));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(e=>{let[s,n]=e;const a=s.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[a]=Ct(n)}),t};var _t=function(e,t,s,n){return new(s||(s=Promise))(function(a,r){function i(e){try{o(n.next(e))}catch(Ca){r(Ca)}}function l(e){try{o(n.throw(e))}catch(Ca){r(Ca)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};const Et=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Tt=(e,t,n)=>_t(void 0,void 0,void 0,function*(){const a=yield St(void 0,void 0,void 0,function*(){return"undefined"===typeof Response?(yield Promise.resolve().then(s.bind(s,630))).Response:Response});e instanceof a&&!(null===n||void 0===n?void 0:n.noResolveJson)?e.json().then(s=>{const n=e.status||500,a=(null===s||void 0===s?void 0:s.statusCode)||n+"";t(new wt(Et(s),n,a))}).catch(e=>{t(new Nt(Et(e),e))}):t(new Nt(Et(e),e))}),Pt=(e,t,s,n)=>{const a={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"!==e&&n?((e=>{if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)})(n)?(a.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,(null===t||void 0===t?void 0:t.duplex)&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),s)):a};function Ot(e,t,s,n,a,r){return _t(this,void 0,void 0,function*(){return new Promise((i,l)=>{e(s,Pt(t,n,a,r)).then(e=>{if(!e.ok)throw e;return(null===n||void 0===n?void 0:n.noResolveJson)?e:e.json()}).then(e=>i(e)).catch(e=>Tt(e,l,n))})})}function Rt(e,t,s,n){return _t(this,void 0,void 0,function*(){return Ot(e,"GET",t,s,n)})}function At(e,t,s,n,a){return _t(this,void 0,void 0,function*(){return Ot(e,"POST",t,n,a,s)})}function It(e,t,s,n,a){return _t(this,void 0,void 0,function*(){return Ot(e,"PUT",t,n,a,s)})}function Lt(e,t,s,n,a){return _t(this,void 0,void 0,function*(){return Ot(e,"DELETE",t,n,a,s)})}var Dt=function(e,t,s,n){return new(s||(s=Promise))(function(a,r){function i(e){try{o(n.next(e))}catch(Ca){r(Ca)}}function l(e){try{o(n.throw(e))}catch(Ca){r(Ca)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};class Bt{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return Dt(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(jt(e))return{data:null,error:e};throw e}})}}var Ut=function(e,t,s,n){return new(s||(s=Promise))(function(a,r){function i(e){try{o(n.next(e))}catch(Ca){r(Ca)}}function l(e){try{o(n.throw(e))}catch(Ca){r(Ca)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};class Ft{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}asStream(){return new Bt(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.execute().then(e,t)}execute(){return Ut(this,void 0,void 0,function*(){try{const e=yield this.downloadFn();return{data:yield e.blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(jt(e))return{data:null,error:e};throw e}})}}var zt=function(e,t,s,n){return new(s||(s=Promise))(function(a,r){function i(e){try{o(n.next(e))}catch(Ca){r(Ca)}}function l(e){try{o(n.throw(e))}catch(Ca){r(Ca)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};const Mt={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Wt={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class qt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=s,this.fetch=kt(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,s,n){return zt(this,void 0,void 0,function*(){try{let a;const r=Object.assign(Object.assign({},Wt),n);let i=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(r.upsert)});const l=r.metadata;"undefined"!==typeof Blob&&s instanceof Blob?(a=new FormData,a.append("cacheControl",r.cacheControl),l&&a.append("metadata",this.encodeMetadata(l)),a.append("",s)):"undefined"!==typeof FormData&&s instanceof FormData?(a=s,a.append("cacheControl",r.cacheControl),l&&a.append("metadata",this.encodeMetadata(l))):(a=s,i["cache-control"]="max-age=".concat(r.cacheControl),i["content-type"]=r.contentType,l&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),(null===n||void 0===n?void 0:n.headers)&&(i=Object.assign(Object.assign({},i),n.headers));const o=this._removeEmptyFolders(t),c=this._getFinalPath(o),d=yield("PUT"==e?It:At)(this.fetch,"".concat(this.url,"/object/").concat(c),a,Object.assign({headers:i},(null===r||void 0===r?void 0:r.duplex)?{duplex:r.duplex}:{}));return{data:{path:o,id:d.Id,fullPath:d.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(jt(a))return{data:null,error:a};throw a}})}upload(e,t,s){return zt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,n){return zt(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),r=this._getFinalPath(a),i=new URL(this.url+"/object/upload/sign/".concat(r));i.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:Wt.upsert},n),r=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!==typeof Blob&&s instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",s)):"undefined"!==typeof FormData&&s instanceof FormData?(e=s,e.append("cacheControl",t.cacheControl)):(e=s,r["cache-control"]="max-age=".concat(t.cacheControl),r["content-type"]=t.contentType);return{data:{path:a,fullPath:(yield It(this.fetch,i.toString(),e,{headers:r})).Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(jt(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return zt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);(null===t||void 0===t?void 0:t.upsert)&&(n["x-upsert"]="true");const a=yield At(this.fetch,"".concat(this.url,"/object/upload/sign/").concat(s),{},{headers:n}),r=new URL(this.url+a.url),i=r.searchParams.get("token");if(!i)throw new bt("No token returned by API");return{data:{signedUrl:r.toString(),path:e,token:i},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}update(e,t,s){return zt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return zt(this,void 0,void 0,function*(){try{return{data:yield At(this.fetch,"".concat(this.url,"/object/move"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===s||void 0===s?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}copy(e,t,s){return zt(this,void 0,void 0,function*(){try{return{data:{path:(yield At(this.fetch,"".concat(this.url,"/object/copy"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===s||void 0===s?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,s){return zt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),a=yield At(this.fetch,"".concat(this.url,"/object/sign/").concat(n),Object.assign({expiresIn:t},(null===s||void 0===s?void 0:s.transform)?{transform:s.transform}:{}),{headers:this.headers});const r=(null===s||void 0===s?void 0:s.download)?"&download=".concat(!0===s.download?"":s.download):"";return a={signedUrl:encodeURI("".concat(this.url).concat(a.signedURL).concat(r))},{data:a,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,s){return zt(this,void 0,void 0,function*(){try{const n=yield At(this.fetch,"".concat(this.url,"/object/sign/").concat(this.bucketId),{expiresIn:t,paths:e},{headers:this.headers}),a=(null===s||void 0===s?void 0:s.download)?"&download=".concat(!0===s.download?"":s.download):"";return{data:n.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI("".concat(this.url).concat(e.signedURL).concat(a)):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}download(e,t){const s="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",n=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),a=n?"?".concat(n):"",r=this._getFinalPath(e);return new Ft(()=>Rt(this.fetch,"".concat(this.url,"/").concat(s,"/").concat(r).concat(a),{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}info(e){return zt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const e=yield Rt(this.fetch,"".concat(this.url,"/object/info/").concat(t),{headers:this.headers});return{data:Ct(e),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}exists(e){return zt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield function(e,t,s,n){return _t(this,void 0,void 0,function*(){return Ot(e,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),n)})}(this.fetch,"".concat(this.url,"/object/").concat(t),{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s)&&s instanceof Nt){const e=s.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),n=[],a=(null===t||void 0===t?void 0:t.download)?"download=".concat(!0===t.download?"":t.download):"";""!==a&&n.push(a);const r="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",i=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==i&&n.push(i);let l=n.join("&");return""!==l&&(l="?".concat(l)),{data:{publicUrl:encodeURI("".concat(this.url,"/").concat(r,"/public/").concat(s).concat(l))}}}remove(e){return zt(this,void 0,void 0,function*(){try{return{data:yield Lt(this.fetch,"".concat(this.url,"/object/").concat(this.bucketId),{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(jt(t))return{data:null,error:t};throw t}})}list(e,t,s){return zt(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Mt),t),{prefix:e||""});return{data:yield At(this.fetch,"".concat(this.url,"/object/list/").concat(this.bucketId),n,{headers:this.headers},s),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}listV2(e,t){return zt(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield At(this.fetch,"".concat(this.url,"/object/list-v2/").concat(this.bucketId),s,{headers:this.headers},t),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return"".concat(this.bucketId,"/").concat(e.replace(/^\/+/,""))}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push("width=".concat(e.width)),e.height&&t.push("height=".concat(e.height)),e.resize&&t.push("resize=".concat(e.resize)),e.format&&t.push("format=".concat(e.format)),e.quality&&t.push("quality=".concat(e.quality)),t.join("&")}}const Ht={"X-Client-Info":"storage-js/".concat("2.74.0")};var Vt=function(e,t,s,n){return new(s||(s=Promise))(function(a,r){function i(e){try{o(n.next(e))}catch(Ca){r(Ca)}}function l(e){try{o(n.throw(e))}catch(Ca){r(Ca)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};class Kt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.shouldThrowOnError=!1;const a=new URL(e);if(null===n||void 0===n?void 0:n.useNewHostname){/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase."))}this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ht),t),this.fetch=kt(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Vt(this,void 0,void 0,function*(){try{return{data:yield Rt(this.fetch,"".concat(this.url,"/bucket"),{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(jt(e))return{data:null,error:e};throw e}})}getBucket(e){return Vt(this,void 0,void 0,function*(){try{return{data:yield Rt(this.fetch,"".concat(this.url,"/bucket/").concat(e),{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(jt(t))return{data:null,error:t};throw t}})}createBucket(e){return Vt(this,arguments,void 0,function(e){var t=this;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return function*(){try{return{data:yield At(t.fetch,"".concat(t.url,"/bucket"),{id:e,name:e,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}}()})}updateBucket(e,t){return Vt(this,void 0,void 0,function*(){try{return{data:yield It(this.fetch,"".concat(this.url,"/bucket/").concat(e),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Vt(this,void 0,void 0,function*(){try{return{data:yield At(this.fetch,"".concat(this.url,"/bucket/").concat(e,"/empty"),{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(jt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Vt(this,void 0,void 0,function*(){try{return{data:yield Lt(this.fetch,"".concat(this.url,"/bucket/").concat(e),{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(jt(t))return{data:null,error:t};throw t}})}}class $t extends Kt{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0)}from(e){return new qt(this.url,this.headers,e,this.fetch)}}let Jt="";Jt="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Gt={headers:{"X-Client-Info":"supabase-js-".concat(Jt,"/").concat("2.74.0")}},Qt={schema:"public"},Yt={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Xt={};var Zt=s(630),es=function(e,t,s,n){return new(s||(s=Promise))(function(a,r){function i(e){try{o(n.next(e))}catch(Ca){r(Ca)}}function l(e){try{o(n.throw(e))}catch(Ca){r(Ca)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};const ts=e=>{let t;return t=e||("undefined"===typeof fetch?Zt.default:fetch),function(){return t(...arguments)}},ss=(e,t,s)=>{const n=ts(s),a="undefined"===typeof Headers?Zt.Headers:Headers;return(s,r)=>es(void 0,void 0,void 0,function*(){var i;const l=null!==(i=yield t())&&void 0!==i?i:e;let o=new a(null===r||void 0===r?void 0:r.headers);return o.has("apikey")||o.set("apikey",e),o.has("Authorization")||o.set("Authorization","Bearer ".concat(l)),n(s,Object.assign(Object.assign({},r),{headers:o}))})};var ns=function(e,t,s,n){return new(s||(s=Promise))(function(a,r){function i(e){try{o(n.next(e))}catch(Ca){r(Ca)}}function l(e){try{o(n.throw(e))}catch(Ca){r(Ca)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};const as="2.74.0",rs=3e4,is=9e4,ls={"X-Client-Info":"gotrue-js/".concat(as)},os="X-Supabase-Api-Version",cs={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},ds=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class us extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function hs(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class ms extends us{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}class fs extends us{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ps extends us{constructor(e,t,s,n){super(e,s,n),this.name=t,this.status=s}}class gs extends ps{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class vs extends ps{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ys extends ps{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class xs extends ps{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class bs extends ps{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class js extends ps{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ws(e){return hs(e)&&"AuthRetryableFetchError"===e.name}class Ns extends ps{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class Ss extends ps{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const ks="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Cs=" \t\n\r=".split(""),_s=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Cs.length;t+=1)e[Cs[t].charCodeAt(0)]=-2;for(let t=0;t<ks.length;t+=1)e[ks[t].charCodeAt(0)]=t;return e})();function Es(e,t,s){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;s(ks[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;s(ks[e]),t.queuedBits-=6}}function Ts(e,t,s){const n=_s[e];if(!(n>-1)){if(-2===n)return;throw new Error('Invalid Base64-URL character "'.concat(String.fromCharCode(e),'"'))}for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function Ps(e){const t=[],s=e=>{t.push(String.fromCodePoint(e))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},r=e=>{!function(e,t,s){if(0===t.utf8seq){if(e<=127)return void s(e);for(let s=1;s<6;s+=1)if(0===(e>>7-s&1)){t.utf8seq=s;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&s(t.codepoint)}}(e,n,s)};for(let i=0;i<e.length;i+=1)Ts(e.charCodeAt(i),a,r);return t.join("")}function Os(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error("Unrecognized Unicode codepoint: ".concat(e.toString(16)))}t(e)}function Rs(e,t){for(let s=0;s<e.length;s+=1){let n=e.charCodeAt(s);if(n>55295&&n<=56319){const t=1024*(n-55296)&65535;n=65536+(e.charCodeAt(s+1)-56320&65535|t),s+=1}Os(n,t)}}function As(e){const t=[],s={queue:0,queuedBits:0},n=e=>{t.push(e)};for(let a=0;a<e.length;a+=1)Ts(e.charCodeAt(a),s,n);return new Uint8Array(t)}function Is(e){const t=[],s={queue:0,queuedBits:0},n=e=>{t.push(e)};return e.forEach(e=>Es(e,s,n)),Es(null,s,n),t.join("")}const Ls=()=>"undefined"!==typeof window&&"undefined"!==typeof document,Ds={tested:!1,writable:!1},Bs=()=>{if(!Ls())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(Ca){return!1}if(Ds.tested)return Ds.writable;const e="lswt-".concat(Math.random()).concat(Math.random());try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ds.tested=!0,Ds.writable=!0}catch(Ca){Ds.tested=!0,Ds.writable=!1}return Ds.writable};const Us=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(s.bind(s,630)).then(e=>{let{default:s}=e;return s(...t)})}:fetch),function(){return t(...arguments)}},Fs=async(e,t,s)=>{await e.setItem(t,JSON.stringify(s))},zs=async(e,t)=>{const s=await e.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(n){return s}},Ms=async(e,t)=>{await e.removeItem(t)};class Ws{constructor(){this.promise=new Ws.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function qs(e){const t=e.split(".");if(3!==t.length)throw new Ss("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!ds.test(t[s]))throw new Ss("JWT not in base64url format");return{header:JSON.parse(Ps(t[0])),payload:JSON.parse(Ps(t[1])),signature:As(t[2]),raw:{header:t[0],payload:t[1]}}}function Hs(e){return("0"+e.toString(16)).substr(-2)}async function Vs(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),s=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(s);return Array.from(n).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ks(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let s="";for(let n=0;n<56;n++)s+=e.charAt(Math.floor(Math.random()*t));return s}return crypto.getRandomValues(e),Array.from(e,Hs).join("")}();let a=n;s&&(a+="/PASSWORD_RECOVERY"),await Fs(e,"".concat(t,"-code-verifier"),a);const r=await Vs(n);return[r,n===r?"plain":"s256"]}Ws.promiseConstructor=Promise;const $s=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const Js=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Gs(e){if(!Js.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Qs(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"===typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "'.concat(t,'" property of the session object is not supported. Please use getUser() instead.'))},set:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))},deleteProperty:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))}})}function Ys(e){return JSON.parse(JSON.stringify(e))}var Xs=function(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(s[n[a]]=e[n[a]])}return s};const Zs=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),en=[502,503,504];async function tn(e){var t,s;if(!("object"===typeof(s=e)&&null!==s&&"status"in s&&"ok"in s&&"json"in s&&"function"===typeof s.json))throw new js(Zs(e),0);if(en.includes(e.status))throw new js(Zs(e),e.status);let n,a;try{n=await e.json()}catch(Ca){throw new fs(Zs(Ca),Ca)}const r=function(e){const t=e.headers.get(os);if(!t)return null;if(!t.match($s))return null;try{return new Date("".concat(t,"T00:00:00.0Z"))}catch(Ca){return null}}(e);if(r&&r.getTime()>=cs.timestamp&&"object"===typeof n&&n&&"string"===typeof n.code?a=n.code:"object"===typeof n&&n&&"string"===typeof n.error_code&&(a=n.error_code),a){if("weak_password"===a)throw new Ns(Zs(n),e.status,(null===(t=n.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===a)throw new gs}else if("object"===typeof n&&n&&"object"===typeof n.weak_password&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0))throw new Ns(Zs(n),e.status,n.weak_password.reasons);throw new ms(Zs(n),e.status||500,a)}async function sn(e,t,s,n){var a;const r=Object.assign({},null===n||void 0===n?void 0:n.headers);r[os]||(r[os]=cs.name),(null===n||void 0===n?void 0:n.jwt)&&(r.Authorization="Bearer ".concat(n.jwt));const i=null!==(a=null===n||void 0===n?void 0:n.query)&&void 0!==a?a:{};(null===n||void 0===n?void 0:n.redirectTo)&&(i.redirect_to=n.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",o=await async function(e,t,s,n,a,r){const i=((e,t,s,n)=>{const a={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),s))})(t,n,a,r);let l;try{l=await e(s,Object.assign({},i))}catch(Ca){throw console.error(Ca),new js(Zs(Ca),0)}l.ok||await tn(l);if(null===n||void 0===n?void 0:n.noResolveJson)return l;try{return await l.json()}catch(Ca){await tn(Ca)}}(e,t,s+l,{headers:r,noResolveJson:null===n||void 0===n?void 0:n.noResolveJson},{},null===n||void 0===n?void 0:n.body);return(null===n||void 0===n?void 0:n.xform)?null===n||void 0===n?void 0:n.xform(o):{data:Object.assign({},o),error:null}}function nn(e){var t;let s=null;var n;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(s=Object.assign({},e),e.expires_at||(s.expires_at=(n=e.expires_in,Math.round(Date.now()/1e3)+n)));return{data:{session:s,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function an(e){const t=nn(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function rn(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function ln(e){return{data:e,error:null}}function on(e){const{action_link:t,email_otp:s,hashed_token:n,redirect_to:a,verification_type:r}=e,i=Xs(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:s,hashed_token:n,redirect_to:a,verification_type:r},user:Object.assign({},i)},error:null}}function cn(e){return e}const dn=["global","local","others"];var un=function(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(s[n[a]]=e[n[a]])}return s};class hn{constructor(e){let{url:t="",headers:s={},fetch:n}=e;this.url=t,this.headers=s,this.fetch=Us(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dn[0];if(dn.indexOf(t)<0)throw new Error("@supabase/auth-js: Parameter scope must be one of ".concat(dn.join(", ")));try{return await sn(this.fetch,"POST","".concat(this.url,"/logout?scope=").concat(t),{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(hs(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await sn(this.fetch,"POST","".concat(this.url,"/invite"),{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:rn})}catch(s){if(hs(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=un(e,["options"]),n=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(n.new_email=null===s||void 0===s?void 0:s.newEmail,delete n.newEmail),await sn(this.fetch,"POST","".concat(this.url,"/admin/generate_link"),{body:n,headers:this.headers,xform:on,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(hs(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await sn(this.fetch,"POST","".concat(this.url,"/admin/users"),{body:e,headers:this.headers,xform:rn})}catch(t){if(hs(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,n,a,r,i,l;try{const o={nextPage:null,lastPage:0,total:0},c=await sn(this.fetch,"GET","".concat(this.url,"/admin/users"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==s?s:"",per_page:null!==(a=null===(n=null===e||void 0===e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==a?a:""},xform:cn});if(c.error)throw c.error;const d=await c.json(),u=null!==(r=c.headers.get("x-total-count"))&&void 0!==r?r:0,h=null!==(l=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==l?l:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(e.split(";")[1].split("=")[1]);o["".concat(s,"Page")]=t}),o.total=parseInt(u)),{data:Object.assign(Object.assign({},d),o),error:null}}catch(o){if(hs(o))return{data:{users:[]},error:o};throw o}}async getUserById(e){Gs(e);try{return await sn(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,xform:rn})}catch(t){if(hs(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Gs(e);try{return await sn(this.fetch,"PUT","".concat(this.url,"/admin/users/").concat(e),{body:t,headers:this.headers,xform:rn})}catch(s){if(hs(s))return{data:{user:null},error:s};throw s}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Gs(e);try{return await sn(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,body:{should_soft_delete:t},xform:rn})}catch(s){if(hs(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Gs(e.userId);try{const{data:t,error:s}=await sn(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e.userId,"/factors"),{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:s}}catch(t){if(hs(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Gs(e.userId),Gs(e.id);try{return{data:await sn(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e.userId,"/factors/").concat(e.id),{headers:this.headers}),error:null}}catch(t){if(hs(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,s,n,a,r,i,l;try{const o={nextPage:null,lastPage:0,total:0},c=await sn(this.fetch,"GET","".concat(this.url,"/admin/oauth/clients"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==s?s:"",per_page:null!==(a=null===(n=null===e||void 0===e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==a?a:""},xform:cn});if(c.error)throw c.error;const d=await c.json(),u=null!==(r=c.headers.get("x-total-count"))&&void 0!==r?r:0,h=null!==(l=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==l?l:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(e.split(";")[1].split("=")[1]);o["".concat(s,"Page")]=t}),o.total=parseInt(u)),{data:Object.assign(Object.assign({},d),o),error:null}}catch(o){if(hs(o))return{data:{clients:[]},error:o};throw o}}async _createOAuthClient(e){try{return await sn(this.fetch,"POST","".concat(this.url,"/admin/oauth/clients"),{body:e,headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(hs(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await sn(this.fetch,"GET","".concat(this.url,"/admin/oauth/clients/").concat(e),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(hs(t))return{data:null,error:t};throw t}}async _deleteOAuthClient(e){try{return await sn(this.fetch,"DELETE","".concat(this.url,"/admin/oauth/clients/").concat(e),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(hs(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await sn(this.fetch,"POST","".concat(this.url,"/admin/oauth/clients/").concat(e,"/regenerate_secret"),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(hs(t))return{data:null,error:t};throw t}}}function mn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,s)=>{e[t]=s},removeItem:t=>{delete e[t]}}}const fn=!!(globalThis&&Bs()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class pn extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class gn extends pn{}async function vn(e,t,s){fn&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),fn&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async n=>{if(!n){if(0===t)throw fn&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new gn('Acquiring an exclusive Navigator LockManager lock "'.concat(e,'" immediately failed'));if(fn)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(Ca){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",Ca)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}fn&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await s()}finally{fn&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}))}function yn(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error('@supabase/auth-js: Address "'.concat(e,'" is invalid.'));return e.toLowerCase()}function xn(e){const t=(new TextEncoder).encode(e);return"0x"+Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")}class bn extends Error{constructor(e){let{message:t,code:s,cause:n,name:a}=e;var r;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=null!==(r=null!==a&&void 0!==a?a:n instanceof Error?n.name:void 0)&&void 0!==r?r:"Unknown Error",this.code=s}}class jn extends bn{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function wn(e){let{error:t,options:s}=e;var n,a,r;const{publicKey:i}=s;if(!i)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(s.signal instanceof AbortSignal)return new bn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if("ConstraintError"===t.name){if(!0===(null===(n=i.authenticatorSelection)||void 0===n?void 0:n.requireResidentKey))return new bn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if("conditional"===s.mediation&&"required"===(null===(a=i.authenticatorSelection)||void 0===a?void 0:a.userVerification))return new bn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if("required"===(null===(r=i.authenticatorSelection)||void 0===r?void 0:r.userVerification))return new bn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if("InvalidStateError"===t.name)return new bn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if("NotAllowedError"===t.name)return new bn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("NotSupportedError"===t.name){return 0===i.pubKeyCredParams.filter(e=>"public-key"===e.type).length?new bn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new bn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t})}if("SecurityError"===t.name){const e=window.location.hostname;if(!Pn(e))return new bn({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(i.rp.id!==e)return new bn({message:'The RP ID "'.concat(i.rp.id,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("TypeError"===t.name){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new bn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if("UnknownError"===t.name)return new bn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new bn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Nn(e){let{error:t,options:s}=e;const{publicKey:n}=s;if(!n)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(s.signal instanceof AbortSignal)return new bn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if("NotAllowedError"===t.name)return new bn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("SecurityError"===t.name){const e=window.location.hostname;if(!Pn(e))return new bn({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(n.rpId!==e)return new bn({message:'The RP ID "'.concat(n.rpId,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("UnknownError"===t.name)return new bn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new bn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}var Sn=function(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(s[n[a]]=e[n[a]])}return s};const kn=new class{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}};function Cn(e){if(!e)throw new Error("Credential creation options are required");if("undefined"!==typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"===typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:s,excludeCredentials:n}=e,a=Sn(e,["challenge","user","excludeCredentials"]),r=As(t).buffer,i=Object.assign(Object.assign({},s),{id:As(s.id).buffer}),l=Object.assign(Object.assign({},a),{challenge:r,user:i});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let e=0;e<n.length;e++){const t=n[e];l.excludeCredentials[e]=Object.assign(Object.assign({},t),{id:As(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return l}function _n(e){if(!e)throw new Error("Credential request options are required");if("undefined"!==typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"===typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:s}=e,n=Sn(e,["challenge","allowCredentials"]),a=As(t).buffer,r=Object.assign(Object.assign({},n),{challenge:a});if(s&&s.length>0){r.allowCredentials=new Array(s.length);for(let e=0;e<s.length;e++){const t=s[e];r.allowCredentials[e]=Object.assign(Object.assign({},t),{id:As(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return r}function En(e){var t;if("toJSON"in e&&"function"===typeof e.toJSON)return e.toJSON();const s=e;return{id:e.id,rawId:e.id,response:{attestationObject:Is(new Uint8Array(e.response.attestationObject)),clientDataJSON:Is(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:null!==(t=s.authenticatorAttachment)&&void 0!==t?t:void 0}}function Tn(e){var t;if("toJSON"in e&&"function"===typeof e.toJSON)return e.toJSON();const s=e,n=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Is(new Uint8Array(a.authenticatorData)),clientDataJSON:Is(new Uint8Array(a.clientDataJSON)),signature:Is(new Uint8Array(a.signature)),userHandle:a.userHandle?Is(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:null!==(t=s.authenticatorAttachment)&&void 0!==t?t:void 0}}function Pn(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function On(){var e,t;return!!(Ls()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"===typeof(null===(e=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===e?void 0:e.create)&&"function"===typeof(null===(t=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===t?void 0:t.get))}const Rn={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},An={userVerification:"preferred",hints:["security-key"]};function In(){const e=e=>null!==e&&"object"===typeof e&&!Array.isArray(e),t=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),s={};for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];for(const i of a)if(i)for(const n in i){const a=i[n];if(void 0!==a)if(Array.isArray(a))s[n]=a;else if(t(a))s[n]=a;else if(e(a)){const t=s[n];e(t)?s[n]=In(t,a):s[n]=In(a)}else s[n]=a}return s}class Ln{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge(e,t){let{factorId:s,webauthn:n,friendlyName:a,signal:r}=e;try{const{data:e,error:i}=await this.client.mfa.challenge({factorId:s,webauthn:n});if(!e)return{data:null,error:i};const l=null!==r&&void 0!==r?r:kn.createNewAbortSignal();if("create"===e.webauthn.type){const{user:t}=e.webauthn.credential_options.publicKey;t.name||(t.name="".concat(t.id,":").concat(a)),t.displayName||(t.displayName=t.name)}switch(e.webauthn.type){case"create":{const n=function(e,t){return In(Rn,e,t||{})}(e.webauthn.credential_options.publicKey,null===t||void 0===t?void 0:t.create),{data:a,error:r}=await async function(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new jn("Browser returned unexpected credential type",t)}:{data:null,error:new jn("Empty credential response",t)}}catch(t){return{data:null,error:wn({error:t,options:e})}}}({publicKey:n,signal:l});return a?{data:{factorId:s,challengeId:e.id,webauthn:{type:e.webauthn.type,credential_response:a}},error:null}:{data:null,error:r}}case"request":{const n=function(e,t){return In(An,e,t||{})}(e.webauthn.credential_options.publicKey,null===t||void 0===t?void 0:t.request),{data:a,error:r}=await async function(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new jn("Browser returned unexpected credential type",t)}:{data:null,error:new jn("Empty credential response",t)}}catch(t){return{data:null,error:Nn({error:t,options:e})}}}(Object.assign(Object.assign({},e.webauthn.credential_options),{publicKey:n,signal:l}));return a?{data:{factorId:s,challengeId:e.id,webauthn:{type:e.webauthn.type,credential_response:a}},error:null}:{data:null,error:r}}}}catch(i){return hs(i)?{data:null,error:i}:{data:null,error:new fs("Unexpected error in challenge",i)}}}async _verify(e){let{challengeId:t,factorId:s,webauthn:n}=e;return this.client.mfa.verify({factorId:s,challengeId:t,webauthn:n})}async _authenticate(e,t){let{factorId:s,webauthn:{rpId:n=("undefined"!==typeof window?window.location.hostname:void 0),rpOrigins:a=("undefined"!==typeof window?[window.location.origin]:void 0),signal:r}}=e;if(!n)return{data:null,error:new us("rpId is required for WebAuthn authentication")};try{if(!On())return{data:null,error:new fs("Browser does not support WebAuthn",null)};const{data:e,error:i}=await this.challenge({factorId:s,webauthn:{rpId:n,rpOrigins:a},signal:r},{request:t});if(!e)return{data:null,error:i};const{webauthn:l}=e;return this._verify({factorId:s,challengeId:e.challengeId,webauthn:{type:l.type,rpId:n,rpOrigins:a,credential_response:l.credential_response}})}catch(i){return hs(i)?{data:null,error:i}:{data:null,error:new fs("Unexpected error in authenticate",i)}}}async _register(e,t){let{friendlyName:s,rpId:n=("undefined"!==typeof window?window.location.hostname:void 0),rpOrigins:a=("undefined"!==typeof window?[window.location.origin]:void 0),signal:r}=e;if(!n)return{data:null,error:new us("rpId is required for WebAuthn registration")};try{if(!On())return{data:null,error:new fs("Browser does not support WebAuthn",null)};const{data:e,error:i}=await this._enroll({friendlyName:s});if(!e)return await this.client.mfa.listFactors().then(e=>{var t;return null===(t=e.data)||void 0===t?void 0:t.all.find(e=>"webauthn"===e.factor_type&&e.friendly_name===s&&"unverified"!==e.status)}).then(e=>e?this.client.mfa.unenroll({factorId:null===e||void 0===e?void 0:e.id}):void 0),{data:null,error:i};const{data:l,error:o}=await this._challenge({factorId:e.id,friendlyName:e.friendly_name,webauthn:{rpId:n,rpOrigins:a},signal:r},{create:t});return l?this._verify({factorId:e.id,challengeId:l.challengeId,webauthn:{rpId:n,rpOrigins:a,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:o}}catch(i){return hs(i)?{data:null,error:i}:{data:null,error:new fs("Unexpected error in register",i)}}}}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(Ca){"undefined"!==typeof self&&(self.globalThis=self)}}();const Dn={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ls,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Bn(e,t,s){return await s()}const Un={};class Fn{get jwks(){var e,t;return null!==(t=null===(e=Un[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){Un[this.storageKey]=Object.assign(Object.assign({},Un[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=Un[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Un[this.storageKey]=Object.assign(Object.assign({},Un[this.storageKey]),{cachedAt:e})}constructor(e){var t,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Fn.nextInstanceID,Fn.nextInstanceID+=1,this.instanceID>0&&Ls()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Dn),e);if(this.logDebugMessages=!!n.debug,"function"===typeof n.debug&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new hn({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Us(n.fetch),this.lock=n.lock||Bn,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Ls()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=vn:this.lock=Bn,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Ln(this)},this.persistSession?(n.storage?this.storage=n.storage:Bs()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=mn(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=mn(this.memoryStorage)),Ls()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(Ca){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",Ca)}null===(s=this.broadcastChannel)||void 0===s||s.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.logger("GoTrueClient@".concat(this.instanceID," (").concat(as,") ").concat((new Date).toISOString()),...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},s=new URL(e);if(s.hash&&"#"===s.hash[0])try{new URLSearchParams(s.hash.substring(1)).forEach((e,s)=>{t[s]=e})}catch(Ca){}return s.searchParams.forEach((e,s)=>{t[s]=e}),t}(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),Ls()&&this.detectSessionInUrl&&"none"!==s){const{data:n,error:a}=await this._getSessionFromURL(t,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),function(e){return hs(e)&&"AuthImplicitGrantRedirectError"===e.name}(a)){const t=null===(e=a.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:a}}return await this._removeSession(),{error:a}}const{session:r,redirectType:i}=n;return this._debug("#_initialize()","detected session in URL",r,"redirect type",i),await this._saveSession(r),setTimeout(async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",r):await this._notifyAllSubscribers("SIGNED_IN",r)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return hs(t)?{error:t}:{error:new fs("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,n;try{const a=await sn(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{data:null!==(s=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==s?s:{},gotrue_meta_security:{captcha_token:null===(n=null===e||void 0===e?void 0:e.options)||void 0===n?void 0:n.captchaToken}},xform:nn}),{data:r,error:i}=a;if(i||!r)return{data:{user:null,session:null},error:i};const l=r.session,o=r.user;return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:o,session:l},error:null}}catch(a){if(hs(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,s,n;try{let a;if("email"in e){const{email:s,password:n,options:r}=e;let i=null,l=null;"pkce"===this.flowType&&([i,l]=await Ks(this.storage,this.storageKey)),a=await sn(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,redirectTo:null===r||void 0===r?void 0:r.emailRedirectTo,body:{email:s,password:n,data:null!==(t=null===r||void 0===r?void 0:r.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken},code_challenge:i,code_challenge_method:l},xform:nn})}else{if(!("phone"in e))throw new ys("You must provide either an email or phone number and a password");{const{phone:t,password:r,options:i}=e;a=await sn(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{phone:t,password:r,data:null!==(s=null===i||void 0===i?void 0:i.data)&&void 0!==s?s:{},channel:null!==(n=null===i||void 0===i?void 0:i.channel)&&void 0!==n?n:"sms",gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},xform:nn})}}const{data:r,error:i}=a;if(i||!r)return{data:{user:null,session:null},error:i};const l=r.session,o=r.user;return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:o,session:l},error:null}}catch(a){if(hs(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:n,options:a}=e;t=await sn(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{email:s,password:n,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:an})}else{if(!("phone"in e))throw new ys("You must provide either an email or phone number and a password");{const{phone:s,password:n,options:a}=e;t=await sn(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{phone:s,password:n,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:an})}}const{data:s,error:n}=t;return n?{data:{user:null,session:null},error:n}:s&&s.session&&s.user?(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n}):{data:{user:null,session:null},error:new vs}}catch(t){if(hs(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,n,a;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:null===(a=e.options)||void 0===a?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error('@supabase/auth-js: Unsupported chain "'.concat(t,'"'))}}async signInWithEthereum(e){var t,s,n,a,r,i,l,o,c,d,u;let h,m;if("message"in e)h=e.message,m=e.signature;else{const{chain:d,wallet:u,statement:f,options:p}=e;let g;if(Ls())if("object"===typeof u)g=u;else{const e=window;if(!("ethereum"in e)||"object"!==typeof e.ethereum||!("request"in e.ethereum)||"function"!==typeof e.ethereum.request)throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.");g=e.ethereum}else{if("object"!==typeof u||!(null===p||void 0===p?void 0:p.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=u}const v=new URL(null!==(t=null===p||void 0===p?void 0:p.url)&&void 0!==t?t:window.location.href),y=await g.request({method:"eth_requestAccounts"}).then(e=>e).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!y||0===y.length)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const x=yn(y[0]);let b=null===(s=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===s?void 0:s.chainId;if(!b){const e=await g.request({method:"eth_chainId"});b=parseInt(e,16)}h=function(e){var t;const{chainId:s,domain:n,expirationTime:a,issuedAt:r=new Date,nonce:i,notBefore:l,requestId:o,resources:c,scheme:d,uri:u,version:h}=e;if(!Number.isInteger(s))throw new Error('@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: '.concat(s));if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error('@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: '.concat(i));if(!u)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==h)throw new Error("@supabase/auth-js: Invalid SIWE message field \"version\". Version must be '1'. Provided value: ".concat(h));if(null===(t=e.statement)||void 0===t?void 0:t.includes("\n"))throw new Error("@supabase/auth-js: Invalid SIWE message field \"statement\". Statement must not include '\\n'. Provided value: ".concat(e.statement));const m=yn(e.address),f=d?"".concat(d,"://").concat(n):n,p=e.statement?"".concat(e.statement,"\n"):"",g="".concat(f," wants you to sign in with your Ethereum account:\n").concat(m,"\n\n").concat(p);let v="URI: ".concat(u,"\nVersion: ").concat(h,"\nChain ID: ").concat(s).concat(i?"\nNonce: ".concat(i):"","\nIssued At: ").concat(r.toISOString());if(a&&(v+="\nExpiration Time: ".concat(a.toISOString())),l&&(v+="\nNot Before: ".concat(l.toISOString())),o&&(v+="\nRequest ID: ".concat(o)),c){let e="\nResources:";for(const t of c){if(!t||"string"!==typeof t)throw new Error('@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: '.concat(t));e+="\n- ".concat(t)}v+=e}return"".concat(g,"\n").concat(v)}({domain:v.host,address:x,statement:f,uri:v.href,version:"1",chainId:b,nonce:null===(n=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===n?void 0:n.nonce,issuedAt:null!==(r=null===(a=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===a?void 0:a.issuedAt)&&void 0!==r?r:new Date,expirationTime:null===(i=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===i?void 0:i.expirationTime,notBefore:null===(l=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===l?void 0:l.notBefore,requestId:null===(o=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===o?void 0:o.requestId,resources:null===(c=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===c?void 0:c.resources}),m=await g.request({method:"personal_sign",params:[xn(h),x]})}try{const{data:t,error:s}=await sn(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:m},(null===(d=e.options)||void 0===d?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:null===(u=e.options)||void 0===u?void 0:u.captchaToken}}:null),xform:nn});if(s)throw s;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:s}):{data:{user:null,session:null},error:new vs}}catch(f){if(hs(f))return{data:{user:null,session:null},error:f};throw f}}async signInWithSolana(e){var t,s,n,a,r,i,l,o,c,d,u,h;let m,f;if("message"in e)m=e.message,f=e.signature;else{const{chain:u,wallet:h,statement:p,options:g}=e;let v;if(Ls())if("object"===typeof h)v=h;else{const e=window;if(!("solana"in e)||"object"!==typeof e.solana||!("signIn"in e.solana&&"function"===typeof e.solana.signIn||"signMessage"in e.solana&&"function"===typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");v=e.solana}else{if("object"!==typeof h||!(null===g||void 0===g?void 0:g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=h}const y=new URL(null!==(t=null===g||void 0===g?void 0:g.url)&&void 0!==t?t:window.location.href);if("signIn"in v&&v.signIn){const e=await v.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null===g||void 0===g?void 0:g.signInWithSolana),{version:"1",domain:y.host,uri:y.href}),p?{statement:p}:null));let t;if(Array.isArray(e)&&e[0]&&"object"===typeof e[0])t=e[0];else{if(!(e&&"object"===typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"===typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");m="string"===typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),f=t.signature}else{if(!("signMessage"in v)||"function"!==typeof v.signMessage||!("publicKey"in v)||"object"!==typeof v||!v.publicKey||!("toBase58"in v.publicKey)||"function"!==typeof v.publicKey.toBase58)throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=["".concat(y.host," wants you to sign in with your Solana account:"),v.publicKey.toBase58(),...p?["",p,""]:[""],"Version: 1","URI: ".concat(y.href),"Issued At: ".concat(null!==(n=null===(s=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===s?void 0:s.issuedAt)&&void 0!==n?n:(new Date).toISOString()),...(null===(a=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===a?void 0:a.notBefore)?["Not Before: ".concat(g.signInWithSolana.notBefore)]:[],...(null===(r=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===r?void 0:r.expirationTime)?["Expiration Time: ".concat(g.signInWithSolana.expirationTime)]:[],...(null===(i=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===i?void 0:i.chainId)?["Chain ID: ".concat(g.signInWithSolana.chainId)]:[],...(null===(l=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===l?void 0:l.nonce)?["Nonce: ".concat(g.signInWithSolana.nonce)]:[],...(null===(o=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===o?void 0:o.requestId)?["Request ID: ".concat(g.signInWithSolana.requestId)]:[],...(null===(d=null===(c=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===d?void 0:d.length)?["Resources",...g.signInWithSolana.resources.map(e=>"- ".concat(e))]:[]].join("\n");const e=await v.signMessage((new TextEncoder).encode(m),"utf8");if(!e||!(e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");f=e}}try{const{data:t,error:s}=await sn(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:Is(f)},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:nn});if(s)throw s;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:s}):{data:{user:null,session:null},error:new vs}}catch(p){if(hs(p))return{data:{user:null,session:null},error:p};throw p}}async _exchangeCodeForSession(e){const t=await zs(this.storage,"".concat(this.storageKey,"-code-verifier")),[s,n]=(null!==t&&void 0!==t?t:"").split("/");try{const{data:t,error:a}=await sn(this.fetch,"POST","".concat(this.url,"/token?grant_type=pkce"),{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:nn});if(await Ms(this.storage,"".concat(this.storageKey,"-code-verifier")),a)throw a;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!==n&&void 0!==n?n:null}),error:a}):{data:{user:null,session:null,redirectType:null},error:new vs}}catch(a){if(hs(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:s,token:n,access_token:a,nonce:r}=e,i=await sn(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,body:{provider:s,id_token:n,access_token:a,nonce:r,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:nn}),{data:l,error:o}=i;return o?{data:{user:null,session:null},error:o}:l&&l.session&&l.user?(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:o}):{data:{user:null,session:null},error:new vs}}catch(t){if(hs(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,n,a,r;try{if("email"in e){const{email:n,options:a}=e;let r=null,i=null;"pkce"===this.flowType&&([r,i]=await Ks(this.storage,this.storageKey));const{error:l}=await sn(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{email:n,data:null!==(t=null===a||void 0===a?void 0:a.data)&&void 0!==t?t:{},create_user:null===(s=null===a||void 0===a?void 0:a.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken},code_challenge:r,code_challenge_method:i},redirectTo:null===a||void 0===a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:l}}if("phone"in e){const{phone:t,options:s}=e,{data:i,error:l}=await sn(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{phone:t,data:null!==(n=null===s||void 0===s?void 0:s.data)&&void 0!==n?n:{},create_user:null===(a=null===s||void 0===s?void 0:s.shouldCreateUser)||void 0===a||a,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken},channel:null!==(r=null===s||void 0===s?void 0:s.channel)&&void 0!==r?r:"sms"}});return{data:{user:null,session:null,messageId:null===i||void 0===i?void 0:i.message_id},error:l}}throw new ys("You must provide either an email or phone number.")}catch(i){if(hs(i))return{data:{user:null,session:null},error:i};throw i}}async verifyOtp(e){var t,s;try{let n,a;"options"in e&&(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo,a=null===(s=e.options)||void 0===s?void 0:s.captchaToken);const{data:r,error:i}=await sn(this.fetch,"POST","".concat(this.url,"/verify"),{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:nn});if(i)throw i;if(!r)throw new Error("An error occurred on token verification.");const l=r.session,o=r.user;return(null===l||void 0===l?void 0:l.access_token)&&(await this._saveSession(l),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:o,session:l},error:null}}catch(n){if(hs(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,s,n;try{let a=null,r=null;return"pkce"===this.flowType&&([a,r]=await Ks(this.storage,this.storageKey)),await sn(this.fetch,"POST","".concat(this.url,"/sso"),{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==s?s:void 0}),(null===(n=null===e||void 0===e?void 0:e.options)||void 0===n?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:r}),headers:this.headers,xform:ln})}catch(a){if(hs(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new gs;const{error:n}=await sn(this.fetch,"GET","".concat(this.url,"/reauthenticate"),{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(hs(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t="".concat(this.url,"/resend");if("email"in e){const{email:s,type:n,options:a}=e,{error:r}=await sn(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},redirectTo:null===a||void 0===a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:r}}if("phone"in e){const{phone:s,type:n,options:a}=e,{data:r,error:i}=await sn(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:null===r||void 0===r?void 0:r.message_id},error:i}}throw new ys("You must provide either an email or phone number and a type")}catch(t){if(hs(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch(Ca){}})()),s}return await this.lock("lock:".concat(this.storageKey),e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(Ca){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await zs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=!!e.expires_at&&1e3*e.expires_at-Date.now()<is;if(this._debug("#__loadSession()","session has".concat(s?"":" not"," expired"),"expires_at",e.expires_at),!s){if(this.userStorage){const t=await zs(this.userStorage,this.storageKey+"-user");(null===t||void 0===t?void 0:t.user)?e.user=t.user:e.user=Qs()}if(this.storage.isServer&&e.user){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,s,n)=>(t||"user"!==s||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,s,n))})}return{data:{session:e},error:null}}const{data:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,async()=>await this._getUser())}async _getUser(e){try{return e?await sn(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:e,xform:rn}):await this._useSession(async e=>{var t,s,n;const{data:a,error:r}=e;if(r)throw r;return(null===(t=a.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await sn(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:null!==(n=null===(s=a.session)||void 0===s?void 0:s.access_token)&&void 0!==n?n:void 0,xform:rn}):{data:{user:null},error:new gs}})}catch(t){if(hs(t))return function(e){return hs(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await Ms(this.storage,"".concat(this.storageKey,"-code-verifier"))),{data:{user:null},error:t};throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession(async s=>{const{data:n,error:a}=s;if(a)throw a;if(!n.session)throw new gs;const r=n.session;let i=null,l=null;"pkce"===this.flowType&&null!=e.email&&([i,l]=await Ks(this.storage,this.storageKey));const{data:o,error:c}=await sn(this.fetch,"PUT","".concat(this.url,"/user"),{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:l}),jwt:r.access_token,xform:rn});if(c)throw c;return r.user=o.user,await this._saveSession(r),await this._notifyAllSubscribers("USER_UPDATED",r),{data:{user:r.user},error:null}})}catch(s){if(hs(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new gs;const t=Date.now()/1e3;let s=t,n=!0,a=null;const{payload:r}=qs(e.access_token);if(r.exp&&(s=r.exp,n=s<=t),n){const{data:t,error:s}=await this._callRefreshToken(e.refresh_token);if(s)return{data:{user:null,session:null},error:s};if(!t)return{data:{user:null,session:null},error:null};a=t}else{const{data:n,error:r}=await this._getUser(e.access_token);if(r)throw r;a={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(hs(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:n,error:a}=t;if(a)throw a;e=null!==(s=n.session)&&void 0!==s?s:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new gs;const{data:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(hs(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Ls())throw new xs("No browser detected.");if(e.error||e.error_description||e.error_code)throw new xs(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new bs("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new xs("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new bs("No code detected.");const{data:t,error:s}=await this._exchangeCodeForSession(e.code);if(s)throw s;const n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:a,refresh_token:r,expires_in:i,expires_at:l,token_type:o}=e;if(!a||!i||!r||!o)throw new xs("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(i);let u=c+d;l&&(u=parseInt(l));const h=u-c;1e3*h<=rs&&console.warn("@supabase/gotrue-js: Session as retrieved from URL expires in ".concat(h,"s, should have been closer to ").concat(d,"s"));const m=u-d;c-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,u,c):c-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,u,c);const{data:f,error:p}=await this._getUser(a);if(p)throw p;const g={provider_token:s,provider_refresh_token:n,access_token:a,expires_in:d,expires_at:u,refresh_token:r,token_type:o,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(s){if(hs(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await zs(this.storage,"".concat(this.storageKey,"-code-verifier"));return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession(async t=>{var s;const{data:n,error:a}=t;if(a)return{error:a};const r=null===(s=n.session)||void 0===s?void 0:s.access_token;if(r){const{error:t}=await this.admin.signOut(r,e);if(t&&(!function(e){return hs(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await Ms(this.storage,"".concat(this.storageKey,"-code-verifier"))),{error:null}})}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,n;try{const{data:{session:n},error:a}=t;if(a)throw a;await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(a){await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=null,n=null;"pkce"===this.flowType&&([s,n]=await Ks(this.storage,this.storageKey,!0));try{return await sn(this.fetch,"POST","".concat(this.url,"/recover"),{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(hs(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(hs(t))return{data:null,error:t};throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:s,error:n}=await this._useSession(async t=>{var s,n,a,r,i;const{data:l,error:o}=t;if(o)throw o;const c=await this._getUrlForProvider("".concat(this.url,"/user/identities/authorize"),e.provider,{redirectTo:null===(s=e.options)||void 0===s?void 0:s.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(a=e.options)||void 0===a?void 0:a.queryParams,skipBrowserRedirect:!0});return await sn(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(i=null===(r=l.session)||void 0===r?void 0:r.access_token)&&void 0!==i?i:void 0})});if(n)throw n;return Ls()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===s||void 0===s?void 0:s.url),{data:{provider:e.provider,url:null===s||void 0===s?void 0:s.url},error:null}}catch(s){if(hs(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var s;try{const{error:n,data:{session:a}}=t;if(n)throw n;const{options:r,provider:i,token:l,access_token:o,nonce:c}=e,d=await sn(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,jwt:null!==(s=null===a||void 0===a?void 0:a.access_token)&&void 0!==s?s:void 0,body:{provider:i,id_token:l,access_token:o,nonce:c,link_identity:!0,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},xform:nn}),{data:u,error:h}=d;return h?{data:{user:null,session:null},error:h}:u&&u.session&&u.user?(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("USER_UPDATED",u.session)),{data:u,error:h}):{data:{user:null,session:null},error:new vs}}catch(n){if(hs(n))return{data:{user:null,session:null},error:n};throw n}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,n;const{data:a,error:r}=t;if(r)throw r;return await sn(this.fetch,"DELETE","".concat(this.url,"/user/identities/").concat(e.identity_id),{headers:this.headers,jwt:null!==(n=null===(s=a.session)||void 0===s?void 0:s.access_token)&&void 0!==n?n:void 0})})}catch(t){if(hs(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t="#_refreshAccessToken(".concat(e.substring(0,5),"...)");this._debug(t,"begin");try{const a=Date.now();return await(s=async s=>(s>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await sn(this.fetch,"POST","".concat(this.url,"/token?grant_type=refresh_token"),{body:{refresh_token:e},headers:this.headers,xform:nn})),n=(e,t)=>{const s=200*Math.pow(2,e);return t&&ws(t)&&Date.now()+s-a<rs},new Promise((e,t)=>{(async()=>{for(let a=0;a<1/0;a++)try{const t=await s(a);if(!n(a,null,t))return void e(t)}catch(Ca){if(!n(a,Ca))return void t(Ca)}})()}))}catch(a){if(this._debug(t,"error",a),hs(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(t,"end")}var s,n}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider("".concat(this.url,"/authorize"),e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),Ls()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const a=await zs(this.storage,this.storageKey);if(a&&this.userStorage){let t=await zs(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:a.user},await Fs(this.userStorage,this.storageKey+"-user",t)),a.user=null!==(e=null===t||void 0===t?void 0:t.user)&&void 0!==e?e:Qs()}else if(a&&!a.user&&!a.user){const e=await zs(this.storage,this.storageKey+"-user");e&&(null===e||void 0===e?void 0:e.user)?(a.user=e.user,await Ms(this.storage,this.storageKey+"-user"),await Fs(this.storage,this.storageKey,a)):a.user=Qs()}if(this._debug(s,"session from storage",a),!this._isValidSession(a))return this._debug(s,"session is not valid"),void(null!==a&&await this._removeSession());const r=1e3*(null!==(t=a.expires_at)&&void 0!==t?t:1/0)-Date.now()<is;if(this._debug(s,"session has".concat(r?"":" not"," expired with margin of ").concat(is,"s")),r){if(this.autoRefreshToken&&a.refresh_token){const{error:e}=await this._callRefreshToken(a.refresh_token);e&&(console.error(e),ws(e)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(a.user&&!0===a.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(a.access_token);!t&&(null===e||void 0===e?void 0:e.user)?(a.user=e.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(n){console.error("Error getting user data:",n),this._debug(s,"error getting user data, skipping SIGNED_IN notification",n)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){return this._debug(s,"error",a),void console.error(a)}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new gs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n="#_callRefreshToken(".concat(e.substring(0,5),"...)");this._debug(n,"begin");try{this.refreshingDeferred=new Ws;const{data:t,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!t.session)throw new gs;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const n={data:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(a){if(this._debug(n,"error",a),hs(a)){const e={data:null,error:a};return ws(a)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(s=this.refreshingDeferred)||void 0===s||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n="#_notifyAllSubscribers(".concat(e,")");this._debug(n,"begin",t,"broadcast = ".concat(s));try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const n=[],a=Array.from(this.stateChangeEmitters.values()).map(async s=>{try{await s.callback(e,t)}catch(Ca){n.push(Ca)}});if(await Promise.all(a),n.length>0){for(let e=0;e<n.length;e+=1)console.error(n[e]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),s=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!s&&t.user&&await Fs(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const n=Ys(e);await Fs(this.storage,this.storageKey,n)}else{const e=Ys(t);await Fs(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),await Ms(this.storage,this.storageKey),await Ms(this.storage,this.storageKey+"-code-verifier"),await Ms(this.storage,this.storageKey+"-user"),this.userStorage&&await Ms(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ls()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(Ca){console.error("removing visibilitychange callback failed",Ca)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),rs);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const n=Math.floor((1e3*s.expires_at-e)/rs);this._debug("#_autoRefreshTokenTick()","access token expires in ".concat(n," ticks, a tick lasts ").concat(rs,"ms, refresh threshold is ").concat(3," ticks")),n<=3&&await this._callRefreshToken(s.refresh_token)})}catch(Ca){console.error("Auto refresh tick failed with error. This is likely a transient error.",Ca)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(Ca){if(!(Ca.isAcquireTimeout||Ca instanceof pn))throw Ca;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ls()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t="#_onVisibilityChanged(".concat(e,")");this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const n=["provider=".concat(encodeURIComponent(t))];if((null===s||void 0===s?void 0:s.redirectTo)&&n.push("redirect_to=".concat(encodeURIComponent(s.redirectTo))),(null===s||void 0===s?void 0:s.scopes)&&n.push("scopes=".concat(encodeURIComponent(s.scopes))),"pkce"===this.flowType){const[e,t]=await Ks(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:"".concat(encodeURIComponent(e)),code_challenge_method:"".concat(encodeURIComponent(t))});n.push(s.toString())}if(null===s||void 0===s?void 0:s.queryParams){const e=new URLSearchParams(s.queryParams);n.push(e.toString())}return(null===s||void 0===s?void 0:s.skipBrowserRedirect)&&n.push("skip_http_redirect=".concat(s.skipBrowserRedirect)),"".concat(e,"?").concat(n.join("&"))}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;return a?{data:null,error:a}:await sn(this.fetch,"DELETE","".concat(this.url,"/factors/").concat(e.factorId),{headers:this.headers,jwt:null===(s=null===n||void 0===n?void 0:n.session)||void 0===s?void 0:s.access_token})})}catch(t){if(hs(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,n;const{data:a,error:r}=t;if(r)return{data:null,error:r};const i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:"totp"===e.factorType?{issuer:e.issuer}:{}),{data:l,error:o}=await sn(this.fetch,"POST","".concat(this.url,"/factors"),{body:i,headers:this.headers,jwt:null===(s=null===a||void 0===a?void 0:a.session)||void 0===s?void 0:s.access_token});return o?{data:null,error:o}:("totp"===e.factorType&&"totp"===l.type&&(null===(n=null===l||void 0===l?void 0:l.totp)||void 0===n?void 0:n.qr_code)&&(l.totp.qr_code="data:image/svg+xml;utf-8,".concat(l.totp.qr_code)),{data:l,error:null})})}catch(t){if(hs(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;if(a)return{data:null,error:a};const r=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:"create"===e.webauthn.type?En(e.webauthn.credential_response):Tn(e.webauthn.credential_response)})}:{code:e.code}),{data:i,error:l}=await sn(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/verify"),{body:r,headers:this.headers,jwt:null===(s=null===n||void 0===n?void 0:n.session)||void 0===s?void 0:s.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:l})})}catch(t){if(hs(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;if(a)return{data:null,error:a};const r=await sn(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/challenge"),{body:e,headers:this.headers,jwt:null===(s=null===n||void 0===n?void 0:n.session)||void 0===s?void 0:s.access_token});if(r.error)return r;const{data:i}=r;if("webauthn"!==i.type)return{data:i,error:null};switch(i.webauthn.type){case"create":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:Cn(i.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:_n(i.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(hs(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const a of null!==(e=null===t||void 0===t?void 0:t.factors)&&void 0!==e?e:[])n.all.push(a),"verified"===a.status&&n[a.factor_type].push(a);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:n},error:a}=e;if(a)return{data:null,error:a};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:r}=qs(n.access_token);let i=null;r.aal&&(i=r.aal);let l=i;(null!==(s=null===(t=n.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==s?s:[]).length>0&&(l="aal2");return{data:{currentLevel:i,nextLevel:l,currentAuthenticationMethods:r.amr||[]},error:null}}))}async fetchJwk(e){let t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]}).keys.find(t=>t.kid===e);if(t)return t;const s=Date.now();if(t=this.jwks.keys.find(t=>t.kid===e),t&&this.jwks_cached_at+6e5>s)return t;const{data:n,error:a}=await sn(this.fetch,"GET","".concat(this.url,"/.well-known/jwks.json"),{headers:this.headers});if(a)throw a;return n.keys&&0!==n.keys.length?(this.jwks=n,this.jwks_cached_at=s,t=n.keys.find(t=>t.kid===e),t||null):null}async getClaims(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let s=e;if(!s){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};s=e.session.access_token}const{header:n,payload:a,signature:r,raw:{header:i,payload:l}}=qs(s);(null===t||void 0===t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(a.exp);const o=n.alg&&!n.alg.startsWith("HS")&&n.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(n.kid,(null===t||void 0===t?void 0:t.keys)?{keys:t.keys}:null===t||void 0===t?void 0:t.jwks):null;if(!o){const{error:e}=await this.getUser(s);if(e)throw e;return{data:{claims:a,header:n,signature:r},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(n.alg),d=await crypto.subtle.importKey("jwk",o,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,r,function(e){const t=[];return Rs(e,e=>t.push(e)),new Uint8Array(t)}("".concat(i,".").concat(l))))throw new Ss("Invalid JWT signature");return{data:{claims:a,header:n,signature:r},error:null}}catch(s){if(hs(s))return{data:null,error:s};throw s}}}Fn.nextInstanceID=0;const zn=Fn;class Mn extends zn{constructor(e){super(e)}}var Wn=function(e,t,s,n){return new(s||(s=Promise))(function(a,r){function i(e){try{o(n.next(e))}catch(Ca){r(Ca)}}function l(e){try{o(n.throw(e))}catch(Ca){r(Ca)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,l)}o((n=n.apply(e,t||[])).next())})};class qn{constructor(e,t,s){var n,a,r;this.supabaseUrl=e,this.supabaseKey=t;const i=function(e){const t=null===e||void 0===e?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL((s=t).endsWith("/")?s:s+"/")}catch(n){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}var s}(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const l="sb-".concat(i.hostname.split(".")[0],"-auth-token"),o=function(e,t){var s,n;const{db:a,auth:r,realtime:i,global:l}=e,{db:o,auth:c,realtime:d,global:u}=t,h={db:Object.assign(Object.assign({},o),a),auth:Object.assign(Object.assign({},c),r),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},u),l),{headers:Object.assign(Object.assign({},null!==(s=null===u||void 0===u?void 0:u.headers)&&void 0!==s?s:{}),null!==(n=null===l||void 0===l?void 0:l.headers)&&void 0!==n?n:{})}),accessToken:()=>ns(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!==s&&void 0!==s?s:{},{db:Qt,realtime:Xt,auth:Object.assign(Object.assign({},Yt),{storageKey:l}),global:Gt});this.storageKey=null!==(n=o.auth.storageKey)&&void 0!==n?n:"",this.headers=null!==(a=o.global.headers)&&void 0!==a?a:{},o.accessToken?(this.accessToken=o.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error("@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.".concat(String(t)," is not possible"))}})):this.auth=this._initSupabaseAuthClient(null!==(r=o.auth)&&void 0!==r?r:{},this.headers,o.global.fetch),this.fetch=ss(t,this._getAccessToken.bind(this),o.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},o.realtime)),this.rest=new Ie(new URL("rest/v1",i).href,{headers:this.headers,schema:o.db.schema,fetch:this.fetch}),this.storage=new $t(this.storageUrl.href,this.headers,this.fetch,null===s||void 0===s?void 0:s.storage),o.accessToken||this._listenForAuthEvents()}get functions(){return new Re(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.rest.rpc(e,t,s)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return Wn(this,void 0,void 0,function*(){var e,t;if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return null!==(t=null===(e=s.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:this.supabaseKey})}_initSupabaseAuthClient(e,t,s){let{autoRefreshToken:n,persistSession:a,detectSessionInUrl:r,storage:i,userStorage:l,storageKey:o,flowType:c,lock:d,debug:u}=e;const h={Authorization:"Bearer ".concat(this.supabaseKey),apikey:"".concat(this.supabaseKey)};return new Mn({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),t),storageKey:o,autoRefreshToken:n,persistSession:a,detectSessionInUrl:r,storage:i,userStorage:l,flowType:c,lock:d,debug:u,fetch:s,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new xt(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)})}_handleTokenChanged(e,t,s){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===s?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.changedAccessToken=s,this.realtime.setAuth(s))}}(function(){if("undefined"!==typeof window)return!1;if("undefined"===typeof process)return!1;const e=process.version;if(void 0===e||null===e)return!1;const t=e.match(/^v(\d+)\./);return!!t&&parseInt(t[1],10)<=18})()&&console.warn("\u26a0\ufe0f  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Hn=((e,t,s)=>new qn(e,t,s))("https://rzyrhnupwzppwiudfuxk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ6eXJobnVwd3pwcHdpdWRmdXhrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE4ODA5NjksImV4cCI6MjA2NzQ1Njk2OX0.aq0cp84sxMjLPvr_8E4btcQLjhT9zZSUEPgr0bqHMUs"),Vn=["password"],Kn=["password"],$n={async login(e,t){try{const{data:s,error:n}=await Hn.from("users").select("*").eq("email",e).eq("status","active").single();if(n){if("PGRST116"===n.code)throw new Error("Invalid email or password");throw new Error("Login failed: "+n.message)}if(!s)throw new Error("Invalid email or password");if(!(t===s.password))throw new Error("Invalid email or password");await Hn.from("users").update({lastlogin:(new Date).toISOString()}).eq("userid",s.userid);const{password:a}=s;return{success:!0,user:ke(s,Vn)}}catch(s){return{success:!1,error:s.message}}},setUserSession(e){localStorage.setItem("user",JSON.stringify(e)),window.dispatchEvent(new Event("authChange"))},getUserSession(){const e=localStorage.getItem("user");return e?JSON.parse(e):null},logout(){localStorage.removeItem("user"),window.dispatchEvent(new Event("authChange"))},isAuthenticated(){return null!==this.getUserSession()},async updateProfile(e,t){try{const{data:s,error:n}=await Hn.from("users").update({firstname:t.firstname,lastname:t.lastname,email:t.email,phone:t.phone,address:t.address}).eq("userid",e).select().single();if(n)throw n;const{password:a}=s,r=ke(s,Kn);return this.setUserSession(r),{success:!0,data:r}}catch(s){return console.error("Error updating profile:",s),{success:!1,error:s.message}}},async changePassword(e,t,s){try{const{data:n,error:a}=await Hn.from("users").select("password").eq("userid",e).single();if(a)throw a;if(n.password!==t)return{success:!1,error:"Current password is incorrect"};const{error:r}=await Hn.from("users").update({password:s}).eq("userid",e);if(r)throw r;return{success:!0}}catch(n){return console.error("Error changing password:",n),{success:!1,error:n.message}}}};var Jn=s(960);const Gn=e=>{let{onLoginSuccess:t}=e;const[s,n]=(0,a.useState)(""),[r,i]=(0,a.useState)(""),[l,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(""),u=se();return(0,Jn.jsxs)("div",{className:"login-container",children:[(0,Jn.jsx)("div",{className:"login-left",children:(0,Jn.jsxs)("div",{className:"login-branding",children:[(0,Jn.jsxs)("div",{className:"logo-section",children:[(0,Jn.jsx)("div",{className:"logo-icon",children:(0,Jn.jsx)("i",{className:"fas fa-landmark"})}),(0,Jn.jsxs)("div",{className:"logo-text",children:[(0,Jn.jsx)("h1",{className:"system-title",children:"Municipal Treasurer's Office"}),(0,Jn.jsx)("p",{className:"system-subtitle",children:"Online Systems Portal"}),(0,Jn.jsx)("p",{className:"system-location",children:"LGU Concepcion, Romblon"})]})]}),(0,Jn.jsxs)("div",{className:"login-features",children:[(0,Jn.jsxs)("div",{className:"feature-item",children:[(0,Jn.jsx)("i",{className:"fas fa-shield-alt"}),(0,Jn.jsx)("span",{children:"Secure Access"})]}),(0,Jn.jsxs)("div",{className:"feature-item",children:[(0,Jn.jsx)("i",{className:"fas fa-tint"}),(0,Jn.jsx)("span",{children:"Water Billing"})]}),(0,Jn.jsxs)("div",{className:"feature-item",children:[(0,Jn.jsx)("i",{className:"fas fa-building"}),(0,Jn.jsx)("span",{children:"Property Tax"})]}),(0,Jn.jsxs)("div",{className:"feature-item",children:[(0,Jn.jsx)("i",{className:"fas fa-briefcase"}),(0,Jn.jsx)("span",{children:"Business Permits"})]}),(0,Jn.jsxs)("div",{className:"feature-item",children:[(0,Jn.jsx)("i",{className:"fas fa-coins"}),(0,Jn.jsx)("span",{children:"Treasury Management"})]})]})]})}),(0,Jn.jsx)("div",{className:"login-right",children:(0,Jn.jsxs)("div",{className:"login-form-container",children:[(0,Jn.jsxs)("div",{className:"form-header",children:[(0,Jn.jsx)("h2",{className:"form-title",children:"Sign In"}),(0,Jn.jsx)("p",{className:"form-subtitle",children:"Access your account to continue"})]}),(0,Jn.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),o(!0),d(""),!s||!r)return d("Please fill in all fields"),void o(!1);try{const e=await $n.login(s,r);e.success?($n.setUserSession(e.user),t&&t(),u("/portal",{replace:!0})):d(e.error)}catch(n){d("An unexpected error occurred")}finally{o(!1)}},className:"professional-form",children:[c&&(0,Jn.jsxs)("div",{className:"error-message",children:[(0,Jn.jsx)("i",{className:"fas fa-exclamation-circle"}),(0,Jn.jsx)("span",{children:c}),(0,Jn.jsx)("button",{className:"error-close",onClick:()=>d(""),type:"button",children:(0,Jn.jsx)("i",{className:"fas fa-times"})})]}),(0,Jn.jsxs)("div",{className:"form-group",children:[(0,Jn.jsx)("label",{className:"form-label",children:"Email Address"}),(0,Jn.jsxs)("div",{className:"input-wrapper",children:[(0,Jn.jsx)("input",{className:"form-input",type:"email",placeholder:"Enter your email address",value:s,onChange:e=>n(e.target.value),disabled:l,required:!0}),(0,Jn.jsx)("i",{className:"fas fa-envelope input-icon"})]})]}),(0,Jn.jsxs)("div",{className:"form-group",children:[(0,Jn.jsx)("label",{className:"form-label",children:"Password"}),(0,Jn.jsxs)("div",{className:"input-wrapper",children:[(0,Jn.jsx)("input",{className:"form-input",type:"password",placeholder:"Enter your password",value:r,onChange:e=>i(e.target.value),disabled:l,required:!0}),(0,Jn.jsx)("i",{className:"fas fa-lock input-icon"})]})]}),(0,Jn.jsx)("button",{className:"login-button ".concat(l?"loading":""),type:"submit",disabled:l,children:l?(0,Jn.jsxs)(Jn.Fragment,{children:[(0,Jn.jsx)("i",{className:"fas fa-spinner fa-spin"}),(0,Jn.jsx)("span",{children:"Signing In..."})]}):(0,Jn.jsxs)(Jn.Fragment,{children:[(0,Jn.jsx)("i",{className:"fas fa-sign-in-alt"}),(0,Jn.jsx)("span",{children:"Sign In"})]})})]}),(0,Jn.jsx)("div",{className:"form-footer",children:(0,Jn.jsx)("p",{children:"\xa9 2024 LGU Concepcion, Romblon. All rights reserved."})})]})})]})},Qn=e=>{let{onLogout:t}=e;const[s,n]=(0,a.useState)(null),[r,i]=(0,a.useState)(!1),l=se();(0,a.useEffect)(()=>{const e=$n.getUserSession();e?n(e):l("/login")},[l]),(0,a.useEffect)(()=>{const e=e=>{const t=document.querySelector(".user-dropdown");t&&!t.contains(e.target)&&i(!1)};if(r)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[r]);return s?(0,Jn.jsxs)("div",{className:"systems-portal",children:[(0,Jn.jsx)("header",{className:"portal-header",children:(0,Jn.jsxs)("div",{className:"portal-header-content",children:[(0,Jn.jsxs)("div",{className:"portal-branding",children:[(0,Jn.jsx)("div",{className:"brand-icon",children:(0,Jn.jsx)("i",{className:"fas fa-landmark"})}),(0,Jn.jsxs)("div",{className:"brand-text",children:[(0,Jn.jsx)("h1",{className:"brand-title",children:"Municipal Treasurer's Office"}),(0,Jn.jsx)("p",{className:"brand-subtitle",children:"Online Systems Portal"})]})]}),(0,Jn.jsxs)("div",{className:"portal-user-section",children:[(0,Jn.jsxs)("div",{className:"user-info",children:[(0,Jn.jsxs)("div",{className:"user-name",children:[s.firstname," ",s.lastname]}),(0,Jn.jsx)("div",{className:"user-role",children:s.role})]}),(0,Jn.jsxs)("div",{className:"user-dropdown ".concat(r?"is-active":""),children:[(0,Jn.jsxs)("button",{className:"user-button",onClick:()=>i(!r),children:[(0,Jn.jsxs)("div",{className:"user-avatar",children:[s.firstname.charAt(0),s.lastname.charAt(0)]}),(0,Jn.jsx)("i",{className:"fas fa-chevron-down",style:{fontSize:"0.75rem",color:"#9ca3af"}})]}),(0,Jn.jsx)("div",{className:"dropdown-menu",children:(0,Jn.jsxs)("button",{className:"dropdown-item",onClick:()=>{$n.logout(),t&&t(),l("/login",{replace:!0})},children:[(0,Jn.jsx)("i",{className:"fas fa-sign-out-alt"}),(0,Jn.jsx)("span",{children:"Logout"})]})})]})]})]})}),(0,Jn.jsx)("main",{className:"portal-main",children:(0,Jn.jsxs)("div",{className:"portal-container",children:[(0,Jn.jsxs)("div",{className:"portal-welcome",children:[(0,Jn.jsxs)("h2",{className:"welcome-title",children:["Welcome back, ",s.firstname,"!"]}),(0,Jn.jsx)("p",{className:"welcome-subtitle",children:"Select a system to access"})]}),(0,Jn.jsx)("div",{className:"systems-grid",children:[{id:"water-billing",name:"Water Billing System",description:"Manage water consumption billing and payments",icon:"fas fa-tint",color:"#3b82f6",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",path:"/portal/water-billing/dashboard",available:!0},{id:"property-tax",name:"Real Property Tax System",description:"Real property tax assessment and collection",icon:"fas fa-building",color:"#10b981",gradient:"linear-gradient(135deg, #0ea5e9 0%, #06b6d4 100%)",path:"/portal/property-tax",available:!1},{id:"business-permit",name:"Business Permit & Licensing",description:"Business registration and permit processing",icon:"fas fa-briefcase",color:"#f59e0b",gradient:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",path:"/portal/business-permit",available:!1},{id:"treasury",name:"Treasury Management",description:"Revenue collection and financial management",icon:"fas fa-coins",color:"#8b5cf6",gradient:"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)",path:"/portal/treasury",available:!1}].map(e=>(0,Jn.jsxs)("div",{className:"system-card ".concat(e.available?"available":"unavailable"),onClick:()=>(e=>{e.available&&(sessionStorage.setItem("currentSystem",e.id),l(e.path))})(e),style:{cursor:e.available?"pointer":"not-allowed"},children:[(0,Jn.jsxs)("div",{className:"system-card-header",style:{background:e.gradient},children:[(0,Jn.jsx)("div",{className:"system-icon",children:(0,Jn.jsx)("i",{className:e.icon})}),!e.available&&(0,Jn.jsxs)("div",{className:"coming-soon-badge",children:[(0,Jn.jsx)("i",{className:"fas fa-clock"}),(0,Jn.jsx)("span",{children:"Coming Soon"})]})]}),(0,Jn.jsxs)("div",{className:"system-card-body",children:[(0,Jn.jsx)("h3",{className:"system-name",children:e.name}),(0,Jn.jsx)("p",{className:"system-description",children:e.description}),e.available&&(0,Jn.jsxs)("button",{className:"system-access-btn",children:[(0,Jn.jsx)("span",{children:"Access System"}),(0,Jn.jsx)("i",{className:"fas fa-arrow-right"})]})]})]},e.id))}),(0,Jn.jsx)("div",{className:"portal-footer",children:(0,Jn.jsxs)("p",{className:"footer-text",children:[(0,Jn.jsx)("i",{className:"fas fa-info-circle"}),"Contact IT Support for system access issues or technical assistance"]})})]})})]}):(0,Jn.jsx)("div",{className:"container",children:(0,Jn.jsx)("div",{className:"section",children:(0,Jn.jsx)("div",{className:"has-text-centered",children:(0,Jn.jsx)("button",{className:"button is-loading is-large",children:"Loading"})})})})};function Yn(e){return Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yn(e)}function Xn(e){var t=function(e,t){if("object"!=Yn(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=Yn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Yn(t)?t:t+""}function Zn(e,t,s){return(t=Xn(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function ea(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,n)}return s}function ta(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ea(Object(s),!0).forEach(function(t){Zn(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ea(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}const sa={async testConnection(){try{console.log("Testing Supabase connection..."),console.log("Supabase URL:",Hn.supabaseUrl),console.log("Auth status:",await Hn.auth.getSession());const{data:e,error:t,count:s}=await Hn.from("customers").select("*",{count:"exact"}).range(0,99999);return console.log("Connection test result:",{data:e,error:t,count:s}),t?(console.error("Possible RLS issue. Error details:",t),{success:!1,error:"".concat(t.message,". This might be a Row Level Security (RLS) issue. Check console for details.")}):{success:!0,message:"Connection successful! Found ".concat(s," records in database.")}}catch(e){return console.error("Connection test failed:",e),{success:!1,error:e.message}}},async getCustomers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{console.log("Fetching customers with filters:",e);let t=Hn.from("customers").select("*").order("date_added",{ascending:!1});if(e.search){const s=e.search.trim();if(s){const e=/^\d+$/.test(s);console.log("Search term:",s,"Is numeric:",e),e?(console.log("Searching both name and customerid for:",s),t=t.or("name.ilike.%".concat(s,"%,customerid.eq.").concat(s))):(console.log("Searching only name for:",s),t=t.ilike("name","%".concat(s,"%")))}}e.barangay&&"all"!==e.barangay&&(console.log("Filtering by barangay (case-insensitive):",e.barangay),t=t.ilike("barangay",e.barangay)),e.type&&"all"!==e.type&&(console.log("Filtering by type (case-insensitive):",e.type),t=t.ilike("type",e.type)),e.status&&"all"!==e.status&&(console.log("Filtering by status (case-insensitive):",e.status),t=t.ilike("status",e.status));const s=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,s=[],n=0,a=!0;for(;a;){console.log("Fetching batch starting at ".concat(n,"..."));const{data:r,error:i}=await e.range(n,n+t-1);if(i)throw i;r&&r.length>0?(s=[...s,...r],console.log("Fetched ".concat(r.length," records, total so far: ").concat(s.length)),r.length<t?a=!1:n+=t):a=!1}return s}(t);return console.log("Successfully fetched ALL customers:",s.length,"records (truly unlimited)"),{success:!0,data:s}}catch(t){return console.error("Error in getCustomers:",t),{success:!1,error:t.message}}},async getCustomerById(e){try{const{data:t,error:s}=await Hn.from("customers").select("*").eq("customerid",e).single();if(s)throw s;return{success:!0,data:t}}catch(t){return{success:!1,error:t.message}}},async generateCustomerId(){try{const{data:e,error:t}=await Hn.from("customers").select("customerid").order("customerid",{ascending:!1}).limit(1);if(t)throw t;return{success:!0,data:(e.length>0?e[0].customerid:0)+1}}catch(e){return{success:!1,error:e.message}}},async addCustomer(e){try{const{data:t,error:s}=await Hn.from("customers").insert([ta(ta({},e),{},{date_added:(new Date).toISOString().split("T")[0],status:e.status||"Active"})]).select();if(s)throw s;return{success:!0,data:t[0]}}catch(t){return{success:!1,error:t.message}}},async updateCustomer(e,t){try{const{data:s,error:n}=await Hn.from("customers").update(t).eq("customerid",e).select();if(n)throw n;return{success:!0,data:s[0]}}catch(s){return{success:!1,error:s.message}}},async deleteCustomer(e){try{const{error:t}=await Hn.from("customers").delete().eq("customerid",e);if(t)throw t;return{success:!0}}catch(t){return{success:!1,error:t.message}}},async updateCustomerStatus(e,t,s,n){try{const a={status:t,remarks:s||null};"Disconnected"===t?(a.disconnection_date=(new Date).toISOString().split("T")[0],a.disconnected_by=n):"Active"===t&&(a.disconnection_date=null,a.disconnected_by=null);const{data:r,error:i}=await Hn.from("customers").update(a).eq("customerid",e).select();if(i)throw i;return{success:!0,data:r[0]}}catch(a){return{success:!1,error:a.message}}},async getCustomerStats(){try{let e=[],t=0;const s=1e3;let n=!0;for(;n;){const{data:a,error:r}=await Hn.from("customers").select("status").range(t,t+s-1);if(r)throw r;a&&a.length>0?(e=[...e,...a],a.length<s?n=!1:t+=s):n=!1}const a={total:e.length,active:e.filter(e=>e.status&&"active"===e.status.toLowerCase()).length,disconnected:e.filter(e=>e.status&&"disconnected"===e.status.toLowerCase()).length};return console.log("Stats calculated from",e.length,"total records"),{success:!0,data:a}}catch(e){return{success:!1,error:e.message,data:[]}}},async getCustomerTypes(){try{const{data:e,error:t}=await Hn.from("customer_type").select("type, rate1, rate2").order("type",{ascending:!0}).limit(1e4);if(t)throw t;return{success:!0,data:e||[]}}catch(e){return console.error("Error getting customer types:",e),{success:!1,error:e.message,data:[]}}},async getDiscounts(){try{const{data:e,error:t}=await Hn.from("discount").select("type, discountpercentage").order("type",{ascending:!0}).limit(1e4);if(t)throw t;return{success:!0,data:e||[]}}catch(e){return console.error("Error getting discounts:",e),{success:!1,error:e.message,data:[]}}},async getBarangays(){try{const{data:e,error:t}=await Hn.from("barangays").select("*").order("barangay",{ascending:!0}).limit(1e4);if(t)throw t;return{success:!0,data:e||[]}}catch(e){return console.error("Error getting barangays:",e),{success:!1,error:e.message,data:[]}}},exportToCSV(e){const t=[["Customer ID","Name","Type","Barangay","Discount %","Status","Date Added","Added By","Credit Balance","Disconnection Date","Disconnected By","Remarks"].join(","),...e.map(e=>[e.customerid,'"'.concat(e.name||"",'"'),'"'.concat(e.type||"",'"'),'"'.concat(e.barangay||"",'"'),e.discount||0,'"'.concat(e.status||"",'"'),e.date_added||"",'"'.concat(e.added_by||"",'"'),e.credit_balance||0,e.disconnection_date||"",'"'.concat(e.disconnected_by||"",'"'),'"'.concat(e.remarks||"",'"')].join(","))].join("\n"),s=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),a=URL.createObjectURL(s);n.setAttribute("href",a),n.setAttribute("download","customers_".concat((new Date).toISOString().split("T")[0],".csv")),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)},async getRecentCustomers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;try{const{data:t,error:s}=await Hn.from("customers").select("*").order("date_added",{ascending:!1}).limit(e);if(s)throw s;return{success:!0,data:t||[]}}catch(t){return console.error("Error getting recent customers:",t),{success:!1,error:t.message,data:[]}}}},na=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,s=[],n=0,a=!0;for(;a;){console.log("Fetching batch starting at ".concat(n,"..."));const{data:r,error:i}=await e.range(n,n+t-1);if(i)throw i;r&&r.length>0?(s=[...s,...r],console.log("Fetched ".concat(r.length," records, total so far: ").concat(s.length)),r.length<t?a=!1:n+=t):a=!1}return s},aa={async getBills(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"billedmonth",n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{const a=(e-1)*t,r=a+t-1,{data:i,error:l,count:o}=await Hn.from("bills").select("*",{count:"exact"}).order(s,{ascending:n}).range(a,r);if(l)throw l;const c=[...new Set(i.map(e=>e.customerid).filter(e=>e))],{data:d}=await Hn.from("customers").select("customerid, name, type, barangay").in("customerid",c).limit(1e4),u={};d&&d.forEach(e=>{u[e.customerid]=e});return{success:!0,data:i.map(e=>ta(ta({},e),{},{customers:u[e.customerid]||null})),count:o}}catch(a){return console.error("Error getting bills:",a),{success:!1,error:a.message,data:[],count:0}}},async getCustomerTypes(){try{const{data:e,error:t}=await Hn.from("customer_type").select("type, rate1, rate2").order("type",{ascending:!0}).limit(1e4);if(t)throw t;return{success:!0,data:e||[]}}catch(e){return console.error("Error getting customer types:",e),{success:!1,error:e.message,data:[]}}},async getLastBill(e){try{const{data:t,error:s}=await Hn.from("bills").select("*").eq("customerid",e).order("billedmonth",{ascending:!1}).limit(1).single();if(s&&"PGRST116"!==s.code)throw s;return{success:!0,data:t||null}}catch(t){return console.error("Error getting last bill:",t),{success:!1,error:t.message,data:null}}},async checkDuplicateBill(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{let n=Hn.from("bills").select("billid").eq("customerid",e).eq("billedmonth",t);s&&(n=n.neq("billid",s));const{data:a,error:r}=await n;if(r)throw r;return{success:!0,exists:a&&a.length>0}}catch(n){return console.error("Error checking duplicate bill:",n),{success:!1,error:n.message,exists:!1}}},async checkBillIdExists(e){try{const{data:t,error:s}=await Hn.from("bills").select("billid").eq("billid",e).maybeSingle();if(s)throw s;return{success:!0,data:{exists:null!==t}}}catch(t){return console.error("Error checking bill ID exists:",t),{success:!1,error:t.message,data:{exists:!1}}}},calculateBasicAmount(e,t){if(!t)return 0;const s=parseFloat(t.rate1||0),n=parseFloat(t.rate2||0);let a=0;return a=0===e?s:e<=3?e*s:3*s+(e-3)*n,parseFloat(a.toFixed(2))},calculateDiscountAmount:(e,t)=>!t||t<=0?0:e*t/100,async addBill(e){try{const{data:t,error:s}=await Hn.from("bills").insert([e]).select().single();if(s)throw s;return{success:!0,data:t}}catch(t){return console.error("Error adding bill:",t),{success:!1,error:t.message}}},async updateBill(e,t){try{const{data:s,error:n}=await Hn.from("bills").update(t).eq("billid",e).select().single();if(n)throw n;return{success:!0,data:s}}catch(s){return console.error("Error updating bill:",s),{success:!1,error:s.message}}},async deleteBill(e){try{const{error:t}=await Hn.from("bills").delete().eq("billid",e);if(t)throw t;return{success:!0}}catch(t){return console.error("Error deleting bill:",t),{success:!1,error:t.message}}},async getCustomerBills(e){try{const{data:t,error:s}=await Hn.from("bills").select("*").eq("customerid",e).order("billedmonth",{ascending:!1}).limit(1e4);if(s)throw s;return{success:!0,data:t||[]}}catch(t){return console.error("Error getting customer bills:",t),{success:!1,error:t.message,data:[]}}},async getBillsByMonth(e){try{const t=e+"-01";let s=[],n=0;const a=1e3;let r=!0;for(;r;){const{data:e,error:i}=await Hn.from("bills").select("*").eq("billedmonth",t).order("customerid",{ascending:!0}).range(n,n+a-1);if(i)throw i;e&&e.length>0?(s=[...s,...e],e.length<a?r=!1:n+=a):r=!1}if(0===s.length)return{success:!0,data:[]};const i=[...new Set(s.map(e=>e.customerid).filter(e=>e))];let l=[];for(n=0,r=!0;r;){const e=i.slice(n,n+a);if(0===e.length)break;const{data:t,error:s}=await Hn.from("customers").select("customerid, name, type, barangay, status").in("customerid",e);if(s)throw s;t&&t.length>0&&(l=[...l,...t]),n+=a,e.length<a&&(r=!1)}const o={};l.forEach(e=>{o[e.customerid]=e});return{success:!0,data:s.map(e=>{const t=o[e.customerid];return{billid:e.billid,customerid:e.customerid,name:(null===t||void 0===t?void 0:t.name)||"Unknown",type:(null===t||void 0===t?void 0:t.type)||"Unknown",barangay:(null===t||void 0===t?void 0:t.barangay)||"Unknown",status:(null===t||void 0===t?void 0:t.status)||"Unknown",billedmonth:e.billedmonth,previousreading:e.previousreading,currentreading:e.currentreading,consumption:e.consumption}})}}catch(t){return console.error("Error getting bills by month:",t),{success:!1,error:t.message,data:[]}}},async getEncodingStats(e){try{let t=[],s=0;const n=1e3;let a=!0;for(;a;){const{data:e,error:r}=await Hn.from("customers").select("customerid, name, barangay, type, status").order("barangay",{ascending:!0}).range(s,s+n-1);if(r)throw r;e&&e.length>0?(t=[...t,...e],e.length<n?a=!1:s+=n):a=!1}let r=[];for(s=0,a=!0;a;){const{data:t,error:i}=await Hn.from("bills").select("customerid").eq("billedmonth",e).range(s,s+n-1);if(i)throw i;t&&t.length>0?(r=[...r,...t],t.length<n?a=!1:s+=n):a=!1}const i=new Set(r.map(e=>e.customerid));console.log("Encoding Stats: Fetched ".concat(t.length," total customers and ").concat(r.length," bills for ").concat(e));const l={};return t.forEach(e=>{const t=e.barangay||"Unknown";l[t]||(l[t]={barangay:t,totalCustomers:0,encodedCount:0,allCustomers:[],notEncodedCustomers:[]});const s={customerid:e.customerid,name:e.name,type:e.type,status:e.status,isEncoded:i.has(e.customerid)};l[t].allCustomers.push(s),l[t].totalCustomers++,i.has(e.customerid)?l[t].encodedCount++:l[t].notEncodedCustomers.push({customerid:e.customerid,name:e.name,type:e.type,status:e.status})}),{success:!0,data:Object.values(l).sort((e,t)=>e.barangay.localeCompare(t.barangay))}}catch(t){return console.error("Error getting encoding stats:",t),{success:!1,error:t.message,data:[]}}},async getCustomersWithUnpaidBills(){try{const e=Hn.from("bills").select("billid, customerid, billedmonth, basicamount, surchargeamount, totalbillamount").eq("paymentstatus","Unpaid").order("customerid",{ascending:!0}).order("billedmonth",{ascending:!0}),t=await na(e);if(!t||0===t.length)return{success:!0,data:[],totalCustomers:0};const s=[...new Set(t.map(e=>e.customerid).filter(e=>e))],n=Hn.from("customers").select("customerid, name, barangay, type, status").in("customerid",s),a=await na(n),r={};a&&a.forEach(e=>{r[e.customerid]=e});const i={};t.forEach(e=>{const t=e.customerid,s=r[t];i[t]||(i[t]={customerid:t,name:(null===s||void 0===s?void 0:s.name)||"Unknown",barangay:(null===s||void 0===s?void 0:s.barangay)||"",type:(null===s||void 0===s?void 0:s.type)||"",status:(null===s||void 0===s?void 0:s.status)||"",unpaidBills:[],totalBasicAmount:0,totalSurcharge:0,totalBilledAmount:0,billCount:0,earliestMonth:e.billedmonth,latestMonth:e.billedmonth});const n=i[t];n.unpaidBills.push(e),n.totalBasicAmount+=parseFloat(e.basicamount||0),n.totalSurcharge+=parseFloat(e.surchargeamount||0),n.totalBilledAmount+=parseFloat(e.totalbillamount||0),n.billCount++,e.billedmonth<n.earliestMonth&&(n.earliestMonth=e.billedmonth),e.billedmonth>n.latestMonth&&(n.latestMonth=e.billedmonth)});const l=Object.values(i).map(e=>ta(ta({},e),{},{billScope:e.earliestMonth===e.latestMonth?e.earliestMonth:"".concat(e.earliestMonth," to ").concat(e.latestMonth)}));return{success:!0,data:l,totalCustomers:l.length}}catch(e){return console.error("Error getting customers with unpaid bills:",e),{success:!1,error:e.message,data:[]}}},async getRecentBills(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;try{const{data:t,error:s}=await Hn.from("bills").select("*").order("dateencoded",{ascending:!1}).limit(e);if(s)throw s;const n=[...new Set(t.map(e=>e.customerid).filter(e=>e))],{data:a}=await Hn.from("customers").select("customerid, name, type, barangay").in("customerid",n),r={};a&&a.forEach(e=>{r[e.customerid]=e});return{success:!0,data:t.map(e=>ta(ta({},e),{},{customers:r[e.customerid]||null}))}}catch(t){return console.error("Error getting recent bills:",t),{success:!1,error:t.message,data:[]}}},exportToCSV(e){const t=e.map(e=>{var t,s;return[e.billid,e.customerid,(null===(t=e.customers)||void 0===t?void 0:t.name)||"",(null===(s=e.customers)||void 0===s?void 0:s.barangay)||"",e.billedmonth,e.previousreading||0,e.currentreading||0,e.consumption||0,e.basicamount||0,e.surchargeamount||0,e.discountamount||0,e.totalbillamount||0,e.paymentstatus||""]});return[["Bill ID","Customer ID","Customer Name","Barangay","Billed Month","Previous Reading","Current Reading","Consumption","Basic Amount","Surcharge","Discount","Total Bill","Payment Status"].join(","),...t.map(e=>e.join(","))].join("\n")}},ra={async searchCustomers(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let s=Hn.from("customers").select("*").order("name",{ascending:!0});if(e){s=/^\d+$/.test(e.trim())?s.or("customerid.eq.".concat(e,",name.ilike.%").concat(e,"%")):s.ilike("name","%".concat(e,"%"))}t.barangay&&(s=s.ilike("barangay",t.barangay)),t.type&&(s=s.ilike("type",t.type)),t.status&&(s=s.ilike("status",t.status)),s=s.limit(1e4);const{data:n,error:a}=await s;if(a)throw a;return{success:!0,data:n}}catch(s){return console.error("Error searching customers:",s),{success:!1,error:s.message}}},async getBarangays(){try{const{data:e,error:t}=await Hn.from("barangays").select("*").order("barangay",{ascending:!0}).limit(1e4);if(t)throw t;return{success:!0,data:e||[]}}catch(e){return console.error("Error getting barangays:",e),{success:!1,error:e.message,data:[]}}},async getCustomerDetails(e){try{const{data:t,error:s}=await Hn.from("customers").select("*").eq("customerid",e).single();if(s)throw s;return{success:!0,data:t}}catch(t){return console.error("Error getting customer details:",t),{success:!1,error:t.message}}},async getCustomerDetails(e){try{const{data:t,error:s}=await Hn.from("customers").select("customerid, name, barangay, type, status, credit_balance, discount").eq("customerid",e).single();if(s)throw s;return{success:!0,data:t}}catch(t){return console.error("Error getting customer details:",t),{success:!1,error:t.message}}},async getUnpaidBills(e){try{const{data:t,error:s}=await Hn.from("bills").select("*").eq("customerid",e).or("paymentstatus.eq.Unpaid,paymentstatus.eq.Partial").order("billedmonth",{ascending:!0});if(s)throw s;return{success:!0,data:t||[]}}catch(t){return console.error("Error getting unpaid bills:",t),{success:!1,error:t.message}}},async getPaymentHistory(e){try{const{data:t,error:s}=await Hn.from("bills").select("*").eq("customerid",e).eq("paymentstatus","Paid").order("billedmonth",{ascending:!1}).limit(10);if(s)throw s;return{success:!0,data:t||[]}}catch(t){return console.error("Error getting payment history:",t),{success:!1,error:t.message}}},async getSurchargeSettings(){try{const{data:e,error:t}=await Hn.from("surcharge_settings").select("*").limit(1).single();if(t)throw t;return{success:!0,data:e}}catch(e){return console.error("Error getting surcharge settings:",e),{success:!0,data:{due_day:10,first_surcharge_percent:10,second_surcharge_percent:15}}}},calculateSurcharge(e,t){if(!e||!e.billedmonth||!e.basicamount)return{surchargeAmount:0,firstSurcharge:0,secondSurcharge:0,daysOverdue:0,surchargeType:null};const s=new Date,n=new Date(e.billedmonth),a=new Date(n.getFullYear(),n.getMonth()+1,t.due_day),r=Math.floor((s-a)/864e5);if(r<=0)return{surchargeAmount:0,firstSurcharge:0,secondSurcharge:0,daysOverdue:0,surchargeType:null,dueDate:a};const i=parseFloat(e.basicamount),l=new Date(a.getFullYear(),a.getMonth()+1,0),o=s>l;let c=0,d=0,u=null;if(r>=1&&(c=i*t.first_surcharge_percent/100,u="first"),o){d=(i+c)*t.second_surcharge_percent/100,u="both"}const h=c+d;return{surchargeAmount:Math.round(100*h)/100,firstSurcharge:Math.round(100*c)/100,secondSurcharge:Math.round(100*d)/100,daysOverdue:r,surchargeType:u,dueDate:a,endOfDueMonth:l,firstSurchargePercent:t.first_surcharge_percent,secondSurchargePercent:t.second_surcharge_percent}},calculateTotalWithSurcharge(e,t){const s=parseFloat(e.basicamount||0),n=parseFloat(e.discountamount||0),a=parseFloat(e.surchargeamount||0);return s+(t?t.surchargeAmount:a)-n},async processPayment(e,t){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;try{const n=e.map(e=>Hn.from("bills").update({paymentstatus:"Paid",paidby:t,datepaid:(new Date).toISOString(),basicamount:e.basicamount||0,surchargeamount:e.surchargeamount||0,discountamount:e.discountamount||0,totalbillamount:e.totalbillamount||0,advancepaymentamount:e.advancepaymentamount||0}).eq("billid",e.billid)),a=await Promise.all(n);if(a.some(e=>e.error))throw new Error("Some bills failed to update");if(0!==s&&e.length>0){const{data:t,error:n}=await Hn.from("bills").select("customerid").eq("billid",e[0].billid).single();if(!n&&t){const{data:e,error:n}=await Hn.from("customers").select("credit_balance").eq("customerid",t.customerid).single();if(!n&&e){const n=parseFloat(e.credit_balance||0)+s;await Hn.from("customers").update({credit_balance:n}).eq("customerid",t.customerid)}}}return{success:!0,data:{paidCount:e.length,creditApplied:s}}}catch(n){return console.error("Error processing payment:",n),{success:!1,error:n.message}}},async getPaymentStats(){try{const e=new Date;e.setHours(0,0,0,0);const t=new Date;t.setDate(1),t.setHours(0,0,0,0);const{data:s,error:n}=await Hn.from("bills").select("totalbillamount").eq("paymentstatus","Paid").gte("datepaid",e.toISOString()),{data:a,error:r}=await Hn.from("bills").select("totalbillamount").eq("paymentstatus","Paid").gte("datepaid",t.toISOString());if(n||r)throw new Error("Error fetching statistics");const i=s.reduce((e,t)=>e+parseFloat(t.totalbillamount||0),0),l=a.reduce((e,t)=>e+parseFloat(t.totalbillamount||0),0);return{success:!0,data:{todayCollection:i,todayCount:s.length,monthCollection:l,monthCount:a.length}}}catch(e){return console.error("Error getting payment stats:",e),{success:!1,error:e.message}}},async getRecentPayments(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;try{const{data:t,error:s}=await Hn.from("bills").select("*").eq("paymentstatus","Paid").not("datepaid","is",null).order("datepaid",{ascending:!1}).limit(e);if(s)throw s;const n=[...new Set(t.map(e=>e.customerid))],{data:a,error:r}=await Hn.from("customers").select("customerid, name, type, barangay").in("customerid",n).limit(1e4);if(r)throw r;return{success:!0,data:t.map(e=>ta(ta({},e),{},{customer:a.find(t=>t.customerid===e.customerid)}))}}catch(t){return console.error("Error getting recent payments:",t),{success:!1,error:t.message,data:[]}}},async markBillAsUnpaid(e){try{const{data:t,error:s}=await Hn.from("bills").select("customerid, advancepaymentamount").eq("billid",e).single();if(s)throw s;if(t.advancepaymentamount&&parseFloat(t.advancepaymentamount)>0){const e=parseFloat(t.advancepaymentamount),{data:s,error:n}=await Hn.from("customers").select("credit_balance").eq("customerid",t.customerid).single();if(!n&&s){const n=parseFloat(s.credit_balance||0)+e;await Hn.from("customers").update({credit_balance:n}).eq("customerid",t.customerid)}}const{error:n}=await Hn.from("bills").update({paymentstatus:"Unpaid",paidby:null,datepaid:null,advancepaymentamount:null}).eq("billid",e);if(n)throw n;return{success:!0,message:"Bill marked as unpaid successfully"}}catch(t){return console.error("Error marking bill as unpaid:",t),{success:!1,error:t.message}}}},ia=e=>{var t,s,n,r,i,l,o,c,d;let{user:u}=e;const h=se(),[m,f]=(0,a.useState)([]),[p,g]=(0,a.useState)([]),[v,y]=(0,a.useState)([]),[x,b]=(0,a.useState)(!0),[j,w]=(0,a.useState)(!0),[N,S]=(0,a.useState)(null),[k,C]=(0,a.useState)(null),[_,E]=(0,a.useState)(null),[T,P]=(0,a.useState)({totalCustomers:0,activeCustomers:0,monthlyRevenue:0,pendingBills:0,overdueAccounts:0,todayCollection:0});(0,a.useEffect)(()=>{O(),R()},[]);const O=async()=>{b(!0);try{const[e,t,s]=await Promise.all([sa.getRecentCustomers(5),aa.getRecentBills(5),ra.getRecentPayments(5)]);e.success&&f(e.data||[]),t.success&&g(t.data||[]),s.success&&y(s.data||[])}catch(e){console.error("Error loading recent data:",e)}b(!1)},R=async()=>{w(!0);try{var e,t,s,n,a,r;const[i,l,o]=await Promise.all([sa.getCustomerStats(),ra.getPaymentStats(),aa.getBills(1,1e4,"paymentstatus",!0)]),c={totalCustomers:(null===(e=i.data)||void 0===e?void 0:e.total)||0,activeCustomers:(null===(t=i.data)||void 0===t?void 0:t.active)||0,monthlyRevenue:(null===(s=l.data)||void 0===s?void 0:s.monthCollection)||0,todayCollection:(null===(n=l.data)||void 0===n?void 0:n.todayCollection)||0,pendingBills:(null===(a=o.data)||void 0===a?void 0:a.filter(e=>"Unpaid"===e.paymentstatus).length)||0,overdueAccounts:0},d=new Date;d.setMonth(d.getMonth()-2);const u=new Set((null===(r=o.data)||void 0===r?void 0:r.filter(e=>"Unpaid"===e.paymentstatus&&new Date(e.billedmonth)<d).map(e=>e.customerid))||[]);c.overdueAccounts=u.size,P(c)}catch(i){console.error("Error loading statistics:",i)}w(!1)};return(0,Jn.jsxs)("div",{className:"dashboard-content",children:[(0,Jn.jsxs)("div",{className:"page-header",children:[(0,Jn.jsx)("h1",{className:"page-title",children:"Dashboard"}),(0,Jn.jsxs)("p",{className:"page-subtitle",children:["Welcome back, ",u.firstname,"! Here's your system overview."]})]}),(0,Jn.jsxs)("div",{className:"stats-grid",children:[(0,Jn.jsxs)("div",{className:"stat-card blue",children:[(0,Jn.jsx)("div",{className:"stat-icon",children:(0,Jn.jsx)("i",{className:"fas fa-users"})}),(0,Jn.jsxs)("div",{className:"stat-content",children:[(0,Jn.jsx)("div",{className:"stat-number",children:j?(0,Jn.jsx)("i",{className:"fas fa-spinner fa-pulse"}):T.totalCustomers.toLocaleString()}),(0,Jn.jsx)("div",{className:"stat-label",children:"Total Customers"}),(0,Jn.jsxs)("div",{className:"stat-sublabel",children:[T.activeCustomers," Active"]})]})]}),(0,Jn.jsxs)("div",{className:"stat-card green",children:[(0,Jn.jsx)("div",{className:"stat-icon",children:(0,Jn.jsx)("i",{className:"fas fa-peso-sign"})}),(0,Jn.jsxs)("div",{className:"stat-content",children:[(0,Jn.jsx)("div",{className:"stat-number",children:j?(0,Jn.jsx)("i",{className:"fas fa-spinner fa-pulse"}):"\u20b1".concat(T.monthlyRevenue.toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2}))}),(0,Jn.jsx)("div",{className:"stat-label",children:"Monthly Revenue"}),(0,Jn.jsxs)("div",{className:"stat-sublabel",children:["\u20b1",T.todayCollection.toLocaleString("en-PH",{minimumFractionDigits:2})," Today"]})]})]}),(0,Jn.jsxs)("div",{className:"stat-card orange",children:[(0,Jn.jsx)("div",{className:"stat-icon",children:(0,Jn.jsx)("i",{className:"fas fa-file-invoice"})}),(0,Jn.jsxs)("div",{className:"stat-content",children:[(0,Jn.jsx)("div",{className:"stat-number",children:j?(0,Jn.jsx)("i",{className:"fas fa-spinner fa-pulse"}):T.pendingBills.toLocaleString()}),(0,Jn.jsx)("div",{className:"stat-label",children:"Pending Bills"}),(0,Jn.jsx)("div",{className:"stat-sublabel",children:"Awaiting Payment"})]})]}),(0,Jn.jsxs)("div",{className:"stat-card red",children:[(0,Jn.jsx)("div",{className:"stat-icon",children:(0,Jn.jsx)("i",{className:"fas fa-exclamation-circle"})}),(0,Jn.jsxs)("div",{className:"stat-content",children:[(0,Jn.jsx)("div",{className:"stat-number",children:j?(0,Jn.jsx)("i",{className:"fas fa-spinner fa-pulse"}):T.overdueAccounts.toLocaleString()}),(0,Jn.jsx)("div",{className:"stat-label",children:"Overdue Accounts"}),(0,Jn.jsx)("div",{className:"stat-sublabel",children:"2+ Months Behind"})]})]})]}),(0,Jn.jsxs)("div",{className:"box",style:{marginTop:"2rem",padding:"1.5rem"},children:[(0,Jn.jsx)("h2",{className:"title is-5",style:{marginBottom:"1rem"},children:(0,Jn.jsxs)("span",{className:"icon-text",children:[(0,Jn.jsx)("span",{className:"icon has-text-primary",children:(0,Jn.jsx)("i",{className:"fas fa-bolt"})}),(0,Jn.jsx)("span",{children:"Quick Actions"})]})}),(0,Jn.jsxs)("div",{className:"buttons",children:[(0,Jn.jsxs)("button",{className:"button is-primary",onClick:()=>h("/dashboard/customers"),children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-user-plus"})}),(0,Jn.jsx)("span",{children:"Add Customer"})]}),(0,Jn.jsxs)("button",{className:"button is-info",onClick:()=>h("/dashboard/billing"),children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-file-invoice-dollar"})}),(0,Jn.jsx)("span",{children:"Create Bill"})]}),(0,Jn.jsxs)("button",{className:"button is-success",onClick:()=>h("/dashboard/payments"),children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-cash-register"})}),(0,Jn.jsx)("span",{children:"Record Payment"})]}),(0,Jn.jsxs)("button",{className:"button is-link",onClick:()=>h("/dashboard/reports"),children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-chart-line"})}),(0,Jn.jsx)("span",{children:"View Reports"})]}),(0,Jn.jsxs)("button",{className:"button is-warning",onClick:()=>R(),children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-sync-alt ".concat(j?"fa-spin":"")})}),(0,Jn.jsx)("span",{children:"Refresh Stats"})]})]})]}),(0,Jn.jsxs)("div",{className:"columns is-gapless",style:{marginTop:"2rem",gap:"0.5rem"},children:[(0,Jn.jsx)("div",{className:"column is-4",children:(0,Jn.jsxs)("div",{className:"card",style:{boxShadow:"0 2px 8px rgba(0,0,0,0.1)",borderRadius:"6px",overflow:"hidden"},children:[(0,Jn.jsx)("header",{className:"card-header has-background-primary",children:(0,Jn.jsxs)("p",{className:"card-header-title has-text-white",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-users"})}),(0,Jn.jsx)("span",{children:"Recent Customers"})]})}),(0,Jn.jsx)("div",{className:"card-content",style:{padding:0},children:x?(0,Jn.jsx)("div",{className:"has-text-centered",style:{padding:"2rem"},children:(0,Jn.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Jn.jsx)("i",{className:"fas fa-spinner fa-pulse fa-2x"})})}):0===m.length?(0,Jn.jsxs)("div",{className:"has-text-centered has-text-grey",style:{padding:"2rem"},children:[(0,Jn.jsx)("i",{className:"fas fa-inbox",style:{fontSize:"2rem",marginBottom:"1rem",display:"block"}}),"No recent customers"]}):(0,Jn.jsx)("div",{style:{width:"100%"},children:m.map((e,t)=>(0,Jn.jsxs)("div",{style:{cursor:"pointer",padding:"0.875rem 0.25rem",borderBottom:t<m.length-1?"1px solid #f0f0f0":"none",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"space-between"},onClick:()=>S(e),onMouseEnter:e=>e.currentTarget.style.backgroundColor="#f8f9fa",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:[(0,Jn.jsxs)("div",{style:{flex:1},children:[(0,Jn.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"0.4rem"},children:[(0,Jn.jsx)("span",{className:"icon has-text-primary",style:{marginRight:"0.5rem"},children:(0,Jn.jsx)("i",{className:"fas fa-user"})}),(0,Jn.jsx)("strong",{style:{fontSize:"0.95rem",color:"#363636"},children:e.name})]}),(0,Jn.jsxs)("div",{style:{paddingLeft:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,Jn.jsx)("span",{className:"tag is-primary is-light is-small",children:e.type}),(0,Jn.jsxs)("span",{style:{fontSize:"0.8rem",color:"#7a7a7a"},children:[(0,Jn.jsx)("i",{className:"fas fa-map-marker-alt",style:{marginRight:"0.25rem"}}),e.barangay]})]})]}),(0,Jn.jsx)("span",{className:"icon has-text-grey-light",children:(0,Jn.jsx)("i",{className:"fas fa-chevron-right"})})]},e.customerid))})})]})}),(0,Jn.jsx)("div",{className:"column is-4",children:(0,Jn.jsxs)("div",{className:"card",style:{boxShadow:"0 2px 8px rgba(0,0,0,0.1)",borderRadius:"6px",overflow:"hidden"},children:[(0,Jn.jsx)("header",{className:"card-header has-background-info",children:(0,Jn.jsxs)("p",{className:"card-header-title has-text-white",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-file-invoice-dollar"})}),(0,Jn.jsx)("span",{children:"Recent Bills"})]})}),(0,Jn.jsx)("div",{className:"card-content",style:{padding:0},children:x?(0,Jn.jsx)("div",{className:"has-text-centered",style:{padding:"2rem"},children:(0,Jn.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Jn.jsx)("i",{className:"fas fa-spinner fa-pulse fa-2x"})})}):0===p.length?(0,Jn.jsxs)("div",{className:"has-text-centered has-text-grey",style:{padding:"2rem"},children:[(0,Jn.jsx)("i",{className:"fas fa-inbox",style:{fontSize:"2rem",marginBottom:"1rem",display:"block"}}),"No recent bills"]}):(0,Jn.jsx)("div",{style:{width:"100%"},children:p.map((e,t)=>{var s,n;return(0,Jn.jsxs)("div",{style:{cursor:"pointer",padding:"0.875rem 0.25rem",borderBottom:t<p.length-1?"1px solid #f0f0f0":"none",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"space-between"},onClick:()=>C(e),onMouseEnter:e=>e.currentTarget.style.backgroundColor="#f8f9fa",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:[(0,Jn.jsxs)("div",{style:{flex:1},children:[(0,Jn.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"0.4rem"},children:[(0,Jn.jsx)("span",{className:"icon has-text-info",style:{marginRight:"0.5rem"},children:(0,Jn.jsx)("i",{className:"fas fa-file-invoice"})}),(0,Jn.jsx)("strong",{style:{fontSize:"0.95rem",color:"#363636"},children:(null===(s=e.customers)||void 0===s?void 0:s.name)||e.customername})]}),(0,Jn.jsxs)("div",{style:{paddingLeft:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,Jn.jsxs)("span",{style:{fontSize:"0.8rem",color:"#7a7a7a"},children:[(0,Jn.jsx)("i",{className:"fas fa-calendar-alt",style:{marginRight:"0.25rem"}}),e.billedmonth]}),(0,Jn.jsx)("span",{className:"tag is-small ".concat("Paid"===e.paymentstatus?"is-success":"is-warning"),children:e.paymentstatus})]})]}),(0,Jn.jsx)("div",{style:{textAlign:"right"},children:(0,Jn.jsxs)("div",{style:{fontSize:"1rem",fontWeight:"bold",color:"#209cee"},children:["\u20b1",null===(n=e.basicamount)||void 0===n?void 0:n.toFixed(2)]})})]},e.billid)})})})]})}),(0,Jn.jsx)("div",{className:"column is-4",children:(0,Jn.jsxs)("div",{className:"card",style:{boxShadow:"0 2px 8px rgba(0,0,0,0.1)",borderRadius:"6px",overflow:"hidden"},children:[(0,Jn.jsx)("header",{className:"card-header has-background-success",children:(0,Jn.jsxs)("p",{className:"card-header-title has-text-white",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-credit-card"})}),(0,Jn.jsx)("span",{children:"Recent Payments"})]})}),(0,Jn.jsx)("div",{className:"card-content",style:{padding:0},children:x?(0,Jn.jsx)("div",{className:"has-text-centered",style:{padding:"2rem"},children:(0,Jn.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Jn.jsx)("i",{className:"fas fa-spinner fa-pulse fa-2x"})})}):0===v.length?(0,Jn.jsxs)("div",{className:"has-text-centered has-text-grey",style:{padding:"2rem"},children:[(0,Jn.jsx)("i",{className:"fas fa-inbox",style:{fontSize:"2rem",marginBottom:"1rem",display:"block"}}),"No recent payments"]}):(0,Jn.jsx)("div",{style:{width:"100%"},children:v.map((e,t)=>{var s,n;return(0,Jn.jsxs)("div",{style:{cursor:"pointer",padding:"0.875rem 0.25rem",borderBottom:t<v.length-1?"1px solid #f0f0f0":"none",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"space-between"},onClick:()=>E(e),onMouseEnter:e=>e.currentTarget.style.backgroundColor="#f8f9fa",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:[(0,Jn.jsxs)("div",{style:{flex:1},children:[(0,Jn.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"0.4rem"},children:[(0,Jn.jsx)("span",{className:"icon has-text-success",style:{marginRight:"0.5rem"},children:(0,Jn.jsx)("i",{className:"fas fa-check-circle"})}),(0,Jn.jsx)("strong",{style:{fontSize:"0.95rem",color:"#363636"},children:(null===(s=e.customer)||void 0===s?void 0:s.name)||"Unknown"})]}),(0,Jn.jsx)("div",{style:{paddingLeft:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:(0,Jn.jsxs)("span",{style:{fontSize:"0.8rem",color:"#7a7a7a"},children:[(0,Jn.jsx)("i",{className:"fas fa-clock",style:{marginRight:"0.25rem"}}),new Date(e.datepaid).toLocaleDateString()]})})]}),(0,Jn.jsx)("div",{style:{textAlign:"right"},children:(0,Jn.jsxs)("div",{style:{fontSize:"1rem",fontWeight:"bold",color:"#48c774"},children:["\u20b1",null===(n=e.totalbillamount)||void 0===n?void 0:n.toFixed(2)]})})]},e.billid)})})})]})})]}),N&&(0,Jn.jsxs)("div",{className:"modal is-active",children:[(0,Jn.jsx)("div",{className:"modal-background",onClick:()=>S(null)}),(0,Jn.jsxs)("div",{className:"modal-card",children:[(0,Jn.jsxs)("header",{className:"modal-card-head",children:[(0,Jn.jsx)("p",{className:"modal-card-title",children:"Customer Details"}),(0,Jn.jsx)("button",{className:"delete","aria-label":"close",onClick:()=>S(null)})]}),(0,Jn.jsx)("section",{className:"modal-card-body",children:(0,Jn.jsxs)("div",{className:"content",children:[(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Customer ID"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:N.customerid,readOnly:!0})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Name"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:N.name,readOnly:!0})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Type"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:N.type||"N/A",readOnly:!0})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Barangay"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:N.barangay||"N/A",readOnly:!0})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Status"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("span",{className:"tag ".concat("Active"===N.status?"is-success":"is-danger"),children:N.status||"N/A"})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Date Added"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:N.date_added||"N/A",readOnly:!0})})]})]})}),(0,Jn.jsx)("footer",{className:"modal-card-foot",children:(0,Jn.jsx)("button",{className:"button",onClick:()=>S(null),children:"Close"})})]})]}),k&&(0,Jn.jsxs)("div",{className:"modal is-active",children:[(0,Jn.jsx)("div",{className:"modal-background",onClick:()=>C(null)}),(0,Jn.jsxs)("div",{className:"modal-card",children:[(0,Jn.jsxs)("header",{className:"modal-card-head",children:[(0,Jn.jsx)("p",{className:"modal-card-title",children:"Bill Details"}),(0,Jn.jsx)("button",{className:"delete","aria-label":"close",onClick:()=>C(null)})]}),(0,Jn.jsx)("section",{className:"modal-card-body",children:(0,Jn.jsxs)("div",{className:"content",children:[(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Bill ID"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:k.billid,readOnly:!0})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Customer"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:(null===(t=k.customers)||void 0===t?void 0:t.name)||k.customername,readOnly:!0})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Billed Month"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:k.billedmonth,readOnly:!0})})]}),(0,Jn.jsxs)("div",{className:"columns",children:[(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Previous Reading"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:k.previousreading||0,readOnly:!0})})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Current Reading"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:k.currentreading||0,readOnly:!0})})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Consumption"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:k.consumption||0,readOnly:!0})})]})})]}),(0,Jn.jsxs)("div",{className:"columns",children:[(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Basic Amount"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:"\u20b1".concat((null===(s=k.basicamount)||void 0===s?void 0:s.toFixed(2))||"0.00"),readOnly:!0})})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Surcharge"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:"\u20b1".concat((null===(n=k.surchargeamount)||void 0===n?void 0:n.toFixed(2))||"0.00"),readOnly:!0})})]})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Total Amount"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input has-text-weight-bold",type:"text",value:"\u20b1".concat((null===(r=k.totalbillamount)||void 0===r?void 0:r.toFixed(2))||"0.00"),readOnly:!0})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Payment Status"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("span",{className:"tag ".concat("Paid"===k.paymentstatus?"is-success":"is-warning"),children:k.paymentstatus})})]})]})}),(0,Jn.jsx)("footer",{className:"modal-card-foot",children:(0,Jn.jsx)("button",{className:"button",onClick:()=>C(null),children:"Close"})})]})]}),_&&(0,Jn.jsxs)("div",{className:"modal is-active",children:[(0,Jn.jsx)("div",{className:"modal-background",onClick:()=>E(null)}),(0,Jn.jsxs)("div",{className:"modal-card",children:[(0,Jn.jsxs)("header",{className:"modal-card-head",children:[(0,Jn.jsx)("p",{className:"modal-card-title",children:"Payment Details"}),(0,Jn.jsx)("button",{className:"delete","aria-label":"close",onClick:()=>E(null)})]}),(0,Jn.jsx)("section",{className:"modal-card-body",children:(0,Jn.jsxs)("div",{className:"content",children:[(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Bill ID"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:_.billid,readOnly:!0})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Customer"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:(null===(i=_.customer)||void 0===i?void 0:i.name)||"Unknown",readOnly:!0})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Billed Month"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:_.billedmonth||"N/A",readOnly:!0})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Payment Date"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:_.datepaid?new Date(_.datepaid).toLocaleDateString():"N/A",readOnly:!0})})]}),(0,Jn.jsxs)("div",{className:"columns",children:[(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Basic Amount"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:"\u20b1".concat((null===(l=_.basicamount)||void 0===l?void 0:l.toFixed(2))||"0.00"),readOnly:!0})})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Surcharge"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:"\u20b1".concat((null===(o=_.surchargeamount)||void 0===o?void 0:o.toFixed(2))||"0.00"),readOnly:!0})})]})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Total Amount"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input has-text-weight-bold",type:"text",value:"\u20b1".concat((null===(c=_.totalbillamount)||void 0===c?void 0:c.toFixed(2))||"0.00"),readOnly:!0})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Processed By"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:_.paidby||"N/A",readOnly:!0})})]}),_.advancepaymentamount&&_.advancepaymentamount>0&&(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Credit Applied"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:"\u20b1".concat(null===(d=_.advancepaymentamount)||void 0===d?void 0:d.toFixed(2)),readOnly:!0})})]})]})}),(0,Jn.jsx)("footer",{className:"modal-card-foot",children:(0,Jn.jsx)("button",{className:"button",onClick:()=>E(null),children:"Close"})})]})]})]})},la=()=>{const[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(!0),[r,i]=(0,a.useState)("Loading customers..."),[l,o]=(0,a.useState)(""),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)("add"),[m,f]=(0,a.useState)(null),[p,g]=(0,a.useState)(!1),[v,y]=(0,a.useState)(""),[x,b]=(0,a.useState)("all"),[j,w]=(0,a.useState)("all"),[N,S]=(0,a.useState)("all"),[k,C]=(0,a.useState)("date_added"),[_,E]=(0,a.useState)("desc"),[T,P]=(0,a.useState)(1),O=50,[R,A]=(0,a.useState)({customerid:"",name:"",type:"",barangay:"",discount:0,status:"Active",remarks:""}),[I,L]=(0,a.useState)({total:0,active:0,disconnected:0}),[D,B]=(0,a.useState)([]),[U,F]=(0,a.useState)([]),[z,M]=(0,a.useState)([]),W=$n.getUserSession(),q=()=>U.length>0?U[0].type:"",H=()=>D.length>0?D[0].barangay:"",V=()=>z.length>0?Number(z[0].discountpercentage):0;(0,a.useEffect)(()=>{K(),$(),J()},[]),(0,a.useEffect)(()=>{U.length>0&&A(e=>ta(ta({},e),{},{type:e.type||U[0].type}))},[U]),(0,a.useEffect)(()=>{D.length>0&&A(e=>ta(ta({},e),{},{barangay:e.barangay||D[0].barangay}))},[D]),(0,a.useEffect)(()=>{z.length>0&&A(e=>{var t;return ta(ta({},e),{},{discount:null!==(t=e.discount)&&void 0!==t?t:V()})})},[z]),(0,a.useEffect)(()=>{const e=setTimeout(()=>{P(1),K()},300);return()=>clearTimeout(e)},[v,x,j,N]);const K=async()=>{n(!0);try{const e=await sa.getCustomers({search:v,barangay:x,type:j,status:N});e.success?(t(e.data||[]),o("")):(e.error.includes("404")||e.error.includes('relation "public.customers" does not exist')?o("The customers table has not been created yet. Please create the customers table in your Supabase database."):o(e.error),t([]))}catch(e){console.error("Error loading customers:",e),o("Failed to load customers. Please check your database connection."),t([])}n(!1)},$=async()=>{try{const[e,t,s]=await Promise.all([sa.getBarangays(),sa.getCustomerTypes(),sa.getDiscounts()]);e.success?B(e.data||[]):B([]),t.success?F(t.data||[]):F([]),s.success?M((s.data||[]).map(e=>({type:e.type,discountpercentage:null!==e.discountpercentage?Number(e.discountpercentage):0}))):M([])}catch(e){console.error("Error loading filter options:",e),B([]),F([]),M([])}},J=async()=>{try{const e=await sa.getCustomerStats();e.success&&L(e.data||{total:0,active:0,disconnected:0})}catch(e){console.error("Error loading stats:",e),L({total:0,active:0,disconnected:0})}},G=async e=>{let t;e.preventDefault(),"add"===u?t=await sa.addCustomer(R):"edit"===u?t=await sa.updateCustomer(m.customerid,R):"status"===u&&(t=await sa.updateCustomerStatus(m.customerid,R.status,R.remarks,W.firstname+" "+W.lastname)),t.success?(K(),J(),$(),d(!1),f(null),Q()):o(t.error)},Q=()=>{A({customerid:"",name:"",type:q(),barangay:H(),discount:V(),status:"Active",remarks:""})},Y=e=>{k===e?E("asc"===_?"desc":"asc"):(C(e),E("asc"))},X=(0,a.useMemo)(()=>[...e].sort((e,t)=>{let s=e[k],n=t[k];return"string"===typeof s&&(s=s.toLowerCase(),n=n.toLowerCase()),"asc"===_?s>n?1:-1:s<n?1:-1}),[e,k,_]),Z=(0,a.useMemo)(()=>{const e=(T-1)*O;return X.slice(e,e+O)},[X,T,O]),ee=Math.ceil(X.length/O);return(0,Jn.jsxs)("div",{className:"customers-page",children:[(0,Jn.jsx)("div",{className:"compact-header",children:(0,Jn.jsxs)("div",{className:"header-row",children:[(0,Jn.jsxs)("div",{className:"title-section",children:[(0,Jn.jsx)("h1",{className:"page-title",children:"Customer Management"}),(0,Jn.jsxs)("div",{className:"stats-inline",children:[(0,Jn.jsxs)("span",{className:"stat-item",children:[(0,Jn.jsx)("i",{className:"fas fa-users"}),(0,Jn.jsx)("strong",{children:I.total})," Total"]}),(0,Jn.jsxs)("span",{className:"stat-item active",children:[(0,Jn.jsx)("i",{className:"fas fa-check-circle"}),(0,Jn.jsx)("strong",{children:I.active})," Active"]}),(0,Jn.jsxs)("span",{className:"stat-item disconnected",children:[(0,Jn.jsx)("i",{className:"fas fa-times-circle"}),(0,Jn.jsx)("strong",{children:I.disconnected})," Disconnected"]})]})]}),(0,Jn.jsxs)("div",{className:"header-actions",children:[(0,Jn.jsxs)("button",{className:"button is-info",onClick:()=>{sa.exportToCSV(e)},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-download"})}),(0,Jn.jsx)("span",{children:"Export"})]}),0===e.length&&!s&&(0,Jn.jsxs)("button",{className:"button is-link",onClick:async()=>{const e=[{customerid:1,name:"Juan Tolentino",type:"Residential",barangay:"Poblacion",discount:0,status:"Active",added_by:W.firstname+" "+W.lastname},{customerid:2,name:"Maria Santos",type:"Commercial",barangay:"Barangay 1",discount:5,status:"Active",added_by:W.firstname+" "+W.lastname},{customerid:3,name:"Pedro Garcia",type:"Residential",barangay:"Barangay 2",discount:0,status:"Disconnected",added_by:W.firstname+" "+W.lastname},{customerid:4,name:"Ana Cruz",type:"Residential",barangay:"Poblacion",discount:10,status:"Active",added_by:W.firstname+" "+W.lastname},{customerid:5,name:"Roberto Reyes",type:"Industrial",barangay:"Barangay 3",discount:0,status:"Active",added_by:W.firstname+" "+W.lastname}];try{for(const t of e)await sa.addCustomer(t);K(),J(),o("")}catch(t){o("Failed to create sample data: "+t.message)}},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-database"})}),(0,Jn.jsx)("span",{children:"Sample Data"})]}),(0,Jn.jsxs)("button",{className:"button is-primary",onClick:async()=>{if(!W)return void o("Your session has expired. Please log in again to add customers.");if(0===U.length)return void o("No customer types are configured. Please add customer types before creating a customer.");if(0===D.length)return void o("No barangays are configured. Please add barangays before creating a customer.");if(0===z.length)return void o("No discounts are configured. Please add discount options before creating a customer.");const e=await sa.generateCustomerId();if(!e.success)return void o(e.error||"Failed to generate a new customer ID. Please try again.");const{firstname:t="",lastname:s=""}=W,n="".concat(t," ").concat(s).trim()||"Unknown User";A({customerid:e.data,name:"",type:q(),barangay:H(),discount:V(),status:"Active",remarks:"",added_by:n}),h("add"),d(!0)},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-plus"})}),(0,Jn.jsx)("span",{children:"Add Customer"})]})]})]})}),(()=>{if(!c)return null;const e="view"===u,t="status"===u,s="add"===u,n="edit"===u,a=()=>{d(!1),f(null),Q()};return(0,Jn.jsxs)("div",{className:"modal ".concat(c?"is-active":""),children:[(0,Jn.jsx)("div",{className:"modal-background",onClick:a}),(0,Jn.jsxs)("div",{className:"modal-card",children:[(0,Jn.jsxs)("header",{className:"modal-card-head",children:[(0,Jn.jsxs)("p",{className:"modal-card-title",children:[s&&"Add Customer",n&&"Edit Customer",e&&"Customer Details",t&&"Update Customer Status"]}),(0,Jn.jsx)("button",{className:"delete","aria-label":"close",onClick:a})]}),(0,Jn.jsx)("section",{className:"modal-card-body",children:e?(0,Jn.jsxs)("div",{className:"content",children:[(0,Jn.jsxs)("p",{children:[(0,Jn.jsx)("strong",{children:"ID:"})," ",R.customerid]}),(0,Jn.jsxs)("p",{children:[(0,Jn.jsx)("strong",{children:"Name:"})," ",R.name]}),(0,Jn.jsxs)("p",{children:[(0,Jn.jsx)("strong",{children:"Type:"})," ",R.type]}),(0,Jn.jsxs)("p",{children:[(0,Jn.jsx)("strong",{children:"Barangay:"})," ",R.barangay]}),(0,Jn.jsxs)("p",{children:[(0,Jn.jsx)("strong",{children:"Status:"})," ",R.status]}),(0,Jn.jsxs)("p",{children:[(0,Jn.jsx)("strong",{children:"Discount:"})," ",R.discount,"%"]}),(0,Jn.jsxs)("p",{children:[(0,Jn.jsx)("strong",{children:"Remarks:"})," ",R.remarks]})]}):(0,Jn.jsxs)("form",{onSubmit:G,children:[(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Customer ID"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:R.customerid,readOnly:!0})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Name"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",value:R.name,onChange:e=>A(ta(ta({},R),{},{name:e.target.value})),required:!0,disabled:t})})]}),!t&&(0,Jn.jsxs)(Jn.Fragment,{children:[(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Type"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsx)("select",{value:R.type,onChange:e=>A(ta(ta({},R),{},{type:e.target.value})),disabled:t,children:U.map(e=>(0,Jn.jsx)("option",{value:e.type,children:e.type},e.type))})})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Barangay"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:R.barangay,onChange:e=>A(ta(ta({},R),{},{barangay:e.target.value})),children:[D.map(e=>(0,Jn.jsx)("option",{value:e.barangay,children:e.barangay},e.barangay)),R.barangay&&!D.some(e=>e.barangay===R.barangay)&&(0,Jn.jsx)("option",{value:R.barangay,children:R.barangay})]})})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Discount (%)"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:R.discount,onChange:e=>A(ta(ta({},R),{},{discount:Number(e.target.value)})),children:[z.map(e=>(0,Jn.jsxs)("option",{value:e.discountpercentage,children:[e.type," (",e.discountpercentage,"%)"]},e.type)),"number"===typeof R.discount&&!z.some(e=>e.discountpercentage===Number(R.discount))&&(0,Jn.jsxs)("option",{value:R.discount,children:[R.discount,"%"]})]})})})]})]}),(s||n)&&(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Remarks"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("textarea",{className:"textarea",value:R.remarks,onChange:e=>A(ta(ta({},R),{},{remarks:e.target.value}))})})]}),t&&(0,Jn.jsxs)(Jn.Fragment,{children:[(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Status"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:R.status,onChange:e=>A(ta(ta({},R),{},{status:e.target.value})),children:[(0,Jn.jsx)("option",{value:"Active",children:"Active"}),(0,Jn.jsx)("option",{value:"Disconnected",children:"Disconnected"})]})})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Remarks"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("textarea",{className:"textarea",value:R.remarks,onChange:e=>A(ta(ta({},R),{},{remarks:e.target.value})),placeholder:"Reason for status change"})})]})]}),(0,Jn.jsxs)("footer",{className:"modal-card-foot",children:[(0,Jn.jsxs)("button",{type:"submit",className:"button is-primary",children:[s&&"Save Customer",n&&"Update Customer",t&&"Update Status"]}),(0,Jn.jsx)("button",{type:"button",className:"button",onClick:a,children:"Cancel"})]})]})})]})]})})(),(0,Jn.jsxs)("div",{className:"compact-filters",children:[(0,Jn.jsx)("div",{className:"search-input",children:(0,Jn.jsxs)("div",{className:"control has-icons-left",children:[(0,Jn.jsx)("input",{className:"input",type:"text",placeholder:"Search customers...",value:v,onChange:e=>y(e.target.value)}),(0,Jn.jsx)("span",{className:"icon is-small is-left",children:(0,Jn.jsx)("i",{className:"fas fa-search"})})]})}),(0,Jn.jsxs)("div",{className:"filter-row",children:[(0,Jn.jsx)("div",{className:"filter-group",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:x,onChange:e=>b(e.target.value),children:[(0,Jn.jsx)("option",{value:"all",children:"All Barangays"}),D.map(e=>(0,Jn.jsx)("option",{value:e.barangay,children:e.barangay},e.barangay))]})})}),(0,Jn.jsx)("div",{className:"filter-group",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:j,onChange:e=>w(e.target.value),children:[(0,Jn.jsx)("option",{value:"all",children:"All Types"}),U.map(e=>(0,Jn.jsx)("option",{value:e.type,children:e.type},e.type))]})})}),(0,Jn.jsx)("div",{className:"filter-group",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:N,onChange:e=>S(e.target.value),children:[(0,Jn.jsx)("option",{value:"all",children:"All Status"}),(0,Jn.jsx)("option",{value:"Active",children:"Active"}),(0,Jn.jsx)("option",{value:"Disconnected",children:"Disconnected"})]})})})]})]}),l&&(0,Jn.jsxs)("div",{className:"notification is-warning",children:[(0,Jn.jsx)("button",{className:"delete",onClick:()=>o("")}),(0,Jn.jsxs)("div",{children:[(0,Jn.jsx)("strong",{children:"Database Setup Required:"}),(0,Jn.jsx)("p",{children:l}),l.includes("customers table")&&(0,Jn.jsxs)("div",{className:"mt-3",children:[(0,Jn.jsx)("p",{children:(0,Jn.jsx)("strong",{children:"To fix this issue:"})}),(0,Jn.jsxs)("ol",{children:[(0,Jn.jsx)("li",{children:"Go to your Supabase Dashboard"}),(0,Jn.jsx)("li",{children:"Navigate to SQL Editor"}),(0,Jn.jsx)("li",{children:"Run the SQL provided in the console or documentation"}),(0,Jn.jsx)("li",{children:"Refresh this page"})]}),(0,Jn.jsxs)("div",{className:"buttons",children:[(0,Jn.jsxs)("button",{className:"button is-small is-info",onClick:()=>{console.log("\nCREATE TABLE public.customers (\n  customerid bigint not null,\n  name text not null,\n  type text null,\n  barangay text null,\n  discount numeric null,\n  date_added date null default CURRENT_DATE,\n  remarks text null,\n  credit_balance numeric null,\n  status text null,\n  disconnection_date date null,\n  added_by text null,\n  disconnected_by text null,\n  constraint customers_pkey primary key (customerid)\n);\n                      "),alert("SQL command copied to console. Check browser console for the CREATE TABLE statement.")},children:[(0,Jn.jsx)("i",{className:"fas fa-copy"}),"Show SQL in Console"]}),(0,Jn.jsxs)("button",{className:"button is-small is-primary",onClick:()=>{o(""),K(),J(),$()},children:[(0,Jn.jsx)("i",{className:"fas fa-sync"}),"Retry Connection"]}),(0,Jn.jsxs)("button",{className:"button is-small is-success",onClick:async()=>{const e=await sa.testConnection();e.success?alert("Connection successful! Check console for details."):alert("Connection failed: "+e.error)},children:[(0,Jn.jsx)("i",{className:"fas fa-plug"}),"Test Connection"]})]})]})]})]}),(0,Jn.jsx)("div",{className:"table-container",children:s?(0,Jn.jsxs)("div",{className:"loading-container",children:[(0,Jn.jsxs)("div",{className:"loading-message",children:[(0,Jn.jsx)("div",{className:"loading-spinner"}),(0,Jn.jsx)("h3",{className:"title is-5",children:r}),(0,Jn.jsx)("p",{className:"has-text-grey",children:"Fetching all customer records from database..."})]}),(0,Jn.jsx)("div",{className:"loading-skeleton",children:[...Array(5)].map((e,t)=>(0,Jn.jsxs)("div",{className:"skeleton-row",children:[(0,Jn.jsx)("div",{className:"skeleton-avatar"}),(0,Jn.jsx)("div",{className:"skeleton-text"}),(0,Jn.jsx)("div",{className:"skeleton-text short"}),(0,Jn.jsx)("div",{className:"skeleton-text"}),(0,Jn.jsx)("div",{className:"skeleton-badge"})]},t))})]}):(0,Jn.jsxs)(Jn.Fragment,{children:[(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"Customer"}),(0,Jn.jsxs)("th",{onClick:()=>Y("customerid"),className:"sortable",children:["ID ","customerid"===k&&(0,Jn.jsx)("i",{className:"fas fa-sort-".concat("asc"===_?"up":"down")})]}),(0,Jn.jsxs)("th",{onClick:()=>Y("type"),className:"sortable",children:["Type ","type"===k&&(0,Jn.jsx)("i",{className:"fas fa-sort-".concat("asc"===_?"up":"down")})]}),(0,Jn.jsxs)("th",{onClick:()=>Y("barangay"),className:"sortable",children:["Barangay ","barangay"===k&&(0,Jn.jsx)("i",{className:"fas fa-sort-".concat("asc"===_?"up":"down")})]}),(0,Jn.jsxs)("th",{onClick:()=>Y("status"),className:"sortable",children:["Status ","status"===k&&(0,Jn.jsx)("i",{className:"fas fa-sort-".concat("asc"===_?"up":"down")})]}),(0,Jn.jsxs)("th",{onClick:()=>Y("date_added"),className:"sortable",children:["Date Added ","date_added"===k&&(0,Jn.jsx)("i",{className:"fas fa-sort-".concat("asc"===_?"up":"down")})]}),(0,Jn.jsx)("th",{children:"Actions"})]})}),(0,Jn.jsx)("tbody",{children:Z.length>0?Z.map(e=>{return(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{children:(0,Jn.jsxs)("div",{className:"customer-info",children:[(0,Jn.jsx)("div",{className:"customer-avatar",children:(t=e.name,t.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2))}),(0,Jn.jsxs)("div",{children:[(0,Jn.jsx)("div",{className:"customer-name",children:e.name}),(0,Jn.jsx)("div",{className:"customer-discount",children:e.discount>0&&"".concat(e.discount,"% discount")})]})]})}),(0,Jn.jsx)("td",{children:e.customerid}),(0,Jn.jsx)("td",{children:e.type}),(0,Jn.jsx)("td",{children:e.barangay}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag ".concat(e.status&&"active"===e.status.toLowerCase()?"is-success":"is-danger"),children:e.status})}),(0,Jn.jsx)("td",{children:new Date(e.date_added).toLocaleDateString()}),(0,Jn.jsx)("td",{children:(0,Jn.jsxs)("div",{className:"buttons are-small",children:[(0,Jn.jsx)("button",{className:"button is-info is-small",onClick:()=>(e=>{f(e),h("view"),d(!0)})(e),title:"View Customer",children:(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-eye"})})}),(0,Jn.jsx)("button",{className:"button is-link is-small",onClick:()=>(e=>{A(e),f(e),h("edit"),d(!0)})(e),title:"Edit Customer",children:(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-edit"})})}),(0,Jn.jsx)("button",{className:"button is-warning is-small",onClick:()=>(e=>{f(e),A(ta(ta({},e),{},{remarks:""})),h("status"),d(!0)})(e),title:"Change Status",children:(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-power-off"})})}),(0,Jn.jsx)("button",{className:"button is-danger is-small",onClick:()=>(e=>{f(e),g(!0)})(e),title:"Delete Customer",children:(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-trash"})})})]})})]},e.customerid);var t}):(0,Jn.jsx)("tr",{children:(0,Jn.jsx)("td",{colSpan:"7",className:"has-text-centered",style:{padding:"3rem"},children:(0,Jn.jsxs)("div",{className:"empty-state",children:[(0,Jn.jsx)("i",{className:"fas fa-users fa-3x has-text-grey-light"}),(0,Jn.jsx)("h3",{className:"title is-5 has-text-grey mt-4",children:"No customers found"}),(0,Jn.jsx)("p",{className:"has-text-grey",children:l?"Please check the error message above.":v||"all"!==x||"all"!==j||"all"!==N?"Try adjusting your search or filters.":"Start by adding your first customer."})]})})})})]}),ee>1&&(0,Jn.jsxs)("div",{className:"pagination-container",children:[(0,Jn.jsxs)("div",{className:"pagination-info",children:[(0,Jn.jsxs)("span",{children:["Showing ",(T-1)*O+1," to ",Math.min(T*O,X.length)," of ",X.length," customers"]}),ee>5&&(0,Jn.jsxs)("div",{className:"page-jump",children:[(0,Jn.jsx)("span",{children:"Go to page:"}),(0,Jn.jsx)("input",{type:"number",min:"1",max:ee,value:T,onChange:e=>{const t=parseInt(e.target.value);t>=1&&t<=ee&&P(t)},className:"page-input"}),(0,Jn.jsxs)("span",{children:["of ",ee]})]})]}),(0,Jn.jsxs)("nav",{className:"pagination is-centered",role:"navigation",children:[(0,Jn.jsxs)("button",{className:"pagination-previous",disabled:1===T,onClick:()=>P(T-1),children:[(0,Jn.jsx)("i",{className:"fas fa-chevron-left"}),"Previous"]}),(0,Jn.jsxs)("button",{className:"pagination-next",disabled:T===ee,onClick:()=>P(T+1),children:["Next",(0,Jn.jsx)("i",{className:"fas fa-chevron-right"})]}),(0,Jn.jsxs)("ul",{className:"pagination-list",children:[T>3&&(0,Jn.jsxs)(Jn.Fragment,{children:[(0,Jn.jsx)("li",{children:(0,Jn.jsx)("button",{className:"pagination-link",onClick:()=>P(1),children:"1"})}),T>4&&(0,Jn.jsx)("li",{children:(0,Jn.jsx)("span",{className:"pagination-ellipsis",children:"\u2026"})})]}),[...Array(ee)].map((e,t)=>{const s=t+1;return s===T||s>=T-2&&s<=T+2||T<=3&&s<=5||T>=ee-2&&s>=ee-4?(0,Jn.jsx)("li",{children:(0,Jn.jsx)("button",{className:"pagination-link ".concat(T===s?"is-current":""),onClick:()=>P(s),children:s})},t):null}),T<ee-2&&(0,Jn.jsxs)(Jn.Fragment,{children:[T<ee-3&&(0,Jn.jsx)("li",{children:(0,Jn.jsx)("span",{className:"pagination-ellipsis",children:"\u2026"})}),(0,Jn.jsx)("li",{children:(0,Jn.jsx)("button",{className:"pagination-link",onClick:()=>P(ee),children:ee})})]})]})]})]})]})})]})},oa=e=>{let{isOpen:t,onClose:s,mode:n,bill:r,preSelectedCustomer:i,onSuccess:l,customerTypes:o,surchargeSettings:c}=e;const[d,u]=(0,a.useState)(!1),[h,m]=(0,a.useState)(""),[f,p]=(0,a.useState)(!1),[g,v]=(0,a.useState)(""),[y,x]=(0,a.useState)([]),[b,j]=(0,a.useState)(null),[w,N]=(0,a.useState)(null),[S,k]=(0,a.useState)([]),[C,_]=(0,a.useState)(!1),[E,T]=(0,a.useState)(null),[P,O]=(0,a.useState)({customerid:"",billedmonth:"",previousreading:0,currentreading:0,consumption:0,basicamount:0});(0,a.useEffect)(()=>{t&&("edit"===n&&r?R():"add"===n&&i?A():I())},[t,n,r,i]);const R=async()=>{var e,t,s,n;const a={customerid:r.customerid,name:(null===(e=r.customers)||void 0===e?void 0:e.name)||"",type:(null===(t=r.customers)||void 0===t?void 0:t.type)||"",barangay:(null===(s=r.customers)||void 0===s?void 0:s.barangay)||"",discount:(null===(n=r.customers)||void 0===n?void 0:n.discount)||0};j(a),O({customerid:r.customerid,billedmonth:r.billedmonth.substring(0,7),previousreading:r.previousreading,currentreading:r.currentreading,consumption:r.consumption,basicamount:r.basicamount});const i=await aa.getCustomerBills(r.customerid);i.success&&k(i.data)},A=async()=>{await B(i)},I=()=>{j(null),x([]),v(""),N(null),k([]),m(""),O({customerid:"",billedmonth:L(),previousreading:0,currentreading:0,consumption:0,basicamount:0})},L=()=>{const e=new Date;return"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"))},D=async()=>{if(!g.trim())return void m("Please enter customer name or ID");u(!0),m("");const e=await ra.searchCustomers(g);e.success?(x(e.data),0===e.data.length&&m("No customers found")):m(e.error),u(!1)},B=async e=>{var t;j(e),x([]),v("");const s=await aa.getLastBill(e.customerid);s.success&&s.data?(N(s.data),O(e=>ta(ta({},e),{},{previousreading:s.data.currentreading||0}))):(N(null),O(e=>ta(ta({},e),{},{previousreading:0})));const n=await aa.getCustomerBills(e.customerid);n.success&&k(n.data);const a=U(null===(t=s.data)||void 0===t?void 0:t.billedmonth);O(t=>ta(ta({},t),{},{customerid:e.customerid,billedmonth:a}))},U=e=>{if(!e)return L();const t=e.substring(0,7),s=new Date(t+"-01");return s.setMonth(s.getMonth()+1),"".concat(s.getFullYear(),"-").concat(String(s.getMonth()+1).padStart(2,"0"))},F=(e,t)=>{const s=ta(ta({},P),{},{[e]:t});if("previousreading"===e||"currentreading"===e){const n=parseFloat("previousreading"===e?t:s.previousreading)||0,a=parseFloat("currentreading"===e?t:s.currentreading)||0;s.consumption=Math.max(0,a-n)}if("consumption"===e||"previousreading"===e||"currentreading"===e){const e=o.find(e=>e.type===(null===b||void 0===b?void 0:b.type));e&&s.consumption>=0&&(s.basicamount=aa.calculateBasicAmount(s.consumption,e))}O(s)},z=e=>"\u20b1".concat(parseFloat(e||0).toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})),M=e=>e?new Date(e).toLocaleDateString("en-PH",{year:"numeric",month:"long"}):"N/A";return t?(0,Jn.jsxs)("div",{className:"modal is-active",children:[(0,Jn.jsx)("div",{className:"modal-background",onClick:s}),(0,Jn.jsxs)("div",{className:"modal-card",style:{width:"90vw",maxWidth:"1000px"},children:[(0,Jn.jsxs)("header",{className:"modal-card-head",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:[(0,Jn.jsxs)("p",{className:"modal-card-title",style:{color:"white",fontSize:"1.25rem",fontWeight:"600"},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-file-invoice-dollar"})}),(0,Jn.jsx)("span",{children:"add"===n?"Add New Bill":"Edit Bill"})]}),(0,Jn.jsx)("button",{className:"delete",onClick:s})]}),(0,Jn.jsxs)("section",{className:"modal-card-body",style:{maxHeight:"75vh",overflowY:"auto",padding:"1.5rem"},children:[h&&(0,Jn.jsxs)("div",{className:"notification is-danger",children:[(0,Jn.jsx)("button",{className:"delete",onClick:()=>m("")}),h]}),!b&&"add"===n&&(0,Jn.jsxs)("div",{className:"box",children:[(0,Jn.jsx)("h3",{className:"title is-5",children:"Select Customer"}),(0,Jn.jsxs)("div",{className:"field has-addons",children:[(0,Jn.jsx)("div",{className:"control is-expanded",children:(0,Jn.jsx)("input",{className:"input",type:"text",placeholder:"Search by customer name or ID...",value:g,onChange:e=>v(e.target.value),onKeyPress:e=>"Enter"===e.key&&D()})}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("button",{className:"button is-primary ".concat(d?"is-loading":""),onClick:D,children:"Search"})})]}),y.length>0&&(0,Jn.jsx)("div",{className:"table-container mt-3",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"ID"}),(0,Jn.jsx)("th",{children:"Name"}),(0,Jn.jsx)("th",{children:"Type"}),(0,Jn.jsx)("th",{children:"Barangay"}),(0,Jn.jsx)("th",{children:"Action"})]})}),(0,Jn.jsx)("tbody",{children:y.map(e=>(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{children:e.customerid}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("strong",{children:e.name})}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag is-info",children:e.type})}),(0,Jn.jsx)("td",{children:e.barangay}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("button",{className:"button is-small is-primary",onClick:()=>B(e),children:"Select"})})]},e.customerid))})]})})]}),b&&(0,Jn.jsxs)(Jn.Fragment,{children:[(0,Jn.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea15 0%, #764ba215 100%)",border:"1px solid #e0e0e0",borderRadius:"8px",padding:"1.25rem",marginBottom:"1.5rem"},children:[(0,Jn.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"1rem"},children:[(0,Jn.jsx)("span",{className:"icon has-text-primary",style:{fontSize:"1.5rem",marginRight:"0.5rem"},children:(0,Jn.jsx)("i",{className:"fas fa-user-circle"})}),(0,Jn.jsx)("h3",{style:{fontSize:"1.1rem",fontWeight:"600",margin:0},children:"Customer Information"})]}),(0,Jn.jsxs)("div",{className:"columns is-multiline is-mobile",style:{marginBottom:"0"},children:[(0,Jn.jsxs)("div",{className:"column is-3",children:[(0,Jn.jsx)("p",{style:{fontSize:"0.75rem",color:"#7a7a7a",marginBottom:"0.25rem",textTransform:"uppercase",fontWeight:"600"},children:"ID"}),(0,Jn.jsx)("p",{style:{fontSize:"1rem",fontWeight:"600",color:"#363636"},children:b.customerid})]}),(0,Jn.jsxs)("div",{className:"column is-3",children:[(0,Jn.jsx)("p",{style:{fontSize:"0.75rem",color:"#7a7a7a",marginBottom:"0.25rem",textTransform:"uppercase",fontWeight:"600"},children:"Name"}),(0,Jn.jsx)("p",{style:{fontSize:"1rem",fontWeight:"600",color:"#363636"},children:b.name})]}),(0,Jn.jsxs)("div",{className:"column is-3",children:[(0,Jn.jsx)("p",{style:{fontSize:"0.75rem",color:"#7a7a7a",marginBottom:"0.25rem",textTransform:"uppercase",fontWeight:"600"},children:"Type"}),(0,Jn.jsx)("span",{className:"tag is-info is-light",style:{fontWeight:"600"},children:b.type})]}),(0,Jn.jsxs)("div",{className:"column is-3",children:[(0,Jn.jsx)("p",{style:{fontSize:"0.75rem",color:"#7a7a7a",marginBottom:"0.25rem",textTransform:"uppercase",fontWeight:"600"},children:"Barangay"}),(0,Jn.jsx)("p",{style:{fontSize:"1rem",fontWeight:"600",color:"#363636"},children:b.barangay})]}),w&&(0,Jn.jsx)("div",{className:"column is-full",children:(0,Jn.jsxs)("div",{style:{background:"#fff",padding:"0.75rem",borderRadius:"6px",border:"1px solid #e0e0e0",marginTop:"0.5rem"},children:[(0,Jn.jsxs)("p",{style:{fontSize:"0.75rem",color:"#7a7a7a",marginBottom:"0.25rem",textTransform:"uppercase",fontWeight:"600"},children:[(0,Jn.jsx)("i",{className:"fas fa-history"})," Last Reading"]}),(0,Jn.jsxs)("p",{style:{fontSize:"1rem",fontWeight:"600",color:"#3273dc"},children:[w.currentreading," cu.m ",(0,Jn.jsxs)("span",{style:{color:"#7a7a7a",fontWeight:"400"},children:["(",M(w.billedmonth),")"]})]})]})})]})]}),(0,Jn.jsxs)("div",{style:{background:"white",border:"1px solid #e0e0e0",borderRadius:"8px",padding:"1.25rem",marginBottom:"1.5rem"},children:[(0,Jn.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"1.25rem"},children:[(0,Jn.jsx)("span",{className:"icon has-text-link",style:{fontSize:"1.5rem",marginRight:"0.5rem"},children:(0,Jn.jsx)("i",{className:"fas fa-file-invoice"})}),(0,Jn.jsx)("h3",{style:{fontSize:"1.1rem",fontWeight:"600",margin:0},children:"Bill Details"})]}),(0,Jn.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,Jn.jsxs)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#363636",marginBottom:"0.5rem"},children:[(0,Jn.jsx)("i",{className:"fas fa-calendar-alt",style:{marginRight:"0.5rem",color:"#667eea"}}),"Billing Month *"]}),(0,Jn.jsx)("input",{className:"input",type:"month",value:P.billedmonth,onChange:e=>F("billedmonth",e.target.value),style:{fontSize:"1rem",borderRadius:"6px",borderColor:"#e0e0e0"}}),(0,Jn.jsx)("p",{className:"help",style:{fontSize:"0.75rem",color:"#7a7a7a",marginTop:"0.25rem"},children:"Select month and year for billing"})]}),(0,Jn.jsxs)("div",{style:{background:"#f9fafb",padding:"1rem",borderRadius:"6px",border:"1px solid #e5e7eb"},children:[(0,Jn.jsxs)("p",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#4b5563",marginBottom:"0.75rem"},children:[(0,Jn.jsx)("i",{className:"fas fa-tachometer-alt",style:{marginRight:"0.5rem"}}),"Meter Readings & Amount"]}),(0,Jn.jsxs)("div",{className:"columns",style:{marginBottom:"0"},children:[(0,Jn.jsxs)("div",{className:"column is-3",children:[(0,Jn.jsx)("label",{style:{display:"block",fontSize:"0.75rem",fontWeight:"600",color:"#6b7280",marginBottom:"0.5rem"},children:"Previous Reading *"}),(0,Jn.jsx)("input",{className:"input",type:"number",step:"0.01",value:P.previousreading,onChange:e=>F("previousreading",e.target.value),style:{borderRadius:"6px",fontSize:"1rem",fontWeight:"500"}}),w&&(0,Jn.jsxs)("p",{className:"help is-info",style:{fontSize:"0.7rem",marginTop:"0.25rem"},children:[(0,Jn.jsx)("i",{className:"fas fa-info-circle"})," Last: ",w.currentreading," cu.m"]})]}),(0,Jn.jsxs)("div",{className:"column is-3",children:[(0,Jn.jsx)("label",{style:{display:"block",fontSize:"0.75rem",fontWeight:"600",color:"#6b7280",marginBottom:"0.5rem"},children:"Current Reading *"}),(0,Jn.jsx)("input",{className:"input",type:"number",step:"0.01",value:P.currentreading,onChange:e=>F("currentreading",e.target.value),style:{borderRadius:"6px",fontSize:"1rem",fontWeight:"500"}})]}),(0,Jn.jsxs)("div",{className:"column is-3",children:[(0,Jn.jsx)("label",{style:{display:"block",fontSize:"0.75rem",fontWeight:"600",color:"#6b7280",marginBottom:"0.5rem"},children:"Consumption"}),(0,Jn.jsx)("input",{className:"input",type:"number",step:"0.01",value:P.consumption,readOnly:!0,style:{borderRadius:"6px",fontSize:"1rem",fontWeight:"700",background:"#fff",color:"#667eea",borderColor:"#667eea"}}),(0,Jn.jsx)("p",{className:"help",style:{fontSize:"0.7rem",color:"#9ca3af",marginTop:"0.25rem"},children:"Auto-calculated"})]}),(0,Jn.jsxs)("div",{className:"column is-3",children:[(0,Jn.jsxs)("label",{style:{display:"block",fontSize:"0.75rem",fontWeight:"600",color:"#6b7280",marginBottom:"0.5rem"},children:[(0,Jn.jsx)("i",{className:"fas fa-coins",style:{marginRight:"0.25rem"}}),"Basic Amount"]}),(0,Jn.jsx)("input",{className:"input",type:"number",step:"0.01",value:P.basicamount,readOnly:!0,style:{borderRadius:"6px",fontSize:"1rem",fontWeight:"700",background:"#fff",color:"#667eea",borderColor:"#667eea"}}),(0,Jn.jsx)("p",{className:"help",style:{fontSize:"0.7rem",color:"#9ca3af",marginTop:"0.25rem"},children:"Auto-calculated"})]})]})]})]}),S.length>0&&(0,Jn.jsxs)("div",{style:{background:"white",border:"1px solid #e0e0e0",borderRadius:"8px",padding:"1.25rem"},children:[(0,Jn.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"1rem"},children:[(0,Jn.jsx)("span",{className:"icon has-text-info",style:{fontSize:"1.5rem",marginRight:"0.5rem"},children:(0,Jn.jsx)("i",{className:"fas fa-history"})}),(0,Jn.jsx)("h3",{style:{fontSize:"1.1rem",fontWeight:"600",margin:0},children:"Recent Billing History"})]}),(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-narrow is-striped is-hoverable",style:{fontSize:"0.9rem"},children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"Month"}),(0,Jn.jsx)("th",{children:"Reading"}),(0,Jn.jsx)("th",{children:"Consumption"}),(0,Jn.jsx)("th",{children:"Basic Amount"}),(0,Jn.jsx)("th",{children:"Status"}),(0,Jn.jsx)("th",{width:"120",children:"Actions"})]})}),(0,Jn.jsx)("tbody",{children:S.slice(0,5).map(e=>(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{children:M(e.billedmonth)}),(0,Jn.jsxs)("td",{children:[e.previousreading," \u2192 ",e.currentreading]}),(0,Jn.jsxs)("td",{children:[e.consumption," cu.m"]}),(0,Jn.jsx)("td",{children:z(e.basicamount)}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag is-small ".concat("Paid"===e.paymentstatus?"is-success":"Partial"===e.paymentstatus?"is-warning":"is-danger"),children:e.paymentstatus})}),(0,Jn.jsx)("td",{children:(0,Jn.jsxs)("div",{style:{display:"flex",gap:"0.25rem"},children:[(0,Jn.jsx)("button",{className:"button is-small is-info is-light",onClick:()=>{const t=ta(ta({},e),{},{customers:b});s(),setTimeout(()=>{window.dispatchEvent(new CustomEvent("editBill",{detail:t}))},100)},title:"Edit this bill",style:{borderRadius:"4px"},children:(0,Jn.jsx)("span",{className:"icon is-small",children:(0,Jn.jsx)("i",{className:"fas fa-edit"})})}),(0,Jn.jsx)("button",{className:"button is-small is-danger is-light",onClick:()=>{T(e),_(!0)},title:"Delete this bill",style:{borderRadius:"4px"},children:(0,Jn.jsx)("span",{className:"icon is-small",children:(0,Jn.jsx)("i",{className:"fas fa-trash"})})})]})})]},e.billid))})]})})]})]})]}),(0,Jn.jsxs)("footer",{className:"modal-card-foot",style:{background:"#f9fafb",borderTop:"1px solid #e5e7eb",padding:"1.25rem 1.5rem",display:"flex",justifyContent:"space-between",gap:"0.75rem"},children:[(0,Jn.jsxs)("div",{style:{display:"flex",gap:"0.75rem"},children:[(0,Jn.jsxs)("button",{className:"button",onClick:s,style:{borderRadius:"6px",fontWeight:"600",padding:"0.75rem 1.5rem"},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-times"})}),(0,Jn.jsx)("span",{children:"Cancel"})]}),b&&(0,Jn.jsxs)("button",{className:"button is-info ".concat(f?"is-loading":""),onClick:()=>{b?(p(!0),sessionStorage.setItem("preSelectedCustomerForPayment",JSON.stringify(b)),window.dispatchEvent(new CustomEvent("navigateToPayments",{detail:{customer:b}})),s()):m("Please select a customer first")},disabled:f,style:{borderRadius:"6px",fontWeight:"600",padding:"0.75rem 1.5rem"},title:"Process payment for this customer",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-credit-card"})}),(0,Jn.jsx)("span",{children:"Process Payment"})]})]}),(0,Jn.jsxs)("button",{className:"button is-primary ".concat(d?"is-loading":""),onClick:async()=>{if(await(async()=>{if(!b)return m("Please select a customer"),!1;if(!P.billedmonth)return m("Please select billing month"),!1;if(parseFloat(P.currentreading)<parseFloat(P.previousreading))return m("Current reading cannot be less than previous reading"),!1;const e=P.billedmonth+"-01";return!(await aa.checkDuplicateBill(P.customerid,e,"edit"===n?null===r||void 0===r?void 0:r.billid:null)).exists||(m("A bill for this customer and month already exists"),!1)})()){u(!0),m("");try{const e=$n.getUserSession(),t={customerid:P.customerid,billedmonth:P.billedmonth+"-01",previousreading:parseFloat(P.previousreading)||0,currentreading:parseFloat(P.currentreading)||0,consumption:parseFloat(P.consumption)||0,basicamount:parseFloat(P.basicamount)||0,surchargeamount:0,discountamount:0,totalbillamount:0,paymentstatus:"Unpaid",encodedby:e?"".concat(e.firstname," ").concat(e.lastname):"Unknown"};let a;if("add"===n){const e=await(async()=>{const e=()=>Math.floor(1e7+9e7*Math.random());let t=e(),s=0;for(;s<10;){const{data:n,error:a}=await aa.checkBillIdExists(t);if(a)throw new Error("Error checking bill ID: "+a);if(!n.exists)return t;t=e(),s++}throw new Error("Could not generate unique bill ID after 10 attempts")})();t.billid=e,a=await aa.addBill(t)}else a=await aa.updateBill(r.billid,t);a.success?(l("Bill ".concat("add"===n?"added":"updated"," successfully!")),s()):m(a.error)}catch(h){m(h.message)}u(!1)}},disabled:!b,style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"6px",fontWeight:"600",padding:"0.75rem 2rem",boxShadow:"0 4px 6px rgba(102, 126, 234, 0.25)"},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-save"})}),(0,Jn.jsx)("span",{children:"add"===n?"Add Bill":"Update Bill"})]})]})]}),C&&E&&(0,Jn.jsx)("div",{className:"dialog-overlay",children:(0,Jn.jsxs)("div",{style:{background:"white",borderRadius:"12px",padding:"2rem",maxWidth:"450px",width:"90%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",animation:"fadeIn 0.2s ease-out"},children:[(0,Jn.jsxs)("div",{style:{textAlign:"center",marginBottom:"1.5rem"},children:[(0,Jn.jsx)("div",{style:{width:"64px",height:"64px",borderRadius:"50%",background:"linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem",boxShadow:"0 8px 16px rgba(255, 107, 107, 0.3)"},children:(0,Jn.jsx)("i",{className:"fas fa-exclamation-triangle",style:{fontSize:"2rem",color:"white"}})}),(0,Jn.jsx)("h3",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#363636",marginBottom:"0.5rem"},children:"Delete Bill?"}),(0,Jn.jsx)("p",{style:{fontSize:"0.95rem",color:"#7a7a7a"},children:"This action cannot be undone"})]}),(0,Jn.jsxs)("div",{style:{background:"#f9fafb",padding:"1rem",borderRadius:"8px",marginBottom:"1.5rem",border:"1px solid #e5e7eb"},children:[(0,Jn.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,Jn.jsx)("span",{style:{color:"#7a7a7a",fontSize:"0.875rem"},children:"Billing Month:"}),(0,Jn.jsx)("span",{style:{fontWeight:"600",color:"#363636"},children:M(E.billedmonth)})]}),(0,Jn.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,Jn.jsx)("span",{style:{color:"#7a7a7a",fontSize:"0.875rem"},children:"Consumption:"}),(0,Jn.jsxs)("span",{style:{fontWeight:"600",color:"#363636"},children:[E.consumption," cu.m"]})]}),(0,Jn.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,Jn.jsx)("span",{style:{color:"#7a7a7a",fontSize:"0.875rem"},children:"Amount:"}),(0,Jn.jsx)("span",{style:{fontWeight:"600",color:"#667eea"},children:z(E.basicamount)})]})]}),(0,Jn.jsxs)("div",{style:{display:"flex",gap:"0.75rem"},children:[(0,Jn.jsxs)("button",{className:"button is-light",onClick:()=>{_(!1),T(null)},style:{flex:1,borderRadius:"8px",fontWeight:"600",padding:"0.75rem 1.5rem",border:"2px solid #e5e7eb"},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-times"})}),(0,Jn.jsx)("span",{children:"Cancel"})]}),(0,Jn.jsxs)("button",{className:"button is-danger",onClick:()=>{s(),_(!1),setTimeout(()=>{const e=ta(ta({},E),{},{customers:b});window.dispatchEvent(new CustomEvent("deleteBill",{detail:e}))},100),T(null)},style:{flex:1,background:"linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%)",border:"none",borderRadius:"8px",fontWeight:"600",padding:"0.75rem 1.5rem",boxShadow:"0 4px 12px rgba(255, 107, 107, 0.3)"},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-trash"})}),(0,Jn.jsx)("span",{children:"Delete"})]})]})]})})]}):null},ca=e=>{let{onCustomerClick:t}=e;const[s,n]=(0,a.useState)(""),[r,i]=(0,a.useState)([]),[l,o]=(0,a.useState)([]),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(""),[m,f]=(0,a.useState)(""),[p,g]=(0,a.useState)(""),[v,y]=(0,a.useState)(""),[x,b]=(0,a.useState)([]),[j,w]=(0,a.useState)([]);(0,a.useEffect)(()=>{n(N())},[]);const N=()=>{const e=new Date;return"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"))},S=function(){let e=[...arguments.length>0&&void 0!==arguments[0]?arguments[0]:r];m&&(e=e.filter(e=>{var t;return(null===(t=e.barangay)||void 0===t?void 0:t.toLowerCase())===m.toLowerCase()})),(p||v)&&(e=e.map(e=>{const t=(e.allCustomers||[]).filter(e=>{var t,s;const n=!p||(null===(t=e.type)||void 0===t?void 0:t.toLowerCase())===p.toLowerCase(),a=!v||(null===(s=e.status)||void 0===s?void 0:s.toLowerCase())===v.toLowerCase();return n&&a}),s=t.filter(e=>e.isEncoded).length,n=t.filter(e=>!e.isEncoded);return ta(ta({},e),{},{totalCustomers:t.length,encodedCount:s,notEncodedCustomers:n})})),o(e)};(0,a.useEffect)(()=>{r.length>0&&S()},[m,p,v,r]);return(0,Jn.jsxs)("div",{className:"encoding-stats",children:[u&&(0,Jn.jsxs)("div",{className:"notification is-danger is-light py-3",children:[(0,Jn.jsx)("button",{className:"delete",onClick:()=>h("")}),u]}),(0,Jn.jsx)("div",{className:"box",style:{marginBottom:"1rem",padding:"1.5rem"},children:(0,Jn.jsxs)("div",{className:"level",style:{marginBottom:"0"},children:[(0,Jn.jsx)("div",{className:"level-left",children:(0,Jn.jsx)("div",{className:"level-item",children:(0,Jn.jsxs)("div",{className:"field has-addons",style:{marginBottom:"0"},children:[(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"month",value:s,onChange:e=>n(e.target.value)})}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsxs)("button",{className:"button is-primary ".concat(c?"is-loading":""),onClick:async()=>{if(!s)return;d(!0),h("");const e="".concat(s,"-01"),t=await aa.getEncodingStats(e);t.success?(i(t.data),S(t.data)):h(t.error),d(!1)},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-search"})}),(0,Jn.jsx)("span",{children:"Load Stats"})]})})]})})}),(0,Jn.jsx)("div",{className:"level-right",children:r.length>0&&(0,Jn.jsxs)(Jn.Fragment,{children:[(0,Jn.jsx)("div",{className:"level-item",children:(0,Jn.jsxs)("button",{className:"button is-info",onClick:()=>{const e=r.map(e=>[e.barangay,e.totalCustomers,e.encodedCount,e.notEncodedCustomers.length,e.notEncodedCustomers.map(e=>"".concat(e.customerid,": ").concat(e.name)).join("; ")]),t=[["Barangay","Total Customers","Encoded","Not Encoded","Not Encoded List"].join(","),...e.map(e=>e.join(","))].join("\n"),n=new Blob([t],{type:"text/csv"}),a=window.URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download="encoding_stats_".concat(s,".csv"),i.click(),window.URL.revokeObjectURL(a)},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-file-excel"})}),(0,Jn.jsx)("span",{children:"Export"})]})}),(0,Jn.jsx)("div",{className:"level-item",children:(0,Jn.jsxs)("button",{className:"button is-link",onClick:()=>{const e='\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <title>Encoding Stats Report</title>\n        <style>\n          body { font-family: Arial, sans-serif; padding: 20px; }\n          h1 { text-align: center; color: #333; }\n          h2 { color: #666; margin-top: 30px; border-bottom: 2px solid #ddd; padding-bottom: 5px; }\n          h3 { color: #888; margin-top: 20px; }\n          table { width: 100%; border-collapse: collapse; margin-top: 10px; }\n          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n          th { background-color: #f2f2f2; font-weight: bold; }\n          .summary { background-color: #f9f9f9; padding: 15px; margin: 20px 0; border-radius: 5px; }\n          .stat-box { display: inline-block; padding: 10px 15px; margin: 5px; background: #e8f4f8; border-radius: 5px; }\n          .no-print { margin-top: 30px; text-align: center; }\n          @media print {\n            .no-print { display: none; }\n          }\n        </style>\n      </head>\n      <body>\n        <h1>\ud83d\udcca Billing Encoding Statistics Report</h1>\n        <div class="summary">\n          <p><strong>Report Period:</strong> '.concat(new Date(s+"-01").toLocaleDateString("en-PH",{year:"numeric",month:"long"}),"</p>\n          <p><strong>Generated:</strong> ").concat((new Date).toLocaleString("en-PH"),"</p>\n          <p><strong>Total Barangays:</strong> ").concat(r.length,"</p>\n        </div>\n        \n        ").concat(r.map(e=>"\n          <h2>\ud83c\udfd8\ufe0f ".concat(e.barangay,'</h2>\n          <div style="margin: 10px 0;">\n            <div class="stat-box">\n              <strong>Total Customers:</strong> ').concat(e.totalCustomers,'\n            </div>\n            <div class="stat-box" style="background: #d4edda;">\n              <strong>Encoded Bills:</strong> ').concat(e.encodedCount,'\n            </div>\n            <div class="stat-box" style="background: ').concat(e.notEncodedCustomers.length>0?"#f8d7da":"#d4edda",';">\n              <strong>Not Encoded:</strong> ').concat(e.notEncodedCustomers.length,'\n            </div>\n            <div class="stat-box" style="background: #d1ecf1;">\n              <strong>Completion:</strong> ').concat((e.encodedCount/e.totalCustomers*100).toFixed(1),"%\n            </div>\n          </div>\n          \n          ").concat(e.notEncodedCustomers.length>0?"\n            <h3>\u26a0\ufe0f Customers Without Bills (".concat(e.notEncodedCustomers.length,')</h3>\n            <table>\n              <thead>\n                <tr>\n                  <th style="width: 20%;">Customer ID</th>\n                  <th>Customer Name</th>\n                </tr>\n              </thead>\n              <tbody>\n                ').concat(e.notEncodedCustomers.map(e=>"\n                  <tr>\n                    <td><strong>".concat(e.customerid,"</strong></td>\n                    <td>").concat(e.name,"</td>\n                  </tr>\n                ")).join(""),"\n              </tbody>\n            </table>\n          "):'<p style="color: #28a745; font-weight: bold;">\u2705 All customers in this barangay have been encoded!</p>',"\n        ")).join(""),'\n        \n        <div class="summary" style="margin-top: 40px;">\n          <h3>\ud83d\udcc8 Overall Summary</h3>\n          <p><strong>Total Customers:</strong> ').concat(r.reduce((e,t)=>e+t.totalCustomers,0),"</p>\n          <p><strong>Total Encoded:</strong> ").concat(r.reduce((e,t)=>e+t.encodedCount,0),"</p>\n          <p><strong>Total Not Encoded:</strong> ").concat(r.reduce((e,t)=>e+t.notEncodedCustomers.length,0),"</p>\n          <p><strong>Overall Completion:</strong> ").concat((r.reduce((e,t)=>e+t.encodedCount,0)/r.reduce((e,t)=>e+t.totalCustomers,0)*100).toFixed(1),'%</p>\n        </div>\n        \n        <div class="no-print">\n          <button onclick="window.print()" style="padding: 10px 20px; font-size: 16px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 5px; margin-right: 10px;">\n            \ud83d\udda8\ufe0f Print Report\n          </button>\n          <button onclick="window.close()" style="padding: 10px 20px; font-size: 16px; cursor: pointer; background: #6c757d; color: white; border: none; border-radius: 5px;">\n            \u274c Close\n          </button>\n        </div>\n      </body>\n      </html>\n    '),t=window.open("","_blank");t.document.write(e),t.document.close()},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-print"})}),(0,Jn.jsx)("span",{children:"Print"})]})})]})})]})}),r.length>0&&(0,Jn.jsxs)("div",{className:"box",style:{marginBottom:"1rem",padding:"1.5rem"},children:[(0,Jn.jsxs)("h3",{className:"title is-6 mb-3",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-filter"})}),"Filters"]}),(0,Jn.jsxs)("div",{className:"columns",style:{marginBottom:"0"},children:[(0,Jn.jsx)("div",{className:"column is-3",children:(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:m,onChange:e=>f(e.target.value),children:[(0,Jn.jsx)("option",{value:"",children:"All Barangays"}),r.map(e=>(0,Jn.jsx)("option",{value:e.barangay,children:e.barangay},e.barangay))]})})})}),(0,Jn.jsx)("div",{className:"column is-3",children:(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:p,onChange:e=>g(e.target.value),children:[(0,Jn.jsx)("option",{value:"",children:"All Types"}),(0,Jn.jsx)("option",{value:"Residential",children:"Residential"}),(0,Jn.jsx)("option",{value:"Commercial",children:"Commercial"}),(0,Jn.jsx)("option",{value:"Industrial",children:"Industrial"})]})})})}),(0,Jn.jsx)("div",{className:"column is-3",children:(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:v,onChange:e=>y(e.target.value),children:[(0,Jn.jsx)("option",{value:"",children:"All Status"}),(0,Jn.jsx)("option",{value:"Active",children:"Active"}),(0,Jn.jsx)("option",{value:"Disconnected",children:"Disconnected"})]})})})}),(0,Jn.jsx)("div",{className:"column is-3",children:(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsxs)("button",{className:"button is-light is-fullwidth",onClick:()=>{f(""),g(""),y(""),o(r)},disabled:!m&&!p&&!v,children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-times"})}),(0,Jn.jsx)("span",{children:"Clear Filters"})]})})})]})]}),c?(0,Jn.jsx)("div",{className:"has-text-centered",style:{padding:"2rem"},children:(0,Jn.jsx)("button",{className:"button is-loading is-large is-ghost"})}):0===r.length?(0,Jn.jsxs)("div",{className:"has-text-centered",style:{padding:"2rem"},children:[(0,Jn.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Jn.jsx)("i",{className:"fas fa-chart-bar fa-3x"})}),(0,Jn.jsx)("p",{className:"has-text-grey mt-4",children:'Select a month and click "Load Stats" to view encoding statistics'})]}):(0,Jn.jsxs)(Jn.Fragment,{children:[(0,Jn.jsxs)("div",{className:"box has-background-info-light mb-3 p-4",children:[(0,Jn.jsx)("h3",{className:"title is-6 mb-3",children:"Overall Summary"}),(0,Jn.jsxs)("div",{className:"columns is-mobile",children:[(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"notification is-info is-light p-3",children:[(0,Jn.jsx)("p",{className:"heading",children:"Total Customers"}),(0,Jn.jsx)("p",{className:"title is-4",children:l.reduce((e,t)=>e+t.totalCustomers,0)})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"notification is-success is-light p-3",children:[(0,Jn.jsx)("p",{className:"heading",children:"Encoded Bills"}),(0,Jn.jsx)("p",{className:"title is-4",children:l.reduce((e,t)=>e+t.encodedCount,0)})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"notification is-danger is-light p-3",children:[(0,Jn.jsx)("p",{className:"heading",children:"Not Encoded"}),(0,Jn.jsx)("p",{className:"title is-4",children:l.reduce((e,t)=>e+t.notEncodedCustomers.length,0)})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"notification is-primary is-light p-3",children:[(0,Jn.jsx)("p",{className:"heading",children:"Completion Rate"}),(0,Jn.jsxs)("p",{className:"title is-4",children:[l.reduce((e,t)=>e+t.totalCustomers,0)>0?(l.reduce((e,t)=>e+t.encodedCount,0)/l.reduce((e,t)=>e+t.totalCustomers,0)*100).toFixed(1):0,"%"]})]})})]})]}),l.map(e=>{const s=(e.allCustomers||[]).filter(e=>e.isEncoded);return(0,Jn.jsxs)("div",{className:"box mb-3 p-3",children:[(0,Jn.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:(0,Jn.jsxs)("h3",{className:"title is-5",style:{marginBottom:"0"},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-map-marker-alt"})}),e.barangay]})}),(0,Jn.jsxs)("div",{className:"columns is-mobile",children:[(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"notification is-info is-light p-2",children:[(0,Jn.jsx)("p",{className:"heading",children:"Total Customers"}),(0,Jn.jsx)("p",{className:"title is-5",children:e.totalCustomers})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsx)("div",{className:"notification is-success is-light p-2",children:(0,Jn.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Jn.jsxs)("div",{children:[(0,Jn.jsx)("p",{className:"heading",children:"Encoded Bills"}),(0,Jn.jsx)("p",{className:"title is-5",children:e.encodedCount})]}),e.encodedCount>0&&(0,Jn.jsx)("button",{className:"button is-small is-success",onClick:()=>{return t=e.barangay,void b(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},title:"View encoded customers",children:(0,Jn.jsx)("span",{className:"icon is-small",children:(0,Jn.jsx)("i",{className:"fas fa-chevron-".concat(x.includes(e.barangay)?"up":"down")})})})]})})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsx)("div",{className:"notification is-danger is-light p-2",children:(0,Jn.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Jn.jsxs)("div",{children:[(0,Jn.jsx)("p",{className:"heading",children:"Not Encoded"}),(0,Jn.jsx)("p",{className:"title is-5",children:e.notEncodedCustomers.length})]}),e.notEncodedCustomers.length>0&&(0,Jn.jsx)("button",{className:"button is-small is-danger",onClick:()=>{return t=e.barangay,void w(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},title:"View not encoded customers",children:(0,Jn.jsx)("span",{className:"icon is-small",children:(0,Jn.jsx)("i",{className:"fas fa-chevron-".concat(j.includes(e.barangay)?"up":"down")})})})]})})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"notification is-primary is-light p-2",children:[(0,Jn.jsx)("p",{className:"heading",children:"Completion"}),(0,Jn.jsxs)("p",{className:"title is-5",children:[(e.encodedCount/e.totalCustomers*100).toFixed(1),"%"]})]})})]}),e.encodedCount>0&&x.includes(e.barangay)&&(0,Jn.jsxs)(Jn.Fragment,{children:[(0,Jn.jsxs)("h4",{className:"title is-6 has-text-success mb-2 mt-3",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-check-circle"})}),"Encoded Customers (",e.encodedCount,")"]}),(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-narrow is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{width:"150",children:"Customer ID"}),(0,Jn.jsx)("th",{children:"Customer Name"}),(0,Jn.jsx)("th",{width:"120",children:"Type"}),(0,Jn.jsx)("th",{width:"120",children:"Status"})]})}),(0,Jn.jsx)("tbody",{children:s.map(e=>(0,Jn.jsxs)("tr",{onClick:()=>t&&t(e),style:{cursor:t?"pointer":"default"},title:t?"Click to add bill for this customer":"",children:[(0,Jn.jsx)("td",{className:"has-text-weight-bold",children:e.customerid}),(0,Jn.jsx)("td",{children:e.name}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag is-info is-light",children:e.type})}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag ".concat("Active"===e.status?"is-success":"is-warning"," is-light"),children:e.status})})]},e.customerid))})]})})]}),e.notEncodedCustomers.length>0&&j.includes(e.barangay)&&(0,Jn.jsxs)(Jn.Fragment,{children:[(0,Jn.jsxs)("h4",{className:"title is-6 has-text-danger mb-2 mt-3",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-exclamation-triangle"})}),"Customers Without Bills (",e.notEncodedCustomers.length,")"]}),(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-narrow is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{width:"150",children:"Customer ID"}),(0,Jn.jsx)("th",{children:"Customer Name"}),(0,Jn.jsx)("th",{width:"120",children:"Type"}),(0,Jn.jsx)("th",{width:"120",children:"Status"})]})}),(0,Jn.jsx)("tbody",{children:e.notEncodedCustomers.map(e=>(0,Jn.jsxs)("tr",{onClick:()=>t&&t(e),style:{cursor:t?"pointer":"default"},title:t?"Click to add bill for this customer":"",children:[(0,Jn.jsx)("td",{className:"has-text-weight-bold",children:e.customerid}),(0,Jn.jsx)("td",{children:e.name}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag is-info is-light",children:e.type})}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag ".concat("Active"===e.status?"is-success":"is-warning"," is-light"),children:e.status})})]},e.customerid))})]})})]}),0===e.notEncodedCustomers.length&&(0,Jn.jsxs)("div",{className:"notification is-success is-light p-2 mt-3",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-check-circle"})}),(0,Jn.jsx)("strong",{children:"All customers in this barangay have been encoded!"})]})]},e.barangay)})]})]})},da=e=>{let{isOpen:t,onClose:s,onConfirm:n,title:a,message:r,subMessage:i,confirmText:l="Confirm",cancelText:o="Cancel",type:c="info",loading:d=!1,icon:u=null}=e;if(!t)return null;return(0,Jn.jsx)("div",{className:"confirmation-dialog-overlay",children:(0,Jn.jsxs)("div",{className:"confirmation-dialog-content ".concat(c),children:[(0,Jn.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,Jn.jsxs)("h3",{className:"title is-5 mb-3",children:[(0,Jn.jsx)("span",{className:"icon ".concat((()=>{switch(c){case"danger":return"has-text-danger";case"warning":return"has-text-warning";case"success":return"has-text-success";default:return"has-text-info"}})()),style:{marginRight:"0.5rem"},children:(()=>{if(u)return u;switch(c){case"danger":return(0,Jn.jsx)("i",{className:"fas fa-exclamation-triangle"});case"warning":return(0,Jn.jsx)("i",{className:"fas fa-exclamation-circle"});case"success":return(0,Jn.jsx)("i",{className:"fas fa-check-circle"});default:return(0,Jn.jsx)("i",{className:"fas fa-info-circle"})}})()}),a]}),(0,Jn.jsx)("p",{className:"mb-3",style:{fontSize:"1rem",color:"#4a5568"},children:r}),i&&(0,Jn.jsx)("p",{className:"has-text-grey is-size-7",children:i})]}),(0,Jn.jsxs)("div",{className:"buttons is-right",style:{marginBottom:"0"},children:[(0,Jn.jsx)("button",{className:"button",onClick:s,disabled:d,children:o}),(0,Jn.jsxs)("button",{className:"button ".concat((()=>{switch(c){case"danger":return"is-danger";case"warning":return"is-warning";case"success":return"is-success";default:return"is-primary"}})()," ").concat(d?"is-loading":""),onClick:n,disabled:d,children:[(0,Jn.jsxs)("span",{className:"icon",children:["danger"===c&&(0,Jn.jsx)("i",{className:"fas fa-trash"}),"success"===c&&(0,Jn.jsx)("i",{className:"fas fa-check"}),"warning"===c&&(0,Jn.jsx)("i",{className:"fas fa-exclamation"}),"info"===c&&(0,Jn.jsx)("i",{className:"fas fa-info"})]}),(0,Jn.jsx)("span",{children:l})]})]})]})})},ua=()=>{var e;const[t,s]=(0,a.useState)("management"),[n,r]=(0,a.useState)([]),[i,l]=(0,a.useState)([]),[o,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(!1),[h,m]=(0,a.useState)(""),[f,p]=(0,a.useState)(""),[g,v]=(0,a.useState)(1),[y,x]=(0,a.useState)(0),[b]=(0,a.useState)(50),[j,w]=(0,a.useState)(!1),[N,S]=(0,a.useState)("add"),[k,C]=(0,a.useState)(null),[_,E]=(0,a.useState)(null),[T,P]=(0,a.useState)(""),[O,R]=(0,a.useState)([]),[A,I]=(0,a.useState)(!1),[L,D]=(0,a.useState)(""),[B,U]=(0,a.useState)(""),[F,z]=(0,a.useState)(""),[M,W]=(0,a.useState)([]),[q,H]=(0,a.useState)(!1),[V,K]=(0,a.useState)(null);(0,a.useEffect)(()=>{$(),J(),G(),Q();const e=e=>{const t=e.detail;ee(t)},t=e=>{const t=e.detail,s="object"===typeof t?t:n.find(e=>e.billid===t);s&&te(s)};return window.addEventListener("editBill",e),window.addEventListener("deleteBill",t),()=>{window.removeEventListener("editBill",e),window.removeEventListener("deleteBill",t)}},[]),(0,a.useEffect)(()=>{if(!(""!==T.trim())&&!(L||B||F))return void R([]);const e=setTimeout(()=>{Y()},500);return()=>clearTimeout(e)},[T,L,B,F]);const $=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;u(!0);const t=await aa.getBills(e,b,"dateencoded",!1);t.success?(r(t.data),x(t.count),v(e)):m(t.error),u(!1)},J=async()=>{const e=await aa.getCustomerTypes();e.success&&l(e.data)},G=async()=>{const e=await ra.getSurchargeSettings();e.success&&c(e.data)},Q=async()=>{const e=await ra.getBarangays();e.success&&W(e.data)},Y=async()=>{I(!0),m("");const e=await ra.searchCustomers(T||"",{barangay:L,type:B,status:F});e.success?(R(e.data),0===e.data.length&&m("No customers found matching your criteria")):m(e.error),I(!1)},X=e=>{E(e),Z()},Z=()=>{S("add"),C(null),w(!0)},ee=e=>{S("edit"),C(e),w(!0)},te=e=>{K(e),H(!0)},se=Math.ceil(y/b);return(0,Jn.jsxs)("div",{className:"billing-page",style:{padding:"0"},children:[(0,Jn.jsxs)("div",{className:"level mb-3",children:[(0,Jn.jsx)("div",{className:"level-left",children:(0,Jn.jsx)("div",{className:"level-item",children:(0,Jn.jsxs)("h1",{className:"title is-4 mb-0",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-file-invoice-dollar"})}),"Billing Management"]})})}),(0,Jn.jsx)("div",{className:"level-right",children:(0,Jn.jsx)("div",{className:"level-item",children:n.length>0&&"management"===t&&(0,Jn.jsxs)("button",{className:"button is-info",onClick:()=>{const e=aa.exportToCSV(n),t=new Blob([e],{type:"text/csv"}),s=window.URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download="bills_".concat((new Date).toISOString().split("T")[0],".csv"),a.click(),window.URL.revokeObjectURL(s)},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-file-csv"})}),(0,Jn.jsx)("span",{children:"Export CSV"})]})})})]}),h&&(0,Jn.jsxs)("div",{className:"notification is-danger is-light py-3",children:[(0,Jn.jsx)("button",{className:"delete",onClick:()=>m("")}),h]}),f&&(0,Jn.jsxs)("div",{className:"notification is-success is-light py-3",children:[(0,Jn.jsx)("button",{className:"delete",onClick:()=>p("")}),f]}),(0,Jn.jsx)("div",{className:"tabs is-boxed",children:(0,Jn.jsxs)("ul",{children:[(0,Jn.jsx)("li",{className:"management"===t?"is-active":"",onClick:()=>s("management"),children:(0,Jn.jsxs)("a",{children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-file-invoice"})}),(0,Jn.jsx)("span",{children:"Bill Management"})]})}),(0,Jn.jsx)("li",{className:"stats"===t?"is-active":"",onClick:()=>s("stats"),children:(0,Jn.jsxs)("a",{children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-chart-bar"})}),(0,Jn.jsx)("span",{children:"Encoding Stats"})]})})]})}),"management"===t&&(0,Jn.jsx)("div",{style:{width:"100%"},children:(0,Jn.jsxs)("div",{className:"box",style:{marginBottom:"0",padding:"1.5rem",borderRadius:"0"},children:[(0,Jn.jsxs)("h3",{className:"title is-6 mb-3",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-user-plus"})}),"Add New Bill - Search Customer"]}),(0,Jn.jsxs)("div",{className:"columns",style:{marginBottom:"0"},children:[(0,Jn.jsx)("div",{className:"column is-4",children:(0,Jn.jsxs)("div",{className:"field has-addons",style:{marginBottom:"0"},children:[(0,Jn.jsx)("div",{className:"control is-expanded",children:(0,Jn.jsx)("input",{className:"input",type:"text",placeholder:"Search by customer name or ID...",value:T,onChange:e=>P(e.target.value),onKeyPress:e=>"Enter"===e.key&&Y()})}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsxs)("button",{className:"button is-primary ".concat(A?"is-loading":""),onClick:Y,children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-search"})}),(0,Jn.jsx)("span",{children:"Search"})]})})]})}),(0,Jn.jsx)("div",{className:"column is-2",children:(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:L,onChange:e=>D(e.target.value),children:[(0,Jn.jsx)("option",{value:"",children:"All Barangays"}),M.map(e=>(0,Jn.jsx)("option",{value:e.barangay,children:e.barangay},e.barangay))]})})})}),(0,Jn.jsx)("div",{className:"column is-2",children:(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:B,onChange:e=>U(e.target.value),children:[(0,Jn.jsx)("option",{value:"",children:"All Types"}),i.map(e=>(0,Jn.jsx)("option",{value:e.type,children:e.type},e.type))]})})})}),(0,Jn.jsx)("div",{className:"column is-2",children:(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:F,onChange:e=>z(e.target.value),children:[(0,Jn.jsx)("option",{value:"",children:"All Status"}),(0,Jn.jsx)("option",{value:"Active",children:"Active"}),(0,Jn.jsx)("option",{value:"Disconnected",children:"Disconnected"})]})})})}),(0,Jn.jsx)("div",{className:"column is-2",children:(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsxs)("button",{className:"button is-light is-fullwidth",onClick:()=>{P(""),D(""),U(""),z(""),R([])},disabled:!T&&!L&&!B&&!F,title:"Clear all filters",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-times"})}),(0,Jn.jsx)("span",{children:"Clear"})]})})})]}),O.length>0&&(0,Jn.jsx)("div",{className:"table-container mt-3",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable is-narrow",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"Customer ID"}),(0,Jn.jsx)("th",{children:"Name"}),(0,Jn.jsx)("th",{children:"Type"}),(0,Jn.jsx)("th",{children:"Barangay"}),(0,Jn.jsx)("th",{children:"Status"}),(0,Jn.jsx)("th",{width:"100",children:"Action"})]})}),(0,Jn.jsx)("tbody",{children:O.map(e=>(0,Jn.jsxs)("tr",{onClick:()=>X(e),style:{cursor:"pointer"},title:"Click to add bill for this customer",children:[(0,Jn.jsx)("td",{className:"has-text-weight-bold",children:e.customerid}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("strong",{children:e.name})}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag is-info is-light",children:e.type})}),(0,Jn.jsx)("td",{children:e.barangay}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag is-small ".concat("Active"===e.status?"is-success":"is-danger"),children:e.status})}),(0,Jn.jsx)("td",{children:(0,Jn.jsxs)("button",{className:"button is-small is-primary",onClick:t=>{t.stopPropagation(),X(e)},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-plus"})}),(0,Jn.jsx)("span",{children:"Add Bill"})]})})]},e.customerid))})]})}),(0,Jn.jsxs)("div",{className:"mt-4",children:[(0,Jn.jsx)("hr",{}),(0,Jn.jsxs)("h3",{className:"title is-6 mb-3 mt-3",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-clock"})}),"Recent Bills Added"]}),d?(0,Jn.jsxs)("div",{className:"has-text-centered py-5",children:[(0,Jn.jsx)("span",{className:"icon is-large",children:(0,Jn.jsx)("i",{className:"fas fa-spinner fa-pulse fa-2x"})}),(0,Jn.jsx)("p",{className:"mt-3",children:"Loading bills..."})]}):0===n.length?(0,Jn.jsxs)("div",{className:"notification is-light has-text-centered",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-info-circle"})}),(0,Jn.jsx)("span",{children:"No bills found"})]}):(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable is-narrow",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"Bill ID"}),(0,Jn.jsx)("th",{children:"Customer ID"}),(0,Jn.jsx)("th",{children:"Customer Name"}),(0,Jn.jsx)("th",{children:"Barangay"}),(0,Jn.jsx)("th",{children:"Billing Month"}),(0,Jn.jsx)("th",{children:"Consumption"}),(0,Jn.jsx)("th",{children:"Basic Amount"}),(0,Jn.jsx)("th",{children:"Status"}),(0,Jn.jsx)("th",{children:"Encoded By"}),(0,Jn.jsx)("th",{width:"120",children:"Actions"})]})}),(0,Jn.jsx)("tbody",{children:n.slice(0,10).map(e=>{var t,s,n,a;return(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{className:"has-text-weight-bold",children:e.billid}),(0,Jn.jsx)("td",{children:e.customerid}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("strong",{children:(null===(t=e.customers)||void 0===t?void 0:t.name)||"N/A"})}),(0,Jn.jsx)("td",{children:(null===(s=e.customers)||void 0===s?void 0:s.barangay)||"N/A"}),(0,Jn.jsx)("td",{children:(a=e.billedmonth,a?new Date(a).toLocaleDateString("en-PH",{year:"numeric",month:"long"}):"N/A")}),(0,Jn.jsxs)("td",{children:[e.consumption," cu.m"]}),(0,Jn.jsx)("td",{children:(n=e.basicamount,"\u20b1".concat(parseFloat(n||0).toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})))}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag is-small ".concat("Paid"===e.paymentstatus?"is-success":"Partial"===e.paymentstatus?"is-warning":"is-danger"),children:e.paymentstatus})}),(0,Jn.jsx)("td",{children:e.encodedby||"N/A"}),(0,Jn.jsx)("td",{children:(0,Jn.jsxs)("div",{className:"buttons are-small",children:[(0,Jn.jsx)("button",{className:"button is-info is-small",onClick:()=>ee(e),title:"Edit bill",children:(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-edit"})})}),(0,Jn.jsx)("button",{className:"button is-danger is-small",onClick:()=>te(e),title:"Delete bill",children:(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-trash"})})})]})})]},e.billid)})})]})}),n.length>0&&se>1&&(0,Jn.jsxs)("nav",{className:"pagination is-small mt-3",role:"navigation",children:[(0,Jn.jsx)("button",{className:"button is-small",onClick:()=>$(g-1),disabled:1===g,children:"Previous"}),(0,Jn.jsx)("button",{className:"button is-small",onClick:()=>$(g+1),disabled:g===se,children:"Next"}),(0,Jn.jsx)("ul",{className:"pagination-list",children:(0,Jn.jsx)("li",{children:(0,Jn.jsxs)("span",{className:"pagination-ellipsis",children:["Page ",g," of ",se]})})})]})]})]})}),"stats"===t&&(0,Jn.jsx)("div",{style:{width:"100%"},children:(0,Jn.jsx)(ca,{onCustomerClick:X})}),(0,Jn.jsx)(oa,{isOpen:j,onClose:()=>{w(!1),E(null)},mode:N,bill:k,preSelectedCustomer:_,onSuccess:e=>{p(e),$(g),E(null);(L||B||F||""!==T.trim())&&Y()},customerTypes:i,surchargeSettings:o}),(0,Jn.jsx)(da,{isOpen:q&&null!==V,onClose:()=>{H(!1),K(null)},onConfirm:async()=>{if(!V)return;u(!0);const e=await aa.deleteBill(V.billid);e.success?(p("Bill deleted successfully"),$(g),setTimeout(()=>p(""),3e3)):m(e.error),u(!1),H(!1),K(null)},title:"Confirm Delete",message:V?"Are you sure you want to delete bill #".concat(V.billid,"?"):"",subMessage:V?"Customer: ".concat((null===(e=V.customers)||void 0===e?void 0:e.name)||"N/A"," | Month: ").concat(new Date(V.billedmonth).toLocaleDateString("en-PH",{year:"numeric",month:"long"})):"",confirmText:"Delete Bill",cancelText:"Cancel",type:"danger",loading:d})]})},ha=e=>{let{isOpen:t,onClose:s,onConfirm:n,billCount:r,grandTotal:i,creditBalance:l=0,loading:o=!1,totalSurcharge:c=0}=e;const[d,u]=(0,a.useState)(""),[h,m]=(0,a.useState)(""),[f,p]=(0,a.useState)(!1),g=f?i-c:i,v=Math.min(l,g),y=g-v,x=l-v;(0,a.useEffect)(()=>{t&&(u(y.toFixed(2)),m(""))},[t,y]);if(!t)return null;const b=parseFloat(d||0)-y,j=b>0;return(0,Jn.jsx)("div",{className:"confirmation-dialog-overlay",children:(0,Jn.jsxs)("div",{className:"confirmation-dialog-content success",style:{maxWidth:"550px"},children:[(0,Jn.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,Jn.jsxs)("h3",{className:"title is-5 mb-3",children:[(0,Jn.jsx)("span",{className:"icon has-text-success",style:{marginRight:"0.5rem"},children:(0,Jn.jsx)("i",{className:"fas fa-cash-register"})}),"Confirm Payment Processing"]}),(0,Jn.jsxs)("div",{className:"box",style:{background:"#f0f9ff",border:"2px solid #3b82f6",marginBottom:"1rem"},children:[(0,Jn.jsxs)("div",{style:{marginBottom:"0.75rem"},children:[(0,Jn.jsx)("span",{className:"has-text-grey",children:"Number of Bills:"}),(0,Jn.jsx)("strong",{style:{float:"right",fontSize:"1.1rem"},children:r})]}),(0,Jn.jsxs)("div",{style:{borderTop:"1px solid #ddd",paddingTop:"0.75rem",marginBottom:"0.75rem"},children:[(0,Jn.jsx)("span",{className:"has-text-grey",children:"Grand Total:"}),(0,Jn.jsxs)("strong",{style:{float:"right",fontSize:"1.2rem",color:"#059669"},children:["\u20b1",i.toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),c>0&&f&&(0,Jn.jsxs)("div",{style:{borderTop:"1px solid #ddd",paddingTop:"0.75rem",marginBottom:"0.75rem"},children:[(0,Jn.jsx)("span",{className:"has-text-grey",children:"Surcharge Waived:"}),(0,Jn.jsxs)("strong",{style:{float:"right",fontSize:"1.2rem",color:"#dc2626"},children:["-\u20b1",c.toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),v>0&&(0,Jn.jsxs)("div",{style:{borderTop:"1px solid #ddd",paddingTop:"0.75rem",marginBottom:"0.75rem"},children:[(0,Jn.jsx)("span",{className:"has-text-grey",children:"Credit Applied:"}),(0,Jn.jsxs)("strong",{style:{float:"right",fontSize:"1.2rem",color:"#d97706"},children:["-\u20b1",v.toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,Jn.jsxs)("div",{style:{borderTop:"2px solid #3b82f6",paddingTop:"0.75rem",background:"#dbeafe",margin:"-1rem",marginTop:"0.75rem",padding:"1rem"},children:[(0,Jn.jsx)("span",{className:"has-text-grey has-text-weight-bold",children:"Amount to Pay:"}),(0,Jn.jsxs)("strong",{style:{float:"right",fontSize:"1.5rem",color:"#059669"},children:["\u20b1",y.toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),c>0&&(0,Jn.jsx)("div",{className:"field",style:{marginBottom:"1rem"},children:(0,Jn.jsxs)("label",{className:"checkbox",children:[(0,Jn.jsx)("input",{type:"checkbox",checked:f,onChange:e=>p(e.target.checked),disabled:o})," ","Waive Surcharge (\u20b1",c.toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2}),") - Remove late payment penalty"]})}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsxs)("label",{className:"label",children:["Amount Received ",(0,Jn.jsx)("span",{className:"has-text-danger",children:"*"})]}),(0,Jn.jsxs)("div",{className:"control has-icons-left",children:[(0,Jn.jsx)("input",{className:"input ".concat(h?"is-danger":""),type:"number",step:"0.01",placeholder:"Enter amount received",value:d,onChange:e=>{u(e.target.value),m("")},autoFocus:!0,disabled:o}),(0,Jn.jsx)("span",{className:"icon is-small is-left",children:(0,Jn.jsx)("i",{className:"fas fa-peso-sign"})})]}),h&&(0,Jn.jsx)("p",{className:"help is-danger",children:h}),!h&&j&&(0,Jn.jsxs)("p",{className:"help is-success",children:[(0,Jn.jsx)("i",{className:"fas fa-info-circle"})," New credit from overpayment: \u20b1",b.toFixed(2)]})]}),v>0&&(0,Jn.jsx)("div",{className:"notification is-warning is-light",style:{padding:"0.75rem 1rem",marginBottom:"1rem"},children:(0,Jn.jsxs)("p",{className:"is-size-7",children:[(0,Jn.jsxs)("strong",{children:[(0,Jn.jsx)("i",{className:"fas fa-piggy-bank"})," Credit Auto-Applied:"]}),(0,Jn.jsx)("br",{}),"\u20b1",v.toFixed(2)," from available credit balance has been automatically applied to this payment.",x>0&&" Remaining credit: \u20b1".concat(x.toFixed(2))]})}),j&&!h&&(0,Jn.jsx)("div",{className:"notification is-success is-light",style:{padding:"0.75rem 1rem"},children:(0,Jn.jsxs)("p",{className:"is-size-7",children:[(0,Jn.jsxs)("strong",{children:[(0,Jn.jsx)("i",{className:"fas fa-coins"})," Overpayment Detected:"]}),(0,Jn.jsx)("br",{}),"The excess amount of ",(0,Jn.jsxs)("strong",{children:["\u20b1",b.toFixed(2)]})," will be saved as credit and automatically applied to future bills."]})})]}),(0,Jn.jsxs)("div",{className:"buttons is-right",style:{marginBottom:"0"},children:[(0,Jn.jsx)("button",{className:"button",onClick:s,disabled:o,children:"Cancel"}),(0,Jn.jsxs)("button",{className:"button is-success ".concat(o?"is-loading":""),onClick:()=>{const e=parseFloat(d);if(isNaN(e)||e<0)return void m("Please enter a valid amount");if(e<y)return void m("Amount received (\u20b1".concat(e.toFixed(2),") is less than required (\u20b1").concat(y.toFixed(2),")"));n(e,v,e-y,f)},disabled:o,children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-check-circle"})}),(0,Jn.jsx)("span",{children:"Confirm Payment"})]})]})]})})},ma=()=>{const[e,t]=(0,a.useState)("search"),[s,n]=(0,a.useState)(""),[r,i]=(0,a.useState)([]),[l,o]=(0,a.useState)([]),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(""),[m,f]=(0,a.useState)(""),[p,g]=(0,a.useState)("all"),[v,y]=(0,a.useState)("all"),[x,b]=(0,a.useState)("all"),[j,w]=(0,a.useState)([]),[N,S]=(0,a.useState)([]),[k,C]=(0,a.useState)(null),[_,E]=(0,a.useState)({todayCollection:0,todayCount:0,monthCollection:0,monthCount:0}),[T,P]=(0,a.useState)([]),[O,R]=(0,a.useState)(!1),[A,I]=(0,a.useState)(!1),[L,D]=(0,a.useState)(null),[B,U]=(0,a.useState)(""),[F,z]=(0,a.useState)(!1),[M,W]=(0,a.useState)(null),q=$n.getUserSession();(0,a.useEffect)(()=>{H(),V(),K(),$();const e=sessionStorage.getItem("preSelectedCustomerForPayment");if(e)try{const t=JSON.parse(e);Y(t),sessionStorage.removeItem("preSelectedCustomerForPayment")}catch(u){console.error("Error parsing preselected customer:",u)}},[]),(0,a.useEffect)(()=>{if(!s.trim())return void i([]);const e=setTimeout(()=>{Q()},500);return()=>clearTimeout(e)},[s,p,v,x]);const H=async()=>{const e=await ra.getPaymentStats();e.success&&E(e.data)},V=async()=>{try{const{data:e}=await ra.searchCustomers("");if(e){const t=[...new Set(e.map(e=>e.barangay).filter(Boolean))];w(t.map(e=>({barangay:e})));const s=[...new Set(e.map(e=>e.type).filter(Boolean))];S(s.map(e=>({type:e})))}}catch(u){console.error("Error loading filter options:",u)}},K=async()=>{const e=await ra.getSurchargeSettings();e.success&&C(e.data)},$=async()=>{R(!0);const e=await ra.getRecentPayments(10);e.success&&P(e.data),R(!1)},J=()=>l.find(t=>t.customer.customerid===e),G=(e,t)=>k?e.map(e=>{const s=ra.calculateSurcharge(e,k),n=parseFloat(e.basicamount||0);let a=0;if(e.discountamount&&parseFloat(e.discountamount)>0)a=parseFloat(e.discountamount);else if(t&&t.discount){a=n*parseFloat(t.discount)/100}const r=n+(s?s.surchargeAmount:parseFloat(e.surchargeamount||0))-a;return ta(ta({},e),{},{surchargeInfo:s,calculatedDiscountAmount:a,calculatedTotal:r})}):e,Q=async()=>{if(!s.trim())return void h("Please enter a customer name or ID");d(!0),h("");const e=await ra.searchCustomers(s);if(e.success){let t=e.data;"all"!==p&&(t=t.filter(e=>{var t;return(null===(t=e.barangay)||void 0===t?void 0:t.toLowerCase())===p.toLowerCase()})),"all"!==v&&(t=t.filter(e=>{var t;return(null===(t=e.type)||void 0===t?void 0:t.toLowerCase())===v.toLowerCase()})),"all"!==x&&(t=t.filter(e=>{var t;return(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())===x.toLowerCase()})),i(t),0===t.length&&h('No customers found matching "'.concat(s,'" with current filters.'))}else h("Search error: ".concat(e.error));d(!1)},Y=async e=>{if(l.find(t=>t.customer.customerid===e.customerid))return void t(e.customerid);d(!0),h("");const s=await ra.getCustomerDetails(e.customerid),n=s.success?s.data:e,a=await ra.getUnpaidBills(e.customerid),r=a.success?a.data:[],i=await ra.getPaymentHistory(e.customerid),c={customer:n,unpaidBills:r,paymentHistory:i.success?i.data:[],billsWithSurcharge:G(r,n),selectedBills:[],creditBalance:parseFloat(n.credit_balance||0)};o([...l,c]),t(e.customerid),d(!1)},X=t=>{o(s=>s.map(s=>s.customer.customerid===e?ta(ta({},s),{},{selectedBills:t}):s))},Z=async e=>{const t=await ra.getCustomerDetails(e),s=await ra.getUnpaidBills(e),n=await ra.getPaymentHistory(e),a=s.success?s.data:[],r=t.success?t.data:null,i=G(a,r);o(t=>t.map(t=>t.customer.customerid===e?ta(ta({},t),{},{customer:r||t.customer,unpaidBills:a,paymentHistory:n.success?n.data:[],billsWithSurcharge:i,creditBalance:r?parseFloat(r.credit_balance||0):0,selectedBills:[]}):t))},ee=e=>"\u20b1".concat(parseFloat(e||0).toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})),te=e=>e?new Date(e).toLocaleDateString("en-PH",{year:"numeric",month:"long"}):"N/A";return(0,Jn.jsxs)("div",{className:"customers-page",children:[(0,Jn.jsx)("div",{className:"compact-header",children:(0,Jn.jsxs)("div",{className:"header-row",children:[(0,Jn.jsxs)("div",{className:"title-section",children:[(0,Jn.jsx)("h1",{className:"page-title",children:"Payment Processing"}),(0,Jn.jsxs)("div",{className:"stats-inline",children:[(0,Jn.jsxs)("span",{className:"stat-item",children:[(0,Jn.jsx)("i",{className:"fas fa-cash-register"}),(0,Jn.jsx)("strong",{children:ee(_.todayCollection)})," Today"]}),(0,Jn.jsxs)("span",{className:"stat-item active",children:[(0,Jn.jsx)("i",{className:"fas fa-calendar-alt"}),(0,Jn.jsx)("strong",{children:ee(_.monthCollection)})," This Month"]}),(0,Jn.jsxs)("span",{className:"stat-item",children:[(0,Jn.jsx)("i",{className:"fas fa-receipt"}),(0,Jn.jsx)("strong",{children:_.todayCount+_.monthCount})," Transactions"]})]})]}),(0,Jn.jsx)("div",{className:"header-actions",children:l.length>0&&(0,Jn.jsxs)("button",{className:"button is-info",onClick:()=>t("search"),children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-search"})}),(0,Jn.jsx)("span",{children:"Search Customers"})]})})]})}),u&&(0,Jn.jsxs)("div",{className:"notification is-warning",children:[(0,Jn.jsx)("button",{className:"delete",onClick:()=>h("")}),u]}),m&&(0,Jn.jsxs)("div",{className:"notification is-success",children:[(0,Jn.jsx)("button",{className:"delete",onClick:()=>f("")}),m]}),(0,Jn.jsx)("div",{className:"tabs is-boxed",children:(0,Jn.jsxs)("ul",{children:[(0,Jn.jsx)("li",{className:"search"===e?"is-active":"",onClick:()=>t("search"),children:(0,Jn.jsxs)("a",{children:[(0,Jn.jsx)("span",{className:"icon is-small",children:(0,Jn.jsx)("i",{className:"fas fa-search"})}),(0,Jn.jsx)("span",{children:"Customer Search"})]})}),l.map(s=>(0,Jn.jsxs)("li",{className:e===s.customer.customerid?"is-active":"",style:{position:"relative"},children:[(0,Jn.jsxs)("a",{onClick:()=>t(s.customer.customerid),style:{paddingRight:"2rem"},children:[(0,Jn.jsx)("span",{className:"icon is-small",children:(0,Jn.jsx)("i",{className:"fas fa-money-check-alt"})}),(0,Jn.jsx)("span",{children:s.customer.name})]}),(0,Jn.jsx)("button",{className:"delete is-small",onClick:n=>{n.stopPropagation(),(s=>{const n=l.filter(e=>e.customer.customerid!==s);o(n),e===s&&(n.length>0?t(n[n.length-1].customer.customerid):t("search"))})(s.customer.customerid)},style:{position:"absolute",top:"8px",right:"8px",zIndex:10},title:"Close tab"})]},s.customer.customerid))]})}),"search"===e&&(0,Jn.jsxs)("div",{children:[(0,Jn.jsxs)("div",{className:"compact-filters",children:[(0,Jn.jsx)("div",{className:"search-input",children:(0,Jn.jsxs)("div",{className:"control has-icons-left",children:[(0,Jn.jsx)("input",{className:"input",type:"text",placeholder:"Search customer name or ID...",value:s,onChange:e=>n(e.target.value),onKeyPress:e=>"Enter"===e.key&&Q()}),(0,Jn.jsx)("span",{className:"icon is-small is-left",children:(0,Jn.jsx)("i",{className:"fas fa-search"})})]})}),(0,Jn.jsxs)("div",{className:"filter-row",children:[(0,Jn.jsx)("div",{className:"filter-group",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:p,onChange:e=>g(e.target.value),children:[(0,Jn.jsx)("option",{value:"all",children:"All Barangays"}),j.map(e=>(0,Jn.jsx)("option",{value:e.barangay,children:e.barangay},e.barangay))]})})}),(0,Jn.jsx)("div",{className:"filter-group",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:v,onChange:e=>y(e.target.value),children:[(0,Jn.jsx)("option",{value:"all",children:"All Types"}),N.map(e=>(0,Jn.jsx)("option",{value:e.type,children:e.type},e.type))]})})}),(0,Jn.jsx)("div",{className:"filter-group",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:x,onChange:e=>b(e.target.value),children:[(0,Jn.jsx)("option",{value:"all",children:"All Status"}),(0,Jn.jsx)("option",{value:"Active",children:"Active"}),(0,Jn.jsx)("option",{value:"Disconnected",children:"Disconnected"})]})})}),(0,Jn.jsxs)("button",{className:"button is-primary ".concat(c?"is-loading":""),onClick:Q,disabled:c,children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-search"})}),(0,Jn.jsx)("span",{children:"Search"})]}),(0,Jn.jsxs)("button",{className:"button is-info ".concat(c?"is-loading":""),onClick:async()=>{d(!0),h(""),n("");const e=await ra.searchCustomers("");if(e.success){let t=e.data;"all"!==p&&(t=t.filter(e=>{var t;return(null===(t=e.barangay)||void 0===t?void 0:t.toLowerCase())===p.toLowerCase()})),"all"!==v&&(t=t.filter(e=>{var t;return(null===(t=e.type)||void 0===t?void 0:t.toLowerCase())===v.toLowerCase()})),"all"!==x&&(t=t.filter(e=>{var t;return(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())===x.toLowerCase()})),i(t),0===t.length&&h("No customers found with current filters.")}else h("Error loading customers: ".concat(e.error));d(!1)},disabled:c,children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-list"})}),(0,Jn.jsx)("span",{children:"Browse All"})]})]})]}),r.length>0&&(0,Jn.jsxs)("div",{className:"box",style:{marginTop:"1rem",padding:"1.5rem"},children:[(0,Jn.jsxs)("h3",{className:"title is-6 mb-3",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-users"})}),"Search Results"]}),(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"Customer ID"}),(0,Jn.jsx)("th",{children:"Name"}),(0,Jn.jsx)("th",{children:"Type"}),(0,Jn.jsx)("th",{children:"Barangay"}),(0,Jn.jsx)("th",{children:"Status"}),(0,Jn.jsx)("th",{width:"100",children:"Action"})]})}),(0,Jn.jsx)("tbody",{children:r.map(e=>(0,Jn.jsxs)("tr",{onClick:()=>Y(e),style:{cursor:"pointer"},title:"Click to select customer",children:[(0,Jn.jsx)("td",{children:e.customerid}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("strong",{children:e.name})}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag is-info is-light",children:e.type})}),(0,Jn.jsx)("td",{children:e.barangay}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag ".concat("Active"===e.status?"is-success":"is-danger"),children:e.status})}),(0,Jn.jsx)("td",{children:(0,Jn.jsxs)("button",{className:"button is-small is-primary",onClick:t=>{t.stopPropagation(),Y(e)},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-arrow-right"})}),(0,Jn.jsx)("span",{children:"Select"})]})})]},e.customerid))})]})})]}),T.length>0&&(0,Jn.jsxs)("div",{className:"box",style:{marginTop:"1rem",padding:"1.5rem"},children:[(0,Jn.jsxs)("h3",{className:"title is-6 mb-3",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-clock"})}),"Recent Payments"]}),(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-narrow is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"Date Paid"}),(0,Jn.jsx)("th",{children:"Customer ID"}),(0,Jn.jsx)("th",{children:"Customer Name"}),(0,Jn.jsx)("th",{children:"Barangay"}),(0,Jn.jsx)("th",{children:"Billed Month"}),(0,Jn.jsx)("th",{children:"Amount Paid"})]})}),(0,Jn.jsx)("tbody",{children:T.map(e=>{var t,s;return(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{children:(0,Jn.jsxs)("span",{className:"icon-text",children:[(0,Jn.jsx)("span",{className:"icon has-text-success",children:(0,Jn.jsx)("i",{className:"fas fa-check-circle"})}),(0,Jn.jsx)("span",{children:new Date(e.datepaid).toLocaleDateString("en-PH",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})}),(0,Jn.jsx)("td",{className:"has-text-weight-bold",children:e.customerid}),(0,Jn.jsx)("td",{children:(null===(t=e.customer)||void 0===t?void 0:t.name)||"N/A"}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag is-light",children:(null===(s=e.customer)||void 0===s?void 0:s.barangay)||"N/A"})}),(0,Jn.jsx)("td",{children:new Date(e.billedmonth).toLocaleDateString("en-PH",{year:"numeric",month:"long"})}),(0,Jn.jsxs)("td",{className:"has-text-weight-bold has-text-success",children:["\u20b1",parseFloat(e.totalbillamount||0).toLocaleString("en-PH",{minimumFractionDigits:2})]})]},e.billid)})})]})})]}),0===r.length&&!c&&0===T.length&&(0,Jn.jsxs)("div",{className:"has-text-centered",style:{padding:"3rem"},children:[(0,Jn.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Jn.jsx)("i",{className:"fas fa-search fa-3x"})}),(0,Jn.jsx)("p",{className:"has-text-grey mt-4",children:"Search for customers to process payments"})]})]}),"search"!==e&&J()&&(()=>{const e=J(),{customer:t,unpaidBills:s,paymentHistory:n,billsWithSurcharge:a,selectedBills:r}=e;return(0,Jn.jsxs)("div",{children:[(0,Jn.jsx)("div",{className:"box",style:{background:"#f5f5f5",marginBottom:"1rem"},children:(0,Jn.jsx)("div",{className:"level is-mobile",children:(0,Jn.jsxs)("div",{className:"level-left",children:[(0,Jn.jsx)("div",{className:"level-item",children:(0,Jn.jsxs)("div",{children:[(0,Jn.jsx)("p",{className:"heading",children:"Customer"}),(0,Jn.jsx)("p",{className:"title is-5",children:t.name})]})}),(0,Jn.jsx)("div",{className:"level-item",children:(0,Jn.jsxs)("div",{children:[(0,Jn.jsx)("p",{className:"heading",children:"ID"}),(0,Jn.jsx)("p",{className:"title is-6",children:t.customerid})]})}),(0,Jn.jsx)("div",{className:"level-item",children:(0,Jn.jsxs)("div",{children:[(0,Jn.jsx)("p",{className:"heading",children:"Type"}),(0,Jn.jsx)("p",{children:(0,Jn.jsx)("span",{className:"tag is-info",children:t.type})})]})}),(0,Jn.jsx)("div",{className:"level-item",children:(0,Jn.jsxs)("div",{children:[(0,Jn.jsx)("p",{className:"heading",children:"Barangay"}),(0,Jn.jsx)("p",{className:"title is-6",children:t.barangay})]})}),(0,Jn.jsx)("div",{className:"level-item",children:(0,Jn.jsxs)("div",{children:[(0,Jn.jsx)("p",{className:"heading",children:"Discount"}),(0,Jn.jsxs)("p",{className:"title is-6",children:[t.discount||0,"%"]})]})}),(0,Jn.jsx)("div",{className:"level-item",children:(0,Jn.jsxs)("div",{children:[(0,Jn.jsx)("p",{className:"heading",children:"Status"}),(0,Jn.jsx)("p",{children:(0,Jn.jsx)("span",{className:"tag ".concat("Active"===t.status?"is-success":"is-danger"),children:t.status})})]})}),(0,Jn.jsx)("div",{className:"level-item",children:(0,Jn.jsxs)("div",{children:[(0,Jn.jsx)("p",{className:"heading",children:"Credit Balance"}),(0,Jn.jsx)("p",{className:"title is-6 has-text-success",children:ee(e.creditBalance||0)})]})})]})})}),(0,Jn.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,Jn.jsxs)("h2",{className:"title is-5",children:[(0,Jn.jsx)("i",{className:"fas fa-file-invoice-dollar"})," Unpaid Bills",s.length>0&&(0,Jn.jsx)("span",{className:"tag is-danger ml-2",children:s.length})]}),c?(0,Jn.jsx)("div",{className:"has-text-centered",style:{padding:"2rem"},children:(0,Jn.jsx)("button",{className:"button is-loading is-large is-ghost"})}):0===s.length?(0,Jn.jsxs)("div",{className:"notification is-success is-light has-text-centered",children:[(0,Jn.jsx)("i",{className:"fas fa-check-circle fa-2x"}),(0,Jn.jsx)("p",{className:"mt-2",children:"No unpaid bills"})]}):(0,Jn.jsxs)(Jn.Fragment,{children:[(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{width:"50",children:(0,Jn.jsx)("label",{className:"checkbox",children:(0,Jn.jsx)("input",{type:"checkbox",checked:r.length===a.length&&a.length>0,onChange:e=>{e.target.checked?X(a.map(e=>e.billid)):X([])}})})}),(0,Jn.jsx)("th",{children:"Bill ID"}),(0,Jn.jsx)("th",{children:"Billing Month"}),(0,Jn.jsx)("th",{children:"Previous"}),(0,Jn.jsx)("th",{children:"Current"}),(0,Jn.jsx)("th",{children:"Consumption"}),(0,Jn.jsx)("th",{children:"Basic Amount"}),(0,Jn.jsx)("th",{children:"Surcharge"}),(0,Jn.jsx)("th",{children:"Discount"}),(0,Jn.jsx)("th",{children:"Total Bill"}),(0,Jn.jsx)("th",{children:"Status"})]})}),(0,Jn.jsx)("tbody",{children:a.map(e=>{const t=e.surchargeInfo&&e.surchargeInfo.daysOverdue>0;return(0,Jn.jsxs)("tr",{className:r.includes(e.billid)?"is-selected":"",children:[(0,Jn.jsx)("td",{children:(0,Jn.jsx)("label",{className:"checkbox",children:(0,Jn.jsx)("input",{type:"checkbox",checked:r.includes(e.billid),onChange:t=>{t.target.checked?X([...r,e.billid]):X(r.filter(t=>t!==e.billid))}})})}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("strong",{children:e.billid})}),(0,Jn.jsxs)("td",{children:[(0,Jn.jsx)("div",{children:te(e.billedmonth)}),t&&(0,Jn.jsxs)("small",{className:"has-text-danger",children:[(0,Jn.jsx)("i",{className:"fas fa-exclamation-triangle"})," ",e.surchargeInfo.daysOverdue," days overdue"]})]}),(0,Jn.jsx)("td",{children:e.previousreading||0}),(0,Jn.jsx)("td",{children:e.currentreading||0}),(0,Jn.jsx)("td",{children:(0,Jn.jsxs)("strong",{children:[e.consumption," cu.m"]})}),(0,Jn.jsx)("td",{children:ee(e.basicamount)}),(0,Jn.jsx)("td",{children:e.surchargeInfo&&e.surchargeInfo.surchargeAmount>0?(0,Jn.jsx)("span",{className:"has-text-danger has-text-weight-bold",children:ee(e.surchargeInfo.surchargeAmount)}):(0,Jn.jsx)("span",{className:"has-text-grey",children:"-"})}),(0,Jn.jsx)("td",{className:"has-text-success",children:e.calculatedDiscountAmount>0?"-".concat(ee(e.calculatedDiscountAmount)):"-"}),(0,Jn.jsx)("td",{className:"has-text-weight-bold is-size-5",children:ee(e.calculatedTotal||e.totalbillamount)}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag ".concat("Unpaid"===e.paymentstatus?"is-danger":"Partial"===e.paymentstatus?"is-warning":"is-info"),children:e.paymentstatus})})]},e.billid)})}),(0,Jn.jsx)("tfoot",{children:(0,Jn.jsxs)("tr",{className:"has-background-light",children:[(0,Jn.jsx)("td",{className:"has-text-centered has-text-weight-bold",children:r.length}),(0,Jn.jsx)("td",{colSpan:"5",className:"has-text-right has-text-weight-bold",children:"Selected Bills:"}),(0,Jn.jsxs)("td",{className:"has-text-weight-bold",children:[(0,Jn.jsx)("div",{className:"heading",children:"Total Basic Amount"}),(0,Jn.jsx)("div",{className:"is-size-5",children:ee(a.filter(e=>r.includes(e.billid)).reduce((e,t)=>e+parseFloat(t.basicamount||0),0))})]}),(0,Jn.jsxs)("td",{className:"has-text-weight-bold",children:[(0,Jn.jsx)("div",{className:"heading",children:"Total Surcharge"}),(0,Jn.jsx)("div",{className:"is-size-5 has-text-danger",children:ee(a.filter(e=>r.includes(e.billid)).reduce((e,t)=>{var s;return e+parseFloat((null===(s=t.surchargeInfo)||void 0===s?void 0:s.surchargeAmount)||0)},0))})]}),(0,Jn.jsxs)("td",{className:"has-text-weight-bold",children:[(0,Jn.jsx)("div",{className:"heading",children:"Total Discount"}),(0,Jn.jsxs)("div",{className:"is-size-5 has-text-success",children:["-",ee(a.filter(e=>r.includes(e.billid)).reduce((e,t)=>e+parseFloat(t.calculatedDiscountAmount||0),0))]})]}),(0,Jn.jsxs)("td",{className:"has-text-weight-bold",children:[(0,Jn.jsx)("div",{className:"heading",children:"Grand Total"}),(0,Jn.jsx)("div",{className:"is-size-4 has-text-success",children:ee(a.filter(e=>r.includes(e.billid)).reduce((e,t)=>e+parseFloat(t.calculatedTotal||t.totalbillamount||0),0))})]}),(0,Jn.jsx)("td",{})]})})]})}),r.length>0&&(0,Jn.jsxs)("div",{className:"buttons is-right mt-3",children:[(0,Jn.jsxs)("button",{className:"button is-small is-light",onClick:()=>X([]),children:[(0,Jn.jsx)("span",{className:"icon is-small",children:(0,Jn.jsx)("i",{className:"fas fa-times"})}),(0,Jn.jsx)("span",{children:"Clear"})]}),(0,Jn.jsxs)("button",{className:"button is-success",onClick:()=>{const s=a.filter(e=>r.includes(e.billid)),n=s.reduce((e,t)=>e+parseFloat(t.calculatedTotal||t.totalbillamount||0),0),i=s.reduce((e,t)=>{var s;return e+parseFloat((null===(s=t.surchargeInfo)||void 0===s?void 0:s.surchargeAmount)||0)},0);D({bills:r,customerid:t.customerid,count:r.length,totalAmount:n,totalSurcharge:i,creditBalance:e.creditBalance||0}),U(""),I(!0)},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-check-circle"})}),(0,Jn.jsx)("span",{children:"Process Payment"})]})]})]})]}),(0,Jn.jsxs)("div",{style:{marginTop:"1.5rem"},children:[(0,Jn.jsxs)("h2",{className:"title is-5",children:[(0,Jn.jsx)("i",{className:"fas fa-history"})," Payment History",n.length>0&&(0,Jn.jsx)("span",{className:"tag is-info ml-2",children:n.length})]}),c?(0,Jn.jsx)("div",{className:"has-text-centered",style:{padding:"2rem"},children:(0,Jn.jsx)("button",{className:"button is-loading is-large is-ghost"})}):0===n.length?(0,Jn.jsxs)("div",{className:"notification is-light has-text-centered",children:[(0,Jn.jsx)("i",{className:"fas fa-history fa-2x has-text-grey-light"}),(0,Jn.jsx)("p",{className:"has-text-grey mt-2",children:"No payment history"})]}):(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"Bill ID"}),(0,Jn.jsx)("th",{children:"Billing Month"}),(0,Jn.jsx)("th",{children:"Previous"}),(0,Jn.jsx)("th",{children:"Current"}),(0,Jn.jsx)("th",{children:"Consumption"}),(0,Jn.jsx)("th",{children:"Amount Paid"}),(0,Jn.jsx)("th",{children:"Date Paid"}),(0,Jn.jsx)("th",{children:"Paid By"}),(0,Jn.jsx)("th",{children:"Status"}),(0,Jn.jsx)("th",{width:"120",children:"Actions"})]})}),(0,Jn.jsx)("tbody",{children:n.map(e=>{return(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{children:(0,Jn.jsx)("strong",{children:e.billid})}),(0,Jn.jsx)("td",{children:te(e.billedmonth)}),(0,Jn.jsx)("td",{children:e.previousreading||0}),(0,Jn.jsx)("td",{children:e.currentreading||0}),(0,Jn.jsx)("td",{children:(0,Jn.jsxs)("strong",{children:[e.consumption," cu.m"]})}),(0,Jn.jsx)("td",{className:"has-text-weight-bold",children:ee(e.totalbillamount)}),(0,Jn.jsx)("td",{children:(t=e.datepaid,t?new Date(t).toLocaleDateString("en-PH",{year:"numeric",month:"short",day:"numeric"}):"N/A")}),(0,Jn.jsx)("td",{children:e.paidby}),(0,Jn.jsx)("td",{children:(0,Jn.jsxs)("span",{className:"tag is-success",children:[(0,Jn.jsx)("i",{className:"fas fa-check"})," ",e.paymentstatus]})}),(0,Jn.jsx)("td",{children:(0,Jn.jsxs)("button",{className:"button is-warning is-small",onClick:()=>{W(e),z(!0)},title:"Mark as Unpaid",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-undo"})}),(0,Jn.jsx)("span",{children:"Unpaid"})]})})]},e.billid);var t})})]})})]})]})})(),(0,Jn.jsx)(ha,{isOpen:A&&null!==L,onClose:()=>{I(!1),D(null)},onConfirm:async function(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!L)return;d(!0);const a=s-t,r=J();if(!r)return h("Unable to find customer data"),void d(!1);const i=r.billsWithSurcharge.filter(e=>L.bills.includes(e.billid)).map(e=>{var s;const a=n?0:(null===(s=e.surchargeInfo)||void 0===s?void 0:s.surchargeAmount)||0,r=parseFloat(e.basicamount||0),i=e.calculatedDiscountAmount||0,l=r+a-i;return{billid:e.billid,basicamount:r,surchargeamount:a,discountamount:i,totalbillamount:l,advancepaymentamount:t>0?t/L.bills.length:0}}),l=await ra.processPayment(i,"".concat(q.firstname," ").concat(q.lastname),e,a);if(l.success){let e="Successfully processed payment for ".concat(l.data.paidCount," bill(s)!");t>0&&(e+=" Credit of \u20b1".concat(t.toFixed(2)," was applied.")),s>0&&(e+=" New credit of \u20b1".concat(s.toFixed(2)," added to account.")),f(e),await Z(L.customerid),H(),$(),setTimeout(()=>f(""),5e3)}else h(l.error);d(!1),I(!1),D(null)},billCount:(null===L||void 0===L?void 0:L.count)||0,grandTotal:(null===L||void 0===L?void 0:L.totalAmount)||0,totalSurcharge:(null===L||void 0===L?void 0:L.totalSurcharge)||0,creditBalance:(null===L||void 0===L?void 0:L.creditBalance)||0,loading:c}),(0,Jn.jsx)(da,{isOpen:F&&null!==M,onClose:()=>{z(!1),W(null)},onConfirm:async()=>{if(!M)return;d(!0);const e=await ra.markBillAsUnpaid(M.billid);e.success?(f("Bill #".concat(M.billid," marked as unpaid successfully!")),await Z(M.customerid),H(),$(),setTimeout(()=>f(""),3e3)):h(e.error),d(!1),z(!1),W(null)},title:"Mark Bill as Unpaid?",message:M?"Are you sure you want to mark Bill #".concat(M.billid," as unpaid?"):"",subMessage:"This will reverse the payment status. Use this only if the bill was accidentally marked as paid.",confirmText:"Mark as Unpaid",cancelText:"Cancel",type:"warning",loading:c})]})},fa={async getCustomersWithCredit(){try{const{data:e,error:t}=await Hn.from("customers").select("customerid, name, barangay, type, status, credit_balance").gt("credit_balance",0).order("credit_balance",{ascending:!1}).range(0,999999);if(t)throw t;return{success:!0,data:e||[]}}catch(e){return console.error("Error getting customers with credit:",e),{success:!1,error:e.message,data:[]}}},async getCreditStats(){try{const{data:e,error:t}=await Hn.from("customers").select("credit_balance").range(0,999999);if(t)throw t;const s=e.filter(e=>parseFloat(e.credit_balance||0)>0),n=e.reduce((e,t)=>e+parseFloat(t.credit_balance||0),0);return{success:!0,data:{totalCustomers:e.length,customersWithCredit:s.length,totalCreditAmount:n,averageCredit:s.length>0?n/s.length:0}}}catch(e){return console.error("Error getting credit stats:",e),{success:!1,error:e.message}}},async searchCustomers(e){try{let t=Hn.from("customers").select("customerid, name, barangay, type, status, credit_balance").range(0,999999);if(e){t=/^\d+$/.test(e)?t.or("name.ilike.%".concat(e,"%,customerid.eq.").concat(e)):t.ilike("name","%".concat(e,"%"))}t=t.order("name",{ascending:!0});const{data:s,error:n}=await t;if(n)throw n;return{success:!0,data:s||[]}}catch(t){return console.error("Error searching customers:",t),{success:!1,error:t.message,data:[]}}},async adjustCredit(e,t,s,n){try{const{data:a,error:r}=await Hn.from("customers").select("credit_balance, name").eq("customerid",e).single();if(r)throw r;const i=parseFloat(a.credit_balance||0);let l;if("add"===s)l=i+parseFloat(t);else{if("deduct"!==s)return{success:!1,error:"Invalid adjustment type"};if(l=i-parseFloat(t),l<0)return{success:!1,error:"Cannot deduct more than available credit balance"}}const{error:o}=await Hn.from("customers").update({credit_balance:l}).eq("customerid",e);if(o)throw o;return{success:!0,data:{customerid:e,customerName:a.name,previousBalance:i,adjustment:"add"===s?t:-t,newBalance:l,remarks:n}}}catch(a){return console.error("Error adjusting credit:",a),{success:!1,error:a.message}}},async getUnpaidBills(e){try{const{data:t,error:s}=await Hn.from("bills").select("*").eq("customerid",e).eq("paymentstatus","Unpaid").order("billedmonth",{ascending:!0}).range(0,999999);if(s)throw s;return{success:!0,data:t||[]}}catch(t){return console.error("Error getting unpaid bills:",t),{success:!1,error:t.message,data:[]}}},async applyCreditToBills(e,t,s,n){try{const{data:a,error:r}=await Hn.from("customers").select("credit_balance").eq("customerid",e).single();if(r)throw r;const i=parseFloat(a.credit_balance||0);if(s>i)return{success:!1,error:"Insufficient credit balance"};const l=t.map(e=>{let{billid:t,amount:s}=e;return Hn.from("bills").update({paymentstatus:"Paid",advancepaymentamount:s,paidby:n,datepaid:(new Date).toISOString()}).eq("billid",t)}),o=await Promise.all(l);if(o.some(e=>e.error))throw new Error("Some bills failed to update");const c=i-s;return await Hn.from("customers").update({credit_balance:c}).eq("customerid",e),{success:!0,data:{billsPaid:t.length,creditUsed:s,remainingCredit:c}}}catch(a){return console.error("Error applying credit to bills:",a),{success:!1,error:a.message}}}},pa=()=>{const[e,t]=(0,a.useState)("overview"),[s,n]=(0,a.useState)([]),[r,i]=(0,a.useState)({totalCustomers:0,customersWithCredit:0,totalCreditAmount:0,averageCredit:0}),[l,o]=(0,a.useState)(""),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(""),[m,f]=(0,a.useState)(""),[p,g]=(0,a.useState)(!1),[v,y]=(0,a.useState)(null),[x,b]=(0,a.useState)("add"),[j,w]=(0,a.useState)(""),[N,S]=(0,a.useState)(""),[k,C]=(0,a.useState)(!1),[_,E]=(0,a.useState)([]),[T,P]=(0,a.useState)([]),[O,R]=(0,a.useState)(!1),[A,I]=(0,a.useState)(null),L=$n.getUserSession();(0,a.useEffect)(()=>{D()},[]),(0,a.useEffect)(()=>{if(l.trim()){const e=setTimeout(()=>{B()},500);return()=>clearTimeout(e)}D()},[l]);const D=async()=>{d(!0);const[e,t]=await Promise.all([fa.getCustomersWithCredit(),fa.getCreditStats()]);e.success?n(e.data):h(e.error),t.success&&i(t.data),d(!1)},B=async()=>{d(!0);const e=await fa.searchCustomers(l);e.success?n(e.data):h(e.error),d(!1)},U=e=>"\u20b1".concat(parseFloat(e||0).toLocaleString("en-PH",{minimumFractionDigits:2}));return(0,Jn.jsxs)("div",{className:"credit-management-page",style:{padding:"0"},children:[(0,Jn.jsx)("div",{className:"level mb-3",children:(0,Jn.jsx)("div",{className:"level-left",children:(0,Jn.jsx)("div",{className:"level-item",children:(0,Jn.jsxs)("h1",{className:"title is-4 mb-0",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-piggy-bank"})}),"Credit Management"]})})})}),u&&(0,Jn.jsxs)("div",{className:"notification is-danger is-light py-3",children:[(0,Jn.jsx)("button",{className:"delete",onClick:()=>h("")}),u]}),m&&(0,Jn.jsxs)("div",{className:"notification is-success is-light py-3",children:[(0,Jn.jsx)("button",{className:"delete",onClick:()=>f("")}),m]}),(0,Jn.jsxs)("div",{className:"columns mb-3",children:[(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-info-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Total Customers"}),(0,Jn.jsx)("p",{className:"title is-4",children:r.totalCustomers.toLocaleString()})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-success-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Customers with Credit"}),(0,Jn.jsx)("p",{className:"title is-4",children:r.customersWithCredit.toLocaleString()})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-warning-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Total Credit Amount"}),(0,Jn.jsx)("p",{className:"title is-4",children:U(r.totalCreditAmount)})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-primary-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Average Credit"}),(0,Jn.jsx)("p",{className:"title is-4",children:U(r.averageCredit)})]})})]}),(0,Jn.jsx)("div",{className:"box",style:{marginBottom:"1rem",padding:"1.5rem"},children:(0,Jn.jsxs)("div",{className:"field has-addons",children:[(0,Jn.jsx)("div",{className:"control is-expanded",children:(0,Jn.jsx)("input",{className:"input",type:"text",placeholder:"Search customer by name or ID...",value:l,onChange:e=>o(e.target.value)})}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsxs)("button",{className:"button is-primary ".concat(c?"is-loading":""),onClick:B,children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-search"})}),(0,Jn.jsx)("span",{children:"Search"})]})})]})}),(0,Jn.jsx)("div",{className:"box",style:{padding:"0"},children:c&&0===s.length?(0,Jn.jsx)("div",{className:"has-text-centered",style:{padding:"3rem"},children:(0,Jn.jsx)("button",{className:"button is-loading is-large is-ghost"})}):0===s.length?(0,Jn.jsxs)("div",{className:"has-text-centered",style:{padding:"3rem"},children:[(0,Jn.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Jn.jsx)("i",{className:"fas fa-piggy-bank fa-3x"})}),(0,Jn.jsx)("p",{className:"has-text-grey mt-4",children:"No customers found"})]}):(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"Customer ID"}),(0,Jn.jsx)("th",{children:"Customer Name"}),(0,Jn.jsx)("th",{children:"Barangay"}),(0,Jn.jsx)("th",{children:"Type"}),(0,Jn.jsx)("th",{children:"Status"}),(0,Jn.jsx)("th",{children:"Credit Balance"}),(0,Jn.jsx)("th",{width:"200",children:"Actions"})]})}),(0,Jn.jsx)("tbody",{children:s.map(e=>(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{className:"has-text-weight-bold",children:e.customerid}),(0,Jn.jsx)("td",{children:e.name}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag is-light",children:e.barangay})}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag is-info is-light",children:e.type})}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag ".concat("Active"===e.status?"is-success":"is-warning"," is-light"),children:e.status})}),(0,Jn.jsx)("td",{className:"has-text-weight-bold has-text-success",children:U(e.credit_balance)}),(0,Jn.jsx)("td",{children:(0,Jn.jsxs)("div",{className:"buttons are-small",children:[(0,Jn.jsxs)("button",{className:"button is-info is-small",onClick:()=>(e=>{y(e),b("add"),w(""),S(""),g(!0)})(e),title:"Adjust Credit",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-edit"})}),(0,Jn.jsx)("span",{children:"Adjust"})]}),parseFloat(e.credit_balance||0)>0&&(0,Jn.jsxs)("button",{className:"button is-success is-small",onClick:()=>(async e=>{y(e),d(!0);const t=await fa.getUnpaidBills(e.customerid);t.success?(E(t.data),P([]),C(!0)):h(t.error),d(!1)})(e),title:"Apply Credit to Bills",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-check-circle"})}),(0,Jn.jsx)("span",{children:"Apply"})]})]})})]},e.customerid))})]})})}),p&&v&&(0,Jn.jsxs)("div",{className:"modal is-active",children:[(0,Jn.jsx)("div",{className:"modal-background",onClick:()=>g(!1)}),(0,Jn.jsxs)("div",{className:"modal-card",children:[(0,Jn.jsxs)("header",{className:"modal-card-head",children:[(0,Jn.jsxs)("p",{className:"modal-card-title",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-coins"})}),"Adjust Credit - ",v.name]}),(0,Jn.jsx)("button",{className:"delete",onClick:()=>g(!1)})]}),(0,Jn.jsxs)("section",{className:"modal-card-body",children:[(0,Jn.jsxs)("div",{className:"notification is-info is-light mb-3",children:[(0,Jn.jsx)("strong",{children:"Current Credit Balance:"})," ",U(v.credit_balance)]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Adjustment Type"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:x,onChange:e=>b(e.target.value),children:[(0,Jn.jsx)("option",{value:"add",children:"Add Credit"}),(0,Jn.jsx)("option",{value:"deduct",children:"Deduct Credit"})]})})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsxs)("label",{className:"label",children:["Amount ",(0,Jn.jsx)("span",{className:"has-text-danger",children:"*"})]}),(0,Jn.jsxs)("div",{className:"control has-icons-left",children:[(0,Jn.jsx)("input",{className:"input",type:"number",step:"0.01",placeholder:"Enter amount",value:j,onChange:e=>w(e.target.value)}),(0,Jn.jsx)("span",{className:"icon is-small is-left",children:(0,Jn.jsx)("i",{className:"fas fa-peso-sign"})})]})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Remarks"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("textarea",{className:"textarea",placeholder:"Enter remarks (optional)",value:N,onChange:e=>S(e.target.value),rows:"3"})})]}),j&&(0,Jn.jsxs)("div",{className:"notification ".concat("add"===x?"is-success":"is-warning"," is-light"),children:[(0,Jn.jsx)("strong",{children:"New Balance:"})," ",U(parseFloat(v.credit_balance||0)+("add"===x?1:-1)*parseFloat(j||0))]})]}),(0,Jn.jsxs)("footer",{className:"modal-card-foot",children:[(0,Jn.jsxs)("button",{className:"button is-success ".concat(c?"is-loading":""),onClick:async()=>{if(!v||!j)return void h("Please fill in all required fields");const e=parseFloat(j);if(isNaN(e)||e<=0)return void h("Please enter a valid amount");d(!0);const t=await fa.adjustCredit(v.customerid,e,x,N);t.success?(f("Credit ".concat("add"===x?"added":"deducted"," successfully!")),g(!1),D(),setTimeout(()=>f(""),3e3)):h(t.error),d(!1)},disabled:c,children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-check"})}),(0,Jn.jsx)("span",{children:"Confirm Adjustment"})]}),(0,Jn.jsx)("button",{className:"button",onClick:()=>g(!1),children:"Cancel"})]})]})]}),k&&v&&(0,Jn.jsxs)("div",{className:"modal is-active",children:[(0,Jn.jsx)("div",{className:"modal-background",onClick:()=>C(!1)}),(0,Jn.jsxs)("div",{className:"modal-card",style:{width:"900px"},children:[(0,Jn.jsxs)("header",{className:"modal-card-head",children:[(0,Jn.jsxs)("p",{className:"modal-card-title",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-money-check-alt"})}),"Apply Credit - ",v.name]}),(0,Jn.jsx)("button",{className:"delete",onClick:()=>C(!1)})]}),(0,Jn.jsxs)("section",{className:"modal-card-body",children:[(0,Jn.jsx)("div",{className:"notification is-info is-light mb-3",children:(0,Jn.jsxs)("div",{className:"columns is-mobile",children:[(0,Jn.jsxs)("div",{className:"column",children:[(0,Jn.jsx)("strong",{children:"Available Credit:"})," ",U(v.credit_balance)]}),(0,Jn.jsxs)("div",{className:"column",children:[(0,Jn.jsx)("strong",{children:"Selected Total:"})," ",U(T.reduce((e,t)=>e+t.amount,0))]})]})}),0===_.length?(0,Jn.jsxs)("div",{className:"has-text-centered",style:{padding:"2rem"},children:[(0,Jn.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Jn.jsx)("i",{className:"fas fa-check-circle fa-2x"})}),(0,Jn.jsx)("p",{className:"has-text-grey mt-3",children:"No unpaid bills found"})]}):(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable is-narrow",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{width:"50"}),(0,Jn.jsx)("th",{children:"Bill ID"}),(0,Jn.jsx)("th",{children:"Billed Month"}),(0,Jn.jsx)("th",{children:"Consumption"}),(0,Jn.jsx)("th",{children:"Amount"})]})}),(0,Jn.jsx)("tbody",{children:_.map(e=>{return(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{children:(0,Jn.jsx)("input",{type:"checkbox",checked:T.some(t=>t.billid===e.billid),onChange:()=>(e=>{const t=parseFloat(e.totalbillamount||0),s=T.findIndex(t=>t.billid===e.billid);P(s>=0?t=>t.filter(t=>t.billid!==e.billid):s=>[...s,{billid:e.billid,amount:t}])})(e)})}),(0,Jn.jsx)("td",{children:e.billid}),(0,Jn.jsx)("td",{children:(t=e.billedmonth,new Date(t).toLocaleDateString("en-PH",{year:"numeric",month:"long"}))}),(0,Jn.jsxs)("td",{children:[e.consumption," cu.m"]}),(0,Jn.jsx)("td",{className:"has-text-weight-bold",children:U(e.totalbillamount)})]},e.billid);var t})})]})})]}),(0,Jn.jsxs)("footer",{className:"modal-card-foot",children:[(0,Jn.jsxs)("button",{className:"button is-success ".concat(c?"is-loading":""),onClick:async()=>{if(0===T.length)return void h("Please select at least one bill");const e=T.reduce((e,t)=>e+parseFloat(t.amount),0);if(e>parseFloat(v.credit_balance||0))return void h("Total amount exceeds available credit");d(!0);const t=await fa.applyCreditToBills(v.customerid,T,e,"".concat(L.firstname," ").concat(L.lastname));t.success?(f("Credit applied to ".concat(t.data.billsPaid," bill(s) successfully!")),C(!1),D(),setTimeout(()=>f(""),3e3)):h(t.error),d(!1)},disabled:c||0===T.length,children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-check-circle"})}),(0,Jn.jsxs)("span",{children:["Apply Credit to ",T.length," Bill(s)"]})]}),(0,Jn.jsx)("button",{className:"button",onClick:()=>C(!1),children:"Cancel"})]})]})]})]})},ga={async getWaterUsageReport(e,t){try{const{data:s,error:n}=await Hn.from("bills").select("billedmonth, consumption, customerid, customername, barangay").gte("billedmonth",e).lte("billedmonth",t).order("billedmonth",{ascending:!0}).range(0,999999);if(n)throw n;const a=s.reduce((e,t)=>e+parseFloat(t.consumption||0),0),r=s.length>0?a/s.length:0,i={};s.forEach(e=>{const t=e.billedmonth;i[t]||(i[t]={month:t,consumption:0,count:0}),i[t].consumption+=parseFloat(e.consumption||0),i[t].count++});const l={};return s.forEach(e=>{const t=e.barangay||"Unknown";l[t]||(l[t]={barangay:t,consumption:0,count:0}),l[t].consumption+=parseFloat(e.consumption||0),l[t].count++}),{success:!0,data:{totalConsumption:a,averageConsumption:r,billCount:s.length,byMonth:Object.values(i),byBarangay:Object.values(l).sort((e,t)=>t.consumption-e.consumption),rawData:s}}}catch(s){return console.error("Error getting water usage report:",s),{success:!1,error:s.message}}},async getRevenueReport(e,t){try{const{data:s,error:n}=await Hn.from("bills").select("billedmonth, totalbillamount, paymentstatus, datepaid, basicamount, surchargeamount, discountamount, barangay").gte("billedmonth",e).lte("billedmonth",t).range(0,999999);if(n)throw n;const a=s.reduce((e,t)=>e+parseFloat(t.totalbillamount||0),0),r=s.filter(e=>"Paid"===e.paymentstatus).reduce((e,t)=>e+parseFloat(t.totalbillamount||0),0),i=s.filter(e=>"Unpaid"===e.paymentstatus).reduce((e,t)=>e+parseFloat(t.totalbillamount||0),0),l=s.reduce((e,t)=>e+parseFloat(t.surchargeamount||0),0),o=s.reduce((e,t)=>e+parseFloat(t.discountamount||0),0),c=s.filter(e=>"Paid"===e.paymentstatus).length,d=s.filter(e=>"Unpaid"===e.paymentstatus).length,u=s.length>0?c/s.length*100:0,h={};s.forEach(e=>{const t=e.billedmonth;h[t]||(h[t]={month:t,billed:0,paid:0,unpaid:0}),h[t].billed+=parseFloat(e.totalbillamount||0),"Paid"===e.paymentstatus?h[t].paid+=parseFloat(e.totalbillamount||0):h[t].unpaid+=parseFloat(e.totalbillamount||0)});const m={};return s.forEach(e=>{const t=e.barangay||"Unknown";m[t]||(m[t]={barangay:t,billed:0,paid:0,unpaid:0,billCount:0}),m[t].billed+=parseFloat(e.totalbillamount||0),m[t].billCount++,"Paid"===e.paymentstatus?m[t].paid+=parseFloat(e.totalbillamount||0):m[t].unpaid+=parseFloat(e.totalbillamount||0)}),{success:!0,data:{totalBilled:a,totalPaid:r,totalUnpaid:i,totalSurcharge:l,totalDiscount:o,paidCount:c,unpaidCount:d,collectionRate:u,byMonth:Object.values(h),byBarangay:Object.values(m).sort((e,t)=>t.billed-e.billed)}}}catch(s){return console.error("Error getting revenue report:",s),{success:!1,error:s.message}}},async getCollectionReport(e,t){try{const{data:s,error:n}=await Hn.from("bills").select("datepaid, totalbillamount, paidby, customername, barangay").eq("paymentstatus","Paid").gte("datepaid",e).lte("datepaid",t).order("datepaid",{ascending:!0}).range(0,999999);if(n)throw n;const a=s.reduce((e,t)=>e+parseFloat(t.totalbillamount||0),0),r={};s.forEach(e=>{const t=e.datepaid.split("T")[0];r[t]||(r[t]={date:t,amount:0,count:0}),r[t].amount+=parseFloat(e.totalbillamount||0),r[t].count++});const i={};return s.forEach(e=>{const t=e.paidby||"Unknown";i[t]||(i[t]={collector:t,amount:0,count:0}),i[t].amount+=parseFloat(e.totalbillamount||0),i[t].count++}),{success:!0,data:{totalCollected:a,collectionCount:s.length,byDate:Object.values(r),byCollector:Object.values(i).sort((e,t)=>t.amount-e.amount)}}}catch(s){return console.error("Error getting collection report:",s),{success:!1,error:s.message}}},async getTopConsumers(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{const{data:n,error:a}=await Hn.from("bills").select("customerid, customername, consumption, barangay").gte("billedmonth",e).lte("billedmonth",t).range(0,999999);if(a)throw a;const r={};n.forEach(e=>{const t=e.customerid;r[t]||(r[t]={customerid:t,customername:e.customername,barangay:e.barangay,totalConsumption:0,billCount:0}),r[t].totalConsumption+=parseFloat(e.consumption||0),r[t].billCount++});return{success:!0,data:Object.values(r).sort((e,t)=>t.totalConsumption-e.totalConsumption).slice(0,s)}}catch(n){return console.error("Error getting top consumers:",n),{success:!1,error:n.message}}}},va=()=>{const[e,t]=(0,a.useState)("water"),[s,n]=(0,a.useState)(""),[r,i]=(0,a.useState)(""),[l,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(""),[u,h]=(0,a.useState)(null),[m,f]=(0,a.useState)(null),[p,g]=(0,a.useState)(null),[v,y]=(0,a.useState)([]);(0,a.useEffect)(()=>{const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),s=new Date(e.getFullYear(),e.getMonth()+1,0);n(t.toISOString().split("T")[0]),i(s.toISOString().split("T")[0])},[]),(0,a.useEffect)(()=>{s&&r&&x()},[s,r]);const x=async()=>{o(!0),d("");try{const[e,t,n,a]=await Promise.all([ga.getWaterUsageReport(s,r),ga.getRevenueReport(s,r),ga.getCollectionReport(s,r),ga.getTopConsumers(s,r,10)]);e.success&&h(e.data),t.success&&f(t.data),n.success&&g(n.data),a.success&&y(a.data),e.success&&t.success&&n.success||d("Some reports failed to load")}catch(e){d("Failed to load reports")}o(!1)},b=e=>"\u20b1".concat(parseFloat(e||0).toLocaleString("en-PH",{minimumFractionDigits:2})),j=e=>parseFloat(e||0).toLocaleString("en-PH",{minimumFractionDigits:2}),w=e=>new Date(e).toLocaleDateString("en-PH",{year:"numeric",month:"long"}),N=(e,t)=>{const n=e.map(e=>Object.values(e).join(",")).join("\n"),a=new Blob([n],{type:"text/csv"}),i=window.URL.createObjectURL(a),l=document.createElement("a");l.href=i,l.download="".concat(t,"_").concat(s,"_").concat(r,".csv"),l.click(),window.URL.revokeObjectURL(i)};return(0,Jn.jsxs)("div",{className:"reports-page",style:{padding:"0"},children:[(0,Jn.jsxs)("div",{className:"level mb-3",children:[(0,Jn.jsx)("div",{className:"level-left",children:(0,Jn.jsx)("div",{className:"level-item",children:(0,Jn.jsxs)("h1",{className:"title is-4 mb-0",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-chart-bar"})}),"Reports & Analytics"]})})}),(0,Jn.jsx)("div",{className:"level-right",children:(0,Jn.jsx)("div",{className:"level-item",children:(0,Jn.jsxs)("button",{className:"button is-info",onClick:x,disabled:l,children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-sync"})}),(0,Jn.jsx)("span",{children:"Refresh"})]})})})]}),c&&(0,Jn.jsxs)("div",{className:"notification is-danger is-light py-3",children:[(0,Jn.jsx)("button",{className:"delete",onClick:()=>d("")}),c]}),(0,Jn.jsx)("div",{className:"box",style:{marginBottom:"1rem",padding:"1.5rem"},children:(0,Jn.jsxs)("div",{className:"columns",children:[(0,Jn.jsx)("div",{className:"column is-4",children:(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Start Date"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"date",value:s,onChange:e=>n(e.target.value)})})]})}),(0,Jn.jsx)("div",{className:"column is-4",children:(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"End Date"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"date",value:r,onChange:e=>i(e.target.value)})})]})}),(0,Jn.jsx)("div",{className:"column is-4",children:(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"\xa0"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsxs)("div",{className:"buttons",children:[(0,Jn.jsx)("button",{className:"button is-light is-small",onClick:()=>{const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),s=new Date(e.getFullYear(),e.getMonth()+1,0);n(t.toISOString().split("T")[0]),i(s.toISOString().split("T")[0])},children:"This Month"}),(0,Jn.jsx)("button",{className:"button is-light is-small",onClick:()=>{const e=new Date,t=new Date(e.getFullYear(),0,1),s=new Date(e.getFullYear(),11,31);n(t.toISOString().split("T")[0]),i(s.toISOString().split("T")[0])},children:"This Year"})]})})]})})]})}),(0,Jn.jsx)("div",{className:"tabs is-boxed",children:(0,Jn.jsxs)("ul",{children:[(0,Jn.jsx)("li",{className:"water"===e?"is-active":"",children:(0,Jn.jsxs)("a",{onClick:()=>t("water"),children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-tint"})}),(0,Jn.jsx)("span",{children:"Water Usage"})]})}),(0,Jn.jsx)("li",{className:"revenue"===e?"is-active":"",children:(0,Jn.jsxs)("a",{onClick:()=>t("revenue"),children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-dollar-sign"})}),(0,Jn.jsx)("span",{children:"Revenue"})]})}),(0,Jn.jsx)("li",{className:"collections"===e?"is-active":"",children:(0,Jn.jsxs)("a",{onClick:()=>t("collections"),children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-hand-holding-usd"})}),(0,Jn.jsx)("span",{children:"Collections"})]})})]})}),l?(0,Jn.jsxs)("div",{className:"has-text-centered",style:{padding:"3rem"},children:[(0,Jn.jsx)("button",{className:"button is-loading is-large is-ghost"}),(0,Jn.jsx)("p",{className:"has-text-grey mt-3",children:"Loading reports..."})]}):(0,Jn.jsxs)(Jn.Fragment,{children:["water"===e&&u&&(0,Jn.jsxs)("div",{children:[(0,Jn.jsxs)("div",{className:"columns mb-3",children:[(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-info-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Total Consumption"}),(0,Jn.jsxs)("p",{className:"title is-4",children:[j(u.totalConsumption)," cu.m"]})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-success-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Average Consumption"}),(0,Jn.jsxs)("p",{className:"title is-4",children:[j(u.averageConsumption)," cu.m"]})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-warning-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Total Bills"}),(0,Jn.jsx)("p",{className:"title is-4",children:u.billCount.toLocaleString()})]})})]}),(0,Jn.jsxs)("div",{className:"box",style:{marginBottom:"1rem"},children:[(0,Jn.jsxs)("div",{className:"level",children:[(0,Jn.jsx)("div",{className:"level-left",children:(0,Jn.jsx)("h2",{className:"title is-5 mb-3",children:"Monthly Consumption"})}),(0,Jn.jsx)("div",{className:"level-right",children:(0,Jn.jsxs)("button",{className:"button is-small is-info",onClick:()=>N(u.byMonth,"monthly_consumption"),children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-download"})}),(0,Jn.jsx)("span",{children:"Export"})]})})]}),(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"Month"}),(0,Jn.jsx)("th",{children:"Total Consumption"}),(0,Jn.jsx)("th",{children:"Bill Count"}),(0,Jn.jsx)("th",{children:"Average"})]})}),(0,Jn.jsx)("tbody",{children:u.byMonth.map(e=>(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{children:w(e.month)}),(0,Jn.jsxs)("td",{className:"has-text-weight-bold",children:[j(e.consumption)," cu.m"]}),(0,Jn.jsx)("td",{children:e.count.toLocaleString()}),(0,Jn.jsxs)("td",{children:[j(e.consumption/e.count)," cu.m"]})]},e.month))})]})})]}),(0,Jn.jsxs)("div",{className:"box",style:{marginBottom:"1rem"},children:[(0,Jn.jsx)("h2",{className:"title is-5 mb-3",children:"Consumption by Barangay"}),(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"Barangay"}),(0,Jn.jsx)("th",{children:"Total Consumption"}),(0,Jn.jsx)("th",{children:"Customer Count"}),(0,Jn.jsx)("th",{children:"Average per Customer"})]})}),(0,Jn.jsx)("tbody",{children:u.byBarangay.map(e=>(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{className:"has-text-weight-bold",children:e.barangay}),(0,Jn.jsxs)("td",{children:[j(e.consumption)," cu.m"]}),(0,Jn.jsx)("td",{children:e.count.toLocaleString()}),(0,Jn.jsxs)("td",{children:[j(e.consumption/e.count)," cu.m"]})]},e.barangay))})]})})]}),(0,Jn.jsxs)("div",{className:"box",children:[(0,Jn.jsx)("h2",{className:"title is-5 mb-3",children:"Top 10 Consumers"}),(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"#"}),(0,Jn.jsx)("th",{children:"Customer ID"}),(0,Jn.jsx)("th",{children:"Customer Name"}),(0,Jn.jsx)("th",{children:"Barangay"}),(0,Jn.jsx)("th",{children:"Total Consumption"}),(0,Jn.jsx)("th",{children:"Average per Bill"})]})}),(0,Jn.jsx)("tbody",{children:v.map((e,t)=>(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{className:"has-text-weight-bold",children:t+1}),(0,Jn.jsx)("td",{children:e.customerid}),(0,Jn.jsx)("td",{children:e.customername}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag is-light",children:e.barangay})}),(0,Jn.jsxs)("td",{className:"has-text-weight-bold has-text-danger",children:[j(e.totalConsumption)," cu.m"]}),(0,Jn.jsxs)("td",{children:[j(e.totalConsumption/e.billCount)," cu.m"]})]},e.customerid))})]})})]})]}),"revenue"===e&&m&&(0,Jn.jsxs)("div",{children:[(0,Jn.jsxs)("div",{className:"columns mb-3",children:[(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-info-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Total Billed"}),(0,Jn.jsx)("p",{className:"title is-4",children:b(m.totalBilled)})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-success-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Total Paid"}),(0,Jn.jsx)("p",{className:"title is-4",children:b(m.totalPaid)})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-danger-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Total Unpaid"}),(0,Jn.jsx)("p",{className:"title is-4",children:b(m.totalUnpaid)})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-primary-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Collection Rate"}),(0,Jn.jsxs)("p",{className:"title is-4",children:[m.collectionRate.toFixed(1),"%"]})]})})]}),(0,Jn.jsxs)("div",{className:"columns mb-3",children:[(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-warning-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Total Surcharges"}),(0,Jn.jsx)("p",{className:"title is-5",children:b(m.totalSurcharge)})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-success-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Total Discounts"}),(0,Jn.jsx)("p",{className:"title is-5",children:b(m.totalDiscount)})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-info-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Paid Bills"}),(0,Jn.jsx)("p",{className:"title is-5",children:m.paidCount.toLocaleString()})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-danger-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Unpaid Bills"}),(0,Jn.jsx)("p",{className:"title is-5",children:m.unpaidCount.toLocaleString()})]})})]}),(0,Jn.jsxs)("div",{className:"box",style:{marginBottom:"1rem"},children:[(0,Jn.jsxs)("div",{className:"level",children:[(0,Jn.jsx)("div",{className:"level-left",children:(0,Jn.jsx)("h2",{className:"title is-5 mb-3",children:"Monthly Revenue"})}),(0,Jn.jsx)("div",{className:"level-right",children:(0,Jn.jsxs)("button",{className:"button is-small is-info",onClick:()=>N(m.byMonth,"monthly_revenue"),children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-download"})}),(0,Jn.jsx)("span",{children:"Export"})]})})]}),(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"Month"}),(0,Jn.jsx)("th",{children:"Billed Amount"}),(0,Jn.jsx)("th",{children:"Paid Amount"}),(0,Jn.jsx)("th",{children:"Unpaid Amount"}),(0,Jn.jsx)("th",{children:"Collection %"})]})}),(0,Jn.jsx)("tbody",{children:m.byMonth.map(e=>(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{children:w(e.month)}),(0,Jn.jsx)("td",{children:b(e.billed)}),(0,Jn.jsx)("td",{className:"has-text-success has-text-weight-bold",children:b(e.paid)}),(0,Jn.jsx)("td",{className:"has-text-danger has-text-weight-bold",children:b(e.unpaid)}),(0,Jn.jsxs)("td",{children:[e.billed>0?(e.paid/e.billed*100).toFixed(1):0,"%"]})]},e.month))})]})})]}),(0,Jn.jsxs)("div",{className:"box",children:[(0,Jn.jsx)("h2",{className:"title is-5 mb-3",children:"Revenue by Barangay"}),(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"Barangay"}),(0,Jn.jsx)("th",{children:"Bills"}),(0,Jn.jsx)("th",{children:"Billed Amount"}),(0,Jn.jsx)("th",{children:"Paid Amount"}),(0,Jn.jsx)("th",{children:"Unpaid Amount"}),(0,Jn.jsx)("th",{children:"Collection %"})]})}),(0,Jn.jsx)("tbody",{children:m.byBarangay.map(e=>(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{className:"has-text-weight-bold",children:e.barangay}),(0,Jn.jsx)("td",{children:e.billCount.toLocaleString()}),(0,Jn.jsx)("td",{children:b(e.billed)}),(0,Jn.jsx)("td",{className:"has-text-success",children:b(e.paid)}),(0,Jn.jsx)("td",{className:"has-text-danger",children:b(e.unpaid)}),(0,Jn.jsxs)("td",{children:[e.billed>0?(e.paid/e.billed*100).toFixed(1):0,"%"]})]},e.barangay))})]})})]})]}),"collections"===e&&p&&(0,Jn.jsxs)("div",{children:[(0,Jn.jsxs)("div",{className:"columns mb-3",children:[(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-success-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Total Collected"}),(0,Jn.jsx)("p",{className:"title is-4",children:b(p.totalCollected)})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-info-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Collection Count"}),(0,Jn.jsx)("p",{className:"title is-4",children:p.collectionCount.toLocaleString()})]})}),(0,Jn.jsx)("div",{className:"column",children:(0,Jn.jsxs)("div",{className:"box has-background-primary-light",children:[(0,Jn.jsx)("p",{className:"heading",children:"Average per Collection"}),(0,Jn.jsx)("p",{className:"title is-4",children:b(p.totalCollected/p.collectionCount)})]})})]}),(0,Jn.jsxs)("div",{className:"box",style:{marginBottom:"1rem"},children:[(0,Jn.jsxs)("div",{className:"level",children:[(0,Jn.jsx)("div",{className:"level-left",children:(0,Jn.jsx)("h2",{className:"title is-5 mb-3",children:"Daily Collections"})}),(0,Jn.jsx)("div",{className:"level-right",children:(0,Jn.jsxs)("button",{className:"button is-small is-info",onClick:()=>N(p.byDate,"daily_collections"),children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-download"})}),(0,Jn.jsx)("span",{children:"Export"})]})})]}),(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"Date"}),(0,Jn.jsx)("th",{children:"Amount Collected"}),(0,Jn.jsx)("th",{children:"Collection Count"}),(0,Jn.jsx)("th",{children:"Average"})]})}),(0,Jn.jsx)("tbody",{children:p.byDate.map(e=>(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{children:new Date(e.date).toLocaleDateString("en-PH")}),(0,Jn.jsx)("td",{className:"has-text-weight-bold has-text-success",children:b(e.amount)}),(0,Jn.jsx)("td",{children:e.count.toLocaleString()}),(0,Jn.jsx)("td",{children:b(e.amount/e.count)})]},e.date))})]})})]}),(0,Jn.jsxs)("div",{className:"box",children:[(0,Jn.jsx)("h2",{className:"title is-5 mb-3",children:"Collections by Collector"}),(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"Collector"}),(0,Jn.jsx)("th",{children:"Amount Collected"}),(0,Jn.jsx)("th",{children:"Collection Count"}),(0,Jn.jsx)("th",{children:"Average per Collection"})]})}),(0,Jn.jsx)("tbody",{children:p.byCollector.map(e=>(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{className:"has-text-weight-bold",children:e.collector}),(0,Jn.jsx)("td",{className:"has-text-success has-text-weight-bold",children:b(e.amount)}),(0,Jn.jsx)("td",{children:e.count.toLocaleString()}),(0,Jn.jsx)("td",{children:b(e.amount/e.count)})]},e.collector))})]})})]})]})]})]})},ya={async getAllUsers(){try{const{data:e,error:t}=await Hn.from("users").select("*").order("firstname",{ascending:!0}).limit(1e4);if(t)throw t;return{success:!0,data:e||[]}}catch(e){return console.error("Error getting users:",e),{success:!1,error:e.message,data:[]}}},async searchUsers(e){try{const{data:t,error:s}=await Hn.from("users").select("*").or("firstname.ilike.%".concat(e,"%,lastname.ilike.%").concat(e,"%")).order("firstname",{ascending:!0}).limit(1e4);if(s)throw s;return{success:!0,data:t||[]}}catch(t){return console.error("Error searching users:",t),{success:!1,error:t.message,data:[]}}},async addUser(e){try{const t={userid:crypto.randomUUID(),firstname:e.firstname,lastname:e.lastname,email:e.email,password:"admin",department:e.department,position:e.position,role:e.role,status:e.status||"Active"},{data:s,error:n}=await Hn.from("users").insert([t]).select();if(n)throw n;return{success:!0,data:s[0]}}catch(t){return console.error("Error adding user:",t),{success:!1,error:t.message}}},async updateUser(e,t){try{const s={firstname:t.firstname,lastname:t.lastname,department:t.department,position:t.position,role:t.role,status:t.status},{data:n,error:a}=await Hn.from("users").update(s).eq("userid",e).select();if(a)throw a;return{success:!0,data:n[0]}}catch(s){return console.error("Error updating user:",s),{success:!1,error:s.message}}},async deleteUser(e){try{const{error:t}=await Hn.from("users").delete().eq("userid",e);if(t)throw t;return{success:!0}}catch(t){return console.error("Error deleting user:",t),{success:!1,error:t.message}}},async getUserById(e){try{const{data:t,error:s}=await Hn.from("users").select("*").eq("userid",e).single();if(s)throw s;return{success:!0,data:t}}catch(t){return console.error("Error getting user:",t),{success:!1,error:t.message}}}},xa=()=>{const[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)([]),[r,i]=(0,a.useState)(""),[l,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(""),[u,h]=(0,a.useState)(""),[m,f]=(0,a.useState)(!1),[p,g]=(0,a.useState)("add"),[v,y]=(0,a.useState)(null),[x,b]=(0,a.useState)({firstname:"",lastname:"",email:"",department:"",position:"",role:"Reader",status:"Active"}),[j,w]=(0,a.useState)(!1),[N,S]=(0,a.useState)(null);(0,a.useEffect)(()=>{k()},[]),(0,a.useEffect)(()=>{C()},[r,e]);const k=async()=>{o(!0);const e=await ya.getAllUsers();e.success?(t(e.data),n(e.data)):d(e.error),o(!1)},C=()=>{if(!r.trim())return void n(e);const t=e.filter(e=>"".concat(e.firstname," ").concat(e.lastname).toLowerCase().includes(r.toLowerCase())||e.firstname.toLowerCase().includes(r.toLowerCase())||e.lastname.toLowerCase().includes(r.toLowerCase()));n(t)},_=async()=>{if(!r.trim())return void n(e);o(!0);const t=await ya.searchUsers(r);t.success?n(t.data):d(t.error),o(!1)},E=()=>{f(!1),y(null),b({firstname:"",lastname:"",email:"",department:"",position:"",role:"Reader",status:"Active"})},T=(e,t)=>{b(s=>ta(ta({},s),{},{[e]:t}))},P=()=>{S(null),w(!1)},O=e=>{switch(e){case"Admin":return"is-danger";case"Manager":return"is-warning";case"Collector":return"is-info";default:return"is-light"}};return(0,Jn.jsxs)("div",{className:"users-page",style:{padding:"0"},children:[(0,Jn.jsxs)("div",{className:"level mb-3",children:[(0,Jn.jsx)("div",{className:"level-left",children:(0,Jn.jsx)("div",{className:"level-item",children:(0,Jn.jsxs)("h1",{className:"title is-4 mb-0",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-users"})}),"User Management"]})})}),(0,Jn.jsx)("div",{className:"level-right",children:(0,Jn.jsx)("div",{className:"level-item",children:(0,Jn.jsxs)("button",{className:"button is-primary",onClick:()=>{g("add"),y(null),b({firstname:"",lastname:"",email:"",department:"",position:"",role:"Reader",status:"Active"}),f(!0)},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-user-plus"})}),(0,Jn.jsx)("span",{children:"Add User"})]})})})]}),c&&(0,Jn.jsxs)("div",{className:"notification is-danger is-light py-3",children:[(0,Jn.jsx)("button",{className:"delete",onClick:()=>d("")}),c]}),u&&(0,Jn.jsxs)("div",{className:"notification is-success is-light py-3",children:[(0,Jn.jsx)("button",{className:"delete",onClick:()=>h("")}),u]}),(0,Jn.jsx)("div",{className:"box",style:{marginBottom:"1rem",padding:"1.5rem"},children:(0,Jn.jsxs)("div",{className:"field has-addons",children:[(0,Jn.jsx)("div",{className:"control is-expanded",children:(0,Jn.jsx)("input",{className:"input",type:"text",placeholder:"Search by first name or last name...",value:r,onChange:e=>i(e.target.value),onKeyPress:e=>"Enter"===e.key&&_()})}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsxs)("button",{className:"button is-primary ".concat(l?"is-loading":""),onClick:_,children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-search"})}),(0,Jn.jsx)("span",{children:"Search"})]})})]})}),(0,Jn.jsx)("div",{className:"box",style:{padding:"0"},children:l&&0===s.length?(0,Jn.jsx)("div",{className:"has-text-centered",style:{padding:"3rem"},children:(0,Jn.jsx)("button",{className:"button is-loading is-large is-ghost"})}):0===s.length?(0,Jn.jsxs)("div",{className:"has-text-centered",style:{padding:"3rem"},children:[(0,Jn.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Jn.jsx)("i",{className:"fas fa-users fa-3x"})}),(0,Jn.jsx)("p",{className:"has-text-grey mt-4",children:"No users found"})]}):(0,Jn.jsx)("div",{className:"table-container",children:(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"Name"}),(0,Jn.jsx)("th",{children:"Email"}),(0,Jn.jsx)("th",{children:"Role"}),(0,Jn.jsx)("th",{children:"Department"}),(0,Jn.jsx)("th",{children:"Position"}),(0,Jn.jsx)("th",{children:"Status"}),(0,Jn.jsx)("th",{width:"150",children:"Actions"})]})}),(0,Jn.jsx)("tbody",{children:s.map(e=>{return(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{children:(0,Jn.jsxs)("strong",{children:[e.firstname," ",e.lastname]})}),(0,Jn.jsx)("td",{children:e.email}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag ".concat(O(e.role)),children:e.role})}),(0,Jn.jsx)("td",{children:e.department||"-"}),(0,Jn.jsx)("td",{children:e.position||"-"}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag ".concat((t=e.status,"Active"===t?"is-success":"is-danger")),children:e.status})}),(0,Jn.jsx)("td",{children:(0,Jn.jsxs)("div",{className:"buttons are-small",children:[(0,Jn.jsx)("button",{className:"button is-info is-small",onClick:()=>(e=>{g("edit"),y(e),b({firstname:e.firstname,lastname:e.lastname,email:e.email,department:e.department||"",position:e.position||"",role:e.role,status:e.status}),f(!0)})(e),title:"Edit User",children:(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-edit"})})}),(0,Jn.jsx)("button",{className:"button is-danger is-small",onClick:()=>(e=>{S(e),w(!0)})(e),title:"Delete User",children:(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-trash"})})})]})})]},e.userid);var t})})]})})}),m&&(0,Jn.jsxs)("div",{className:"modal is-active",children:[(0,Jn.jsx)("div",{className:"modal-background",onClick:E}),(0,Jn.jsxs)("div",{className:"modal-card",style:{width:"600px"},children:[(0,Jn.jsxs)("header",{className:"modal-card-head",children:[(0,Jn.jsxs)("p",{className:"modal-card-title",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-user-".concat("add"===p?"plus":"edit")})}),"add"===p?"Add New User":"Edit User"]}),(0,Jn.jsx)("button",{className:"delete","aria-label":"close",onClick:E})]}),(0,Jn.jsxs)("section",{className:"modal-card-body",children:[(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsxs)("label",{className:"label",children:["First Name ",(0,Jn.jsx)("span",{className:"has-text-danger",children:"*"})]}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",placeholder:"Enter first name",value:x.firstname,onChange:e=>T("firstname",e.target.value)})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsxs)("label",{className:"label",children:["Last Name ",(0,Jn.jsx)("span",{className:"has-text-danger",children:"*"})]}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",placeholder:"Enter last name",value:x.lastname,onChange:e=>T("lastname",e.target.value)})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsxs)("label",{className:"label",children:["Email ",(0,Jn.jsx)("span",{className:"has-text-danger",children:"*"})]}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"email",placeholder:"Enter email",value:x.email,onChange:e=>T("email",e.target.value),disabled:"edit"===p})}),"edit"===p&&(0,Jn.jsx)("p",{className:"help",children:"Email cannot be edited"})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Department"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",placeholder:"Enter department",value:x.department,onChange:e=>T("department",e.target.value)})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Position"}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"text",placeholder:"Enter position",value:x.position,onChange:e=>T("position",e.target.value)})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsxs)("label",{className:"label",children:["Role ",(0,Jn.jsx)("span",{className:"has-text-danger",children:"*"})]}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:x.role,onChange:e=>T("role",e.target.value),children:[(0,Jn.jsx)("option",{value:"Admin",children:"Admin"}),(0,Jn.jsx)("option",{value:"Manager",children:"Manager"}),(0,Jn.jsx)("option",{value:"Collector",children:"Collector"}),(0,Jn.jsx)("option",{value:"Reader",children:"Reader"})]})})})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsxs)("label",{className:"label",children:["Status ",(0,Jn.jsx)("span",{className:"has-text-danger",children:"*"})]}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:x.status,onChange:e=>T("status",e.target.value),children:[(0,Jn.jsx)("option",{value:"Active",children:"Active"}),(0,Jn.jsx)("option",{value:"Inactive",children:"Inactive"})]})})})]}),"add"===p&&(0,Jn.jsx)("div",{className:"notification is-info is-light",children:(0,Jn.jsxs)("p",{className:"is-size-7",children:[(0,Jn.jsx)("strong",{children:"Note:"})," Default password will be set to ",(0,Jn.jsx)("strong",{children:'"admin"'})]})})]}),(0,Jn.jsxs)("footer",{className:"modal-card-foot",children:[(0,Jn.jsxs)("button",{className:"button is-success ".concat(l?"is-loading":""),onClick:async()=>{if(!x.firstname.trim()||!x.lastname.trim()||!x.email.trim())return void d("Please fill in all required fields (First Name, Last Name, Email)");let e;o(!0),d(""),e="add"===p?await ya.addUser(x):await ya.updateUser(v.userid,x),e.success?(h("User ".concat("add"===p?"added":"updated"," successfully!")),E(),k(),setTimeout(()=>h(""),3e3)):d(e.error),o(!1)},disabled:l,children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-save"})}),(0,Jn.jsx)("span",{children:"add"===p?"Add User":"Save Changes"})]}),(0,Jn.jsx)("button",{className:"button",onClick:E,children:"Cancel"})]})]})]}),(0,Jn.jsx)(da,{isOpen:j&&null!==N,onClose:P,onConfirm:async()=>{if(!N)return;o(!0);const e=await ya.deleteUser(N.userid);e.success?(h("User deleted successfully!"),P(),k(),setTimeout(()=>h(""),3e3)):d(e.error),o(!1)},title:"Confirm Delete",message:N?"Are you sure you want to delete user ".concat(N.firstname," ").concat(N.lastname,"?"):"",subMessage:"This action cannot be undone.",confirmText:"Delete User",cancelText:"Cancel",type:"danger",loading:l})]})},ba=()=>{const[e,t]=(0,a.useState)("rpt-calculator"),[s,n]=(0,a.useState)(""),[r,i]=(0,a.useState)([]),[l,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(""),[u,h]=(0,a.useState)("all"),[m,f]=(0,a.useState)("all"),[p,g]=(0,a.useState)("all"),[v,y]=(0,a.useState)([]),[x,b]=(0,a.useState)([]),[j,w]=(0,a.useState)([]),[N,S]=(0,a.useState)(!1),[k,C]=(0,a.useState)(""),[_,E]=(0,a.useState)("all"),[T,P]=(0,a.useState)("all"),[O,R]=(0,a.useState)("all"),[A,I]=(0,a.useState)(null),[L,D]=(0,a.useState)(null),[B,U]=(0,a.useState)(!1),[F,z]=(0,a.useState)(""),[M,W]=(0,a.useState)("200");(0,a.useEffect)(()=>{const e=new Date,t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0");n("".concat(t,"-").concat(s))},[]),(0,a.useEffect)(()=>{"generate-reading-sheets"!==e&&"generate-notice"!==e||V()},[e]),(0,a.useEffect)(()=>{"generate-notice"===e&&(q(),H())},[e]),(0,a.useEffect)(()=>{"generate-notice"===e&&A&&$()},[A,e]);const q=async()=>{const e=await ra.getSurchargeSettings();e.success&&I(e.data)},H=async()=>{try{const{data:e,error:t}=await Hn.from("users").select("firstname, lastname, position, status").ilike("position","%Municipal Treasurer%").limit(10);if(t)return void console.error("Error loading Municipal Treasurer:",t);if(e&&e.length>0){const t=e.find(e=>{var t;return"active"===(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())})||e[0];D(t),console.log("Municipal Treasurer loaded:",t)}else console.log("No Municipal Treasurer found in users table")}catch(e){console.error("Error loading Municipal Treasurer:",e)}};(0,a.useEffect)(()=>{"generate-reading-sheets"===e&&s&&K()},[s,e]);const V=async()=>{try{const[e,t]=await Promise.all([sa.getBarangays(),sa.getCustomerTypes()]);e.success&&y(e.data||[]),t.success&&b(t.data||[])}catch(e){console.error("Error loading filter options:",e)}},K=async()=>{if(s){o(!0);try{const e=await aa.getBillsByMonth(s);e.success&&i(e.data||[])}catch(e){console.error("Error loading reading data:",e)}o(!1)}},$=async()=>{S(!0);try{const e=await aa.getCustomersWithUnpaidBills();if(e.success&&A){const t=(e.data||[]).map(e=>{const t=e.unpaidBills||[];let s=0,n=0;return t.forEach(e=>{const t=parseFloat(e.basicamount||0);s+=t;const a=ra.calculateSurcharge(e,A);n+=a.surchargeAmount}),ta(ta({},e),{},{totalBasicAmount:s,totalSurcharge:n,totalBilledAmount:s+n})});w(t)}else e.success&&w(e.data||[])}catch(e){console.error("Error loading customers with unpaid bills:",e)}S(!1)},J=()=>{H(),$()},G=r.filter(e=>{var t,s,n,a;const r=!c||(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(c.toLowerCase()))||String(e.customerid).includes(c),i="all"===u||(null===(s=e.barangay)||void 0===s?void 0:s.toLowerCase())===u.toLowerCase(),l="all"===m||(null===(n=e.type)||void 0===n?void 0:n.toLowerCase())===m.toLowerCase(),o="all"===p||(null===(a=e.status)||void 0===a?void 0:a.toLowerCase())===p.toLowerCase();return r&&i&&l&&o}),Q=j.filter(e=>{var t,s,n,a,r;const i=!k||(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(k.toLowerCase()))||String(e.customerid).includes(k)||(null===(s=e.barangay)||void 0===s?void 0:s.toLowerCase().includes(k.toLowerCase())),l="all"===_||(null===(n=e.barangay)||void 0===n?void 0:n.toLowerCase())===_.toLowerCase(),o="all"===T||(null===(a=e.type)||void 0===a?void 0:a.toLowerCase())===T.toLowerCase(),c="all"===O||(null===(r=e.status)||void 0===r?void 0:r.toLowerCase())===O.toLowerCase();return i&&l&&o&&c}),Y=()=>{0!==Q.length?U(!0):alert("No customers to generate notices for.")},X=e=>{const t=e=>{if(!e)return"";let t;if(e.includes("-")){t=2===e.split("-").length?new Date(e+"-01"):new Date(e)}else t=new Date(e);return isNaN(t.getTime())?e:t.toLocaleDateString("en-US",{month:"long",year:"numeric"})};if(e&&e.includes(" to ")){const[s,n]=e.split(" to ");return"".concat(t(s.trim())," to ").concat(t(n.trim()))}return t(e)},Z=()=>{const e=[["Customer ID","Name","Type","Barangay","Status","Previous Reading","Current Reading","Consumption","Billed Month"].join(","),...G.map(e=>[e.customerid,'"'.concat(e.name||"",'"'),'"'.concat(e.type||"",'"'),'"'.concat(e.barangay||"",'"'),'"'.concat(e.status||"",'"'),e.previousreading||0,e.currentreading||0,e.consumption||0,e.billedmonth||""].join(","))].join("\n"),t=new Blob([e],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),a=URL.createObjectURL(t);n.setAttribute("href",a),n.setAttribute("download","reading_sheets_".concat(s,".csv")),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)};return(0,Jn.jsxs)("div",{children:[(0,Jn.jsx)("div",{className:"level",children:(0,Jn.jsx)("div",{className:"level-left",children:(0,Jn.jsx)("div",{className:"level-item",children:(0,Jn.jsx)("h1",{className:"title",children:"System Tools & Utilities"})})})}),(0,Jn.jsx)("div",{className:"tabs is-boxed",children:(0,Jn.jsx)("ul",{children:[{id:"rpt-calculator",name:"RPT Calculator",icon:"fas fa-calculator"},{id:"generate-notice",name:"Generate Notice",icon:"fas fa-file-invoice"},{id:"generate-reading-sheets",name:"Generate Reading Sheets",icon:"fas fa-file-alt"}].map(s=>(0,Jn.jsx)("li",{className:e===s.id?"is-active":"",children:(0,Jn.jsxs)("a",{onClick:()=>t(s.id),children:[(0,Jn.jsx)("span",{className:"icon is-small",children:(0,Jn.jsx)("i",{className:s.icon})}),(0,Jn.jsx)("span",{children:s.name})]})},s.id))})}),(()=>{switch(e){case"rpt-calculator":return(0,Jn.jsx)("div",{className:"card",children:(0,Jn.jsx)("div",{className:"card-content",children:(0,Jn.jsx)("div",{className:"iframe-container",children:(0,Jn.jsx)("iframe",{src:"https://script.google.com/macros/s/AKfycbzdhU6lDW5kd9w28hE3inteCV1zdz_VLUOOD_RAWwUlyIyNCTsoMfklGIbOKsf5TX96qg/exec",title:"RPT Calculator",className:"responsive-iframe",frameBorder:"0",allowFullScreen:!0})})})});case"generate-notice":return(0,Jn.jsxs)("div",{className:"customers-page",children:[(0,Jn.jsx)("div",{className:"compact-header",children:(0,Jn.jsxs)("div",{className:"header-row",children:[(0,Jn.jsxs)("div",{className:"title-section",children:[(0,Jn.jsx)("h1",{className:"page-title",children:"Generate Notice"}),(0,Jn.jsxs)("div",{className:"stats-inline",children:[(0,Jn.jsxs)("span",{className:"stat-item",children:[(0,Jn.jsx)("i",{className:"fas fa-users"}),(0,Jn.jsx)("strong",{children:Q.length})," Customers"]}),(0,Jn.jsxs)("span",{className:"stat-item",children:[(0,Jn.jsx)("i",{className:"fas fa-exclamation-circle"}),(0,Jn.jsx)("strong",{children:Q.reduce((e,t)=>e+t.billCount,0)})," Unpaid Bills"]})]})]}),(0,Jn.jsxs)("div",{className:"header-actions",children:[(0,Jn.jsxs)("button",{className:"button is-danger",onClick:Y,disabled:N||0===Q.length,title:"Generate disconnection notices for filtered customers",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-print"})}),(0,Jn.jsx)("span",{children:"Generate Notices"})]}),(0,Jn.jsxs)("button",{className:"button is-info",onClick:J,disabled:N,children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-sync-alt"})}),(0,Jn.jsx)("span",{children:"Refresh"})]})]})]})}),(0,Jn.jsx)("div",{className:"compact-filters",children:(0,Jn.jsxs)("div",{className:"filter-row",style:{display:"flex",gap:"0.75rem",flexWrap:"nowrap"},children:[(0,Jn.jsx)("div",{style:{flex:"1",minWidth:"200px"},children:(0,Jn.jsxs)("div",{className:"control has-icons-left",children:[(0,Jn.jsx)("input",{className:"input",type:"text",placeholder:"Search customer...",value:k,onChange:e=>C(e.target.value)}),(0,Jn.jsx)("span",{className:"icon is-left",children:(0,Jn.jsx)("i",{className:"fas fa-search"})})]})}),(0,Jn.jsx)("div",{className:"select",style:{minWidth:"150px"},children:(0,Jn.jsxs)("select",{value:_,onChange:e=>E(e.target.value),children:[(0,Jn.jsx)("option",{value:"all",children:"All Barangays"}),v.map(e=>(0,Jn.jsx)("option",{value:e.barangay,children:e.barangay},e.barangay))]})}),(0,Jn.jsx)("div",{className:"select",style:{minWidth:"150px"},children:(0,Jn.jsxs)("select",{value:T,onChange:e=>P(e.target.value),children:[(0,Jn.jsx)("option",{value:"all",children:"All Types"}),x.map(e=>(0,Jn.jsx)("option",{value:e.type,children:e.type},e.type))]})}),(0,Jn.jsx)("div",{className:"select",style:{minWidth:"130px"},children:(0,Jn.jsxs)("select",{value:O,onChange:e=>R(e.target.value),children:[(0,Jn.jsx)("option",{value:"all",children:"All Status"}),(0,Jn.jsx)("option",{value:"Active",children:"Active"}),(0,Jn.jsx)("option",{value:"Inactive",children:"Inactive"}),(0,Jn.jsx)("option",{value:"Disconnected",children:"Disconnected"})]})})]})}),(0,Jn.jsx)("div",{className:"table-container",children:N?(0,Jn.jsxs)("div",{className:"has-text-centered",style:{padding:"3rem"},children:[(0,Jn.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Jn.jsx)("i",{className:"fas fa-spinner fa-pulse fa-3x"})}),(0,Jn.jsx)("p",{className:"subtitle has-text-grey mt-4",children:"Loading customers with unpaid bills..."})]}):0===Q.length?(0,Jn.jsxs)("div",{className:"has-text-centered",style:{padding:"3rem"},children:[(0,Jn.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Jn.jsx)("i",{className:"fas fa-check-circle fa-3x"})}),(0,Jn.jsx)("p",{className:"subtitle has-text-grey mt-4",children:0===j.length?"No customers with unpaid bills found!":"No customers match your search criteria"})]}):(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"Customer ID"}),(0,Jn.jsx)("th",{children:"Name"}),(0,Jn.jsx)("th",{children:"Barangay"}),(0,Jn.jsx)("th",{children:"Type"}),(0,Jn.jsx)("th",{children:"Bill Period"}),(0,Jn.jsx)("th",{className:"has-text-right",children:"Bills"}),(0,Jn.jsx)("th",{className:"has-text-right",children:"Basic Amount"}),(0,Jn.jsx)("th",{className:"has-text-right",children:"Surcharge"}),(0,Jn.jsx)("th",{className:"has-text-right",children:"Total Due"})]})}),(0,Jn.jsx)("tbody",{children:Q.map(e=>(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{children:e.customerid}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("strong",{children:e.name})}),(0,Jn.jsx)("td",{children:e.barangay}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag is-light",children:e.type})}),(0,Jn.jsx)("td",{className:"is-size-7",children:X(e.billScope)}),(0,Jn.jsx)("td",{className:"has-text-right",children:(0,Jn.jsx)("span",{className:"tag is-warning",children:e.billCount})}),(0,Jn.jsxs)("td",{className:"has-text-right",children:["\u20b1",e.totalBasicAmount.toFixed(2)]}),(0,Jn.jsxs)("td",{className:"has-text-right",children:["\u20b1",e.totalSurcharge.toFixed(2)]}),(0,Jn.jsx)("td",{className:"has-text-right",children:(0,Jn.jsxs)("strong",{children:["\u20b1",e.totalBilledAmount.toFixed(2)]})})]},e.customerid))})]})})]});case"generate-reading-sheets":return(0,Jn.jsxs)("div",{className:"customers-page",children:[(0,Jn.jsx)("div",{className:"compact-header",children:(0,Jn.jsxs)("div",{className:"header-row",children:[(0,Jn.jsxs)("div",{className:"title-section",children:[(0,Jn.jsx)("h1",{className:"page-title",children:"Reading Sheets"}),(0,Jn.jsxs)("div",{className:"stats-inline",children:[(0,Jn.jsxs)("span",{className:"stat-item",children:[(0,Jn.jsx)("i",{className:"fas fa-file-alt"}),(0,Jn.jsx)("strong",{children:G.length})," Records"]}),(0,Jn.jsxs)("span",{className:"stat-item",children:[(0,Jn.jsx)("i",{className:"fas fa-calendar"}),(0,Jn.jsx)("strong",{children:s||"N/A"})]})]})]}),(0,Jn.jsx)("div",{className:"header-actions",children:(0,Jn.jsxs)("button",{className:"button is-success",onClick:Z,disabled:0===G.length,children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-file-excel"})}),(0,Jn.jsx)("span",{children:"Export to Excel"})]})})]})}),(0,Jn.jsx)("div",{className:"compact-filters",children:(0,Jn.jsxs)("div",{className:"filter-row",style:{gap:"0.75rem"},children:[(0,Jn.jsx)("div",{className:"filter-group",style:{minWidth:"160px"},children:(0,Jn.jsx)("input",{className:"input",type:"month",value:s,onChange:e=>n(e.target.value),title:"Select Billed Month"})}),(0,Jn.jsx)("div",{className:"search-input",style:{flex:"1",minWidth:"200px"},children:(0,Jn.jsxs)("div",{className:"control has-icons-left",children:[(0,Jn.jsx)("input",{className:"input",type:"text",placeholder:"Search customer...",value:c,onChange:e=>d(e.target.value)}),(0,Jn.jsx)("span",{className:"icon is-small is-left",children:(0,Jn.jsx)("i",{className:"fas fa-search"})})]})}),(0,Jn.jsx)("div",{className:"filter-group",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:u,onChange:e=>h(e.target.value),children:[(0,Jn.jsx)("option",{value:"all",children:"All Barangays"}),v.map(e=>(0,Jn.jsx)("option",{value:e.barangay,children:e.barangay},e.barangay))]})})}),(0,Jn.jsx)("div",{className:"filter-group",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:m,onChange:e=>f(e.target.value),children:[(0,Jn.jsx)("option",{value:"all",children:"All Types"}),x.map(e=>(0,Jn.jsx)("option",{value:e.type,children:e.type},e.type))]})})}),(0,Jn.jsx)("div",{className:"filter-group",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",children:(0,Jn.jsxs)("select",{value:p,onChange:e=>g(e.target.value),children:[(0,Jn.jsx)("option",{value:"all",children:"All Status"}),(0,Jn.jsx)("option",{value:"Active",children:"Active"}),(0,Jn.jsx)("option",{value:"Disconnected",children:"Disconnected"})]})})})]})}),(0,Jn.jsx)("div",{className:"table-container",children:l?(0,Jn.jsx)("div",{className:"loading-container",children:(0,Jn.jsxs)("div",{className:"loading-message",children:[(0,Jn.jsx)("div",{className:"loading-spinner"}),(0,Jn.jsx)("h3",{className:"title is-5",children:"Loading Reading Sheets"}),(0,Jn.jsxs)("p",{className:"has-text-grey",children:["Fetching customer reading data for ",s,"..."]})]})}):0===G.length?(0,Jn.jsxs)("div",{className:"has-text-centered",style:{padding:"4rem 2rem"},children:[(0,Jn.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Jn.jsx)("i",{className:"fas fa-inbox fa-3x"})}),(0,Jn.jsx)("h3",{className:"title is-5 has-text-grey mt-4",children:"No reading data found"}),(0,Jn.jsx)("p",{className:"has-text-grey",children:c||"all"!==u||"all"!==m||"all"!==p?"Try adjusting your search or filters.":"No bills found for the selected month."})]}):(0,Jn.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Jn.jsx)("thead",{children:(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("th",{children:"Customer ID"}),(0,Jn.jsx)("th",{children:"Name"}),(0,Jn.jsx)("th",{children:"Type"}),(0,Jn.jsx)("th",{children:"Barangay"}),(0,Jn.jsx)("th",{children:"Status"}),(0,Jn.jsx)("th",{style:{textAlign:"right"},children:"Previous"}),(0,Jn.jsx)("th",{style:{textAlign:"right"},children:"Current"}),(0,Jn.jsx)("th",{style:{textAlign:"right"},children:"Consumption"})]})}),(0,Jn.jsx)("tbody",{children:G.map(e=>(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{style:{fontWeight:"600",color:"#2563eb"},children:e.customerid})}),(0,Jn.jsx)("td",{children:e.name}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag is-info is-light",children:e.type})}),(0,Jn.jsx)("td",{children:e.barangay}),(0,Jn.jsx)("td",{children:(0,Jn.jsx)("span",{className:"tag ".concat("Active"===e.status?"is-success":"is-danger"),children:e.status})}),(0,Jn.jsx)("td",{style:{textAlign:"right"},children:(0,Jn.jsx)("span",{style:{color:"#6b7280"},children:e.previousreading||0})}),(0,Jn.jsx)("td",{style:{textAlign:"right"},children:(0,Jn.jsx)("strong",{style:{color:"#059669"},children:e.currentreading||0})}),(0,Jn.jsx)("td",{style:{textAlign:"right"},children:(0,Jn.jsx)("strong",{children:e.consumption||0})})]},e.billid||e.customerid))})]})})]});default:return null}})(),B&&(0,Jn.jsxs)("div",{className:"modal is-active",children:[(0,Jn.jsx)("div",{className:"modal-background",onClick:()=>U(!1)}),(0,Jn.jsxs)("div",{className:"modal-card",children:[(0,Jn.jsxs)("header",{className:"modal-card-head",children:[(0,Jn.jsx)("p",{className:"modal-card-title",children:"Generate Disconnection Notices"}),(0,Jn.jsx)("button",{className:"delete","aria-label":"close",onClick:()=>U(!1)})]}),(0,Jn.jsxs)("section",{className:"modal-card-body",children:[(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsxs)("label",{className:"label",children:["Preferred Disconnection Date ",(0,Jn.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("input",{className:"input",type:"date",value:F,onChange:e=>z(e.target.value),required:!0})}),(0,Jn.jsx)("p",{className:"help",children:"The date when water service will be disconnected if payment is not received"})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Reconnection Fee"}),(0,Jn.jsxs)("div",{className:"control has-icons-left",children:[(0,Jn.jsx)("span",{className:"icon is-small is-left",children:(0,Jn.jsx)("i",{className:"fas fa-peso-sign"})}),(0,Jn.jsx)("input",{className:"input",type:"number",step:"0.01",min:"0",value:M,onChange:e=>W(e.target.value),placeholder:"200.00"})]}),(0,Jn.jsx)("p",{className:"help",children:"Fee required for reconnection (default: \u20b1200.00)"})]}),(0,Jn.jsxs)("div",{className:"notification is-info is-light",children:[(0,Jn.jsx)("p",{children:(0,Jn.jsx)("strong",{children:"Summary:"})}),(0,Jn.jsxs)("p",{children:["\u2022 Total notices to generate: ",(0,Jn.jsx)("strong",{children:Q.length})]}),(0,Jn.jsxs)("p",{children:["\u2022 Disconnection date: ",(0,Jn.jsx)("strong",{children:F?new Date(F).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not set"})]}),(0,Jn.jsxs)("p",{children:["\u2022 Reconnection fee: ",(0,Jn.jsxs)("strong",{children:["\u20b1",parseFloat(M||0).toFixed(2)]})]})]})]}),(0,Jn.jsxs)("footer",{className:"modal-card-foot",children:[(0,Jn.jsxs)("button",{className:"button is-danger",onClick:()=>{if(!F)return void alert("Please enter a disconnection date.");console.log("Generating notices with Municipal Treasurer:",L),console.log("Disconnection Date:",F),console.log("Reconnection Fee:",M),U(!1);const e=Q.map((e,t)=>'\n      <div class="notice-box" style="'.concat((t+1)%2===0?"page-break-after: always;":""," padding: 0.75rem; font-family: Arial, sans-serif; font-size: 12px; height: ").concat(t%2===0?"6.75in":"5.5in","; ").concat(t%2!==0?"margin-top: 0.25in;":""," box-sizing: border-box; ").concat(t%2===0?"border-bottom: 2px dashed #999;":"",'">\n        <div style="text-align: center; margin-bottom: 0.6rem;">\n          <p style="margin: 0; font-size: 11px; line-height: 1.4;">Republic of the Philippines</p>\n          <p style="margin: 0; font-size: 11px; line-height: 1.4;">Province of Romblon</p>\n          <p style="margin: 0; font-size: 11px; line-height: 1.4;">Municipality of Concepcion</p>\n          <p style="margin: 0.4rem 0 0 0; font-size: 12px; font-weight: bold; line-height: 1.4;">OFFICE OF THE MUNICIPAL TREASURER</p>\n        </div>\n        \n        <div style="text-align: center; margin-bottom: 0.75rem; border-bottom: 3px solid #dc2626; padding-bottom: 0.5rem;">\n          <h1 style="color: #dc2626; margin: 0; font-size: 18px; font-weight: bold;">\u26a0\ufe0f NOTICE OF WATER DISCONNECTION \u26a0\ufe0f</h1>\n        </div>\n\n        <div style="margin-bottom: 0.65rem; font-size: 11px;">\n          <p style="margin: 0;"><strong>Date:</strong> ').concat((new Date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),'</p>\n        </div>\n\n        <div style="display: flex; gap: 0.6rem; margin-bottom: 0.65rem;">\n          \x3c!-- Customer Information Column --\x3e\n          <div style="flex: 1; background: #fef2f2; border-left: 3px solid #dc2626; padding: 0.6rem;">\n            <h3 style="margin: 0 0 0.5rem 0; color: #991b1b; font-size: 13px; font-weight: bold;">Customer Information</h3>\n            <table style="width: 100%; border-collapse: collapse; font-size: 12px;">\n              <tr>\n                <td style="padding: 0.3rem 0; width: 40%;"><strong>ID:</strong></td>\n                <td style="padding: 0.3rem 0;">').concat(e.customerid,'</td>\n              </tr>\n              <tr>\n                <td style="padding: 0.3rem 0;"><strong>Name:</strong></td>\n                <td style="padding: 0.3rem 0;">').concat(e.name,'</td>\n              </tr>\n              <tr>\n                <td style="padding: 0.3rem 0;"><strong>Barangay:</strong></td>\n                <td style="padding: 0.3rem 0;">').concat(e.barangay,'</td>\n              </tr>\n              <tr>\n                <td style="padding: 0.3rem 0;"><strong>Type:</strong></td>\n                <td style="padding: 0.3rem 0;">').concat(e.type,'</td>\n              </tr>\n            </table>\n          </div>\n\n          \x3c!-- Outstanding Balance Column --\x3e\n          <div style="flex: 1;">\n            <h3 style="color: #991b1b; margin: 0 0 0.5rem 0; font-size: 13px; font-weight: bold;">Outstanding Balance</h3>\n            <table style="width: 100%; border-collapse: collapse; border: 1px solid #999; font-size: 12px;">\n              <tbody>\n                <tr style="background: #f9fafb;">\n                  <td style="padding: 0.45rem; border: 1px solid #999;">Unpaid Bills</td>\n                  <td style="padding: 0.45rem; text-align: right; border: 1px solid #999; font-weight: bold;">').concat(e.billCount,'</td>\n                </tr>\n                <tr>\n                  <td style="padding: 0.45rem; border: 1px solid #999; font-size: 11px;">Period</td>\n                  <td style="padding: 0.45rem; text-align: right; border: 1px solid #999; font-size: 11px;">').concat(X(e.billScope),'</td>\n                </tr>\n                <tr style="background: #f9fafb;">\n                  <td style="padding: 0.45rem; border: 1px solid #999;">Basic</td>\n                  <td style="padding: 0.45rem; text-align: right; border: 1px solid #999;">\u20b1').concat(e.totalBasicAmount.toFixed(2),'</td>\n                </tr>\n                <tr>\n                  <td style="padding: 0.45rem; border: 1px solid #999;">Surcharge</td>\n                  <td style="padding: 0.45rem; text-align: right; border: 1px solid #999;">\u20b1').concat(e.totalSurcharge.toFixed(2),'</td>\n                </tr>\n                <tr style="background: #fee2e2; font-weight: bold;">\n                  <td style="padding: 0.5rem; border: 1px solid #999; font-size: 12px;">TOTAL DUE</td>\n                  <td style="padding: 0.5rem; text-align: right; border: 1px solid #999; color: #dc2626; font-size: 13px;">\u20b1').concat(e.totalBilledAmount.toFixed(2),'</td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        <div style="background: #fef2f2; border: 2px solid #dc2626; padding: 0.65rem; margin-bottom: 0.65rem;">\n          <h3 style="color: #991b1b; margin: 0 0 0.4rem 0; font-size: 12px; font-weight: bold;">\u26a0\ufe0f DISCONNECTION WARNING</h3>\n          <p style="line-height: 1.5; margin: 0.2rem 0; font-size: 11px;">This is to inform you that your water service account has <strong>OVERDUE BILLS</strong> that remain unpaid.</p>\n          <p style="line-height: 1.5; margin: 0.2rem 0; font-size: 11px;">If payment is not received on or before <strong style="color: #dc2626;">').concat(new Date(F).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),'</strong>, your water service will be <strong style="color: #dc2626;">DISCONNECTED</strong> without further notice.</p>\n          <p style="line-height: 1.5; margin: 0.2rem 0; font-size: 11px;">Reconnection will require payment of all outstanding balances plus applicable reconnection fees which is <strong>\u20b1').concat(parseFloat(M).toFixed(2),'</strong>.</p>\n        </div>\n\n        <div style="margin-bottom: 0.4rem;">\n          <h4 style="margin: 0 0 0.3rem 0; font-size: 12px; font-weight: bold;">Payment Instructions:</h4>\n          <ul style="line-height: 1.4; margin: 0; padding-left: 1.3rem; font-size: 11px;">\n            <li style="margin-bottom: 0.15rem;">Please settle your account immediately to avoid service interruption</li>\n            <li style="margin-bottom: 0.15rem;">Payment can be made at our office during business hours</li>\n            <li>For inquiries, please contact our office or visit during office hours</li>\n          </ul>\n        </div>\n\n        <div style="margin-top: 0.25rem; padding-bottom: 0.5rem; display: flex; justify-content: space-between; align-items: flex-start;">\n          <div style="flex: 1;">\n            <p style="margin: 0; font-size: 10px; color: #6b7280; font-style: italic;">This is an official notice. Please keep for your records.</p>\n          </div>\n          <div style="flex: 1; text-align: center;">\n            <p style="margin: 0 0 0.1rem 0; font-size: 11px;">By Authority of:</p>\n            <p style="margin: 0.8rem 0 0.08rem 0; font-size: 12px; font-weight: bold; border-bottom: 1px solid #333; padding-bottom: 0.08rem; display: inline-block; min-width: 180px;">').concat(L?"".concat(L.firstname.toUpperCase()," ").concat(L.lastname.toUpperCase()):"___________________________",'</p>\n            <p style="margin: 0; font-size: 11px;">').concat(L?L.position:"Municipal Treasurer","</p>\n          </div>\n        </div>\n      </div>\n    ")).join(""),t=window.open("","_blank");t.document.write("\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>Water Disconnection Notices - ".concat((new Date).toLocaleDateString(),'</title>\n          <meta charset="UTF-8">\n          <style>\n            * {\n              box-sizing: border-box;\n            }\n            body { \n              margin: 0; \n              padding: 0;\n            }\n            .notice-box { \n              width: 100%;\n              box-sizing: border-box;\n            }\n            @page {\n              size: legal portrait;\n              margin: 0.25in 0;\n            }\n            @media print {\n              body { \n                margin: 0; \n                padding: 0;\n              }\n              .notice-box {\n                height: 6.25in;\n              }\n            }\n          </style>\n        </head>\n        <body>\n          ').concat(e,"\n          <script>\n            window.onload = function() {\n              window.print();\n            }\n          <\/script>\n        </body>\n      </html>\n    ")),t.document.close()},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-print"})}),(0,Jn.jsx)("span",{children:"Generate & Print"})]}),(0,Jn.jsx)("button",{className:"button",onClick:()=>U(!1),children:"Cancel"})]})]})]})]})},ja=e=>{var t,s;let{user:n,isOpen:r,onClose:i,onUpdate:l}=e;const[o,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1),[h,m]=(0,a.useState)(""),[f,p]=(0,a.useState)(""),[g,v]=(0,a.useState)({firstname:n.firstname||"",lastname:n.lastname||"",email:n.email||"",phone:n.phone||"",address:n.address||""});if(!r)return null;const y=(e,t)=>{v(s=>ta(ta({},s),{},{[e]:t})),m("")},x=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";return(0,Jn.jsxs)("div",{className:"modal is-active",children:[(0,Jn.jsx)("div",{className:"modal-background",onClick:i}),(0,Jn.jsxs)("div",{className:"modal-card",style:{width:"600px",maxWidth:"90vw"},children:[(0,Jn.jsxs)("header",{className:"modal-card-head",children:[(0,Jn.jsxs)("p",{className:"modal-card-title",children:[(0,Jn.jsx)("i",{className:"fas fa-user-circle"})," My Profile"]}),(0,Jn.jsx)("button",{className:"delete","aria-label":"close",onClick:i})]}),(0,Jn.jsxs)("section",{className:"modal-card-body",children:[h&&(0,Jn.jsxs)("div",{className:"notification is-danger is-light",children:[(0,Jn.jsx)("button",{className:"delete",onClick:()=>m("")}),h]}),f&&(0,Jn.jsxs)("div",{className:"notification is-success is-light",children:[(0,Jn.jsx)("button",{className:"delete",onClick:()=>p("")}),f]}),(0,Jn.jsxs)("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[(0,Jn.jsxs)("div",{style:{width:"100px",height:"100px",borderRadius:"50%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"2.5rem",color:"white",fontWeight:"bold",marginBottom:"1rem"},children:[null===(t=n.firstname)||void 0===t?void 0:t.charAt(0),null===(s=n.lastname)||void 0===s?void 0:s.charAt(0)]}),(0,Jn.jsxs)("h3",{className:"title is-4",style:{marginBottom:"0.25rem"},children:[n.firstname," ",n.lastname]}),(0,Jn.jsxs)("p",{className:"subtitle is-6",style:{color:"#7a7a7a"},children:[(0,Jn.jsx)("i",{className:"fas fa-shield-alt"})," ",n.role]})]}),(0,Jn.jsx)("div",{className:"box",style:{background:"#f9fafb",padding:"1.5rem"},children:(0,Jn.jsxs)("div",{className:"columns is-multiline",children:[(0,Jn.jsxs)("div",{className:"column is-6",children:[(0,Jn.jsx)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:"First Name"}),o?(0,Jn.jsx)("input",{className:"input",type:"text",value:g.firstname,onChange:e=>y("firstname",e.target.value)}):(0,Jn.jsx)("p",{style:{fontSize:"1rem",fontWeight:"500",marginTop:"0.5rem"},children:n.firstname})]}),(0,Jn.jsxs)("div",{className:"column is-6",children:[(0,Jn.jsx)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:"Last Name"}),o?(0,Jn.jsx)("input",{className:"input",type:"text",value:g.lastname,onChange:e=>y("lastname",e.target.value)}):(0,Jn.jsx)("p",{style:{fontSize:"1rem",fontWeight:"500",marginTop:"0.5rem"},children:n.lastname})]}),(0,Jn.jsxs)("div",{className:"column is-12",children:[(0,Jn.jsxs)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,Jn.jsx)("i",{className:"fas fa-envelope"})," Email Address"]}),o?(0,Jn.jsx)("input",{className:"input",type:"email",value:g.email,onChange:e=>y("email",e.target.value)}):(0,Jn.jsx)("p",{style:{fontSize:"1rem",fontWeight:"500",marginTop:"0.5rem"},children:n.email})]}),(0,Jn.jsxs)("div",{className:"column is-6",children:[(0,Jn.jsxs)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,Jn.jsx)("i",{className:"fas fa-phone"})," Phone Number"]}),o?(0,Jn.jsx)("input",{className:"input",type:"text",value:g.phone,onChange:e=>y("phone",e.target.value),placeholder:"Enter phone number"}):(0,Jn.jsx)("p",{style:{fontSize:"1rem",fontWeight:"500",marginTop:"0.5rem"},children:n.phone||"Not provided"})]}),(0,Jn.jsxs)("div",{className:"column is-6",children:[(0,Jn.jsxs)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,Jn.jsx)("i",{className:"fas fa-user-tag"})," User ID"]}),(0,Jn.jsx)("p",{style:{fontSize:"1rem",fontWeight:"500",marginTop:"0.5rem",color:"#2563eb"},children:n.userid})]}),(0,Jn.jsxs)("div",{className:"column is-12",children:[(0,Jn.jsxs)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,Jn.jsx)("i",{className:"fas fa-map-marker-alt"})," Address"]}),o?(0,Jn.jsx)("textarea",{className:"textarea",value:g.address,onChange:e=>y("address",e.target.value),placeholder:"Enter address",rows:"2"}):(0,Jn.jsx)("p",{style:{fontSize:"1rem",fontWeight:"500",marginTop:"0.5rem"},children:n.address||"Not provided"})]}),(0,Jn.jsxs)("div",{className:"column is-6",children:[(0,Jn.jsxs)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,Jn.jsx)("i",{className:"fas fa-calendar-plus"})," Account Created"]}),(0,Jn.jsx)("p",{style:{fontSize:"0.875rem",color:"#6b7280",marginTop:"0.5rem"},children:x(n.datecreated)})]}),(0,Jn.jsxs)("div",{className:"column is-6",children:[(0,Jn.jsxs)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,Jn.jsx)("i",{className:"fas fa-clock"})," Last Login"]}),(0,Jn.jsx)("p",{style:{fontSize:"0.875rem",color:"#6b7280",marginTop:"0.5rem"},children:x(n.lastlogin)})]}),(0,Jn.jsxs)("div",{className:"column is-12",children:[(0,Jn.jsxs)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,Jn.jsx)("i",{className:"fas fa-toggle-on"})," Account Status"]}),(0,Jn.jsx)("span",{className:"tag ".concat("active"===n.status?"is-success":"is-danger"),children:n.status})]})]})})]}),(0,Jn.jsx)("footer",{className:"modal-card-foot",style:{justifyContent:"flex-end",gap:"0.5rem"},children:o?(0,Jn.jsxs)(Jn.Fragment,{children:[(0,Jn.jsx)("button",{className:"button",onClick:()=>{v({firstname:n.firstname||"",lastname:n.lastname||"",email:n.email||"",phone:n.phone||"",address:n.address||""}),c(!1),m(""),p("")},disabled:d,children:"Cancel"}),(0,Jn.jsxs)("button",{className:"button is-primary ".concat(d?"is-loading":""),onClick:async()=>{u(!0),m(""),p("");try{const e=await $n.updateProfile(n.userid,g);e.success?(p("Profile updated successfully!"),c(!1),l(ta(ta({},n),g)),setTimeout(()=>{p("")},2e3)):m(e.error||"Failed to update profile")}catch(e){m("An error occurred while updating profile")}u(!1)},disabled:d,children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-save"})}),(0,Jn.jsx)("span",{children:"Save Changes"})]})]}):(0,Jn.jsxs)(Jn.Fragment,{children:[(0,Jn.jsx)("button",{className:"button",onClick:i,children:"Close"}),(0,Jn.jsxs)("button",{className:"button is-info",onClick:()=>c(!0),children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-edit"})}),(0,Jn.jsx)("span",{children:"Edit Profile"})]})]})})]})]})},wa=e=>{let{user:t,isOpen:s,onClose:n}=e;const[r,i]=(0,a.useState)("security"),[l,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(""),[u,h]=(0,a.useState)(""),[m,f]=(0,a.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[p,g]=(0,a.useState)({emailNotifications:!0,browserNotifications:!1,theme:"light"});if(!s)return null;const v=(e,t)=>{f(s=>ta(ta({},s),{},{[e]:t})),d("")};return(0,Jn.jsxs)("div",{className:"modal is-active",children:[(0,Jn.jsx)("div",{className:"modal-background",onClick:n}),(0,Jn.jsxs)("div",{className:"modal-card",style:{width:"700px",maxWidth:"90vw"},children:[(0,Jn.jsxs)("header",{className:"modal-card-head",children:[(0,Jn.jsxs)("p",{className:"modal-card-title",children:[(0,Jn.jsx)("i",{className:"fas fa-cog"})," Settings"]}),(0,Jn.jsx)("button",{className:"delete","aria-label":"close",onClick:n})]}),(0,Jn.jsxs)("section",{className:"modal-card-body",style:{minHeight:"400px"},children:[(0,Jn.jsx)("div",{className:"tabs is-boxed",children:(0,Jn.jsxs)("ul",{children:[(0,Jn.jsx)("li",{className:"security"===r?"is-active":"",children:(0,Jn.jsxs)("a",{onClick:()=>i("security"),children:[(0,Jn.jsx)("span",{className:"icon is-small",children:(0,Jn.jsx)("i",{className:"fas fa-lock"})}),(0,Jn.jsx)("span",{children:"Security"})]})}),(0,Jn.jsx)("li",{className:"preferences"===r?"is-active":"",children:(0,Jn.jsxs)("a",{onClick:()=>i("preferences"),children:[(0,Jn.jsx)("span",{className:"icon is-small",children:(0,Jn.jsx)("i",{className:"fas fa-sliders-h"})}),(0,Jn.jsx)("span",{children:"Preferences"})]})}),(0,Jn.jsx)("li",{className:"about"===r?"is-active":"",children:(0,Jn.jsxs)("a",{onClick:()=>i("about"),children:[(0,Jn.jsx)("span",{className:"icon is-small",children:(0,Jn.jsx)("i",{className:"fas fa-info-circle"})}),(0,Jn.jsx)("span",{children:"About"})]})})]})}),c&&(0,Jn.jsxs)("div",{className:"notification is-danger is-light",children:[(0,Jn.jsx)("button",{className:"delete",onClick:()=>d("")}),c]}),u&&(0,Jn.jsxs)("div",{className:"notification is-success is-light",children:[(0,Jn.jsx)("button",{className:"delete",onClick:()=>h("")}),u]}),"security"===r&&(0,Jn.jsxs)("div",{children:[(0,Jn.jsxs)("h3",{className:"title is-5",children:[(0,Jn.jsx)("i",{className:"fas fa-key"})," Change Password"]}),(0,Jn.jsx)("p",{className:"subtitle is-6",style:{color:"#7a7a7a",marginBottom:"1.5rem"},children:"Keep your account secure by using a strong password"}),(0,Jn.jsxs)("div",{className:"box",style:{background:"#f9fafb"},children:[(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Current Password"}),(0,Jn.jsxs)("div",{className:"control has-icons-left",children:[(0,Jn.jsx)("input",{className:"input",type:"password",placeholder:"Enter current password",value:m.currentPassword,onChange:e=>v("currentPassword",e.target.value)}),(0,Jn.jsx)("span",{className:"icon is-small is-left",children:(0,Jn.jsx)("i",{className:"fas fa-lock"})})]})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"New Password"}),(0,Jn.jsxs)("div",{className:"control has-icons-left",children:[(0,Jn.jsx)("input",{className:"input",type:"password",placeholder:"Enter new password",value:m.newPassword,onChange:e=>v("newPassword",e.target.value)}),(0,Jn.jsx)("span",{className:"icon is-small is-left",children:(0,Jn.jsx)("i",{className:"fas fa-key"})})]}),(0,Jn.jsx)("p",{className:"help",children:"Password must be at least 6 characters long"})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("label",{className:"label",children:"Confirm New Password"}),(0,Jn.jsxs)("div",{className:"control has-icons-left",children:[(0,Jn.jsx)("input",{className:"input",type:"password",placeholder:"Confirm new password",value:m.confirmPassword,onChange:e=>v("confirmPassword",e.target.value)}),(0,Jn.jsx)("span",{className:"icon is-small is-left",children:(0,Jn.jsx)("i",{className:"fas fa-check-circle"})})]})]}),(0,Jn.jsx)("div",{className:"field",style:{marginTop:"1.5rem"},children:(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsxs)("button",{className:"button is-primary ".concat(l?"is-loading":""),onClick:async()=>{if(d(""),h(""),m.currentPassword&&m.newPassword&&m.confirmPassword)if(m.newPassword.length<6)d("New password must be at least 6 characters long");else if(m.newPassword===m.confirmPassword){o(!0);try{const e=await $n.changePassword(t.userid,m.currentPassword,m.newPassword);e.success?(h("Password changed successfully!"),f({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>h(""),3e3)):d(e.error||"Failed to change password")}catch(e){d("An error occurred while changing password")}o(!1)}else d("New passwords do not match");else d("All password fields are required")},disabled:l,children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-save"})}),(0,Jn.jsx)("span",{children:"Update Password"})]})})})]}),(0,Jn.jsxs)("div",{className:"notification is-info is-light",style:{marginTop:"1.5rem"},children:[(0,Jn.jsx)("strong",{children:"Security Tips:"}),(0,Jn.jsxs)("ul",{style:{marginTop:"0.5rem",paddingLeft:"1.5rem"},children:[(0,Jn.jsx)("li",{children:"Use a unique password for this account"}),(0,Jn.jsx)("li",{children:"Include uppercase, lowercase, numbers, and symbols"}),(0,Jn.jsx)("li",{children:"Avoid using personal information in your password"}),(0,Jn.jsx)("li",{children:"Change your password regularly"})]})]})]}),"preferences"===r&&(0,Jn.jsxs)("div",{children:[(0,Jn.jsxs)("h3",{className:"title is-5",children:[(0,Jn.jsx)("i",{className:"fas fa-sliders-h"})," Application Preferences"]}),(0,Jn.jsx)("p",{className:"subtitle is-6",style:{color:"#7a7a7a",marginBottom:"1.5rem"},children:"Customize your experience"}),(0,Jn.jsxs)("div",{className:"box",style:{background:"#f9fafb"},children:[(0,Jn.jsxs)("div",{className:"field",style:{marginBottom:"1.5rem"},children:[(0,Jn.jsxs)("label",{className:"label",children:[(0,Jn.jsx)("i",{className:"fas fa-bell"})," Notifications"]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("input",{id:"emailNotif",type:"checkbox",className:"switch is-rounded is-success",checked:p.emailNotifications,onChange:e=>g(t=>ta(ta({},t),{},{emailNotifications:e.target.checked}))}),(0,Jn.jsx)("label",{htmlFor:"emailNotif",children:"Enable email notifications"})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsx)("input",{id:"browserNotif",type:"checkbox",className:"switch is-rounded is-info",checked:p.browserNotifications,onChange:e=>g(t=>ta(ta({},t),{},{browserNotifications:e.target.checked}))}),(0,Jn.jsx)("label",{htmlFor:"browserNotif",children:"Enable browser notifications"})]})]}),(0,Jn.jsxs)("div",{className:"field",children:[(0,Jn.jsxs)("label",{className:"label",children:[(0,Jn.jsx)("i",{className:"fas fa-palette"})," Theme (Coming Soon)"]}),(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsx)("div",{className:"select is-fullwidth",disabled:!0,children:(0,Jn.jsxs)("select",{value:p.theme,onChange:e=>g(t=>ta(ta({},t),{},{theme:e.target.value})),disabled:!0,children:[(0,Jn.jsx)("option",{value:"light",children:"Light Mode"}),(0,Jn.jsx)("option",{value:"dark",children:"Dark Mode"}),(0,Jn.jsx)("option",{value:"auto",children:"Auto (System)"})]})})}),(0,Jn.jsx)("p",{className:"help",children:"Theme customization will be available in a future update"})]}),(0,Jn.jsx)("div",{className:"field",style:{marginTop:"1.5rem"},children:(0,Jn.jsx)("div",{className:"control",children:(0,Jn.jsxs)("button",{className:"button is-primary",onClick:()=>{h("Preferences saved successfully!"),setTimeout(()=>h(""),2e3)},children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-save"})}),(0,Jn.jsx)("span",{children:"Save Preferences"})]})})})]})]}),"about"===r&&(0,Jn.jsxs)("div",{children:[(0,Jn.jsxs)("h3",{className:"title is-5",children:[(0,Jn.jsx)("i",{className:"fas fa-info-circle"})," About This System"]}),(0,Jn.jsxs)("div",{className:"box",style:{background:"#f9fafb",textAlign:"center",padding:"2rem"},children:[(0,Jn.jsx)("div",{style:{width:"80px",height:"80px",borderRadius:"16px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"2rem",color:"white",marginBottom:"1rem"},children:(0,Jn.jsx)("i",{className:"fas fa-building"})}),(0,Jn.jsx)("h3",{className:"title is-4",children:"Water Billing System"}),(0,Jn.jsx)("p",{className:"subtitle is-6",style:{color:"#7a7a7a"},children:"LGU Concepcion, Romblon"})]}),(0,Jn.jsx)("div",{className:"content",style:{marginTop:"1.5rem"},children:(0,Jn.jsx)("table",{className:"table is-fullwidth is-striped",children:(0,Jn.jsxs)("tbody",{children:[(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{children:(0,Jn.jsx)("strong",{children:"Version"})}),(0,Jn.jsx)("td",{children:"2.0.0"})]}),(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{children:(0,Jn.jsx)("strong",{children:"Build Date"})}),(0,Jn.jsx)("td",{children:"October 2025"})]}),(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{children:(0,Jn.jsx)("strong",{children:"Technology"})}),(0,Jn.jsx)("td",{children:"React.js + Supabase"})]}),(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{children:(0,Jn.jsx)("strong",{children:"Database"})}),(0,Jn.jsx)("td",{children:"PostgreSQL (Supabase)"})]}),(0,Jn.jsxs)("tr",{children:[(0,Jn.jsx)("td",{children:(0,Jn.jsx)("strong",{children:"UI Framework"})}),(0,Jn.jsx)("td",{children:"Bulma CSS"})]})]})})}),(0,Jn.jsxs)("div",{className:"notification is-link is-light",children:[(0,Jn.jsx)("p",{children:(0,Jn.jsx)("strong",{children:"Need Help?"})}),(0,Jn.jsx)("p",{style:{marginTop:"0.5rem"},children:"Contact your system administrator or IT support team for assistance with this application."})]})]})]}),(0,Jn.jsx)("footer",{className:"modal-card-foot",style:{justifyContent:"flex-end"},children:(0,Jn.jsx)("button",{className:"button",onClick:n,children:"Close"})})]})]})},Na=e=>{let{onLogout:t}=e;const[s,n]=(0,a.useState)(null),[r,i]=(0,a.useState)(!1),[l,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(!1),m=se(),f=ee(),p=[{name:"Dashboard",icon:"fas fa-tachometer-alt",path:"/portal/water-billing/dashboard"},{name:"Customers",icon:"fas fa-users",path:"/portal/water-billing/customers"},{name:"Billing",icon:"fas fa-file-invoice-dollar",path:"/portal/water-billing/billing"},{name:"Payments",icon:"fas fa-credit-card",path:"/portal/water-billing/payments"},{name:"Credit Management",icon:"fas fa-chart-line",path:"/portal/water-billing/credit-management"},{name:"Reports",icon:"fas fa-chart-bar",path:"/portal/water-billing/reports"},{name:"Users",icon:"fas fa-user-cog",path:"/portal/water-billing/users"},{name:"Tools",icon:"fas fa-tools",path:"/portal/water-billing/tools"}],g=(()=>{const e=f.pathname,t=p.find(t=>t.path===e);return t?t.name:"Dashboard"})();(0,a.useEffect)(()=>{const e=$n.getUserSession();e?n(e):m("/login")},[m]),(0,a.useEffect)(()=>{const e=()=>{const e=document.querySelector(".dashboard-header"),t=document.querySelector(".content-container"),s=t?t.scrollTop>10:window.scrollY>10;e&&(s?e.classList.add("scrolled"):e.classList.remove("scrolled"))},t=document.querySelector(".content-container");return t?(t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)):(window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e))},[]),(0,a.useEffect)(()=>{"/portal/water-billing"===f.pathname&&m("/portal/water-billing/dashboard",{replace:!0})},[f.pathname,m]);(0,a.useEffect)(()=>{const e=e=>{const t=document.querySelector(".user-dropdown");t&&!t.contains(e.target)&&o(!1)};if(l)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[l]),(0,a.useEffect)(()=>{const e=e=>{m("/portal/water-billing/payments")};return window.addEventListener("navigateToPayments",e),()=>window.removeEventListener("navigateToPayments",e)},[m]);const v=e=>{const t=p.find(t=>t.name===e);t&&m(t.path),i(!1)};return s?(0,Jn.jsxs)("div",{className:"dashboard-container",children:[(0,Jn.jsxs)("header",{className:"dashboard-header",children:[(0,Jn.jsxs)("div",{className:"header-content",children:[(0,Jn.jsxs)("div",{className:"header-left",children:[(0,Jn.jsxs)("button",{className:"button is-light is-small",onClick:()=>{m("/portal")},style:{marginRight:"1rem"},title:"Back to Systems Portal",children:[(0,Jn.jsx)("span",{className:"icon",children:(0,Jn.jsx)("i",{className:"fas fa-arrow-left"})}),(0,Jn.jsx)("span",{children:"Portal"})]}),(0,Jn.jsx)("div",{className:"brand-icon",children:(0,Jn.jsx)("i",{className:"fas fa-tint"})}),(0,Jn.jsxs)("div",{className:"brand-text",children:[(0,Jn.jsx)("h1",{className:"brand-title",children:"Water Billing System"}),(0,Jn.jsx)("p",{className:"brand-subtitle",children:"LGU Concepcion, Romblon"})]})]}),(0,Jn.jsx)("nav",{className:"header-center",children:(0,Jn.jsx)("div",{className:"nav-menu",children:p.map(e=>(0,Jn.jsxs)("button",{className:"nav-item ".concat(g===e.name?"active":""),onClick:()=>v(e.name),children:[(0,Jn.jsx)("i",{className:e.icon}),(0,Jn.jsx)("span",{children:e.name})]},e.name))})}),(0,Jn.jsxs)("div",{className:"header-right",children:[(0,Jn.jsxs)("div",{className:"user-info",children:[(0,Jn.jsxs)("span",{className:"user-name",children:[s.firstname," ",s.lastname]}),(0,Jn.jsx)("span",{className:"user-role",children:s.role})]}),(0,Jn.jsxs)("div",{className:"user-dropdown ".concat(l?"is-active":""),children:[(0,Jn.jsxs)("button",{className:"user-button",onClick:()=>o(!l),children:[(0,Jn.jsx)("div",{className:"user-avatar",children:(0,Jn.jsx)("i",{className:"fas fa-user"})}),(0,Jn.jsx)("i",{className:"fas fa-chevron-down"})]}),(0,Jn.jsxs)("div",{className:"dropdown-menu",children:[(0,Jn.jsxs)("a",{className:"dropdown-item",onClick:()=>{d(!0),o(!1)},children:[(0,Jn.jsx)("i",{className:"fas fa-user-edit"}),(0,Jn.jsx)("span",{children:"Profile"})]}),(0,Jn.jsxs)("a",{className:"dropdown-item",onClick:()=>{h(!0),o(!1)},children:[(0,Jn.jsx)("i",{className:"fas fa-cog"}),(0,Jn.jsx)("span",{children:"Settings"})]}),(0,Jn.jsx)("hr",{className:"dropdown-divider"}),(0,Jn.jsxs)("a",{className:"dropdown-item",onClick:()=>{$n.logout(),t&&t(),m("/login",{replace:!0})},children:[(0,Jn.jsx)("i",{className:"fas fa-sign-out-alt"}),(0,Jn.jsx)("span",{children:"Logout"})]})]})]})]}),(0,Jn.jsxs)("button",{className:"mobile-menu-toggle ".concat(r?"active":""),onClick:()=>i(!r),children:[(0,Jn.jsx)("span",{}),(0,Jn.jsx)("span",{}),(0,Jn.jsx)("span",{})]})]}),(0,Jn.jsx)("div",{className:"mobile-nav ".concat(r?"active":""),children:p.map(e=>(0,Jn.jsxs)("button",{className:"mobile-nav-item ".concat(g===e.name?"active":""),onClick:()=>v(e.name),children:[(0,Jn.jsx)("i",{className:e.icon}),(0,Jn.jsx)("span",{children:e.name})]},e.name))})]}),(0,Jn.jsx)("main",{className:"dashboard-main",children:(0,Jn.jsx)("div",{className:"content-container",children:(0,Jn.jsxs)(xe,{children:[(0,Jn.jsx)(ve,{index:!0,element:(0,Jn.jsx)(ia,{user:s})}),(0,Jn.jsx)(ve,{path:"dashboard",element:(0,Jn.jsx)(ia,{user:s})}),(0,Jn.jsx)(ve,{path:"customers",element:(0,Jn.jsx)(la,{})}),(0,Jn.jsx)(ve,{path:"billing",element:(0,Jn.jsx)(ua,{})}),(0,Jn.jsx)(ve,{path:"payments",element:(0,Jn.jsx)(ma,{})}),(0,Jn.jsx)(ve,{path:"credit-management",element:(0,Jn.jsx)(pa,{})}),(0,Jn.jsx)(ve,{path:"reports",element:(0,Jn.jsx)(va,{})}),(0,Jn.jsx)(ve,{path:"users",element:(0,Jn.jsx)(xa,{})}),(0,Jn.jsx)(ve,{path:"tools",element:(0,Jn.jsx)(ba,{})})]})})}),(0,Jn.jsx)(ja,{user:s,isOpen:c,onClose:()=>d(!1),onUpdate:e=>{n(e),$n.setUserSession(e)}}),(0,Jn.jsx)(wa,{user:s,isOpen:u,onClose:()=>h(!1)})]}):(0,Jn.jsx)("div",{className:"container",children:(0,Jn.jsx)("div",{className:"section",children:(0,Jn.jsx)("div",{className:"has-text-centered",children:(0,Jn.jsx)("button",{className:"button is-loading is-large",children:"Loading"})})})})},Sa=e=>{let{children:t}=e;return $n.isAuthenticated()?t:(0,Jn.jsx)(ge,{to:"/login",replace:!0})};const ka=function(){const[e,t]=(0,a.useState)($n.isAuthenticated());return(0,a.useEffect)(()=>{const e=()=>{t($n.isAuthenticated())};return e(),window.addEventListener("storage",e),window.addEventListener("authChange",e),()=>{window.removeEventListener("storage",e),window.removeEventListener("authChange",e)}},[]),(0,Jn.jsx)(we,{children:(0,Jn.jsx)("div",{className:"App",children:(0,Jn.jsxs)(xe,{children:[(0,Jn.jsx)(ve,{path:"/",element:e?(0,Jn.jsx)(ge,{to:"/portal",replace:!0}):(0,Jn.jsx)(ge,{to:"/login",replace:!0})}),(0,Jn.jsx)(ve,{path:"/login",element:e?(0,Jn.jsx)(ge,{to:"/portal",replace:!0}):(0,Jn.jsx)(Gn,{onLoginSuccess:()=>t(!0)})}),(0,Jn.jsx)(ve,{path:"/portal",element:(0,Jn.jsx)(Sa,{children:(0,Jn.jsx)(Qn,{onLogout:()=>t(!1)})})}),(0,Jn.jsx)(ve,{path:"/portal/water-billing/*",element:(0,Jn.jsx)(Sa,{children:(0,Jn.jsx)(Na,{onLogout:()=>t(!1)})})}),(0,Jn.jsx)(ve,{path:"*",element:(0,Jn.jsx)(ge,{to:"/",replace:!0})})]})})})};i.createRoot(document.getElementById("root")).render((0,Jn.jsx)(a.StrictMode,{children:(0,Jn.jsx)(ka,{})}))})();
//# sourceMappingURL=main.f5f098dd.js.map