/*! For license information please see main.336cd9f8.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var s=n(43),a=Symbol.for("react.element"),r=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,l=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var s,r={},c=null,d=null;for(s in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,s)&&!o.hasOwnProperty(s)&&(r[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===r[s]&&(r[s]=t[s]);return{$$typeof:a,type:e,key:c,ref:d,props:r,_owner:l.current}}t.Fragment=r,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),s=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var x=b.prototype=new y;x.constructor=b,p(x,v.prototype),x.isPureReactComponent=!0;var j=Array.isArray,w=Object.prototype.hasOwnProperty,N={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,s){var a,r={},i=null,l=null;if(null!=t)for(a in void 0!==t.ref&&(l=t.ref),void 0!==t.key&&(i=""+t.key),t)w.call(t,a)&&!S.hasOwnProperty(a)&&(r[a]=t[a]);var o=arguments.length-2;if(1===o)r.children=s;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];r.children=c}if(e&&e.defaultProps)for(a in o=e.defaultProps)void 0===r[a]&&(r[a]=o[a]);return{$$typeof:n,type:e,key:i,ref:l,props:r,_owner:N.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var _=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function T(e,t,a,r,i){var l=typeof e;"undefined"!==l&&"boolean"!==l||(e=null);var o=!1;if(null===e)o=!0;else switch(l){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case n:case s:o=!0}}if(o)return i=i(o=e),e=""===r?"."+E(o,0):r,j(i)?(a="",null!=e&&(a=e.replace(_,"$&/")+"/"),T(i,t,a,"",function(e){return e})):null!=i&&(C(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,a+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(_,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=""===r?".":r+":",j(e))for(var c=0;c<e.length;c++){var d=r+E(l=e[c],c);o+=T(l,t,a,d,i)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=m&&e[m]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(l=e.next()).done;)o+=T(l=l.value,t,a,d=r+E(l,c++),i);else if("object"===l)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function P(e,t,n){if(null==e)return e;var s=[],a=0;return T(e,s,"","",function(e){return t.call(n,e,a++)}),s}function O(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},A={transition:null},I={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:A,ReactCurrentOwner:N};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:P,forEach:function(e,t,n){P(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=i,t.PureComponent=b,t.StrictMode=r,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I,t.act=L,t.cloneElement=function(e,t,s){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=p({},e.props),r=e.key,i=e.ref,l=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,l=N.current),void 0!==t.key&&(r=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)w.call(t,c)&&!S.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==o?o[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=s;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];a.children=o}return{$$typeof:n,type:e.type,key:r,ref:i,props:a,_owner:l}},t.createContext=function(e){return(e={$$typeof:o,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:l,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=A.transition;A.transition={};try{e()}finally{A.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},210:function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(n(829)),r=s(n(736));class i{constructor(e){let{headers:t={},schema:n,fetch:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=new Headers(t),this.schemaName=n,this.fetch=s}from(e){const t=new URL("".concat(this.url,"/").concat(e));return new a.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new i(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:n=!1,get:s=!1,count:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i;let l;const o=new URL("".concat(this.url,"/rpc/").concat(e));let c;n||s?(l=n?"HEAD":"GET",Object.entries(t).filter(e=>{let[t,n]=e;return void 0!==n}).map(e=>{let[t,n]=e;return[t,Array.isArray(n)?"{".concat(n.join(","),"}"):"".concat(n)]}).forEach(e=>{let[t,n]=e;o.searchParams.append(t,n)})):(l="POST",c=t);const d=new Headers(this.headers);return a&&d.set("Prefer","count=".concat(a)),new r.default({method:l,url:o,headers:d,schema:this.schemaName,body:c,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}}t.default=i},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var s=n-1>>>1,a=e[s];if(!(0<r(a,t)))break e;e[s]=t,e[n]=a,n=s}}function s(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var s=0,a=e.length,i=a>>>1;s<i;){var l=2*(s+1)-1,o=e[l],c=l+1,d=e[c];if(0>r(o,n))c<a&&0>r(d,o)?(e[s]=d,e[c]=n,s=c):(e[s]=o,e[l]=n,s=l);else{if(!(c<a&&0>r(d,n)))break e;e[s]=d,e[c]=n,s=c}}}return t}function r(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();t.unstable_now=function(){return l.now()-o}}var c=[],d=[],u=1,h=null,m=3,f=!1,p=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=s(d);null!==t;){if(null===t.callback)a(d);else{if(!(t.startTime<=e))break;a(d),t.sortIndex=t.expirationTime,n(c,t)}t=s(d)}}function j(e){if(g=!1,x(e),!p)if(null!==s(c))p=!0,A(w);else{var t=s(d);null!==t&&I(j,t.startTime-e)}}function w(e,n){p=!1,g&&(g=!1,y(C),C=-1),f=!0;var r=m;try{for(x(n),h=s(c);null!==h&&(!(h.expirationTime>n)||e&&!T());){var i=h.callback;if("function"===typeof i){h.callback=null,m=h.priorityLevel;var l=i(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof l?h.callback=l:h===s(c)&&a(c),x(n)}else a(c);h=s(c)}if(null!==h)var o=!0;else{var u=s(d);null!==u&&I(j,u.startTime-n),o=!1}return o}finally{h=null,m=r,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,S=!1,k=null,C=-1,_=5,E=-1;function T(){return!(t.unstable_now()-E<_)}function P(){if(null!==k){var e=t.unstable_now();E=e;var n=!0;try{n=k(!0,e)}finally{n?N():(S=!1,k=null)}}else S=!1}if("function"===typeof b)N=function(){b(P)};else if("undefined"!==typeof MessageChannel){var O=new MessageChannel,R=O.port2;O.port1.onmessage=P,N=function(){R.postMessage(null)}}else N=function(){v(P,0)};function A(e){k=e,S||(S=!0,N())}function I(e,n){C=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,A(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return s(c)},t.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var n=m;m=t;try{return e()}finally{m=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=m;m=e;try{return t()}finally{m=n}},t.unstable_scheduleCallback=function(e,a,r){var i=t.unstable_now();switch("object"===typeof r&&null!==r?r="number"===typeof(r=r.delay)&&0<r?i+r:i:r=i,e){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return e={id:u++,callback:a,priorityLevel:e,startTime:r,expirationTime:l=r+l,sortIndex:-1},r>i?(e.sortIndex=r,n(d,e),null===s(c)&&e===s(d)&&(g?(y(C),C=-1):g=!0,I(j,r-i))):(e.sortIndex=l,n(c,e),p||f||(p=!0,A(w))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=m;return function(){var n=m;m=t;try{return e.apply(this,arguments)}finally{m=n}}}},286:function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(n(630)),r=s(n(611));t.default=class{constructor(e){var t,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(n=e.isMaybeSingle)&&void 0!==n&&n,e.fetch?this.fetch=e.fetch:"undefined"===typeof fetch?this.fetch=a.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let n=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,n,s,a;let i=null,l=null,o=null,c=e.status,d=e.statusText;if(e.ok){if("HEAD"!==this.method){const n=await e.text();""===n||(l="text/csv"===this.headers.get("Accept")||this.headers.get("Accept")&&(null===(t=this.headers.get("Accept"))||void 0===t?void 0:t.includes("application/vnd.pgrst.plan+text"))?n:JSON.parse(n))}const a=null===(n=this.headers.get("Prefer"))||void 0===n?void 0:n.match(/count=(exact|planned|estimated)/),r=null===(s=e.headers.get("content-range"))||void 0===s?void 0:s.split("/");a&&r&&r.length>1&&(o=parseInt(r[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(l)&&(l.length>1?(i={code:"PGRST116",details:"Results contain ".concat(l.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,o=null,c=406,d="Not Acceptable"):l=1===l.length?l[0]:null)}else{const t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(l=[],i=null,c=200,d="OK")}catch(u){404===e.status&&""===t?(c=204,d="No Content"):i={message:t}}if(i&&this.isMaybeSingle&&(null===(a=null===i||void 0===i?void 0:i.details)||void 0===a?void 0:a.includes("0 rows"))&&(i=null,c=200,d="OK"),i&&this.shouldThrowOnError)throw new r.default(i)}return{error:i,data:l,count:o,status:c,statusText:d}});return this.shouldThrowOnError||(n=n.catch(e=>{var t,n,s;return{error:{message:"".concat(null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),details:"".concat(null!==(n=null===e||void 0===e?void 0:e.stack)&&void 0!==n?n:""),hint:"",code:"".concat(null!==(s=null===e||void 0===e?void 0:e.code)&&void 0!==s?s:"")},data:null,count:null,status:0,statusText:""}})),n.then(e,t)}returns(){return this}overrideTypes(){return this}}},374:function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(n(286));class r extends a.default{select(e){let t=!1;const n=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(e){let{ascending:t=!0,nullsFirst:n,foreignTable:s,referencedTable:a=s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=a?"".concat(a,".order"):"order",i=this.url.searchParams.get(r);return this.url.searchParams.set(r,"".concat(i?"".concat(i,","):"").concat(e,".").concat(t?"asc":"desc").concat(void 0===n?"":n?".nullsfirst":".nullslast")),this}limit(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s="undefined"===typeof n?"limit":"".concat(n,".limit");return this.url.searchParams.set(s,"".concat(e)),this}range(e,t){let{foreignTable:n,referencedTable:s=n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a="undefined"===typeof s?"offset":"".concat(s,".offset"),r="undefined"===typeof s?"limit":"".concat(s,".limit");return this.url.searchParams.set(a,"".concat(e)),this.url.searchParams.set(r,"".concat(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain(){let{analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:s=!1,wal:a=!1,format:r="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var i;const l=[e?"analyze":null,t?"verbose":null,n?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),o=null!==(i=this.headers.get("Accept"))&&void 0!==i?i:"application/json";return this.headers.set("Accept","application/vnd.pgrst.plan+".concat(r,'; for="').concat(o,'"; options=').concat(l,";")),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer","max-affected=".concat(e)),this}}t.default=r},391:(e,t,n)=>{var s=n(950);t.createRoot=s.createRoot,t.hydrateRoot=s.hydrateRoot},579:(e,t,n)=>{e.exports=n(153)},611:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=n},630:(e,t,n)=>{n.r(t),n.d(t,{Headers:()=>i,Request:()=>l,Response:()=>o,default:()=>r,fetch:()=>a});var s=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("unable to locate global object")}();const a=s.fetch,r=s.fetch.bind(s),i=s.Headers,l=s.Request,o=s.Response},730:(e,t,n)=>{var s=n(43),a=n(853);function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,l={};function o(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(l[e]=t,e=0;e<t.length;e++)i.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},f={};function p(e,t,n,s,a,r,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=s,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=r,this.removeEmptyString=i}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new p(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new p(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new p(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new p(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new p(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new p(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,s){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:s||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,s){if(null===t||"undefined"===typeof t||function(e,t,n,s){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!s&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,s))return!0;if(s)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,s)&&(n=null),s||null===a?function(e){return!!u.call(f,e)||!u.call(m,e)&&(h.test(e)?f[e]=!0:(m[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,s=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new p(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);g[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)});var x=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,j=Symbol.for("react.element"),w=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),_=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var A=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var I=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=I&&e[I]||e["@@iterator"])?e:null}var D,B=Object.assign;function U(e){if(void 0===D)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var F=!1;function z(e,t){if(!e||F)return"";F=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var s=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){s=c}e.call(t.prototype)}else{try{throw Error()}catch(c){s=c}e()}}catch(c){if(c&&s&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),r=s.stack.split("\n"),i=a.length-1,l=r.length-1;1<=i&&0<=l&&a[i]!==r[l];)l--;for(;1<=i&&0<=l;i--,l--)if(a[i]!==r[l]){if(1!==i||1!==l)do{if(i--,0>--l||a[i]!==r[l]){var o="\n"+a[i].replace(" at new "," at ");return e.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",e.displayName)),o}}while(1<=i&&0<=l);break}}}finally{F=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?U(e):""}function M(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function W(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case w:return"Portal";case k:return"Profiler";case S:return"StrictMode";case T:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case _:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case O:return null!==(t=e.displayName||null)?t:W(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return W(e(t))}catch(n){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function V(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=V(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,r=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){s=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(e){s=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function $(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=V(e)?e.checked?"true":"false":e.value),(e=s)!==n&&(t.setValue(e),!0)}function J(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function G(e,t){var n=t.checked;return B({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Q(e,t){var n=null==t.defaultValue?"":t.defaultValue,s=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){Y(e,t);var n=H(t.value),s=t.type;if(null!=n)"number"===s?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===s||"reset"===s)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!("submit"!==s&&"reset"!==s||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&J(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,s){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&s&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(s&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function se(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(r(91));return B({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(r(92));if(te(n)){if(1<n.length)throw Error(r(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function re(e,t){var n=H(t.value),s=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=s&&(e.defaultValue=""+s)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function le(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function oe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?le(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,s){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var me={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function pe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||me.hasOwnProperty(e)&&me[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var s=0===n.indexOf("--"),a=pe(n,t[n],s);"float"===n&&(n="cssFloat"),s?e.setProperty(n,a):e[n]=a}}Object.keys(me).forEach(function(e){fe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),me[t]=me[e]})});var ve=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(r(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(r(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(r(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function je(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Ne=null,Se=null;function ke(e){if(e=ba(e)){if("function"!==typeof we)throw Error(r(280));var t=e.stateNode;t&&(t=ja(t),we(e.stateNode,e.type,t))}}function Ce(e){Ne?Se?Se.push(e):Se=[e]:Ne=e}function _e(){if(Ne){var e=Ne,t=Se;if(Se=Ne=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function Ee(e,t){return e(t)}function Te(){}var Pe=!1;function Oe(e,t,n){if(Pe)return e(t,n);Pe=!0;try{return Ee(e,t,n)}finally{Pe=!1,(null!==Ne||null!==Se)&&(Te(),_e())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var s=ja(n);if(null===s)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(s=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!s;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(r(231,t,typeof n));return n}var Ae=!1;if(d)try{var Ie={};Object.defineProperty(Ie,"passive",{get:function(){Ae=!0}}),window.addEventListener("test",Ie,Ie),window.removeEventListener("test",Ie,Ie)}catch(de){Ae=!1}function Le(e,t,n,s,a,r,i,l,o){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var De=!1,Be=null,Ue=!1,Fe=null,ze={onError:function(e){De=!0,Be=e}};function Me(e,t,n,s,a,r,i,l,o){De=!1,Be=null,Le.apply(ze,arguments)}function We(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(We(e)!==e)throw Error(r(188))}function Ve(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=We(e)))throw Error(r(188));return t!==e?null:e}for(var n=e,s=t;;){var a=n.return;if(null===a)break;var i=a.alternate;if(null===i){if(null!==(s=a.return)){n=s;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return He(a),e;if(i===s)return He(a),t;i=i.sibling}throw Error(r(188))}if(n.return!==s.return)n=a,s=i;else{for(var l=!1,o=a.child;o;){if(o===n){l=!0,n=a,s=i;break}if(o===s){l=!0,s=a,n=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===n){l=!0,n=i,s=a;break}if(o===s){l=!0,s=i,n=a;break}o=o.sibling}if(!l)throw Error(r(189))}}if(n.alternate!==s)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var $e=a.unstable_scheduleCallback,Je=a.unstable_cancelCallback,Ge=a.unstable_shouldYield,Qe=a.unstable_requestPaint,Ye=a.unstable_now,Xe=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,st=a.unstable_IdlePriority,at=null,rt=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(lt(e)/ot|0)|0},lt=Math.log,ot=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var s=0,a=e.suspendedLanes,r=e.pingedLanes,i=268435455&n;if(0!==i){var l=i&~a;0!==l?s=ut(l):0!==(r&=i)&&(s=ut(r))}else 0!==(i=n&~a)?s=ut(i):0!==r&&(s=ut(r));if(0===s)return 0;if(0!==t&&t!==s&&0===(t&a)&&((a=s&-s)>=(r=t&-t)||16===a&&0!==(4194240&r)))return t;if(0!==(4&s)&&(s|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=s;0<t;)a=1<<(n=31-it(t)),s|=e[n],t&=~a;return s}function mt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-it(n),a=1<<s;a&t|e[s]&t&&(e[s]|=t),n&=~a}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var jt,wt,Nt,St,kt,Ct=!1,_t=[],Et=null,Tt=null,Pt=null,Ot=new Map,Rt=new Map,At=[],It="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":Ot.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Dt(e,t,n,s,a,r){return null===e||e.nativeEvent!==r?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:r,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&wt(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Bt(e){var t=ya(e.target);if(null!==t){var n=We(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void kt(e.priority,function(){Nt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Gt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&wt(t),e.blockedOn=n,!1;var s=new(n=e.nativeEvent).constructor(n.type,n);xe=s,n.target.dispatchEvent(s),xe=null,t.shift()}return!0}function Ft(e,t,n){Ut(e)&&n.delete(t)}function zt(){Ct=!1,null!==Et&&Ut(Et)&&(Et=null),null!==Tt&&Ut(Tt)&&(Tt=null),null!==Pt&&Ut(Pt)&&(Pt=null),Ot.forEach(Ft),Rt.forEach(Ft)}function Mt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,zt)))}function Wt(e){function t(t){return Mt(t,e)}if(0<_t.length){Mt(_t[0],e);for(var n=1;n<_t.length;n++){var s=_t[n];s.blockedOn===e&&(s.blockedOn=null)}}for(null!==Et&&Mt(Et,e),null!==Tt&&Mt(Tt,e),null!==Pt&&Mt(Pt,e),Ot.forEach(t),Rt.forEach(t),n=0;n<At.length;n++)(s=At[n]).blockedOn===e&&(s.blockedOn=null);for(;0<At.length&&null===(n=At[0]).blockedOn;)Bt(n),null===n.blockedOn&&At.shift()}var qt=x.ReactCurrentBatchConfig,Ht=!0;function Vt(e,t,n,s){var a=bt,r=qt.transition;qt.transition=null;try{bt=1,$t(e,t,n,s)}finally{bt=a,qt.transition=r}}function Kt(e,t,n,s){var a=bt,r=qt.transition;qt.transition=null;try{bt=4,$t(e,t,n,s)}finally{bt=a,qt.transition=r}}function $t(e,t,n,s){if(Ht){var a=Gt(e,t,n,s);if(null===a)Hs(e,t,s,Jt,n),Lt(e,s);else if(function(e,t,n,s,a){switch(t){case"focusin":return Et=Dt(Et,e,t,n,s,a),!0;case"dragenter":return Tt=Dt(Tt,e,t,n,s,a),!0;case"mouseover":return Pt=Dt(Pt,e,t,n,s,a),!0;case"pointerover":var r=a.pointerId;return Ot.set(r,Dt(Ot.get(r)||null,e,t,n,s,a)),!0;case"gotpointercapture":return r=a.pointerId,Rt.set(r,Dt(Rt.get(r)||null,e,t,n,s,a)),!0}return!1}(a,e,t,n,s))s.stopPropagation();else if(Lt(e,s),4&t&&-1<It.indexOf(e)){for(;null!==a;){var r=ba(a);if(null!==r&&jt(r),null===(r=Gt(e,t,n,s))&&Hs(e,t,s,Jt,n),r===a)break;a=r}null!==a&&s.stopPropagation()}else Hs(e,t,s,null,n)}}var Jt=null;function Gt(e,t,n,s){if(Jt=null,null!==(e=ya(e=je(s))))if(null===(t=We(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case st:return 536870912;default:return 16}default:return 16}}var Yt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,s=n.length,a="value"in Yt?Yt.value:Yt.textContent,r=a.length;for(e=0;e<s&&n[e]===a[e];e++);var i=s-e;for(t=1;t<=i&&n[s-t]===a[r-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function sn(){return!1}function an(e){function t(t,n,s,a,r){for(var i in this._reactName=t,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(a):a[i]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:sn,this.isPropagationStopped=sn,this}return B(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var rn,ln,on,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=an(cn),un=B({},cn,{view:0,detail:0}),hn=an(un),mn=B({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==on&&(on&&"mousemove"===e.type?(rn=e.screenX-on.screenX,ln=e.screenY-on.screenY):ln=rn=0,on=e),rn)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),fn=an(mn),pn=an(B({},mn,{dataTransfer:0})),gn=an(B({},un,{relatedTarget:0})),vn=an(B({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=B({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),xn=an(B({},cn,{data:0})),jn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Nn[e])&&!!t[e]}function kn(){return Sn}var Cn=B({},un,{key:function(e){if(e.key){var t=jn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),_n=an(Cn),En=an(B({},mn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=an(B({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kn})),Pn=an(B({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),On=B({},mn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=an(On),An=[9,13,27,32],In=d&&"CompositionEvent"in window,Ln=null;d&&"documentMode"in document&&(Ln=document.documentMode);var Dn=d&&"TextEvent"in window&&!Ln,Bn=d&&(!In||Ln&&8<Ln&&11>=Ln),Un=String.fromCharCode(32),Fn=!1;function zn(e,t){switch(e){case"keyup":return-1!==An.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Wn=!1;var qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Vn(e,t,n,s){Ce(s),0<(t=Ks(t,"onChange")).length&&(n=new dn("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var Kn=null,$n=null;function Jn(e){Us(e,0)}function Gn(e){if($(xa(e)))return e}function Qn(e,t){if("change"===e)return t}var Yn=!1;if(d){var Xn;if(d){var Zn="oninput"in document;if(!Zn){var es=document.createElement("div");es.setAttribute("oninput","return;"),Zn="function"===typeof es.oninput}Xn=Zn}else Xn=!1;Yn=Xn&&(!document.documentMode||9<document.documentMode)}function ts(){Kn&&(Kn.detachEvent("onpropertychange",ns),$n=Kn=null)}function ns(e){if("value"===e.propertyName&&Gn($n)){var t=[];Vn(t,$n,e,je(e)),Oe(Jn,t)}}function ss(e,t,n){"focusin"===e?(ts(),$n=n,(Kn=t).attachEvent("onpropertychange",ns)):"focusout"===e&&ts()}function as(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Gn($n)}function rs(e,t){if("click"===e)return Gn(t)}function is(e,t){if("input"===e||"change"===e)return Gn(t)}var ls="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function os(e,t){if(ls(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var a=n[s];if(!u.call(t,a)||!ls(e[a],t[a]))return!1}return!0}function cs(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ds(e,t){var n,s=cs(e);for(e=0;s;){if(3===s.nodeType){if(n=e+s.textContent.length,e<=t&&n>=t)return{node:s,offset:t-e};e=n}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=cs(s)}}function us(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?us(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hs(){for(var e=window,t=J();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(s){n=!1}if(!n)break;t=J((e=t.contentWindow).document)}return t}function ms(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fs(e){var t=hs(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&us(n.ownerDocument.documentElement,n)){if(null!==s&&ms(n))if(t=s.start,void 0===(e=s.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,r=Math.min(s.start,a);s=void 0===s.end?r:Math.min(s.end,a),!e.extend&&r>s&&(a=s,s=r,r=a),a=ds(n,r);var i=ds(n,s);a&&i&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),r>s?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ps=d&&"documentMode"in document&&11>=document.documentMode,gs=null,vs=null,ys=null,bs=!1;function xs(e,t,n){var s=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;bs||null==gs||gs!==J(s)||("selectionStart"in(s=gs)&&ms(s)?s={start:s.selectionStart,end:s.selectionEnd}:s={anchorNode:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset},ys&&os(ys,s)||(ys=s,0<(s=Ks(vs,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=gs)))}function js(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ws={animationend:js("Animation","AnimationEnd"),animationiteration:js("Animation","AnimationIteration"),animationstart:js("Animation","AnimationStart"),transitionend:js("Transition","TransitionEnd")},Ns={},Ss={};function ks(e){if(Ns[e])return Ns[e];if(!ws[e])return e;var t,n=ws[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ss)return Ns[e]=n[t];return e}d&&(Ss=document.createElement("div").style,"AnimationEvent"in window||(delete ws.animationend.animation,delete ws.animationiteration.animation,delete ws.animationstart.animation),"TransitionEvent"in window||delete ws.transitionend.transition);var Cs=ks("animationend"),_s=ks("animationiteration"),Es=ks("animationstart"),Ts=ks("transitionend"),Ps=new Map,Os="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rs(e,t){Ps.set(e,t),o(t,[e])}for(var As=0;As<Os.length;As++){var Is=Os[As];Rs(Is.toLowerCase(),"on"+(Is[0].toUpperCase()+Is.slice(1)))}Rs(Cs,"onAnimationEnd"),Rs(_s,"onAnimationIteration"),Rs(Es,"onAnimationStart"),Rs("dblclick","onDoubleClick"),Rs("focusin","onFocus"),Rs("focusout","onBlur"),Rs(Ts,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ls="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ds=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ls));function Bs(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,s,a,i,l,o,c){if(Me.apply(this,arguments),De){if(!De)throw Error(r(198));var d=Be;De=!1,Be=null,Ue||(Ue=!0,Fe=d)}}(s,t,void 0,e),e.currentTarget=null}function Us(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var s=e[n],a=s.event;s=s.listeners;e:{var r=void 0;if(t)for(var i=s.length-1;0<=i;i--){var l=s[i],o=l.instance,c=l.currentTarget;if(l=l.listener,o!==r&&a.isPropagationStopped())break e;Bs(a,l,c),r=o}else for(i=0;i<s.length;i++){if(o=(l=s[i]).instance,c=l.currentTarget,l=l.listener,o!==r&&a.isPropagationStopped())break e;Bs(a,l,c),r=o}}}if(Ue)throw e=Fe,Ue=!1,Fe=null,e}function Fs(e,t){var n=t[pa];void 0===n&&(n=t[pa]=new Set);var s=e+"__bubble";n.has(s)||(qs(t,e,2,!1),n.add(s))}function zs(e,t,n){var s=0;t&&(s|=4),qs(n,e,s,t)}var Ms="_reactListening"+Math.random().toString(36).slice(2);function Ws(e){if(!e[Ms]){e[Ms]=!0,i.forEach(function(t){"selectionchange"!==t&&(Ds.has(t)||zs(t,!1,e),zs(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ms]||(t[Ms]=!0,zs("selectionchange",!1,t))}}function qs(e,t,n,s){switch(Qt(t)){case 1:var a=Vt;break;case 4:a=Kt;break;default:a=$t}n=a.bind(null,t,n,e),a=void 0,!Ae||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),s?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Hs(e,t,n,s,a){var r=s;if(0===(1&t)&&0===(2&t)&&null!==s)e:for(;;){if(null===s)return;var i=s.tag;if(3===i||4===i){var l=s.stateNode.containerInfo;if(l===a||8===l.nodeType&&l.parentNode===a)break;if(4===i)for(i=s.return;null!==i;){var o=i.tag;if((3===o||4===o)&&((o=i.stateNode.containerInfo)===a||8===o.nodeType&&o.parentNode===a))return;i=i.return}for(;null!==l;){if(null===(i=ya(l)))return;if(5===(o=i.tag)||6===o){s=r=i;continue e}l=l.parentNode}}s=s.return}Oe(function(){var s=r,a=je(n),i=[];e:{var l=Ps.get(e);if(void 0!==l){var o=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":o=_n;break;case"focusin":c="focus",o=gn;break;case"focusout":c="blur",o=gn;break;case"beforeblur":case"afterblur":o=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":o=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":o=pn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":o=Tn;break;case Cs:case _s:case Es:o=vn;break;case Ts:o=Pn;break;case"scroll":o=hn;break;case"wheel":o=Rn;break;case"copy":case"cut":case"paste":o=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":o=En}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==l?l+"Capture":null:l;d=[];for(var m,f=s;null!==f;){var p=(m=f).stateNode;if(5===m.tag&&null!==p&&(m=p,null!==h&&(null!=(p=Re(f,h))&&d.push(Vs(f,p,m)))),u)break;f=f.return}0<d.length&&(l=new o(l,c,null,n,a),i.push({event:l,listeners:d}))}}if(0===(7&t)){if(o="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[fa])&&(o||l)&&(l=a.window===a?a:(l=a.ownerDocument)?l.defaultView||l.parentWindow:window,o?(o=s,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(u=We(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(o=null,c=s),o!==c)){if(d=fn,p="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=En,p="onPointerLeave",h="onPointerEnter",f="pointer"),u=null==o?l:xa(o),m=null==c?l:xa(c),(l=new d(p,f+"leave",o,n,a)).target=u,l.relatedTarget=m,p=null,ya(a)===s&&((d=new d(h,f+"enter",c,n,a)).target=m,d.relatedTarget=u,p=d),u=p,o&&c)e:{for(h=c,f=0,m=d=o;m;m=$s(m))f++;for(m=0,p=h;p;p=$s(p))m++;for(;0<f-m;)d=$s(d),f--;for(;0<m-f;)h=$s(h),m--;for(;f--;){if(d===h||null!==h&&d===h.alternate)break e;d=$s(d),h=$s(h)}d=null}else d=null;null!==o&&Js(i,l,o,d,!1),null!==c&&null!==u&&Js(i,u,c,d,!0)}if("select"===(o=(l=s?xa(s):window).nodeName&&l.nodeName.toLowerCase())||"input"===o&&"file"===l.type)var g=Qn;else if(Hn(l))if(Yn)g=is;else{g=as;var v=ss}else(o=l.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===l.type||"radio"===l.type)&&(g=rs);switch(g&&(g=g(e,s))?Vn(i,g,n,a):(v&&v(e,l,s),"focusout"===e&&(v=l._wrapperState)&&v.controlled&&"number"===l.type&&ee(l,"number",l.value)),v=s?xa(s):window,e){case"focusin":(Hn(v)||"true"===v.contentEditable)&&(gs=v,vs=s,ys=null);break;case"focusout":ys=vs=gs=null;break;case"mousedown":bs=!0;break;case"contextmenu":case"mouseup":case"dragend":bs=!1,xs(i,n,a);break;case"selectionchange":if(ps)break;case"keydown":case"keyup":xs(i,n,a)}var y;if(In)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Wn?zn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Bn&&"ko"!==n.locale&&(Wn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Wn&&(y=en()):(Xt="value"in(Yt=a)?Yt.value:Yt.textContent,Wn=!0)),0<(v=Ks(s,b)).length&&(b=new xn(b,e,null,n,a),i.push({event:b,listeners:v}),y?b.data=y:null!==(y=Mn(n))&&(b.data=y))),(y=Dn?function(e,t){switch(e){case"compositionend":return Mn(t);case"keypress":return 32!==t.which?null:(Fn=!0,Un);case"textInput":return(e=t.data)===Un&&Fn?null:e;default:return null}}(e,n):function(e,t){if(Wn)return"compositionend"===e||!In&&zn(e,t)?(e=en(),Zt=Xt=Yt=null,Wn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(s=Ks(s,"onBeforeInput")).length&&(a=new xn("onBeforeInput","beforeinput",null,n,a),i.push({event:a,listeners:s}),a.data=y))}Us(i,t)})}function Vs(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ks(e,t){for(var n=t+"Capture",s=[];null!==e;){var a=e,r=a.stateNode;5===a.tag&&null!==r&&(a=r,null!=(r=Re(e,n))&&s.unshift(Vs(e,r,a)),null!=(r=Re(e,t))&&s.push(Vs(e,r,a))),e=e.return}return s}function $s(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Js(e,t,n,s,a){for(var r=t._reactName,i=[];null!==n&&n!==s;){var l=n,o=l.alternate,c=l.stateNode;if(null!==o&&o===s)break;5===l.tag&&null!==c&&(l=c,a?null!=(o=Re(n,r))&&i.unshift(Vs(n,o,l)):a||null!=(o=Re(n,r))&&i.push(Vs(n,o,l))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Gs=/\r\n?/g,Qs=/\u0000|\uFFFD/g;function Ys(e){return("string"===typeof e?e:""+e).replace(Gs,"\n").replace(Qs,"")}function Xs(e,t,n){if(t=Ys(t),Ys(e)!==t&&n)throw Error(r(425))}function Zs(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var sa="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ra="function"===typeof Promise?Promise:void 0,ia="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ra?function(e){return ra.resolve(null).then(e).catch(la)}:sa;function la(e){setTimeout(function(){throw e})}function oa(e,t){var n=t,s=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===s)return e.removeChild(a),void Wt(t);s--}else"$"!==n&&"$?"!==n&&"$!"!==n||s++;n=a}while(n);Wt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function da(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ua=Math.random().toString(36).slice(2),ha="__reactFiber$"+ua,ma="__reactProps$"+ua,fa="__reactContainer$"+ua,pa="__reactEvents$"+ua,ga="__reactListeners$"+ua,va="__reactHandles$"+ua;function ya(e){var t=e[ha];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fa]||n[ha]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=da(e);null!==e;){if(n=e[ha])return n;e=da(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[ha]||e[fa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(r(33))}function ja(e){return e[ma]||null}var wa=[],Na=-1;function Sa(e){return{current:e}}function ka(e){0>Na||(e.current=wa[Na],wa[Na]=null,Na--)}function Ca(e,t){Na++,wa[Na]=e.current,e.current=t}var _a={},Ea=Sa(_a),Ta=Sa(!1),Pa=_a;function Oa(e,t){var n=e.type.contextTypes;if(!n)return _a;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var a,r={};for(a in n)r[a]=t[a];return s&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Ra(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Aa(){ka(Ta),ka(Ea)}function Ia(e,t,n){if(Ea.current!==_a)throw Error(r(168));Ca(Ea,t),Ca(Ta,n)}function La(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,"function"!==typeof s.getChildContext)return n;for(var a in s=s.getChildContext())if(!(a in t))throw Error(r(108,q(e)||"Unknown",a));return B({},n,s)}function Da(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_a,Pa=Ea.current,Ca(Ea,e),Ca(Ta,Ta.current),!0}function Ba(e,t,n){var s=e.stateNode;if(!s)throw Error(r(169));n?(e=La(e,t,Pa),s.__reactInternalMemoizedMergedChildContext=e,ka(Ta),ka(Ea),Ca(Ea,e)):ka(Ta),Ca(Ta,n)}var Ua=null,Fa=!1,za=!1;function Ma(e){null===Ua?Ua=[e]:Ua.push(e)}function Wa(){if(!za&&null!==Ua){za=!0;var e=0,t=bt;try{var n=Ua;for(bt=1;e<n.length;e++){var s=n[e];do{s=s(!0)}while(null!==s)}Ua=null,Fa=!1}catch(a){throw null!==Ua&&(Ua=Ua.slice(e+1)),$e(Ze,Wa),a}finally{bt=t,za=!1}}return null}var qa=[],Ha=0,Va=null,Ka=0,$a=[],Ja=0,Ga=null,Qa=1,Ya="";function Xa(e,t){qa[Ha++]=Ka,qa[Ha++]=Va,Va=e,Ka=t}function Za(e,t,n){$a[Ja++]=Qa,$a[Ja++]=Ya,$a[Ja++]=Ga,Ga=e;var s=Qa;e=Ya;var a=32-it(s)-1;s&=~(1<<a),n+=1;var r=32-it(t)+a;if(30<r){var i=a-a%5;r=(s&(1<<i)-1).toString(32),s>>=i,a-=i,Qa=1<<32-it(t)+a|n<<a|s,Ya=r+e}else Qa=1<<r|n<<a|s,Ya=e}function er(e){null!==e.return&&(Xa(e,1),Za(e,1,0))}function tr(e){for(;e===Va;)Va=qa[--Ha],qa[Ha]=null,Ka=qa[--Ha],qa[Ha]=null;for(;e===Ga;)Ga=$a[--Ja],$a[Ja]=null,Ya=$a[--Ja],$a[Ja]=null,Qa=$a[--Ja],$a[Ja]=null}var nr=null,sr=null,ar=!1,rr=null;function ir(e,t){var n=Oc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function lr(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,nr=e,sr=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,nr=e,sr=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ga?{id:Qa,overflow:Ya}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Oc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,nr=e,sr=null,!0);default:return!1}}function or(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cr(e){if(ar){var t=sr;if(t){var n=t;if(!lr(e,t)){if(or(e))throw Error(r(418));t=ca(n.nextSibling);var s=nr;t&&lr(e,t)?ir(s,n):(e.flags=-4097&e.flags|2,ar=!1,nr=e)}}else{if(or(e))throw Error(r(418));e.flags=-4097&e.flags|2,ar=!1,nr=e}}}function dr(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;nr=e}function ur(e){if(e!==nr)return!1;if(!ar)return dr(e),ar=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=sr)){if(or(e))throw hr(),Error(r(418));for(;t;)ir(e,t),t=ca(t.nextSibling)}if(dr(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){sr=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}sr=null}}else sr=nr?ca(e.stateNode.nextSibling):null;return!0}function hr(){for(var e=sr;e;)e=ca(e.nextSibling)}function mr(){sr=nr=null,ar=!1}function fr(e){null===rr?rr=[e]:rr.push(e)}var pr=x.ReactCurrentBatchConfig;function gr(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(r(309));var s=n.stateNode}if(!s)throw Error(r(147,e));var a=s,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=a.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(r(284));if(!n._owner)throw Error(r(290,e))}return e}function vr(e,t){throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yr(e){return(0,e._init)(e._payload)}function br(e){function t(t,n){if(e){var s=t.deletions;null===s?(t.deletions=[n],t.flags|=16):s.push(n)}}function n(n,s){if(!e)return null;for(;null!==s;)t(n,s),s=s.sibling;return null}function s(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Ac(e,t)).index=0,e.sibling=null,e}function i(t,n,s){return t.index=s,e?null!==(s=t.alternate)?(s=s.index)<n?(t.flags|=2,n):s:(t.flags|=2,n):(t.flags|=1048576,n)}function l(t){return e&&null===t.alternate&&(t.flags|=2),t}function o(e,t,n,s){return null===t||6!==t.tag?((t=Bc(n,e.mode,s)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,s){var r=n.type;return r===N?u(e,t,n.props.children,s,n.key):null!==t&&(t.elementType===r||"object"===typeof r&&null!==r&&r.$$typeof===R&&yr(r)===t.type)?((s=a(t,n.props)).ref=gr(e,t,n),s.return=e,s):((s=Ic(n.type,n.key,n.props,null,e.mode,s)).ref=gr(e,t,n),s.return=e,s)}function d(e,t,n,s){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Uc(n,e.mode,s)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function u(e,t,n,s,r){return null===t||7!==t.tag?((t=Lc(n,e.mode,s,r)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Bc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case j:return(n=Ic(t.type,t.key,t.props,null,e.mode,n)).ref=gr(e,null,t),n.return=e,n;case w:return(t=Uc(t,e.mode,n)).return=e,t;case R:return h(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Lc(t,e.mode,n,null)).return=e,t;vr(e,t)}return null}function m(e,t,n,s){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:o(e,t,""+n,s);if("object"===typeof n&&null!==n){switch(n.$$typeof){case j:return n.key===a?c(e,t,n,s):null;case w:return n.key===a?d(e,t,n,s):null;case R:return m(e,t,(a=n._init)(n._payload),s)}if(te(n)||L(n))return null!==a?null:u(e,t,n,s,null);vr(e,n)}return null}function f(e,t,n,s,a){if("string"===typeof s&&""!==s||"number"===typeof s)return o(t,e=e.get(n)||null,""+s,a);if("object"===typeof s&&null!==s){switch(s.$$typeof){case j:return c(t,e=e.get(null===s.key?n:s.key)||null,s,a);case w:return d(t,e=e.get(null===s.key?n:s.key)||null,s,a);case R:return f(e,t,n,(0,s._init)(s._payload),a)}if(te(s)||L(s))return u(t,e=e.get(n)||null,s,a,null);vr(t,s)}return null}function p(a,r,l,o){for(var c=null,d=null,u=r,p=r=0,g=null;null!==u&&p<l.length;p++){u.index>p?(g=u,u=null):g=u.sibling;var v=m(a,u,l[p],o);if(null===v){null===u&&(u=g);break}e&&u&&null===v.alternate&&t(a,u),r=i(v,r,p),null===d?c=v:d.sibling=v,d=v,u=g}if(p===l.length)return n(a,u),ar&&Xa(a,p),c;if(null===u){for(;p<l.length;p++)null!==(u=h(a,l[p],o))&&(r=i(u,r,p),null===d?c=u:d.sibling=u,d=u);return ar&&Xa(a,p),c}for(u=s(a,u);p<l.length;p++)null!==(g=f(u,a,p,l[p],o))&&(e&&null!==g.alternate&&u.delete(null===g.key?p:g.key),r=i(g,r,p),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach(function(e){return t(a,e)}),ar&&Xa(a,p),c}function g(a,l,o,c){var d=L(o);if("function"!==typeof d)throw Error(r(150));if(null==(o=d.call(o)))throw Error(r(151));for(var u=d=null,p=l,g=l=0,v=null,y=o.next();null!==p&&!y.done;g++,y=o.next()){p.index>g?(v=p,p=null):v=p.sibling;var b=m(a,p,y.value,c);if(null===b){null===p&&(p=v);break}e&&p&&null===b.alternate&&t(a,p),l=i(b,l,g),null===u?d=b:u.sibling=b,u=b,p=v}if(y.done)return n(a,p),ar&&Xa(a,g),d;if(null===p){for(;!y.done;g++,y=o.next())null!==(y=h(a,y.value,c))&&(l=i(y,l,g),null===u?d=y:u.sibling=y,u=y);return ar&&Xa(a,g),d}for(p=s(a,p);!y.done;g++,y=o.next())null!==(y=f(p,a,g,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?g:y.key),l=i(y,l,g),null===u?d=y:u.sibling=y,u=y);return e&&p.forEach(function(e){return t(a,e)}),ar&&Xa(a,g),d}return function e(s,r,i,o){if("object"===typeof i&&null!==i&&i.type===N&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case j:e:{for(var c=i.key,d=r;null!==d;){if(d.key===c){if((c=i.type)===N){if(7===d.tag){n(s,d.sibling),(r=a(d,i.props.children)).return=s,s=r;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===R&&yr(c)===d.type){n(s,d.sibling),(r=a(d,i.props)).ref=gr(s,d,i),r.return=s,s=r;break e}n(s,d);break}t(s,d),d=d.sibling}i.type===N?((r=Lc(i.props.children,s.mode,o,i.key)).return=s,s=r):((o=Ic(i.type,i.key,i.props,null,s.mode,o)).ref=gr(s,r,i),o.return=s,s=o)}return l(s);case w:e:{for(d=i.key;null!==r;){if(r.key===d){if(4===r.tag&&r.stateNode.containerInfo===i.containerInfo&&r.stateNode.implementation===i.implementation){n(s,r.sibling),(r=a(r,i.children||[])).return=s,s=r;break e}n(s,r);break}t(s,r),r=r.sibling}(r=Uc(i,s.mode,o)).return=s,s=r}return l(s);case R:return e(s,r,(d=i._init)(i._payload),o)}if(te(i))return p(s,r,i,o);if(L(i))return g(s,r,i,o);vr(s,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==r&&6===r.tag?(n(s,r.sibling),(r=a(r,i)).return=s,s=r):(n(s,r),(r=Bc(i,s.mode,o)).return=s,s=r),l(s)):n(s,r)}}var xr=br(!0),jr=br(!1),wr=Sa(null),Nr=null,Sr=null,kr=null;function Cr(){kr=Sr=Nr=null}function _r(e){var t=wr.current;ka(wr),e._currentValue=t}function Er(e,t,n){for(;null!==e;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==s&&(s.childLanes|=t)):null!==s&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function Tr(e,t){Nr=e,kr=Sr=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(yl=!0),e.firstContext=null)}function Pr(e){var t=e._currentValue;if(kr!==e)if(e={context:e,memoizedValue:t,next:null},null===Sr){if(null===Nr)throw Error(r(308));Sr=e,Nr.dependencies={lanes:0,firstContext:e}}else Sr=Sr.next=e;return t}var Or=null;function Rr(e){null===Or?Or=[e]:Or.push(e)}function Ar(e,t,n,s){var a=t.interleaved;return null===a?(n.next=n,Rr(t)):(n.next=a.next,a.next=n),t.interleaved=n,Ir(e,s)}function Ir(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Lr=!1;function Dr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Br(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ur(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Fr(e,t,n){var s=e.updateQueue;if(null===s)return null;if(s=s.shared,0!==(2&Eo)){var a=s.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),s.pending=t,Ir(e,n)}return null===(a=s.interleaved)?(t.next=t,Rr(s)):(t.next=a.next,a.next=t),s.interleaved=t,Ir(e,n)}function zr(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var s=t.lanes;n|=s&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Mr(e,t){var n=e.updateQueue,s=e.alternate;if(null!==s&&n===(s=s.updateQueue)){var a=null,r=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===r?a=r=i:r=r.next=i,n=n.next}while(null!==n);null===r?a=r=t:r=r.next=t}else a=r=t;return n={baseState:s.baseState,firstBaseUpdate:a,lastBaseUpdate:r,shared:s.shared,effects:s.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Wr(e,t,n,s){var a=e.updateQueue;Lr=!1;var r=a.firstBaseUpdate,i=a.lastBaseUpdate,l=a.shared.pending;if(null!==l){a.shared.pending=null;var o=l,c=o.next;o.next=null,null===i?r=c:i.next=c,i=o;var d=e.alternate;null!==d&&((l=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===l?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=o))}if(null!==r){var u=a.baseState;for(i=0,d=c=o=null,l=r;;){var h=l.lane,m=l.eventTime;if((s&h)===h){null!==d&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var f=e,p=l;switch(h=t,m=n,p.tag){case 1:if("function"===typeof(f=p.payload)){u=f.call(m,u,h);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=p.payload)?f.call(m,u,h):f)||void 0===h)break e;u=B({},u,h);break e;case 2:Lr=!0}}null!==l.callback&&0!==l.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[l]:h.push(l))}else m={eventTime:m,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===d?(c=d=m,o=u):d=d.next=m,i|=h;if(null===(l=l.next)){if(null===(l=a.shared.pending))break;l=(h=l).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===d&&(o=u),a.baseState=o,a.firstBaseUpdate=c,a.lastBaseUpdate=d,null!==(t=a.shared.interleaved)){a=t;do{i|=a.lane,a=a.next}while(a!==t)}else null===r&&(a.shared.lanes=0);Do|=i,e.lanes=i,e.memoizedState=u}}function qr(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var s=e[t],a=s.callback;if(null!==a){if(s.callback=null,s=n,"function"!==typeof a)throw Error(r(191,a));a.call(s)}}}var Hr={},Vr=Sa(Hr),Kr=Sa(Hr),$r=Sa(Hr);function Jr(e){if(e===Hr)throw Error(r(174));return e}function Gr(e,t){switch(Ca($r,t),Ca(Kr,e),Ca(Vr,Hr),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:oe(null,"");break;default:t=oe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ka(Vr),Ca(Vr,t)}function Qr(){ka(Vr),ka(Kr),ka($r)}function Yr(e){Jr($r.current);var t=Jr(Vr.current),n=oe(t,e.type);t!==n&&(Ca(Kr,e),Ca(Vr,n))}function Xr(e){Kr.current===e&&(ka(Vr),ka(Kr))}var Zr=Sa(0);function ei(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ti=[];function ni(){for(var e=0;e<ti.length;e++)ti[e]._workInProgressVersionPrimary=null;ti.length=0}var si=x.ReactCurrentDispatcher,ai=x.ReactCurrentBatchConfig,ri=0,ii=null,li=null,oi=null,ci=!1,di=!1,ui=0,hi=0;function mi(){throw Error(r(321))}function fi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ls(e[n],t[n]))return!1;return!0}function pi(e,t,n,s,a,i){if(ri=i,ii=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,si.current=null===e||null===e.memoizedState?Xi:Zi,e=n(s,a),di){i=0;do{if(di=!1,ui=0,25<=i)throw Error(r(301));i+=1,oi=li=null,t.updateQueue=null,si.current=el,e=n(s,a)}while(di)}if(si.current=Yi,t=null!==li&&null!==li.next,ri=0,oi=li=ii=null,ci=!1,t)throw Error(r(300));return e}function gi(){var e=0!==ui;return ui=0,e}function vi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===oi?ii.memoizedState=oi=e:oi=oi.next=e,oi}function yi(){if(null===li){var e=ii.alternate;e=null!==e?e.memoizedState:null}else e=li.next;var t=null===oi?ii.memoizedState:oi.next;if(null!==t)oi=t,li=e;else{if(null===e)throw Error(r(310));e={memoizedState:(li=e).memoizedState,baseState:li.baseState,baseQueue:li.baseQueue,queue:li.queue,next:null},null===oi?ii.memoizedState=oi=e:oi=oi.next=e}return oi}function bi(e,t){return"function"===typeof t?t(e):t}function xi(e){var t=yi(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var s=li,a=s.baseQueue,i=n.pending;if(null!==i){if(null!==a){var l=a.next;a.next=i.next,i.next=l}s.baseQueue=a=i,n.pending=null}if(null!==a){i=a.next,s=s.baseState;var o=l=null,c=null,d=i;do{var u=d.lane;if((ri&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:e(s,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(o=c=h,l=s):c=c.next=h,ii.lanes|=u,Do|=u}d=d.next}while(null!==d&&d!==i);null===c?l=s:c.next=o,ls(s,t.memoizedState)||(yl=!0),t.memoizedState=s,t.baseState=l,t.baseQueue=c,n.lastRenderedState=s}if(null!==(e=n.interleaved)){a=e;do{i=a.lane,ii.lanes|=i,Do|=i,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ji(e){var t=yi(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var s=n.dispatch,a=n.pending,i=t.memoizedState;if(null!==a){n.pending=null;var l=a=a.next;do{i=e(i,l.action),l=l.next}while(l!==a);ls(i,t.memoizedState)||(yl=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,s]}function wi(){}function Ni(e,t){var n=ii,s=yi(),a=t(),i=!ls(s.memoizedState,a);if(i&&(s.memoizedState=a,yl=!0),s=s.queue,Li(Ci.bind(null,n,s,e),[e]),s.getSnapshot!==t||i||null!==oi&&1&oi.memoizedState.tag){if(n.flags|=2048,Pi(9,ki.bind(null,n,s,a,t),void 0,null),null===To)throw Error(r(349));0!==(30&ri)||Si(n,t,a)}return a}function Si(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ki(e,t,n,s){t.value=n,t.getSnapshot=s,_i(t)&&Ei(e)}function Ci(e,t,n){return n(function(){_i(t)&&Ei(e)})}function _i(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ls(e,n)}catch(s){return!0}}function Ei(e){var t=Ir(e,1);null!==t&&nc(t,e,1,-1)}function Ti(e){var t=vi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bi,lastRenderedState:e},t.queue=e,e=e.dispatch=$i.bind(null,ii,e),[t.memoizedState,e]}function Pi(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e),e}function Oi(){return yi().memoizedState}function Ri(e,t,n,s){var a=vi();ii.flags|=e,a.memoizedState=Pi(1|t,n,void 0,void 0===s?null:s)}function Ai(e,t,n,s){var a=yi();s=void 0===s?null:s;var r=void 0;if(null!==li){var i=li.memoizedState;if(r=i.destroy,null!==s&&fi(s,i.deps))return void(a.memoizedState=Pi(t,n,r,s))}ii.flags|=e,a.memoizedState=Pi(1|t,n,r,s)}function Ii(e,t){return Ri(8390656,8,e,t)}function Li(e,t){return Ai(2048,8,e,t)}function Di(e,t){return Ai(4,2,e,t)}function Bi(e,t){return Ai(4,4,e,t)}function Ui(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Fi(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ai(4,4,Ui.bind(null,t,e),n)}function zi(){}function Mi(e,t){var n=yi();t=void 0===t?null:t;var s=n.memoizedState;return null!==s&&null!==t&&fi(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function Wi(e,t){var n=yi();t=void 0===t?null:t;var s=n.memoizedState;return null!==s&&null!==t&&fi(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function qi(e,t,n){return 0===(21&ri)?(e.baseState&&(e.baseState=!1,yl=!0),e.memoizedState=n):(ls(n,t)||(n=pt(),ii.lanes|=n,Do|=n,e.baseState=!0),t)}function Hi(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var s=ai.transition;ai.transition={};try{e(!1),t()}finally{bt=n,ai.transition=s}}function Vi(){return yi().memoizedState}function Ki(e,t,n){var s=tc(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},Ji(e))Gi(t,n);else if(null!==(n=Ar(e,t,n,s))){nc(n,e,s,ec()),Qi(n,t,s)}}function $i(e,t,n){var s=tc(e),a={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ji(e))Gi(t,a);else{var r=e.alternate;if(0===e.lanes&&(null===r||0===r.lanes)&&null!==(r=t.lastRenderedReducer))try{var i=t.lastRenderedState,l=r(i,n);if(a.hasEagerState=!0,a.eagerState=l,ls(l,i)){var o=t.interleaved;return null===o?(a.next=a,Rr(t)):(a.next=o.next,o.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Ar(e,t,a,s))&&(nc(n,e,s,a=ec()),Qi(n,t,s))}}function Ji(e){var t=e.alternate;return e===ii||null!==t&&t===ii}function Gi(e,t){di=ci=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Qi(e,t,n){if(0!==(4194240&n)){var s=t.lanes;n|=s&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Yi={readContext:Pr,useCallback:mi,useContext:mi,useEffect:mi,useImperativeHandle:mi,useInsertionEffect:mi,useLayoutEffect:mi,useMemo:mi,useReducer:mi,useRef:mi,useState:mi,useDebugValue:mi,useDeferredValue:mi,useTransition:mi,useMutableSource:mi,useSyncExternalStore:mi,useId:mi,unstable_isNewReconciler:!1},Xi={readContext:Pr,useCallback:function(e,t){return vi().memoizedState=[e,void 0===t?null:t],e},useContext:Pr,useEffect:Ii,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ri(4194308,4,Ui.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ri(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ri(4,2,e,t)},useMemo:function(e,t){var n=vi();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=vi();return t=void 0!==n?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=Ki.bind(null,ii,e),[s.memoizedState,e]},useRef:function(e){return e={current:e},vi().memoizedState=e},useState:Ti,useDebugValue:zi,useDeferredValue:function(e){return vi().memoizedState=e},useTransition:function(){var e=Ti(!1),t=e[0];return e=Hi.bind(null,e[1]),vi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=ii,a=vi();if(ar){if(void 0===n)throw Error(r(407));n=n()}else{if(n=t(),null===To)throw Error(r(349));0!==(30&ri)||Si(s,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,Ii(Ci.bind(null,s,i,e),[e]),s.flags|=2048,Pi(9,ki.bind(null,s,i,n,t),void 0,null),n},useId:function(){var e=vi(),t=To.identifierPrefix;if(ar){var n=Ya;t=":"+t+"R"+(n=(Qa&~(1<<32-it(Qa)-1)).toString(32)+n),0<(n=ui++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=hi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zi={readContext:Pr,useCallback:Mi,useContext:Pr,useEffect:Li,useImperativeHandle:Fi,useInsertionEffect:Di,useLayoutEffect:Bi,useMemo:Wi,useReducer:xi,useRef:Oi,useState:function(){return xi(bi)},useDebugValue:zi,useDeferredValue:function(e){return qi(yi(),li.memoizedState,e)},useTransition:function(){return[xi(bi)[0],yi().memoizedState]},useMutableSource:wi,useSyncExternalStore:Ni,useId:Vi,unstable_isNewReconciler:!1},el={readContext:Pr,useCallback:Mi,useContext:Pr,useEffect:Li,useImperativeHandle:Fi,useInsertionEffect:Di,useLayoutEffect:Bi,useMemo:Wi,useReducer:ji,useRef:Oi,useState:function(){return ji(bi)},useDebugValue:zi,useDeferredValue:function(e){var t=yi();return null===li?t.memoizedState=e:qi(t,li.memoizedState,e)},useTransition:function(){return[ji(bi)[0],yi().memoizedState]},useMutableSource:wi,useSyncExternalStore:Ni,useId:Vi,unstable_isNewReconciler:!1};function tl(e,t){if(e&&e.defaultProps){for(var n in t=B({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function nl(e,t,n,s){n=null===(n=n(s,t=e.memoizedState))||void 0===n?t:B({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var sl={isMounted:function(e){return!!(e=e._reactInternals)&&We(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=ec(),a=tc(e),r=Ur(s,a);r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=Fr(e,r,a))&&(nc(t,e,a,s),zr(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=ec(),a=tc(e),r=Ur(s,a);r.tag=1,r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=Fr(e,r,a))&&(nc(t,e,a,s),zr(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),s=tc(e),a=Ur(n,s);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Fr(e,a,s))&&(nc(t,e,s,n),zr(t,e,s))}};function al(e,t,n,s,a,r,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(s,r,i):!t.prototype||!t.prototype.isPureReactComponent||(!os(n,s)||!os(a,r))}function rl(e,t,n){var s=!1,a=_a,r=t.contextType;return"object"===typeof r&&null!==r?r=Pr(r):(a=Ra(t)?Pa:Ea.current,r=(s=null!==(s=t.contextTypes)&&void 0!==s)?Oa(e,a):_a),t=new t(n,r),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=sl,e.stateNode=t,t._reactInternals=e,s&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=r),t}function il(e,t,n,s){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,s),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&sl.enqueueReplaceState(t,t.state,null)}function ll(e,t,n,s){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Dr(e);var r=t.contextType;"object"===typeof r&&null!==r?a.context=Pr(r):(r=Ra(t)?Pa:Ea.current,a.context=Oa(e,r)),a.state=e.memoizedState,"function"===typeof(r=t.getDerivedStateFromProps)&&(nl(e,t,r,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&sl.enqueueReplaceState(a,a.state,null),Wr(e,n,a,s),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function ol(e,t){try{var n="",s=t;do{n+=M(s),s=s.return}while(s);var a=n}catch(r){a="\nError generating stack: "+r.message+"\n"+r.stack}return{value:e,source:t,stack:a,digest:null}}function cl(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function dl(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ul="function"===typeof WeakMap?WeakMap:Map;function hl(e,t,n){(n=Ur(-1,n)).tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){Ho||(Ho=!0,Vo=s),dl(0,t)},n}function ml(e,t,n){(n=Ur(-1,n)).tag=3;var s=e.type.getDerivedStateFromError;if("function"===typeof s){var a=t.value;n.payload=function(){return s(a)},n.callback=function(){dl(0,t)}}var r=e.stateNode;return null!==r&&"function"===typeof r.componentDidCatch&&(n.callback=function(){dl(0,t),"function"!==typeof s&&(null===Ko?Ko=new Set([this]):Ko.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function fl(e,t,n){var s=e.pingCache;if(null===s){s=e.pingCache=new ul;var a=new Set;s.set(t,a)}else void 0===(a=s.get(t))&&(a=new Set,s.set(t,a));a.has(n)||(a.add(n),e=kc.bind(null,e,t,n),t.then(e,e))}function pl(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function gl(e,t,n,s,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ur(-1,1)).tag=2,Fr(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var vl=x.ReactCurrentOwner,yl=!1;function bl(e,t,n,s){t.child=null===e?jr(t,null,n,s):xr(t,e.child,n,s)}function xl(e,t,n,s,a){n=n.render;var r=t.ref;return Tr(t,a),s=pi(e,t,n,s,r,a),n=gi(),null===e||yl?(ar&&n&&er(t),t.flags|=1,bl(e,t,s,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ql(e,t,a))}function jl(e,t,n,s,a){if(null===e){var r=n.type;return"function"!==typeof r||Rc(r)||void 0!==r.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Ic(n.type,null,s,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=r,wl(e,t,r,s,a))}if(r=e.child,0===(e.lanes&a)){var i=r.memoizedProps;if((n=null!==(n=n.compare)?n:os)(i,s)&&e.ref===t.ref)return ql(e,t,a)}return t.flags|=1,(e=Ac(r,s)).ref=t.ref,e.return=t,t.child=e}function wl(e,t,n,s,a){if(null!==e){var r=e.memoizedProps;if(os(r,s)&&e.ref===t.ref){if(yl=!1,t.pendingProps=s=r,0===(e.lanes&a))return t.lanes=e.lanes,ql(e,t,a);0!==(131072&e.flags)&&(yl=!0)}}return kl(e,t,n,s,a)}function Nl(e,t,n){var s=t.pendingProps,a=s.children,r=null!==e?e.memoizedState:null;if("hidden"===s.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ca(Ao,Ro),Ro|=n;else{if(0===(1073741824&n))return e=null!==r?r.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ca(Ao,Ro),Ro|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=null!==r?r.baseLanes:n,Ca(Ao,Ro),Ro|=s}else null!==r?(s=r.baseLanes|n,t.memoizedState=null):s=n,Ca(Ao,Ro),Ro|=s;return bl(e,t,a,n),t.child}function Sl(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function kl(e,t,n,s,a){var r=Ra(n)?Pa:Ea.current;return r=Oa(t,r),Tr(t,a),n=pi(e,t,n,s,r,a),s=gi(),null===e||yl?(ar&&s&&er(t),t.flags|=1,bl(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ql(e,t,a))}function Cl(e,t,n,s,a){if(Ra(n)){var r=!0;Da(t)}else r=!1;if(Tr(t,a),null===t.stateNode)Wl(e,t),rl(t,n,s),ll(t,n,s,a),s=!0;else if(null===e){var i=t.stateNode,l=t.memoizedProps;i.props=l;var o=i.context,c=n.contextType;"object"===typeof c&&null!==c?c=Pr(c):c=Oa(t,c=Ra(n)?Pa:Ea.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate;u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(l!==s||o!==c)&&il(t,i,s,c),Lr=!1;var h=t.memoizedState;i.state=h,Wr(t,s,i,a),o=t.memoizedState,l!==s||h!==o||Ta.current||Lr?("function"===typeof d&&(nl(t,n,d,s),o=t.memoizedState),(l=Lr||al(t,n,l,s,h,o,c))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=o),i.props=s,i.state=o,i.context=c,s=l):("function"===typeof i.componentDidMount&&(t.flags|=4194308),s=!1)}else{i=t.stateNode,Br(e,t),l=t.memoizedProps,c=t.type===t.elementType?l:tl(t.type,l),i.props=c,u=t.pendingProps,h=i.context,"object"===typeof(o=n.contextType)&&null!==o?o=Pr(o):o=Oa(t,o=Ra(n)?Pa:Ea.current);var m=n.getDerivedStateFromProps;(d="function"===typeof m||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(l!==u||h!==o)&&il(t,i,s,o),Lr=!1,h=t.memoizedState,i.state=h,Wr(t,s,i,a);var f=t.memoizedState;l!==u||h!==f||Ta.current||Lr?("function"===typeof m&&(nl(t,n,m,s),f=t.memoizedState),(c=Lr||al(t,n,c,s,h,f,o)||!1)?(d||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(s,f,o),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(s,f,o)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=f),i.props=s,i.state=f,i.context=o,s=c):("function"!==typeof i.componentDidUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),s=!1)}return _l(e,t,n,s,r,a)}function _l(e,t,n,s,a,r){Sl(e,t);var i=0!==(128&t.flags);if(!s&&!i)return a&&Ba(t,n,!1),ql(e,t,r);s=t.stateNode,vl.current=t;var l=i&&"function"!==typeof n.getDerivedStateFromError?null:s.render();return t.flags|=1,null!==e&&i?(t.child=xr(t,e.child,null,r),t.child=xr(t,null,l,r)):bl(e,t,l,r),t.memoizedState=s.state,a&&Ba(t,n,!0),t.child}function El(e){var t=e.stateNode;t.pendingContext?Ia(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ia(0,t.context,!1),Gr(e,t.containerInfo)}function Tl(e,t,n,s,a){return mr(),fr(a),t.flags|=256,bl(e,t,n,s),t.child}var Pl,Ol,Rl,Al,Il={dehydrated:null,treeContext:null,retryLane:0};function Ll(e){return{baseLanes:e,cachePool:null,transitions:null}}function Dl(e,t,n){var s,a=t.pendingProps,i=Zr.current,l=!1,o=0!==(128&t.flags);if((s=o)||(s=(null===e||null!==e.memoizedState)&&0!==(2&i)),s?(l=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Ca(Zr,1&i),null===e)return cr(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(o=a.children,e=a.fallback,l?(a=t.mode,l=t.child,o={mode:"hidden",children:o},0===(1&a)&&null!==l?(l.childLanes=0,l.pendingProps=o):l=Dc(o,a,0,null),e=Lc(e,a,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=Ll(n),t.memoizedState=Il,e):Bl(t,o));if(null!==(i=e.memoizedState)&&null!==(s=i.dehydrated))return function(e,t,n,s,a,i,l){if(n)return 256&t.flags?(t.flags&=-257,Ul(e,t,l,s=cl(Error(r(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=s.fallback,a=t.mode,s=Dc({mode:"visible",children:s.children},a,0,null),(i=Lc(i,a,l,null)).flags|=2,s.return=t,i.return=t,s.sibling=i,t.child=s,0!==(1&t.mode)&&xr(t,e.child,null,l),t.child.memoizedState=Ll(l),t.memoizedState=Il,i);if(0===(1&t.mode))return Ul(e,t,l,null);if("$!"===a.data){if(s=a.nextSibling&&a.nextSibling.dataset)var o=s.dgst;return s=o,Ul(e,t,l,s=cl(i=Error(r(419)),s,void 0))}if(o=0!==(l&e.childLanes),yl||o){if(null!==(s=To)){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(s.suspendedLanes|l))?0:a)&&a!==i.retryLane&&(i.retryLane=a,Ir(e,a),nc(s,e,a,-1))}return pc(),Ul(e,t,l,s=cl(Error(r(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=_c.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,sr=ca(a.nextSibling),nr=t,ar=!0,rr=null,null!==e&&($a[Ja++]=Qa,$a[Ja++]=Ya,$a[Ja++]=Ga,Qa=e.id,Ya=e.overflow,Ga=t),t=Bl(t,s.children),t.flags|=4096,t)}(e,t,o,a,s,i,n);if(l){l=a.fallback,o=t.mode,s=(i=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&o)&&t.child!==i?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Ac(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==s?l=Ac(s,l):(l=Lc(l,o,n,null)).flags|=2,l.return=t,a.return=t,a.sibling=l,t.child=a,a=l,l=t.child,o=null===(o=e.child.memoizedState)?Ll(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},l.memoizedState=o,l.childLanes=e.childLanes&~n,t.memoizedState=Il,a}return e=(l=e.child).sibling,a=Ac(l,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Bl(e,t){return(t=Dc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ul(e,t,n,s){return null!==s&&fr(s),xr(t,e.child,null,n),(e=Bl(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Fl(e,t,n){e.lanes|=t;var s=e.alternate;null!==s&&(s.lanes|=t),Er(e.return,t,n)}function zl(e,t,n,s,a){var r=e.memoizedState;null===r?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:a}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=s,r.tail=n,r.tailMode=a)}function Ml(e,t,n){var s=t.pendingProps,a=s.revealOrder,r=s.tail;if(bl(e,t,s.children,n),0!==(2&(s=Zr.current)))s=1&s|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Fl(e,n,t);else if(19===e.tag)Fl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(Ca(Zr,s),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===ei(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),zl(t,!1,a,n,r);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===ei(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}zl(t,!0,n,null,r);break;case"together":zl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wl(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ql(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Do|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(n=Ac(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ac(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Hl(e,t){if(!ar)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;null!==n;)null!==n.alternate&&(s=n),n=n.sibling;null===s?t||null===e.tail?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Vl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,s=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,s|=14680064&a.subtreeFlags,s|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags,s|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function Kl(e,t,n){var s=t.pendingProps;switch(tr(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vl(t),null;case 1:case 17:return Ra(t.type)&&Aa(),Vl(t),null;case 3:return s=t.stateNode,Qr(),ka(Ta),ka(Ea),ni(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),null!==e&&null!==e.child||(ur(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==rr&&(ic(rr),rr=null))),Ol(e,t),Vl(t),null;case 5:Xr(t);var a=Jr($r.current);if(n=t.type,null!==e&&null!=t.stateNode)Rl(e,t,n,s,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(null===t.stateNode)throw Error(r(166));return Vl(t),null}if(e=Jr(Vr.current),ur(t)){s=t.stateNode,n=t.type;var i=t.memoizedProps;switch(s[ha]=t,s[ma]=i,e=0!==(1&t.mode),n){case"dialog":Fs("cancel",s),Fs("close",s);break;case"iframe":case"object":case"embed":Fs("load",s);break;case"video":case"audio":for(a=0;a<Ls.length;a++)Fs(Ls[a],s);break;case"source":Fs("error",s);break;case"img":case"image":case"link":Fs("error",s),Fs("load",s);break;case"details":Fs("toggle",s);break;case"input":Q(s,i),Fs("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},Fs("invalid",s);break;case"textarea":ae(s,i),Fs("invalid",s)}for(var o in ye(n,i),a=null,i)if(i.hasOwnProperty(o)){var c=i[o];"children"===o?"string"===typeof c?s.textContent!==c&&(!0!==i.suppressHydrationWarning&&Xs(s.textContent,c,e),a=["children",c]):"number"===typeof c&&s.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Xs(s.textContent,c,e),a=["children",""+c]):l.hasOwnProperty(o)&&null!=c&&"onScroll"===o&&Fs("scroll",s)}switch(n){case"input":K(s),Z(s,i,!0);break;case"textarea":K(s),ie(s);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(s.onclick=Zs)}s=a,t.updateQueue=s,null!==s&&(t.flags|=4)}else{o=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=le(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=o.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof s.is?e=o.createElement(n,{is:s.is}):(e=o.createElement(n),"select"===n&&(o=e,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):e=o.createElementNS(e,n),e[ha]=t,e[ma]=s,Pl(e,t,!1,!1),t.stateNode=e;e:{switch(o=be(n,s),n){case"dialog":Fs("cancel",e),Fs("close",e),a=s;break;case"iframe":case"object":case"embed":Fs("load",e),a=s;break;case"video":case"audio":for(a=0;a<Ls.length;a++)Fs(Ls[a],e);a=s;break;case"source":Fs("error",e),a=s;break;case"img":case"image":case"link":Fs("error",e),Fs("load",e),a=s;break;case"details":Fs("toggle",e),a=s;break;case"input":Q(e,s),a=G(e,s),Fs("invalid",e);break;case"option":default:a=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},a=B({},s,{value:void 0}),Fs("invalid",e);break;case"textarea":ae(e,s),a=se(e,s),Fs("invalid",e)}for(i in ye(n,a),c=a)if(c.hasOwnProperty(i)){var d=c[i];"style"===i?ge(e,d):"dangerouslySetInnerHTML"===i?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===i?"string"===typeof d?("textarea"!==n||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(l.hasOwnProperty(i)?null!=d&&"onScroll"===i&&Fs("scroll",e):null!=d&&b(e,i,d,o))}switch(n){case"input":K(e),Z(e,s,!1);break;case"textarea":K(e),ie(e);break;case"option":null!=s.value&&e.setAttribute("value",""+H(s.value));break;case"select":e.multiple=!!s.multiple,null!=(i=s.value)?ne(e,!!s.multiple,i,!1):null!=s.defaultValue&&ne(e,!!s.multiple,s.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zs)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Vl(t),null;case 6:if(e&&null!=t.stateNode)Al(e,t,e.memoizedProps,s);else{if("string"!==typeof s&&null===t.stateNode)throw Error(r(166));if(n=Jr($r.current),Jr(Vr.current),ur(t)){if(s=t.stateNode,n=t.memoizedProps,s[ha]=t,(i=s.nodeValue!==n)&&null!==(e=nr))switch(e.tag){case 3:Xs(s.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xs(s.nodeValue,n,0!==(1&e.mode))}i&&(t.flags|=4)}else(s=(9===n.nodeType?n:n.ownerDocument).createTextNode(s))[ha]=t,t.stateNode=s}return Vl(t),null;case 13:if(ka(Zr),s=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ar&&null!==sr&&0!==(1&t.mode)&&0===(128&t.flags))hr(),mr(),t.flags|=98560,i=!1;else if(i=ur(t),null!==s&&null!==s.dehydrated){if(null===e){if(!i)throw Error(r(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(r(317));i[ha]=t}else mr(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Vl(t),i=!1}else null!==rr&&(ic(rr),rr=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((s=null!==s)!==(null!==e&&null!==e.memoizedState)&&s&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zr.current)?0===Io&&(Io=3):pc())),null!==t.updateQueue&&(t.flags|=4),Vl(t),null);case 4:return Qr(),Ol(e,t),null===e&&Ws(t.stateNode.containerInfo),Vl(t),null;case 10:return _r(t.type._context),Vl(t),null;case 19:if(ka(Zr),null===(i=t.memoizedState))return Vl(t),null;if(s=0!==(128&t.flags),null===(o=i.rendering))if(s)Hl(i,!1);else{if(0!==Io||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=ei(e))){for(t.flags|=128,Hl(i,!1),null!==(s=o.updateQueue)&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;null!==n;)e=s,(i=n).flags&=14680066,null===(o=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ca(Zr,1&Zr.current|2),t.child}e=e.sibling}null!==i.tail&&Ye()>Wo&&(t.flags|=128,s=!0,Hl(i,!1),t.lanes=4194304)}else{if(!s)if(null!==(e=ei(o))){if(t.flags|=128,s=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Hl(i,!0),null===i.tail&&"hidden"===i.tailMode&&!o.alternate&&!ar)return Vl(t),null}else 2*Ye()-i.renderingStartTime>Wo&&1073741824!==n&&(t.flags|=128,s=!0,Hl(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(null!==(n=i.last)?n.sibling=o:t.child=o,i.last=o)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ye(),t.sibling=null,n=Zr.current,Ca(Zr,s?1&n|2:1&n),t):(Vl(t),null);case 22:case 23:return uc(),s=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==s&&(t.flags|=8192),s&&0!==(1&t.mode)?0!==(1073741824&Ro)&&(Vl(t),6&t.subtreeFlags&&(t.flags|=8192)):Vl(t),null;case 24:case 25:return null}throw Error(r(156,t.tag))}function $l(e,t){switch(tr(t),t.tag){case 1:return Ra(t.type)&&Aa(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Qr(),ka(Ta),ka(Ea),ni(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xr(t),null;case 13:if(ka(Zr),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));mr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return ka(Zr),null;case 4:return Qr(),null;case 10:return _r(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Pl=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ol=function(){},Rl=function(e,t,n,s){var a=e.memoizedProps;if(a!==s){e=t.stateNode,Jr(Vr.current);var r,i=null;switch(n){case"input":a=G(e,a),s=G(e,s),i=[];break;case"select":a=B({},a,{value:void 0}),s=B({},s,{value:void 0}),i=[];break;case"textarea":a=se(e,a),s=se(e,s),i=[];break;default:"function"!==typeof a.onClick&&"function"===typeof s.onClick&&(e.onclick=Zs)}for(d in ye(n,s),n=null,a)if(!s.hasOwnProperty(d)&&a.hasOwnProperty(d)&&null!=a[d])if("style"===d){var o=a[d];for(r in o)o.hasOwnProperty(r)&&(n||(n={}),n[r]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(l.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in s){var c=s[d];if(o=null!=a?a[d]:void 0,s.hasOwnProperty(d)&&c!==o&&(null!=c||null!=o))if("style"===d)if(o){for(r in o)!o.hasOwnProperty(r)||c&&c.hasOwnProperty(r)||(n||(n={}),n[r]="");for(r in c)c.hasOwnProperty(r)&&o[r]!==c[r]&&(n||(n={}),n[r]=c[r])}else n||(i||(i=[]),i.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,o=o?o.__html:void 0,null!=c&&o!==c&&(i=i||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(l.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Fs("scroll",e),i||o===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}},Al=function(e,t,n,s){n!==s&&(t.flags|=4)};var Jl=!1,Gl=!1,Ql="function"===typeof WeakSet?WeakSet:Set,Yl=null;function Xl(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(s){Sc(e,t,s)}else n.current=null}function Zl(e,t,n){try{n()}catch(s){Sc(e,t,s)}}var eo=!1;function to(e,t,n){var s=t.updateQueue;if(null!==(s=null!==s?s.lastEffect:null)){var a=s=s.next;do{if((a.tag&e)===e){var r=a.destroy;a.destroy=void 0,void 0!==r&&Zl(t,n,r)}a=a.next}while(a!==s)}}function no(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function so(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ao(e){var t=e.alternate;null!==t&&(e.alternate=null,ao(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[ma],delete t[pa],delete t[ga],delete t[va])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ro(e){return 5===e.tag||3===e.tag||4===e.tag}function io(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ro(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function lo(e,t,n){var s=e.tag;if(5===s||6===s)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zs));else if(4!==s&&null!==(e=e.child))for(lo(e,t,n),e=e.sibling;null!==e;)lo(e,t,n),e=e.sibling}function oo(e,t,n){var s=e.tag;if(5===s||6===s)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==s&&null!==(e=e.child))for(oo(e,t,n),e=e.sibling;null!==e;)oo(e,t,n),e=e.sibling}var co=null,uo=!1;function ho(e,t,n){for(n=n.child;null!==n;)mo(e,t,n),n=n.sibling}function mo(e,t,n){if(rt&&"function"===typeof rt.onCommitFiberUnmount)try{rt.onCommitFiberUnmount(at,n)}catch(l){}switch(n.tag){case 5:Gl||Xl(n,t);case 6:var s=co,a=uo;co=null,ho(e,t,n),uo=a,null!==(co=s)&&(uo?(e=co,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):co.removeChild(n.stateNode));break;case 18:null!==co&&(uo?(e=co,n=n.stateNode,8===e.nodeType?oa(e.parentNode,n):1===e.nodeType&&oa(e,n),Wt(e)):oa(co,n.stateNode));break;case 4:s=co,a=uo,co=n.stateNode.containerInfo,uo=!0,ho(e,t,n),co=s,uo=a;break;case 0:case 11:case 14:case 15:if(!Gl&&(null!==(s=n.updateQueue)&&null!==(s=s.lastEffect))){a=s=s.next;do{var r=a,i=r.destroy;r=r.tag,void 0!==i&&(0!==(2&r)||0!==(4&r))&&Zl(n,t,i),a=a.next}while(a!==s)}ho(e,t,n);break;case 1:if(!Gl&&(Xl(n,t),"function"===typeof(s=n.stateNode).componentWillUnmount))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(l){Sc(n,t,l)}ho(e,t,n);break;case 21:ho(e,t,n);break;case 22:1&n.mode?(Gl=(s=Gl)||null!==n.memoizedState,ho(e,t,n),Gl=s):ho(e,t,n);break;default:ho(e,t,n)}}function fo(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ql),t.forEach(function(t){var s=Ec.bind(null,e,t);n.has(t)||(n.add(t),t.then(s,s))})}}function po(e,t){var n=t.deletions;if(null!==n)for(var s=0;s<n.length;s++){var a=n[s];try{var i=e,l=t,o=l;e:for(;null!==o;){switch(o.tag){case 5:co=o.stateNode,uo=!1;break e;case 3:case 4:co=o.stateNode.containerInfo,uo=!0;break e}o=o.return}if(null===co)throw Error(r(160));mo(i,l,a),co=null,uo=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(d){Sc(a,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)go(t,e),t=t.sibling}function go(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(po(t,e),vo(e),4&s){try{to(3,e,e.return),no(3,e)}catch(g){Sc(e,e.return,g)}try{to(5,e,e.return)}catch(g){Sc(e,e.return,g)}}break;case 1:po(t,e),vo(e),512&s&&null!==n&&Xl(n,n.return);break;case 5:if(po(t,e),vo(e),512&s&&null!==n&&Xl(n,n.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(g){Sc(e,e.return,g)}}if(4&s&&null!=(a=e.stateNode)){var i=e.memoizedProps,l=null!==n?n.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===o&&"radio"===i.type&&null!=i.name&&Y(a,i),be(o,l);var d=be(o,i);for(l=0;l<c.length;l+=2){var u=c[l],h=c[l+1];"style"===u?ge(a,h):"dangerouslySetInnerHTML"===u?ue(a,h):"children"===u?he(a,h):b(a,u,h,d)}switch(o){case"input":X(a,i);break;case"textarea":re(a,i);break;case"select":var m=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var f=i.value;null!=f?ne(a,!!i.multiple,f,!1):m!==!!i.multiple&&(null!=i.defaultValue?ne(a,!!i.multiple,i.defaultValue,!0):ne(a,!!i.multiple,i.multiple?[]:"",!1))}a[ma]=i}catch(g){Sc(e,e.return,g)}}break;case 6:if(po(t,e),vo(e),4&s){if(null===e.stateNode)throw Error(r(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){Sc(e,e.return,g)}}break;case 3:if(po(t,e),vo(e),4&s&&null!==n&&n.memoizedState.isDehydrated)try{Wt(t.containerInfo)}catch(g){Sc(e,e.return,g)}break;case 4:default:po(t,e),vo(e);break;case 13:po(t,e),vo(e),8192&(a=e.child).flags&&(i=null!==a.memoizedState,a.stateNode.isHidden=i,!i||null!==a.alternate&&null!==a.alternate.memoizedState||(Mo=Ye())),4&s&&fo(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Gl=(d=Gl)||u,po(t,e),Gl=d):po(t,e),vo(e),8192&s){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Yl=e,u=e.child;null!==u;){for(h=Yl=u;null!==Yl;){switch(f=(m=Yl).child,m.tag){case 0:case 11:case 14:case 15:to(4,m,m.return);break;case 1:Xl(m,m.return);var p=m.stateNode;if("function"===typeof p.componentWillUnmount){s=m,n=m.return;try{t=s,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){Sc(s,n,g)}}break;case 5:Xl(m,m.return);break;case 22:if(null!==m.memoizedState){jo(h);continue}}null!==f?(f.return=m,Yl=f):jo(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{a=h.stateNode,d?"function"===typeof(i=a.style).setProperty?i.setProperty("display","none","important"):i.display="none":(o=h.stateNode,l=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,o.style.display=pe("display",l))}catch(g){Sc(e,e.return,g)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){Sc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:po(t,e),vo(e),4&s&&fo(e);case 21:}}function vo(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ro(n)){var s=n;break e}n=n.return}throw Error(r(160))}switch(s.tag){case 5:var a=s.stateNode;32&s.flags&&(he(a,""),s.flags&=-33),oo(e,io(e),a);break;case 3:case 4:var i=s.stateNode.containerInfo;lo(e,io(e),i);break;default:throw Error(r(161))}}catch(l){Sc(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yo(e,t,n){Yl=e,bo(e,t,n)}function bo(e,t,n){for(var s=0!==(1&e.mode);null!==Yl;){var a=Yl,r=a.child;if(22===a.tag&&s){var i=null!==a.memoizedState||Jl;if(!i){var l=a.alternate,o=null!==l&&null!==l.memoizedState||Gl;l=Jl;var c=Gl;if(Jl=i,(Gl=o)&&!c)for(Yl=a;null!==Yl;)o=(i=Yl).child,22===i.tag&&null!==i.memoizedState?wo(a):null!==o?(o.return=i,Yl=o):wo(a);for(;null!==r;)Yl=r,bo(r,t,n),r=r.sibling;Yl=a,Jl=l,Gl=c}xo(e)}else 0!==(8772&a.subtreeFlags)&&null!==r?(r.return=a,Yl=r):xo(e)}}function xo(e){for(;null!==Yl;){var t=Yl;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Gl||no(5,t);break;case 1:var s=t.stateNode;if(4&t.flags&&!Gl)if(null===n)s.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:tl(t.type,n.memoizedProps);s.componentDidUpdate(a,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&qr(t,i,s);break;case 3:var l=t.updateQueue;if(null!==l){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}qr(t,l,n)}break;case 5:var o=t.stateNode;if(null===n&&4&t.flags){n=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Wt(h)}}}break;default:throw Error(r(163))}Gl||512&t.flags&&so(t)}catch(m){Sc(t,t.return,m)}}if(t===e){Yl=null;break}if(null!==(n=t.sibling)){n.return=t.return,Yl=n;break}Yl=t.return}}function jo(e){for(;null!==Yl;){var t=Yl;if(t===e){Yl=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Yl=n;break}Yl=t.return}}function wo(e){for(;null!==Yl;){var t=Yl;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{no(4,t)}catch(o){Sc(t,n,o)}break;case 1:var s=t.stateNode;if("function"===typeof s.componentDidMount){var a=t.return;try{s.componentDidMount()}catch(o){Sc(t,a,o)}}var r=t.return;try{so(t)}catch(o){Sc(t,r,o)}break;case 5:var i=t.return;try{so(t)}catch(o){Sc(t,i,o)}}}catch(o){Sc(t,t.return,o)}if(t===e){Yl=null;break}var l=t.sibling;if(null!==l){l.return=t.return,Yl=l;break}Yl=t.return}}var No,So=Math.ceil,ko=x.ReactCurrentDispatcher,Co=x.ReactCurrentOwner,_o=x.ReactCurrentBatchConfig,Eo=0,To=null,Po=null,Oo=0,Ro=0,Ao=Sa(0),Io=0,Lo=null,Do=0,Bo=0,Uo=0,Fo=null,zo=null,Mo=0,Wo=1/0,qo=null,Ho=!1,Vo=null,Ko=null,$o=!1,Jo=null,Go=0,Qo=0,Yo=null,Xo=-1,Zo=0;function ec(){return 0!==(6&Eo)?Ye():-1!==Xo?Xo:Xo=Ye()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Eo)&&0!==Oo?Oo&-Oo:null!==pr.transition?(0===Zo&&(Zo=pt()),Zo):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function nc(e,t,n,s){if(50<Qo)throw Qo=0,Yo=null,Error(r(185));vt(e,n,s),0!==(2&Eo)&&e===To||(e===To&&(0===(2&Eo)&&(Bo|=n),4===Io&&lc(e,Oo)),sc(e,s),1===n&&0===Eo&&0===(1&t.mode)&&(Wo=Ye()+500,Fa&&Wa()))}function sc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,a=e.expirationTimes,r=e.pendingLanes;0<r;){var i=31-it(r),l=1<<i,o=a[i];-1===o?0!==(l&n)&&0===(l&s)||(a[i]=mt(l,t)):o<=t&&(e.expiredLanes|=l),r&=~l}}(e,t);var s=ht(e,e===To?Oo:0);if(0===s)null!==n&&Je(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(null!=n&&Je(n),1===t)0===e.tag?function(e){Fa=!0,Ma(e)}(oc.bind(null,e)):Ma(oc.bind(null,e)),ia(function(){0===(6&Eo)&&Wa()}),n=null;else{switch(xt(s)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=st}n=Tc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Xo=-1,Zo=0,0!==(6&Eo))throw Error(r(327));var n=e.callbackNode;if(wc()&&e.callbackNode!==n)return null;var s=ht(e,e===To?Oo:0);if(0===s)return null;if(0!==(30&s)||0!==(s&e.expiredLanes)||t)t=gc(e,s);else{t=s;var a=Eo;Eo|=2;var i=fc();for(To===e&&Oo===t||(qo=null,Wo=Ye()+500,hc(e,t));;)try{yc();break}catch(o){mc(e,o)}Cr(),ko.current=i,Eo=a,null!==Po?t=0:(To=null,Oo=0,t=Io)}if(0!==t){if(2===t&&(0!==(a=ft(e))&&(s=a,t=rc(e,a))),1===t)throw n=Lo,hc(e,0),lc(e,s),sc(e,Ye()),n;if(6===t)lc(e,s);else{if(a=e.current.alternate,0===(30&s)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var s=0;s<n.length;s++){var a=n[s],r=a.getSnapshot;a=a.value;try{if(!ls(r(),a))return!1}catch(l){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=gc(e,s))&&(0!==(i=ft(e))&&(s=i,t=rc(e,i))),1===t))throw n=Lo,hc(e,0),lc(e,s),sc(e,Ye()),n;switch(e.finishedWork=a,e.finishedLanes=s,t){case 0:case 1:throw Error(r(345));case 2:case 5:jc(e,zo,qo);break;case 3:if(lc(e,s),(130023424&s)===s&&10<(t=Mo+500-Ye())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&s)!==s){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=sa(jc.bind(null,e,zo,qo),t);break}jc(e,zo,qo);break;case 4:if(lc(e,s),(4194240&s)===s)break;for(t=e.eventTimes,a=-1;0<s;){var l=31-it(s);i=1<<l,(l=t[l])>a&&(a=l),s&=~i}if(s=a,10<(s=(120>(s=Ye()-s)?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*So(s/1960))-s)){e.timeoutHandle=sa(jc.bind(null,e,zo,qo),s);break}jc(e,zo,qo);break;default:throw Error(r(329))}}}return sc(e,Ye()),e.callbackNode===n?ac.bind(null,e):null}function rc(e,t){var n=Fo;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=zo,zo=n,null!==t&&ic(t)),e}function ic(e){null===zo?zo=e:zo.push.apply(zo,e)}function lc(e,t){for(t&=~Uo,t&=~Bo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),s=1<<n;e[n]=-1,t&=~s}}function oc(e){if(0!==(6&Eo))throw Error(r(327));wc();var t=ht(e,0);if(0===(1&t))return sc(e,Ye()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var s=ft(e);0!==s&&(t=s,n=rc(e,s))}if(1===n)throw n=Lo,hc(e,0),lc(e,t),sc(e,Ye()),n;if(6===n)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,jc(e,zo,qo),sc(e,Ye()),null}function cc(e,t){var n=Eo;Eo|=1;try{return e(t)}finally{0===(Eo=n)&&(Wo=Ye()+500,Fa&&Wa())}}function dc(e){null!==Jo&&0===Jo.tag&&0===(6&Eo)&&wc();var t=Eo;Eo|=1;var n=_o.transition,s=bt;try{if(_o.transition=null,bt=1,e)return e()}finally{bt=s,_o.transition=n,0===(6&(Eo=t))&&Wa()}}function uc(){Ro=Ao.current,ka(Ao)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Po)for(n=Po.return;null!==n;){var s=n;switch(tr(s),s.tag){case 1:null!==(s=s.type.childContextTypes)&&void 0!==s&&Aa();break;case 3:Qr(),ka(Ta),ka(Ea),ni();break;case 5:Xr(s);break;case 4:Qr();break;case 13:case 19:ka(Zr);break;case 10:_r(s.type._context);break;case 22:case 23:uc()}n=n.return}if(To=e,Po=e=Ac(e.current,null),Oo=Ro=t,Io=0,Lo=null,Uo=Bo=Do=0,zo=Fo=null,null!==Or){for(t=0;t<Or.length;t++)if(null!==(s=(n=Or[t]).interleaved)){n.interleaved=null;var a=s.next,r=n.pending;if(null!==r){var i=r.next;r.next=a,s.next=i}n.pending=s}Or=null}return e}function mc(e,t){for(;;){var n=Po;try{if(Cr(),si.current=Yi,ci){for(var s=ii.memoizedState;null!==s;){var a=s.queue;null!==a&&(a.pending=null),s=s.next}ci=!1}if(ri=0,oi=li=ii=null,di=!1,ui=0,Co.current=null,null===n||null===n.return){Io=1,Lo=t,Po=null;break}e:{var i=e,l=n.return,o=n,c=t;if(t=Oo,o.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=o,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=pl(l);if(null!==f){f.flags&=-257,gl(f,l,o,0,t),1&f.mode&&fl(i,d,t),c=d;var p=(t=f).updateQueue;if(null===p){var g=new Set;g.add(c),t.updateQueue=g}else p.add(c);break e}if(0===(1&t)){fl(i,d,t),pc();break e}c=Error(r(426))}else if(ar&&1&o.mode){var v=pl(l);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),gl(v,l,o,0,t),fr(ol(c,o));break e}}i=c=ol(c,o),4!==Io&&(Io=2),null===Fo?Fo=[i]:Fo.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Mr(i,hl(0,c,t));break e;case 1:o=c;var y=i.type,b=i.stateNode;if(0===(128&i.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Ko||!Ko.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t,Mr(i,ml(i,o,t));break e}}i=i.return}while(null!==i)}xc(n)}catch(x){t=x,Po===n&&null!==n&&(Po=n=n.return);continue}break}}function fc(){var e=ko.current;return ko.current=Yi,null===e?Yi:e}function pc(){0!==Io&&3!==Io&&2!==Io||(Io=4),null===To||0===(268435455&Do)&&0===(268435455&Bo)||lc(To,Oo)}function gc(e,t){var n=Eo;Eo|=2;var s=fc();for(To===e&&Oo===t||(qo=null,hc(e,t));;)try{vc();break}catch(a){mc(e,a)}if(Cr(),Eo=n,ko.current=s,null!==Po)throw Error(r(261));return To=null,Oo=0,Io}function vc(){for(;null!==Po;)bc(Po)}function yc(){for(;null!==Po&&!Ge();)bc(Po)}function bc(e){var t=No(e.alternate,e,Ro);e.memoizedProps=e.pendingProps,null===t?xc(e):Po=t,Co.current=null}function xc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Kl(n,t,Ro)))return void(Po=n)}else{if(null!==(n=$l(n,t)))return n.flags&=32767,void(Po=n);if(null===e)return Io=6,void(Po=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Po=t);Po=t=e}while(null!==t);0===Io&&(Io=5)}function jc(e,t,n){var s=bt,a=_o.transition;try{_o.transition=null,bt=1,function(e,t,n,s){do{wc()}while(null!==Jo);if(0!==(6&Eo))throw Error(r(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-it(n),r=1<<a;t[a]=0,s[a]=-1,e[a]=-1,n&=~r}}(e,i),e===To&&(Po=To=null,Oo=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||$o||($o=!0,Tc(tt,function(){return wc(),null})),i=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||i){i=_o.transition,_o.transition=null;var l=bt;bt=1;var o=Eo;Eo|=4,Co.current=null,function(e,t){if(ea=Ht,ms(e=hs())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var s=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(s&&0!==s.rangeCount){n=s.anchorNode;var a=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch(j){n=null;break e}var l=0,o=-1,c=-1,d=0,u=0,h=e,m=null;t:for(;;){for(var f;h!==n||0!==a&&3!==h.nodeType||(o=l+a),h!==i||0!==s&&3!==h.nodeType||(c=l+s),3===h.nodeType&&(l+=h.nodeValue.length),null!==(f=h.firstChild);)m=h,h=f;for(;;){if(h===e)break t;if(m===n&&++d===a&&(o=l),m===i&&++u===s&&(c=l),null!==(f=h.nextSibling))break;m=(h=m).parentNode}h=f}n=-1===o||-1===c?null:{start:o,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Ht=!1,Yl=t;null!==Yl;)if(e=(t=Yl).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Yl=e;else for(;null!==Yl;){t=Yl;try{var p=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var g=p.memoizedProps,v=p.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:tl(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(r(163))}}catch(j){Sc(t,t.return,j)}if(null!==(e=t.sibling)){e.return=t.return,Yl=e;break}Yl=t.return}p=eo,eo=!1}(e,n),go(n,e),fs(ta),Ht=!!ea,ta=ea=null,e.current=n,yo(n,e,a),Qe(),Eo=o,bt=l,_o.transition=i}else e.current=n;if($o&&($o=!1,Jo=e,Go=a),i=e.pendingLanes,0===i&&(Ko=null),function(e){if(rt&&"function"===typeof rt.onCommitFiberRoot)try{rt.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),sc(e,Ye()),null!==t)for(s=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],s(a.value,{componentStack:a.stack,digest:a.digest});if(Ho)throw Ho=!1,e=Vo,Vo=null,e;0!==(1&Go)&&0!==e.tag&&wc(),i=e.pendingLanes,0!==(1&i)?e===Yo?Qo++:(Qo=0,Yo=e):Qo=0,Wa()}(e,t,n,s)}finally{_o.transition=a,bt=s}return null}function wc(){if(null!==Jo){var e=xt(Go),t=_o.transition,n=bt;try{if(_o.transition=null,bt=16>e?16:e,null===Jo)var s=!1;else{if(e=Jo,Jo=null,Go=0,0!==(6&Eo))throw Error(r(331));var a=Eo;for(Eo|=4,Yl=e.current;null!==Yl;){var i=Yl,l=i.child;if(0!==(16&Yl.flags)){var o=i.deletions;if(null!==o){for(var c=0;c<o.length;c++){var d=o[c];for(Yl=d;null!==Yl;){var u=Yl;switch(u.tag){case 0:case 11:case 15:to(8,u,i)}var h=u.child;if(null!==h)h.return=u,Yl=h;else for(;null!==Yl;){var m=(u=Yl).sibling,f=u.return;if(ao(u),u===d){Yl=null;break}if(null!==m){m.return=f,Yl=m;break}Yl=f}}}var p=i.alternate;if(null!==p){var g=p.child;if(null!==g){p.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Yl=i}}if(0!==(2064&i.subtreeFlags)&&null!==l)l.return=i,Yl=l;else e:for(;null!==Yl;){if(0!==(2048&(i=Yl).flags))switch(i.tag){case 0:case 11:case 15:to(9,i,i.return)}var y=i.sibling;if(null!==y){y.return=i.return,Yl=y;break e}Yl=i.return}}var b=e.current;for(Yl=b;null!==Yl;){var x=(l=Yl).child;if(0!==(2064&l.subtreeFlags)&&null!==x)x.return=l,Yl=x;else e:for(l=b;null!==Yl;){if(0!==(2048&(o=Yl).flags))try{switch(o.tag){case 0:case 11:case 15:no(9,o)}}catch(w){Sc(o,o.return,w)}if(o===l){Yl=null;break e}var j=o.sibling;if(null!==j){j.return=o.return,Yl=j;break e}Yl=o.return}}if(Eo=a,Wa(),rt&&"function"===typeof rt.onPostCommitFiberRoot)try{rt.onPostCommitFiberRoot(at,e)}catch(w){}s=!0}return s}finally{bt=n,_o.transition=t}}return!1}function Nc(e,t,n){e=Fr(e,t=hl(0,t=ol(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),sc(e,t))}function Sc(e,t,n){if(3===e.tag)Nc(e,e,n);else for(;null!==t;){if(3===t.tag){Nc(t,e,n);break}if(1===t.tag){var s=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof s.componentDidCatch&&(null===Ko||!Ko.has(s))){t=Fr(t,e=ml(t,e=ol(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),sc(t,e));break}}t=t.return}}function kc(e,t,n){var s=e.pingCache;null!==s&&s.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,To===e&&(Oo&n)===n&&(4===Io||3===Io&&(130023424&Oo)===Oo&&500>Ye()-Mo?hc(e,0):Uo|=n),sc(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=ec();null!==(e=Ir(e,t))&&(vt(e,t,n),sc(e,n))}function _c(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cc(e,n)}function Ec(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(r(314))}null!==s&&s.delete(t),Cc(e,n)}function Tc(e,t){return $e(e,t)}function Pc(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oc(e,t,n,s){return new Pc(e,t,n,s)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ac(e,t){var n=e.alternate;return null===n?((n=Oc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ic(e,t,n,s,a,i){var l=2;if(s=e,"function"===typeof e)Rc(e)&&(l=1);else if("string"===typeof e)l=5;else e:switch(e){case N:return Lc(n.children,a,i,t);case S:l=8,a|=8;break;case k:return(e=Oc(12,n,t,2|a)).elementType=k,e.lanes=i,e;case T:return(e=Oc(13,n,t,a)).elementType=T,e.lanes=i,e;case P:return(e=Oc(19,n,t,a)).elementType=P,e.lanes=i,e;case A:return Dc(n,a,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:l=10;break e;case _:l=9;break e;case E:l=11;break e;case O:l=14;break e;case R:l=16,s=null;break e}throw Error(r(130,null==e?e:typeof e,""))}return(t=Oc(l,n,t,a)).elementType=e,t.type=s,t.lanes=i,t}function Lc(e,t,n,s){return(e=Oc(7,e,s,t)).lanes=n,e}function Dc(e,t,n,s){return(e=Oc(22,e,s,t)).elementType=A,e.lanes=n,e.stateNode={isHidden:!1},e}function Bc(e,t,n){return(e=Oc(6,e,null,t)).lanes=n,e}function Uc(e,t,n){return(t=Oc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Fc(e,t,n,s,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=s,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,s,a,r,i,l,o){return e=new Fc(e,t,n,l,o),1===t?(t=1,!0===r&&(t|=8)):t=0,r=Oc(3,null,null,t),e.current=r,r.stateNode=e,r.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dr(r),e}function Mc(e){if(!e)return _a;e:{if(We(e=e._reactInternals)!==e||1!==e.tag)throw Error(r(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ra(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(r(171))}if(1===e.tag){var n=e.type;if(Ra(n))return La(e,n,t)}return t}function Wc(e,t,n,s,a,r,i,l,o){return(e=zc(n,s,!0,e,0,r,0,l,o)).context=Mc(null),n=e.current,(r=Ur(s=ec(),a=tc(n))).callback=void 0!==t&&null!==t?t:null,Fr(n,r,a),e.current.lanes=a,vt(e,a,s),sc(e,s),e}function qc(e,t,n,s){var a=t.current,r=ec(),i=tc(a);return n=Mc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ur(r,i)).payload={element:e},null!==(s=void 0===s?null:s)&&(t.callback=s),null!==(e=Fr(a,t,i))&&(nc(e,a,i,r),zr(e,a,i)),i}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){Vc(e,t),(e=e.alternate)&&Vc(e,t)}No=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ta.current)yl=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return yl=!1,function(e,t,n){switch(t.tag){case 3:El(t),mr();break;case 5:Yr(t);break;case 1:Ra(t.type)&&Da(t);break;case 4:Gr(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,a=t.memoizedProps.value;Ca(wr,s._currentValue),s._currentValue=a;break;case 13:if(null!==(s=t.memoizedState))return null!==s.dehydrated?(Ca(Zr,1&Zr.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Dl(e,t,n):(Ca(Zr,1&Zr.current),null!==(e=ql(e,t,n))?e.sibling:null);Ca(Zr,1&Zr.current);break;case 19:if(s=0!==(n&t.childLanes),0!==(128&e.flags)){if(s)return Ml(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ca(Zr,Zr.current),s)break;return null;case 22:case 23:return t.lanes=0,Nl(e,t,n)}return ql(e,t,n)}(e,t,n);yl=0!==(131072&e.flags)}else yl=!1,ar&&0!==(1048576&t.flags)&&Za(t,Ka,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Wl(e,t),e=t.pendingProps;var a=Oa(t,Ea.current);Tr(t,n),a=pi(null,t,s,e,a,n);var i=gi();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ra(s)?(i=!0,Da(t)):i=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Dr(t),a.updater=sl,t.stateNode=a,a._reactInternals=t,ll(t,s,e,n),t=_l(null,t,s,!0,i,n)):(t.tag=0,ar&&i&&er(t),bl(null,t,a,n),t=t.child),t;case 16:s=t.elementType;e:{switch(Wl(e,t),e=t.pendingProps,s=(a=s._init)(s._payload),t.type=s,a=t.tag=function(e){if("function"===typeof e)return Rc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===O)return 14}return 2}(s),e=tl(s,e),a){case 0:t=kl(null,t,s,e,n);break e;case 1:t=Cl(null,t,s,e,n);break e;case 11:t=xl(null,t,s,e,n);break e;case 14:t=jl(null,t,s,tl(s.type,e),n);break e}throw Error(r(306,s,""))}return t;case 0:return s=t.type,a=t.pendingProps,kl(e,t,s,a=t.elementType===s?a:tl(s,a),n);case 1:return s=t.type,a=t.pendingProps,Cl(e,t,s,a=t.elementType===s?a:tl(s,a),n);case 3:e:{if(El(t),null===e)throw Error(r(387));s=t.pendingProps,a=(i=t.memoizedState).element,Br(e,t),Wr(t,s,null,n);var l=t.memoizedState;if(s=l.element,i.isDehydrated){if(i={element:s,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Tl(e,t,s,n,a=ol(Error(r(423)),t));break e}if(s!==a){t=Tl(e,t,s,n,a=ol(Error(r(424)),t));break e}for(sr=ca(t.stateNode.containerInfo.firstChild),nr=t,ar=!0,rr=null,n=jr(t,null,s,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(mr(),s===a){t=ql(e,t,n);break e}bl(e,t,s,n)}t=t.child}return t;case 5:return Yr(t),null===e&&cr(t),s=t.type,a=t.pendingProps,i=null!==e?e.memoizedProps:null,l=a.children,na(s,a)?l=null:null!==i&&na(s,i)&&(t.flags|=32),Sl(e,t),bl(e,t,l,n),t.child;case 6:return null===e&&cr(t),null;case 13:return Dl(e,t,n);case 4:return Gr(t,t.stateNode.containerInfo),s=t.pendingProps,null===e?t.child=xr(t,null,s,n):bl(e,t,s,n),t.child;case 11:return s=t.type,a=t.pendingProps,xl(e,t,s,a=t.elementType===s?a:tl(s,a),n);case 7:return bl(e,t,t.pendingProps,n),t.child;case 8:case 12:return bl(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,a=t.pendingProps,i=t.memoizedProps,l=a.value,Ca(wr,s._currentValue),s._currentValue=l,null!==i)if(ls(i.value,l)){if(i.children===a.children&&!Ta.current){t=ql(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var o=i.dependencies;if(null!==o){l=i.child;for(var c=o.firstContext;null!==c;){if(c.context===s){if(1===i.tag){(c=Ur(-1,n&-n)).tag=2;var d=i.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=n,null!==(c=i.alternate)&&(c.lanes|=n),Er(i.return,n,t),o.lanes|=n;break}c=c.next}}else if(10===i.tag)l=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(l=i.return))throw Error(r(341));l.lanes|=n,null!==(o=l.alternate)&&(o.lanes|=n),Er(l,n,t),l=i.sibling}else l=i.child;if(null!==l)l.return=i;else for(l=i;null!==l;){if(l===t){l=null;break}if(null!==(i=l.sibling)){i.return=l.return,l=i;break}l=l.return}i=l}bl(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,s=t.pendingProps.children,Tr(t,n),s=s(a=Pr(a)),t.flags|=1,bl(e,t,s,n),t.child;case 14:return a=tl(s=t.type,t.pendingProps),jl(e,t,s,a=tl(s.type,a),n);case 15:return wl(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:tl(s,a),Wl(e,t),t.tag=1,Ra(s)?(e=!0,Da(t)):e=!1,Tr(t,n),rl(t,s,a),ll(t,s,a,n),_l(null,t,s,!0,e,n);case 19:return Ml(e,t,n);case 22:return Nl(e,t,n)}throw Error(r(156,t.tag))};var $c="function"===typeof reportError?reportError:function(e){console.error(e)};function Jc(e){this._internalRoot=e}function Gc(e){this._internalRoot=e}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Zc(e,t,n,s,a){var r=n._reactRootContainer;if(r){var i=r;if("function"===typeof a){var l=a;a=function(){var e=Hc(i);l.call(e)}}qc(t,i,e,a)}else i=function(e,t,n,s,a){if(a){if("function"===typeof s){var r=s;s=function(){var e=Hc(i);r.call(e)}}var i=Wc(t,s,e,0,null,!1,0,"",Xc);return e._reactRootContainer=i,e[fa]=i.current,Ws(8===e.nodeType?e.parentNode:e),dc(),i}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof s){var l=s;s=function(){var e=Hc(o);l.call(e)}}var o=zc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=o,e[fa]=o.current,Ws(8===e.nodeType?e.parentNode:e),dc(function(){qc(t,o,n,s)}),o}(n,t,e,a,s);return Hc(i)}Gc.prototype.render=Jc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));qc(e,t,null,null)},Gc.prototype.unmount=Jc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc(function(){qc(null,e,null,null)}),t[fa]=null}},Gc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<At.length&&0!==t&&t<At[n].priority;n++);At.splice(n,0,e),0===n&&Bt(e)}},jt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(yt(t,1|n),sc(t,Ye()),0===(6&Eo)&&(Wo=Ye()+500,Wa()))}break;case 13:dc(function(){var t=Ir(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),Kc(e,1)}},wt=function(e){if(13===e.tag){var t=Ir(e,134217728);if(null!==t)nc(t,e,134217728,ec());Kc(e,134217728)}},Nt=function(e){if(13===e.tag){var t=tc(e),n=Ir(e,t);if(null!==n)nc(n,e,t,ec());Kc(e,t)}},St=function(){return bt},kt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},we=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var a=ja(s);if(!a)throw Error(r(90));$(s),X(s,a)}}}break;case"textarea":re(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=cc,Te=dc;var ed={usingClientEntryPoint:!1,Events:[ba,xa,ja,Ce,_e,cc]},td={findFiberByHostInstance:ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ve(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var sd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sd.isDisabled&&sd.supportsFiber)try{at=sd.inject(nd),rt=sd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qc(t))throw Error(r(200));return function(e,t,n){var s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==s?null:""+s,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Qc(e))throw Error(r(299));var n=!1,s="",a=$c;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(s=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,s,a),e[fa]=t.current,Ws(8===e.nodeType?e.parentNode:e),new Jc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return e=null===(e=Ve(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!Yc(t))throw Error(r(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Qc(e))throw Error(r(405));var s=null!=n&&n.hydratedSources||null,a=!1,i="",l=$c;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(l=n.onRecoverableError)),t=Wc(t,null,e,1,null!=n?n:null,a,0,i,l),e[fa]=t.current,Ws(e),s)for(e=0;e<s.length;e++)a=(a=(n=s[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Gc(t)},t.render=function(e,t,n){if(!Yc(t))throw Error(r(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Yc(e))throw Error(r(40));return!!e._reactRootContainer&&(dc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[fa]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!Yc(n))throw Error(r(200));if(null==e||void 0===e._reactInternals)throw Error(r(38));return Zc(e,t,n,!1,s)},t.version="18.3.1-next-f1338f8080-20240426"},736:function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(n(374));class r extends a.default{eq(e,t){return this.url.searchParams.append(e,"eq.".concat(t)),this}neq(e,t){return this.url.searchParams.append(e,"neq.".concat(t)),this}gt(e,t){return this.url.searchParams.append(e,"gt.".concat(t)),this}gte(e,t){return this.url.searchParams.append(e,"gte.".concat(t)),this}lt(e,t){return this.url.searchParams.append(e,"lt.".concat(t)),this}lte(e,t){return this.url.searchParams.append(e,"lte.".concat(t)),this}like(e,t){return this.url.searchParams.append(e,"like.".concat(t)),this}likeAllOf(e,t){return this.url.searchParams.append(e,"like(all).{".concat(t.join(","),"}")),this}likeAnyOf(e,t){return this.url.searchParams.append(e,"like(any).{".concat(t.join(","),"}")),this}ilike(e,t){return this.url.searchParams.append(e,"ilike.".concat(t)),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,"ilike(all).{".concat(t.join(","),"}")),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,"ilike(any).{".concat(t.join(","),"}")),this}is(e,t){return this.url.searchParams.append(e,"is.".concat(t)),this}in(e,t){const n=Array.from(new Set(t)).map(e=>"string"===typeof e&&new RegExp("[,()]").test(e)?'"'.concat(e,'"'):"".concat(e)).join(",");return this.url.searchParams.append(e,"in.(".concat(n,")")),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cs.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cs.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cs.".concat(JSON.stringify(t))),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cd.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cd.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cd.".concat(JSON.stringify(t))),this}rangeGt(e,t){return this.url.searchParams.append(e,"sr.".concat(t)),this}rangeGte(e,t){return this.url.searchParams.append(e,"nxl.".concat(t)),this}rangeLt(e,t){return this.url.searchParams.append(e,"sl.".concat(t)),this}rangeLte(e,t){return this.url.searchParams.append(e,"nxr.".concat(t)),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,"adj.".concat(t)),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,"ov.".concat(t)):this.url.searchParams.append(e,"ov.{".concat(t.join(","),"}")),this}textSearch(e,t){let{config:n,type:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="";"plain"===s?a="pl":"phrase"===s?a="ph":"websearch"===s&&(a="w");const r=void 0===n?"":"(".concat(n,")");return this.url.searchParams.append(e,"".concat(a,"fts").concat(r,".").concat(t)),this}match(e){return Object.entries(e).forEach(e=>{let[t,n]=e;this.url.searchParams.append(t,"eq.".concat(n))}),this}not(e,t,n){return this.url.searchParams.append(e,"not.".concat(t,".").concat(n)),this}or(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=n?"".concat(n,".or"):"or";return this.url.searchParams.append(s,"(".concat(e,")")),this}filter(e,t,n){return this.url.searchParams.append(e,"".concat(t,".").concat(n)),this}}t.default=r},829:function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(n(736));t.default=class{constructor(e,t){let{headers:n={},schema:s,fetch:a}=t;this.url=e,this.headers=new Headers(n),this.schema=s,this.fetch=a}select(e,t){const{head:n=!1,count:s}=null!==t&&void 0!==t?t:{},r=n?"HEAD":"GET";let i=!1;const l=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!i?"":('"'===e&&(i=!i),e)).join("");return this.url.searchParams.set("select",l),s&&this.headers.append("Prefer","count=".concat(s)),new a.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e){let{count:t,defaultToNull:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s;if(t&&this.headers.append("Prefer","count=".concat(t)),n||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));this.url.searchParams.set("columns",e.join(","))}}return new a.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch})}upsert(e){let{onConflict:t,ignoreDuplicates:n=!1,count:s,defaultToNull:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var i;if(this.headers.append("Prefer","resolution=".concat(n?"ignore":"merge","-duplicates")),void 0!==t&&this.url.searchParams.set("on_conflict",t),s&&this.headers.append("Prefer","count=".concat(s)),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));this.url.searchParams.set("columns",e.join(","))}}return new a.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;return t&&this.headers.append("Prefer","count=".concat(t)),new a.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;return e&&this.headers.append("Prefer","count=".concat(e)),new a.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})}}},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},980:function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;const a=s(n(210));t.PostgrestClient=a.default;const r=s(n(829));t.PostgrestQueryBuilder=r.default;const i=s(n(736));t.PostgrestFilterBuilder=i.default;const l=s(n(374));t.PostgrestTransformBuilder=l.default;const o=s(n(286));t.PostgrestBuilder=o.default;const c=s(n(611));t.PostgrestError=c.default,t.default={PostgrestClient:a.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:l.default,PostgrestBuilder:o.default,PostgrestError:c.default}}},t={};function n(s){var a=t[s];if(void 0!==a)return a.exports;var r=t[s]={exports:{}};return e[s].call(r.exports,r,r.exports,n),r.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(s,a){if(1&a&&(s=this(s)),8&a)return s;if("object"===typeof s&&s){if(4&a&&s.__esModule)return s;if(16&a&&"function"===typeof s.then)return s}var r=Object.create(null);n.r(r);var i={};e=e||[null,t({}),t([]),t(t)];for(var l=2&a&&s;("object"==typeof l||"function"==typeof l)&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach(e=>i[e]=()=>s[e]);return i.default=()=>s,n.d(r,i),r}})(),n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s,a=n(43),r=n.t(a,2),i=n(391),l=n(950),o=n.t(l,2);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},c.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(s||(s={}));const d="popstate";function u(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function h(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function m(e,t){return{usr:e.state,key:e.key,idx:t}}function f(e,t,n,s){return void 0===n&&(n=null),c({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?g(t):t,{state:n,key:t&&t.key||s||Math.random().toString(36).substr(2,8)})}function p(e){let{pathname:t="/",search:n="",hash:s=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),s&&"#"!==s&&(t+="#"===s.charAt(0)?s:"#"+s),t}function g(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let s=e.indexOf("?");s>=0&&(t.search=e.substr(s),e=e.substr(0,s)),e&&(t.pathname=e)}return t}function v(e,t,n,a){void 0===a&&(a={});let{window:r=document.defaultView,v5Compat:i=!1}=a,l=r.history,o=s.Pop,h=null,g=v();function v(){return(l.state||{idx:null}).idx}function y(){o=s.Pop;let e=v(),t=null==e?null:e-g;g=e,h&&h({action:o,location:x.location,delta:t})}function b(e){let t="null"!==r.location.origin?r.location.origin:r.location.href,n="string"===typeof e?e:p(e);return n=n.replace(/ $/,"%20"),u(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,l.replaceState(c({},l.state,{idx:g}),""));let x={get action(){return o},get location(){return e(r,l)},listen(e){if(h)throw new Error("A history only accepts one active listener");return r.addEventListener(d,y),h=e,()=>{r.removeEventListener(d,y),h=null}},createHref:e=>t(r,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o=s.Push;let a=f(x.location,e,t);n&&n(a,e),g=v()+1;let c=m(a,g),d=x.createHref(a);try{l.pushState(c,"",d)}catch(u){if(u instanceof DOMException&&"DataCloneError"===u.name)throw u;r.location.assign(d)}i&&h&&h({action:o,location:x.location,delta:1})},replace:function(e,t){o=s.Replace;let a=f(x.location,e,t);n&&n(a,e),g=v();let r=m(a,g),c=x.createHref(a);l.replaceState(r,"",c),i&&h&&h({action:o,location:x.location,delta:0})},go:e=>l.go(e)};return x}var y;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(y||(y={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function b(e,t,n){return void 0===n&&(n="/"),x(e,t,n,!1)}function x(e,t,n,s){let a=I(("string"===typeof t?g(t):t).pathname||"/",n);if(null==a)return null;let r=j(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(r);let i=null;for(let l=0;null==i&&l<r.length;++l){let e=A(a);i=O(r[l],e,s)}return i}function j(e,t,n,s){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===s&&(s="");let a=(e,a,r)=>{let i={relativePath:void 0===r?e.path||"":r,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};i.relativePath.startsWith("/")&&(u(i.relativePath.startsWith(s),'Absolute route path "'+i.relativePath+'" nested under path "'+s+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(s.length));let l=F([s,i.relativePath]),o=n.concat(i);e.children&&e.children.length>0&&(u(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+l+'".'),j(e.children,t,o,l)),(null!=e.path||e.index)&&t.push({path:l,score:P(l,e.index),routesMeta:o})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let s of w(e.path))a(e,t,s);else a(e,t)}),t}function w(e){let t=e.split("/");if(0===t.length)return[];let[n,...s]=t,a=n.endsWith("?"),r=n.replace(/\?$/,"");if(0===s.length)return a?[r,""]:[r];let i=w(s.join("/")),l=[];return l.push(...i.map(e=>""===e?r:[r,e].join("/"))),a&&l.push(...i),l.map(t=>e.startsWith("/")&&""===t?"/":t)}const N=/^:[\w-]+$/,S=3,k=2,C=1,_=10,E=-2,T=e=>"*"===e;function P(e,t){let n=e.split("/"),s=n.length;return n.some(T)&&(s+=E),t&&(s+=k),n.filter(e=>!T(e)).reduce((e,t)=>e+(N.test(t)?S:""===t?C:_),s)}function O(e,t,n){void 0===n&&(n=!1);let{routesMeta:s}=e,a={},r="/",i=[];for(let l=0;l<s.length;++l){let e=s[l],o=l===s.length-1,c="/"===r?t:t.slice(r.length)||"/",d=R({path:e.relativePath,caseSensitive:e.caseSensitive,end:o},c),u=e.route;if(!d&&o&&n&&!s[s.length-1].route.index&&(d=R({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:F([r,d.pathname]),pathnameBase:z(F([r,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(r=F([r,d.pathnameBase]))}return i}function R(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,s]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);h("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let s=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(s.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(s.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let r=new RegExp(a,t?void 0:"i");return[r,s]}(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let r=a[0],i=r.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:s.reduce((e,t,n)=>{let{paramName:s,isOptional:a}=t;if("*"===s){let e=l[n]||"";i=r.slice(0,r.length-e.length).replace(/(.)\/+$/,"$1")}const o=l[n];return e[s]=a&&!o?void 0:(o||"").replace(/%2F/g,"/"),e},{}),pathname:r,pathnameBase:i,pattern:e}}function A(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return h(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function I(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,s=e.charAt(n);return s&&"/"!==s?null:e.slice(n)||"/"}function L(e,t,n,s){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(s)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function D(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function B(e,t){let n=D(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}function U(e,t,n,s){let a;void 0===s&&(s=!1),"string"===typeof e?a=g(e):(a=c({},e),u(!a.pathname||!a.pathname.includes("?"),L("?","pathname","search",a)),u(!a.pathname||!a.pathname.includes("#"),L("#","pathname","hash",a)),u(!a.search||!a.search.includes("#"),L("#","search","hash",a)));let r,i=""===e||""===a.pathname,l=i?"/":a.pathname;if(null==l)r=n;else{let e=t.length-1;if(!s&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}r=e>=0?t[e]:"/"}let o=function(e,t){void 0===t&&(t="/");let{pathname:n,search:s="",hash:a=""}="string"===typeof e?g(e):e,r=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:r,search:M(s),hash:W(a)}}(a,r),d=l&&"/"!==l&&l.endsWith("/"),h=(i||"."===l)&&n.endsWith("/");return o.pathname.endsWith("/")||!d&&!h||(o.pathname+="/"),o}const F=e=>e.join("/").replace(/\/\/+/g,"/"),z=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),M=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",W=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function q(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const H=["post","put","patch","delete"],V=(new Set(H),["get",...H]);new Set(V),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function K(){return K=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},K.apply(this,arguments)}const $=a.createContext(null);const J=a.createContext(null);const G=a.createContext(null);const Q=a.createContext(null);const Y=a.createContext({outlet:null,matches:[],isDataRoute:!1});const X=a.createContext(null);function Z(){return null!=a.useContext(Q)}function ee(){return Z()||u(!1),a.useContext(Q).location}function te(e){a.useContext(G).static||a.useLayoutEffect(e)}function ne(){let{isDataRoute:e}=a.useContext(Y);return e?function(){let{router:e}=ue(ce.UseNavigateStable),t=me(de.UseNavigateStable),n=a.useRef(!1);return te(()=>{n.current=!0}),a.useCallback(function(s,a){void 0===a&&(a={}),n.current&&("number"===typeof s?e.navigate(s):e.navigate(s,K({fromRouteId:t},a)))},[e,t])}():function(){Z()||u(!1);let e=a.useContext($),{basename:t,future:n,navigator:s}=a.useContext(G),{matches:r}=a.useContext(Y),{pathname:i}=ee(),l=JSON.stringify(B(r,n.v7_relativeSplatPath)),o=a.useRef(!1);return te(()=>{o.current=!0}),a.useCallback(function(n,a){if(void 0===a&&(a={}),!o.current)return;if("number"===typeof n)return void s.go(n);let r=U(n,JSON.parse(l),i,"path"===a.relative);null==e&&"/"!==t&&(r.pathname="/"===r.pathname?t:F([t,r.pathname])),(a.replace?s.replace:s.push)(r,a.state,a)},[t,s,l,i,e])}()}function se(e,t,n,r){Z()||u(!1);let{navigator:i}=a.useContext(G),{matches:l}=a.useContext(Y),o=l[l.length-1],c=o?o.params:{},d=(o&&o.pathname,o?o.pathnameBase:"/");o&&o.route;let h,m=ee();if(t){var f;let e="string"===typeof t?g(t):t;"/"===d||(null==(f=e.pathname)?void 0:f.startsWith(d))||u(!1),h=e}else h=m;let p=h.pathname||"/",v=p;if("/"!==d){let e=d.replace(/^\//,"").split("/");v="/"+p.replace(/^\//,"").split("/").slice(e.length).join("/")}let y=b(e,{pathname:v});let x=oe(y&&y.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:F([d,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:F([d,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),l,n,r);return t&&x?a.createElement(Q.Provider,{value:{location:K({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:s.Pop}},x):x}function ae(){let e=function(){var e;let t=a.useContext(X),n=he(de.UseRouteError),s=me(de.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[s]}(),t=q(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:s};return a.createElement(a.Fragment,null,a.createElement("h2",null,"Unexpected Application Error!"),a.createElement("h3",{style:{fontStyle:"italic"}},t),n?a.createElement("pre",{style:r},n):null,null)}const re=a.createElement(ae,null);class ie extends a.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?a.createElement(Y.Provider,{value:this.props.routeContext},a.createElement(X.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function le(e){let{routeContext:t,match:n,children:s}=e,r=a.useContext($);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),a.createElement(Y.Provider,{value:t},s)}function oe(e,t,n,s){var r;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===s&&(s=null),null==e){var i;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(i=s)&&i.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let l=e,o=null==(r=n)?void 0:r.errors;if(null!=o){let e=l.findIndex(e=>e.route.id&&void 0!==(null==o?void 0:o[e.route.id]));e>=0||u(!1),l=l.slice(0,Math.min(l.length,e+1))}let c=!1,d=-1;if(n&&s&&s.v7_partialHydration)for(let a=0;a<l.length;a++){let e=l[a];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=a),e.route.id){let{loaderData:t,errors:s}=n,a=e.route.loader&&void 0===t[e.route.id]&&(!s||void 0===s[e.route.id]);if(e.route.lazy||a){c=!0,l=d>=0?l.slice(0,d+1):[l[0]];break}}}return l.reduceRight((e,s,r)=>{let i,u=!1,h=null,m=null;var f;n&&(i=o&&s.route.id?o[s.route.id]:void 0,h=s.route.errorElement||re,c&&(d<0&&0===r?(f="route-fallback",!1||fe[f]||(fe[f]=!0),u=!0,m=null):d===r&&(u=!0,m=s.route.hydrateFallbackElement||null)));let p=t.concat(l.slice(0,r+1)),g=()=>{let t;return t=i?h:u?m:s.route.Component?a.createElement(s.route.Component,null):s.route.element?s.route.element:e,a.createElement(le,{match:s,routeContext:{outlet:e,matches:p,isDataRoute:null!=n},children:t})};return n&&(s.route.ErrorBoundary||s.route.errorElement||0===r)?a.createElement(ie,{location:n.location,revalidation:n.revalidation,component:h,error:i,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()},null)}var ce=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ce||{}),de=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(de||{});function ue(e){let t=a.useContext($);return t||u(!1),t}function he(e){let t=a.useContext(J);return t||u(!1),t}function me(e){let t=function(){let e=a.useContext(Y);return e||u(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||u(!1),n.route.id}const fe={};function pe(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}r.startTransition;function ge(e){let{to:t,replace:n,state:s,relative:r}=e;Z()||u(!1);let{future:i,static:l}=a.useContext(G),{matches:o}=a.useContext(Y),{pathname:c}=ee(),d=ne(),h=U(t,B(o,i.v7_relativeSplatPath),c,"path"===r),m=JSON.stringify(h);return a.useEffect(()=>d(JSON.parse(m),{replace:n,state:s,relative:r}),[d,m,r,n,s]),null}function ve(e){u(!1)}function ye(e){let{basename:t="/",children:n=null,location:r,navigationType:i=s.Pop,navigator:l,static:o=!1,future:c}=e;Z()&&u(!1);let d=t.replace(/^\/*/,"/"),h=a.useMemo(()=>({basename:d,navigator:l,static:o,future:K({v7_relativeSplatPath:!1},c)}),[d,c,l,o]);"string"===typeof r&&(r=g(r));let{pathname:m="/",search:f="",hash:p="",state:v=null,key:y="default"}=r,b=a.useMemo(()=>{let e=I(m,d);return null==e?null:{location:{pathname:e,search:f,hash:p,state:v,key:y},navigationType:i}},[d,m,f,p,v,y,i]);return null==b?null:a.createElement(G.Provider,{value:h},a.createElement(Q.Provider,{children:n,value:b}))}function be(e){let{children:t,location:n}=e;return se(xe(t),n)}new Promise(()=>{});a.Component;function xe(e,t){void 0===t&&(t=[]);let n=[];return a.Children.forEach(e,(e,s)=>{if(!a.isValidElement(e))return;let r=[...t,s];if(e.type===a.Fragment)return void n.push.apply(n,xe(e.props.children,r));e.type!==ve&&u(!1),e.props.index&&e.props.children&&u(!1);let i={id:e.props.id||r.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=xe(e.props.children,r)),n.push(i)}),n}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);try{window.__reactRouterVersion="6"}catch(ka){}new Map;const je=r.startTransition;o.flushSync,r.useId;function we(e){let{basename:t,children:n,future:s,window:r}=e,i=a.useRef();var l;null==i.current&&(i.current=(void 0===(l={window:r,v5Compat:!0})&&(l={}),v(function(e,t){let{pathname:n="/",search:s="",hash:a=""}=g(e.location.hash.substr(1));return n.startsWith("/")||n.startsWith(".")||(n="/"+n),f("",{pathname:n,search:s,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){let n=e.document.querySelector("base"),s="";if(n&&n.getAttribute("href")){let t=e.location.href,n=t.indexOf("#");s=-1===n?t:t.slice(0,n)}return s+"#"+("string"===typeof t?t:p(t))},function(e,t){h("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push("+JSON.stringify(t)+")")},l)));let o=i.current,[c,d]=a.useState({action:o.action,location:o.location}),{v7_startTransition:u}=s||{},m=a.useCallback(e=>{u&&je?je(()=>d(e)):d(e)},[d,u]);return a.useLayoutEffect(()=>o.listen(m),[o,m]),a.useEffect(()=>pe(s),[s]),a.createElement(ye,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:o,future:s})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var Ne,Se;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ne||(Ne={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Se||(Se={}));function ke(e,t){if(null==e)return{};var n,s,a=function(e,t){if(null==e)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(-1!==t.indexOf(s))continue;n[s]=e[s]}return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(s=0;s<r.length;s++)n=r[s],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}class Ce extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",n=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=n}}class _e extends Ce{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Ee extends Ce{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Te extends Ce{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Pe;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(Pe||(Pe={}));var Oe=function(e,t,n,s){return new(n||(n=Promise))(function(a,r){function i(e){try{o(s.next(e))}catch(ka){r(ka)}}function l(e){try{o(s.throw(e))}catch(ka){r(ka)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,l)}o((s=s.apply(e,t||[])).next())})};class Re{constructor(e){let{headers:t={},customFetch:s,region:a=Pe.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=a,this.fetch=(e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return Promise.resolve().then(n.bind(n,630)).then(e=>{let{default:n}=e;return n(...t)})}:fetch),function(){return t(...arguments)}})(s)}setAuth(e){this.headers.Authorization="Bearer ".concat(e)}invoke(e){return Oe(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){var s;try{const{headers:a,method:r,body:i,signal:l}=n;let o={},{region:c}=n;c||(c=t.region);const d=new URL("".concat(t.url,"/").concat(e));let u;c&&"any"!==c&&(o["x-region"]=c,d.searchParams.set("forceFunctionRegion",c)),i&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&("undefined"!==typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=i):"string"===typeof i?(o["Content-Type"]="text/plain",u=i):"undefined"!==typeof FormData&&i instanceof FormData?u=i:(o["Content-Type"]="application/json",u=JSON.stringify(i)));const h=yield t.fetch(d.toString(),{method:r||"POST",headers:Object.assign(Object.assign(Object.assign({},o),t.headers),a),body:u,signal:l}).catch(e=>{if("AbortError"===e.name)throw e;throw new _e(e)}),m=h.headers.get("x-relay-error");if(m&&"true"===m)throw new Ee(h);if(!h.ok)throw new Te(h);let f,p=(null!==(s=h.headers.get("Content-Type"))&&void 0!==s?s:"text/plain").split(";")[0].trim();return f="application/json"===p?yield h.json():"application/octet-stream"===p?yield h.blob():"text/event-stream"===p?h:"multipart/form-data"===p?yield h.formData():yield h.text(),{data:f,error:null,response:h}}catch(a){return a instanceof Error&&"AbortError"===a.name?{data:null,error:new _e(a)}:{data:null,error:a,response:a instanceof Te||a instanceof Ee?a.context:void 0}}}()})}}var Ae=n(980);const{PostgrestClient:Ie,PostgrestQueryBuilder:Le,PostgrestFilterBuilder:De,PostgrestTransformBuilder:Be,PostgrestBuilder:Ue,PostgrestError:Fe}=Ae;const ze=class{static detectEnvironment(){var e;if("undefined"!==typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!==typeof n.g&&"undefined"!==typeof n.g.WebSocket)return{type:"native",constructor:n.g.WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocketPair&&"undefined"===typeof globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!==typeof globalThis&&globalThis.EdgeRuntime||"undefined"!==typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!==typeof process){const e=process.versions;if(e&&e.node){const t=e.node,n=parseInt(t.replace(/^v/,"").split(".")[0]);return n>=22?"undefined"!==typeof globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:"Node.js ".concat(n," detected but native WebSocket not found."),workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:"Node.js ".concat(n," detected without native WebSocket support."),workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+="\n\nSuggested solution: ".concat(e.workaround)),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}},Me="realtime-js/".concat("2.74.0"),We=1e4;var qe,He,Ve,Ke,$e,Je;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(qe||(qe={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(He||(He={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(Ve||(Ve={})),function(e){e.websocket="websocket"}(Ke||(Ke={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}($e||($e={}));class Ge{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"===typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const s=t.getUint8(1),a=t.getUint8(2);let r=this.HEADER_LENGTH+2;const i=n.decode(e.slice(r,r+s));r+=s;const l=n.decode(e.slice(r,r+a));r+=a;return{ref:null,topic:i,event:l,payload:JSON.parse(n.decode(e.slice(r,e.byteLength)))}}}class Qe{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(Je||(Je={}));const Ye=function(e,t){var n;const s=null!==(n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==n?n:[];return t?Object.keys(t).reduce((n,a)=>(n[a]=Xe(a,e,t,s),n),{}):{}},Xe=(e,t,n,s)=>{const a=t.find(t=>t.name===e),r=null===a||void 0===a?void 0:a.type,i=n[e];return r&&!s.includes(r)?Ze(r,i):et(i)},Ze=(e,t)=>{if("_"===e.charAt(0)){const n=e.slice(1,e.length);return at(t,n)}switch(e){case Je.bool:return tt(t);case Je.float4:case Je.float8:case Je.int2:case Je.int4:case Je.int8:case Je.numeric:case Je.oid:return nt(t);case Je.json:case Je.jsonb:return st(t);case Je.timestamp:return rt(t);case Je.abstime:case Je.date:case Je.daterange:case Je.int4range:case Je.int8range:case Je.money:case Je.reltime:case Je.text:case Je.time:case Je.timestamptz:case Je.timetz:case Je.tsrange:case Je.tstzrange:default:return et(t)}},et=e=>e,tt=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},nt=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},st=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return console.log("JSON parse error: ".concat(t)),e}return e},at=(e,t)=>{if("string"!==typeof e)return e;const n=e.length-1,s=e[n];if("{"===e[0]&&"}"===s){let s;const r=e.slice(1,n);try{s=JSON.parse("["+r+"]")}catch(a){s=r?r.split(","):[]}return s.map(e=>Ze(t,e))}return e},rt=e=>"string"===typeof e?e.replace(" ","T"):e,it=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class lt{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:We;this.channel=e,this.event=t,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t(null===(n=this.receivedResp)||void 0===n?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:n}=e;this.recHooks.filter(e=>e.status===t).forEach(e=>e.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ot,ct,dt,ut;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(ot||(ot={}));class ht{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},e=>{const{onJoin:t,onLeave:n,onSync:s}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ht.syncState(this.state,e,t,n),this.pendingDiffs.forEach(e=>{this.state=ht.syncDiff(this.state,e,t,n)}),this.pendingDiffs=[],s()}),this.channel._on(n.diff,{},e=>{const{onJoin:t,onLeave:n,onSync:s}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=ht.syncDiff(this.state,e,t,n),s())}),this.onJoin((e,t,n)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:n})}),this.onLeave((e,t,n)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:n})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,s){const a=this.cloneDeep(e),r=this.transformState(t),i={},l={};return this.map(a,(e,t)=>{r[e]||(l[e]=t)}),this.map(r,(e,t)=>{const n=a[e];if(n){const s=t.map(e=>e.presence_ref),a=n.map(e=>e.presence_ref),r=t.filter(e=>a.indexOf(e.presence_ref)<0),o=n.filter(e=>s.indexOf(e.presence_ref)<0);r.length>0&&(i[e]=r),o.length>0&&(l[e]=o)}else i[e]=t}),this.syncDiff(a,{joins:i,leaves:l},n,s)}static syncDiff(e,t,n,s){const{joins:a,leaves:r}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(t,s)=>{var a;const r=null!==(a=e[t])&&void 0!==a?a:[];if(e[t]=this.cloneDeep(s),r.length>0){const n=e[t].map(e=>e.presence_ref),s=r.filter(e=>n.indexOf(e.presence_ref)<0);e[t].unshift(...s)}n(t,r,s)}),this.map(r,(t,n)=>{let a=e[t];if(!a)return;const r=n.map(e=>e.presence_ref);a=a.filter(e=>r.indexOf(e.presence_ref)<0),e[t]=a,s(t,a,n),0===a.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const s=e[n];return t[n]="metas"in s?s.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(ct||(ct={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(dt||(dt={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(ut||(ut={}));class mt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},n=arguments.length>2?arguments[2]:void 0;var s,a;if(this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=He.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new lt(this,Ve.join,this.params,this.timeout),this.rejoinTimer=new Qe(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=He.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel","close ".concat(this.topic," ").concat(this._joinRef())),this.state=He.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=He.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel","timeout ".concat(this.topic),this.joinPush.timeout),this.state=He.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=He.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ve.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new ht(this),this.broadcastEndpointURL=it(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null===(a=null===(s=this.params.config)||void 0===s?void 0:s.broadcast)||void 0===a?void 0:a.replay))throw"tried to use replay on public channel '".concat(this.topic,"'. It must be a private channel.")}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var n,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==He.closed){const{config:{broadcast:r,presence:i,private:l}}=this.params,o=null!==(s=null===(n=this.bindings.postgres_changes)||void 0===n?void 0:n.map(e=>e.filter))&&void 0!==s?s:[],c=!!this.bindings[dt.PRESENCE]&&this.bindings[dt.PRESENCE].length>0||!0===(null===(a=this.params.config.presence)||void 0===a?void 0:a.enabled),d={},u={broadcast:r,presence:Object.assign(Object.assign({},i),{enabled:c}),postgres_changes:o,private:l};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(t=>null===e||void 0===e?void 0:e(ut.CHANNEL_ERROR,t)),this._onClose(()=>null===e||void 0===e?void 0:e(ut.CLOSED)),this.updateJoinPayload(Object.assign({config:u},d)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async t=>{let{postgres_changes:n}=t;var s;if(this.socket.setAuth(),void 0!==n){const t=this.bindings.postgres_changes,a=null!==(s=null===t||void 0===t?void 0:t.length)&&void 0!==s?s:0,r=[];for(let s=0;s<a;s++){const a=t[s],{filter:{event:i,schema:l,table:o,filter:c}}=a,d=n&&n[s];if(!d||d.event!==i||d.schema!==l||d.table!==o||d.filter!==c)return this.unsubscribe(),this.state=He.errored,void(null===e||void 0===e||e(ut.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));r.push(Object.assign(Object.assign({},a),{id:d.id}))}return this.bindings.postgres_changes=r,void(e&&e(ut.SUBSCRIBED))}null===e||void 0===e||e(ut.SUBSCRIBED)}).receive("error",t=>{this.state=He.errored,null===e||void 0===e||e(ut.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null===e||void 0===e||e(ut.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===He.joined&&e===dt.PRESENCE&&(this.socket.log("channel","resubscribe to ".concat(this.topic," due to change in presence callbacks on joined channel")),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,n)}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,s;if(this._canPush()||"broadcast"!==e.type)return new Promise(n=>{var s,a,r;const i=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(r=null===(a=null===(s=this.params)||void 0===s?void 0:s.config)||void 0===a?void 0:a.broadcast)||void 0===r?void 0:r.ack)||n("ok"),i.receive("ok",()=>n("ok")),i.receive("error",()=>n("error")),i.receive("timeout",()=>n("timed out"))});{const{event:r,payload:i}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?"Bearer ".concat(this.socket.accessTokenValue):"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:i,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,l,null!==(n=t.timeout)&&void 0!==n?n:this.timeout);return await(null===(s=e.body)||void 0===s?void 0:s.cancel()),e.ok?"ok":"error"}catch(a){return"AbortError"===a.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=He.leaving;const t=()=>{this.socket.log("channel","leave ".concat(this.topic)),this._trigger(Ve.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new lt(this,Ve.leave,{},e),n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{null===n||void 0===n||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=He.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),r=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(a),r}_push(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw"tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.subscribe() before pushing events");let s=new lt(this,e,t,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel","discarded push due to buffer overflow: ".concat(e.event),e.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var s,a;const r=e.toLocaleLowerCase(),{close:i,error:l,leave:o,join:c}=Ve;if(n&&[i,l,o,c].indexOf(r)>=0&&n!==this._joinRef())return;let d=this._onMessage(r,t,n);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(r)?null===(s=this.bindings.postgres_changes)||void 0===s||s.filter(e=>{var t,n,s;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(s=null===(n=e.filter)||void 0===n?void 0:n.event)||void 0===s?void 0:s.toLocaleLowerCase())===r}).map(e=>e.callback(d,n)):null===(a=this.bindings[r])||void 0===a||a.filter(e=>{var n,s,a,i,l,o;if(["broadcast","presence","postgres_changes"].includes(r)){if("id"in e){const r=e.id,i=null===(n=e.filter)||void 0===n?void 0:n.event;return r&&(null===(s=t.ids)||void 0===s?void 0:s.includes(r))&&("*"===i||(null===i||void 0===i?void 0:i.toLocaleLowerCase())===(null===(a=t.data)||void 0===a?void 0:a.type.toLocaleLowerCase()))}{const n=null===(l=null===(i=null===e||void 0===e?void 0:e.filter)||void 0===i?void 0:i.event)||void 0===l?void 0:l.toLocaleLowerCase();return"*"===n||n===(null===(o=null===t||void 0===t?void 0:t.event)||void 0===o?void 0:o.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===r}).map(e=>{if("object"===typeof d&&"ids"in d){const e=d.data,{schema:t,table:n,commit_timestamp:s,type:a,errors:r}=e,i={schema:t,table:n,commit_timestamp:s,eventType:a,new:{},old:{},errors:r};d=Object.assign(Object.assign({},i),this._getPayloadRecords(e))}e.callback(d,n)})}_isClosed(){return this.state===He.closed}_isJoined(){return this.state===He.joined}_isJoining(){return this.state===He.joining}_isLeaving(){return this.state===He.leaving}_replyEventName(e){return"chan_reply_".concat(e)}_on(e,t,n){const s=e.toLocaleLowerCase(),a={type:s,filter:t,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(e=>{var s;return!((null===(s=e.type)||void 0===s?void 0:s.toLocaleLowerCase())===n&&mt.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ve.close,{},e)}_onError(e){this._on(Ve.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=He.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=Ye(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=Ye(e.columns,e.old_record)),t}}const ft=()=>{},pt=25e3,gt=10,vt=100,yt=[1e3,2e3,5e3,1e4];class bt{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=We,this.transport=null,this.heartbeatIntervalMs=pt,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ft,this.ref=0,this.reconnectTimer=null,this.logger=ft,this.conn=null,this.sendBuffer=[],this.serializer=new Ge,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return Promise.resolve().then(n.bind(n,630)).then(e=>{let{default:n}=e;return n(...t)}).catch(e=>{throw new Error("Failed to load @supabase/node-fetch: ".concat(e.message,". ")+"This is required for HTTP requests in Node.js environments without native fetch.")})}:fetch),function(){return t(...arguments)}},!(null===(s=null===t||void 0===t?void 0:t.params)||void 0===s?void 0:s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint="".concat(e,"/").concat(Ke.websocket),this.httpEndpoint=it(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ze.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error("".concat(t,"\n\n")+'To use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })');throw new Error("WebSocket not available: ".concat(t))}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case qe.connecting:return $e.Connecting;case qe.open:return $e.Open;case qe.closing:return $e.Closing;default:return $e.Closed}}isConnected(){return this.connectionState()===$e.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};const n="realtime:".concat(e),s=this.getChannels().find(e=>e.topic===n);if(s)return s;{const n=new mt("realtime:".concat(e),t,this);return this.channels.push(n),n}}push(e){const{topic:t,event:n,payload:s,ref:a}=e,r=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push","".concat(t," ").concat(n," (").concat(a,")"),s),this.isConnected()?r():this.sendBuffer.push(r)}async setAuth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(ka){this.log("error","error in heartbeat callback",ka)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},vt)}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(ka){this.log("error","error in heartbeat callback",ka)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(ka){this.log("error","error in heartbeat callback",ka)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",'leaving duplicate topic "'.concat(e,'"')),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event)try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error")}catch(ka){this.log("error","error in heartbeat callback",ka)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:t,event:n,payload:s,ref:a}=e,r=a?"(".concat(a,")"):"",i=s.status||"";this.log("receive","".concat(i," ").concat(t," ").concat(n," ").concat(r).trim(),s),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(n,s,a)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport","connected to ".concat(this.endpointURL())),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker","starting worker for from ".concat(this.workerUrl)):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport","".concat(e)),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ve.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return"".concat(e).concat(n).concat(s)}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e=t||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(t=>{const n={access_token:e,version:Me};e&&t.updateJoinPayload(n),t.joinedOnce&&t._isJoined()&&t._push(Ve.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"general";this.setAuth().catch(t=>{this.log("error","error setting auth in ".concat(e),t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(ka){this.log("error","error in ".concat(e," callback"),ka)}})}catch(ka){this.log("error","error triggering ".concat(e," callbacks"),ka)}}_setupReconnectionTimer(){this.reconnectTimer=new Qe(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},gt)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,s,a,r,i,l,o,c;if(this.transport=null!==(t=null===e||void 0===e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(n=null===e||void 0===e?void 0:e.timeout)&&void 0!==n?n:We,this.heartbeatIntervalMs=null!==(s=null===e||void 0===e?void 0:e.heartbeatIntervalMs)&&void 0!==s?s:pt,this.worker=null!==(a=null===e||void 0===e?void 0:e.worker)&&void 0!==a&&a,this.accessToken=null!==(r=null===e||void 0===e?void 0:e.accessToken)&&void 0!==r?r:null,this.heartbeatCallback=null!==(i=null===e||void 0===e?void 0:e.heartbeatCallback)&&void 0!==i?i:ft,(null===e||void 0===e?void 0:e.params)&&(this.params=e.params),(null===e||void 0===e?void 0:e.logger)&&(this.logger=e.logger),((null===e||void 0===e?void 0:e.logLevel)||(null===e||void 0===e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(l=null===e||void 0===e?void 0:e.reconnectAfterMs)&&void 0!==l?l:e=>yt[e-1]||1e4,this.encode=null!==(o=null===e||void 0===e?void 0:e.encode)&&void 0!==o?o:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(c=null===e||void 0===e?void 0:e.decode)&&void 0!==c?c:this.serializer.decode.bind(this.serializer),this.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null===e||void 0===e?void 0:e.workerUrl}}}class xt extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function jt(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}class wt extends xt{constructor(e,t,n){super(e),this.name="StorageApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Nt extends xt{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var St=function(e,t,n,s){return new(n||(n=Promise))(function(a,r){function i(e){try{o(s.next(e))}catch(ka){r(ka)}}function l(e){try{o(s.throw(e))}catch(ka){r(ka)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,l)}o((s=s.apply(e,t||[])).next())})};const kt=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return Promise.resolve().then(n.bind(n,630)).then(e=>{let{default:n}=e;return n(...t)})}:fetch),function(){return t(...arguments)}},Ct=e=>{if(Array.isArray(e))return e.map(e=>Ct(e));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(e=>{let[n,s]=e;const a=n.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[a]=Ct(s)}),t};var _t=function(e,t,n,s){return new(n||(n=Promise))(function(a,r){function i(e){try{o(s.next(e))}catch(ka){r(ka)}}function l(e){try{o(s.throw(e))}catch(ka){r(ka)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,l)}o((s=s.apply(e,t||[])).next())})};const Et=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Tt=(e,t,s)=>_t(void 0,void 0,void 0,function*(){const a=yield St(void 0,void 0,void 0,function*(){return"undefined"===typeof Response?(yield Promise.resolve().then(n.bind(n,630))).Response:Response});e instanceof a&&!(null===s||void 0===s?void 0:s.noResolveJson)?e.json().then(n=>{const s=e.status||500,a=(null===n||void 0===n?void 0:n.statusCode)||s+"";t(new wt(Et(n),s,a))}).catch(e=>{t(new Nt(Et(e),e))}):t(new Nt(Et(e),e))}),Pt=(e,t,n,s)=>{const a={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"!==e&&s?((e=>{if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)})(s)?(a.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),a.body=JSON.stringify(s)):a.body=s,(null===t||void 0===t?void 0:t.duplex)&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),n)):a};function Ot(e,t,n,s,a,r){return _t(this,void 0,void 0,function*(){return new Promise((i,l)=>{e(n,Pt(t,s,a,r)).then(e=>{if(!e.ok)throw e;return(null===s||void 0===s?void 0:s.noResolveJson)?e:e.json()}).then(e=>i(e)).catch(e=>Tt(e,l,s))})})}function Rt(e,t,n,s){return _t(this,void 0,void 0,function*(){return Ot(e,"GET",t,n,s)})}function At(e,t,n,s,a){return _t(this,void 0,void 0,function*(){return Ot(e,"POST",t,s,a,n)})}function It(e,t,n,s,a){return _t(this,void 0,void 0,function*(){return Ot(e,"PUT",t,s,a,n)})}function Lt(e,t,n,s,a){return _t(this,void 0,void 0,function*(){return Ot(e,"DELETE",t,s,a,n)})}var Dt=function(e,t,n,s){return new(n||(n=Promise))(function(a,r){function i(e){try{o(s.next(e))}catch(ka){r(ka)}}function l(e){try{o(s.throw(e))}catch(ka){r(ka)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,l)}o((s=s.apply(e,t||[])).next())})};class Bt{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return Dt(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(jt(e))return{data:null,error:e};throw e}})}}var Ut=function(e,t,n,s){return new(n||(n=Promise))(function(a,r){function i(e){try{o(s.next(e))}catch(ka){r(ka)}}function l(e){try{o(s.throw(e))}catch(ka){r(ka)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,l)}o((s=s.apply(e,t||[])).next())})};class Ft{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}asStream(){return new Bt(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.execute().then(e,t)}execute(){return Ut(this,void 0,void 0,function*(){try{const e=yield this.downloadFn();return{data:yield e.blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(jt(e))return{data:null,error:e};throw e}})}}var zt=function(e,t,n,s){return new(n||(n=Promise))(function(a,r){function i(e){try{o(s.next(e))}catch(ka){r(ka)}}function l(e){try{o(s.throw(e))}catch(ka){r(ka)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,l)}o((s=s.apply(e,t||[])).next())})};const Mt={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Wt={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class qt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=n,this.fetch=kt(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,n,s){return zt(this,void 0,void 0,function*(){try{let a;const r=Object.assign(Object.assign({},Wt),s);let i=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(r.upsert)});const l=r.metadata;"undefined"!==typeof Blob&&n instanceof Blob?(a=new FormData,a.append("cacheControl",r.cacheControl),l&&a.append("metadata",this.encodeMetadata(l)),a.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(a=n,a.append("cacheControl",r.cacheControl),l&&a.append("metadata",this.encodeMetadata(l))):(a=n,i["cache-control"]="max-age=".concat(r.cacheControl),i["content-type"]=r.contentType,l&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),(null===s||void 0===s?void 0:s.headers)&&(i=Object.assign(Object.assign({},i),s.headers));const o=this._removeEmptyFolders(t),c=this._getFinalPath(o),d=yield("PUT"==e?It:At)(this.fetch,"".concat(this.url,"/object/").concat(c),a,Object.assign({headers:i},(null===r||void 0===r?void 0:r.duplex)?{duplex:r.duplex}:{}));return{data:{path:o,id:d.Id,fullPath:d.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(jt(a))return{data:null,error:a};throw a}})}upload(e,t,n){return zt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,s){return zt(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),r=this._getFinalPath(a),i=new URL(this.url+"/object/upload/sign/".concat(r));i.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:Wt.upsert},s),r=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!==typeof Blob&&n instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(e=n,e.append("cacheControl",t.cacheControl)):(e=n,r["cache-control"]="max-age=".concat(t.cacheControl),r["content-type"]=t.contentType);return{data:{path:a,fullPath:(yield It(this.fetch,i.toString(),e,{headers:r})).Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(jt(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return zt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);(null===t||void 0===t?void 0:t.upsert)&&(s["x-upsert"]="true");const a=yield At(this.fetch,"".concat(this.url,"/object/upload/sign/").concat(n),{},{headers:s}),r=new URL(this.url+a.url),i=r.searchParams.get("token");if(!i)throw new xt("No token returned by API");return{data:{signedUrl:r.toString(),path:e,token:i},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}update(e,t,n){return zt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return zt(this,void 0,void 0,function*(){try{return{data:yield At(this.fetch,"".concat(this.url,"/object/move"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}copy(e,t,n){return zt(this,void 0,void 0,function*(){try{return{data:{path:(yield At(this.fetch,"".concat(this.url,"/object/copy"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,n){return zt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),a=yield At(this.fetch,"".concat(this.url,"/object/sign/").concat(s),Object.assign({expiresIn:t},(null===n||void 0===n?void 0:n.transform)?{transform:n.transform}:{}),{headers:this.headers});const r=(null===n||void 0===n?void 0:n.download)?"&download=".concat(!0===n.download?"":n.download):"";return a={signedUrl:encodeURI("".concat(this.url).concat(a.signedURL).concat(r))},{data:a,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,n){return zt(this,void 0,void 0,function*(){try{const s=yield At(this.fetch,"".concat(this.url,"/object/sign/").concat(this.bucketId),{expiresIn:t,paths:e},{headers:this.headers}),a=(null===n||void 0===n?void 0:n.download)?"&download=".concat(!0===n.download?"":n.download):"";return{data:s.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI("".concat(this.url).concat(e.signedURL).concat(a)):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}download(e,t){const n="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",s=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),a=s?"?".concat(s):"",r=this._getFinalPath(e);return new Ft(()=>Rt(this.fetch,"".concat(this.url,"/").concat(n,"/").concat(r).concat(a),{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}info(e){return zt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const e=yield Rt(this.fetch,"".concat(this.url,"/object/info/").concat(t),{headers:this.headers});return{data:Ct(e),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}exists(e){return zt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield function(e,t,n,s){return _t(this,void 0,void 0,function*(){return Ot(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),s)})}(this.fetch,"".concat(this.url,"/object/").concat(t),{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n)&&n instanceof Nt){const e=n.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),s=[],a=(null===t||void 0===t?void 0:t.download)?"download=".concat(!0===t.download?"":t.download):"";""!==a&&s.push(a);const r="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",i=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==i&&s.push(i);let l=s.join("&");return""!==l&&(l="?".concat(l)),{data:{publicUrl:encodeURI("".concat(this.url,"/").concat(r,"/public/").concat(n).concat(l))}}}remove(e){return zt(this,void 0,void 0,function*(){try{return{data:yield Lt(this.fetch,"".concat(this.url,"/object/").concat(this.bucketId),{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(jt(t))return{data:null,error:t};throw t}})}list(e,t,n){return zt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Mt),t),{prefix:e||""});return{data:yield At(this.fetch,"".concat(this.url,"/object/list/").concat(this.bucketId),s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}listV2(e,t){return zt(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield At(this.fetch,"".concat(this.url,"/object/list-v2/").concat(this.bucketId),n,{headers:this.headers},t),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return"".concat(this.bucketId,"/").concat(e.replace(/^\/+/,""))}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push("width=".concat(e.width)),e.height&&t.push("height=".concat(e.height)),e.resize&&t.push("resize=".concat(e.resize)),e.format&&t.push("format=".concat(e.format)),e.quality&&t.push("quality=".concat(e.quality)),t.join("&")}}const Ht={"X-Client-Info":"storage-js/".concat("2.74.0")};var Vt=function(e,t,n,s){return new(n||(n=Promise))(function(a,r){function i(e){try{o(s.next(e))}catch(ka){r(ka)}}function l(e){try{o(s.throw(e))}catch(ka){r(ka)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,l)}o((s=s.apply(e,t||[])).next())})};class Kt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;this.shouldThrowOnError=!1;const a=new URL(e);if(null===s||void 0===s?void 0:s.useNewHostname){/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase."))}this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ht),t),this.fetch=kt(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Vt(this,void 0,void 0,function*(){try{return{data:yield Rt(this.fetch,"".concat(this.url,"/bucket"),{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(jt(e))return{data:null,error:e};throw e}})}getBucket(e){return Vt(this,void 0,void 0,function*(){try{return{data:yield Rt(this.fetch,"".concat(this.url,"/bucket/").concat(e),{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(jt(t))return{data:null,error:t};throw t}})}createBucket(e){return Vt(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return function*(){try{return{data:yield At(t.fetch,"".concat(t.url,"/bucket"),{id:e,name:e,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}}()})}updateBucket(e,t){return Vt(this,void 0,void 0,function*(){try{return{data:yield It(this.fetch,"".concat(this.url,"/bucket/").concat(e),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}emptyBucket(e){return Vt(this,void 0,void 0,function*(){try{return{data:yield At(this.fetch,"".concat(this.url,"/bucket/").concat(e,"/empty"),{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(jt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Vt(this,void 0,void 0,function*(){try{return{data:yield Lt(this.fetch,"".concat(this.url,"/bucket/").concat(e),{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(jt(t))return{data:null,error:t};throw t}})}}class $t extends Kt{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0)}from(e){return new qt(this.url,this.headers,e,this.fetch)}}let Jt="";Jt="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Gt={headers:{"X-Client-Info":"supabase-js-".concat(Jt,"/").concat("2.74.0")}},Qt={schema:"public"},Yt={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Xt={};var Zt=n(630),en=function(e,t,n,s){return new(n||(n=Promise))(function(a,r){function i(e){try{o(s.next(e))}catch(ka){r(ka)}}function l(e){try{o(s.throw(e))}catch(ka){r(ka)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,l)}o((s=s.apply(e,t||[])).next())})};const tn=e=>{let t;return t=e||("undefined"===typeof fetch?Zt.default:fetch),function(){return t(...arguments)}},nn=(e,t,n)=>{const s=tn(n),a="undefined"===typeof Headers?Zt.Headers:Headers;return(n,r)=>en(void 0,void 0,void 0,function*(){var i;const l=null!==(i=yield t())&&void 0!==i?i:e;let o=new a(null===r||void 0===r?void 0:r.headers);return o.has("apikey")||o.set("apikey",e),o.has("Authorization")||o.set("Authorization","Bearer ".concat(l)),s(n,Object.assign(Object.assign({},r),{headers:o}))})};var sn=function(e,t,n,s){return new(n||(n=Promise))(function(a,r){function i(e){try{o(s.next(e))}catch(ka){r(ka)}}function l(e){try{o(s.throw(e))}catch(ka){r(ka)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,l)}o((s=s.apply(e,t||[])).next())})};const an="2.74.0",rn=3e4,ln=9e4,on={"X-Client-Info":"gotrue-js/".concat(an)},cn="X-Supabase-Api-Version",dn={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},un=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class hn extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function mn(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class fn extends hn{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}class pn extends hn{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class gn extends hn{constructor(e,t,n,s){super(e,n,s),this.name=t,this.status=n}}class vn extends gn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class yn extends gn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class bn extends gn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class xn extends gn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class jn extends gn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class wn extends gn{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Nn(e){return mn(e)&&"AuthRetryableFetchError"===e.name}class Sn extends gn{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class kn extends gn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Cn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),_n=" \t\n\r=".split(""),En=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<_n.length;t+=1)e[_n[t].charCodeAt(0)]=-2;for(let t=0;t<Cn.length;t+=1)e[Cn[t].charCodeAt(0)]=t;return e})();function Tn(e,t,n){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;n(Cn[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;n(Cn[e]),t.queuedBits-=6}}function Pn(e,t,n){const s=En[e];if(!(s>-1)){if(-2===s)return;throw new Error('Invalid Base64-URL character "'.concat(String.fromCharCode(e),'"'))}for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function On(e){const t=[],n=e=>{t.push(String.fromCodePoint(e))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},r=e=>{!function(e,t,n){if(0===t.utf8seq){if(e<=127)return void n(e);for(let n=1;n<6;n+=1)if(0===(e>>7-n&1)){t.utf8seq=n;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&n(t.codepoint)}}(e,s,n)};for(let i=0;i<e.length;i+=1)Pn(e.charCodeAt(i),a,r);return t.join("")}function Rn(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error("Unrecognized Unicode codepoint: ".concat(e.toString(16)))}t(e)}function An(e,t){for(let n=0;n<e.length;n+=1){let s=e.charCodeAt(n);if(s>55295&&s<=56319){const t=1024*(s-55296)&65535;s=65536+(e.charCodeAt(n+1)-56320&65535|t),n+=1}Rn(s,t)}}function In(e){const t=[],n={queue:0,queuedBits:0},s=e=>{t.push(e)};for(let a=0;a<e.length;a+=1)Pn(e.charCodeAt(a),n,s);return new Uint8Array(t)}function Ln(e){const t=[],n={queue:0,queuedBits:0},s=e=>{t.push(e)};return e.forEach(e=>Tn(e,n,s)),Tn(null,n,s),t.join("")}const Dn=()=>"undefined"!==typeof window&&"undefined"!==typeof document,Bn={tested:!1,writable:!1},Un=()=>{if(!Dn())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(ka){return!1}if(Bn.tested)return Bn.writable;const e="lswt-".concat(Math.random()).concat(Math.random());try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Bn.tested=!0,Bn.writable=!0}catch(ka){Bn.tested=!0,Bn.writable=!1}return Bn.writable};const Fn=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return Promise.resolve().then(n.bind(n,630)).then(e=>{let{default:n}=e;return n(...t)})}:fetch),function(){return t(...arguments)}},zn=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},Mn=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch(s){return n}},Wn=async(e,t)=>{await e.removeItem(t)};class qn{constructor(){this.promise=new qn.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function Hn(e){const t=e.split(".");if(3!==t.length)throw new kn("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!un.test(t[n]))throw new kn("JWT not in base64url format");return{header:JSON.parse(On(t[0])),payload:JSON.parse(On(t[1])),signature:In(t[2]),raw:{header:t[0],payload:t[1]}}}function Vn(e){return("0"+e.toString(16)).substr(-2)}async function Kn(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(n);return Array.from(s).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $n(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const s=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let n="";for(let s=0;s<56;s++)n+=e.charAt(Math.floor(Math.random()*t));return n}return crypto.getRandomValues(e),Array.from(e,Vn).join("")}();let a=s;n&&(a+="/PASSWORD_RECOVERY"),await zn(e,"".concat(t,"-code-verifier"),a);const r=await Kn(s);return[r,s===r?"plain":"s256"]}qn.promiseConstructor=Promise;const Jn=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const Gn=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Qn(e){if(!Gn.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Yn(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"===typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "'.concat(t,'" property of the session object is not supported. Please use getUser() instead.'))},set:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))},deleteProperty:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))}})}function Xn(e){return JSON.parse(JSON.stringify(e))}var Zn=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(n[s[a]]=e[s[a]])}return n};const es=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ts=[502,503,504];async function ns(e){var t,n;if(!("object"===typeof(n=e)&&null!==n&&"status"in n&&"ok"in n&&"json"in n&&"function"===typeof n.json))throw new wn(es(e),0);if(ts.includes(e.status))throw new wn(es(e),e.status);let s,a;try{s=await e.json()}catch(ka){throw new pn(es(ka),ka)}const r=function(e){const t=e.headers.get(cn);if(!t)return null;if(!t.match(Jn))return null;try{return new Date("".concat(t,"T00:00:00.0Z"))}catch(ka){return null}}(e);if(r&&r.getTime()>=dn.timestamp&&"object"===typeof s&&s&&"string"===typeof s.code?a=s.code:"object"===typeof s&&s&&"string"===typeof s.error_code&&(a=s.error_code),a){if("weak_password"===a)throw new Sn(es(s),e.status,(null===(t=s.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===a)throw new vn}else if("object"===typeof s&&s&&"object"===typeof s.weak_password&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0))throw new Sn(es(s),e.status,s.weak_password.reasons);throw new fn(es(s),e.status||500,a)}async function ss(e,t,n,s){var a;const r=Object.assign({},null===s||void 0===s?void 0:s.headers);r[cn]||(r[cn]=dn.name),(null===s||void 0===s?void 0:s.jwt)&&(r.Authorization="Bearer ".concat(s.jwt));const i=null!==(a=null===s||void 0===s?void 0:s.query)&&void 0!==a?a:{};(null===s||void 0===s?void 0:s.redirectTo)&&(i.redirect_to=s.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",o=await async function(e,t,n,s,a,r){const i=((e,t,n,s)=>{const a={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),n))})(t,s,a,r);let l;try{l=await e(n,Object.assign({},i))}catch(ka){throw console.error(ka),new wn(es(ka),0)}l.ok||await ns(l);if(null===s||void 0===s?void 0:s.noResolveJson)return l;try{return await l.json()}catch(ka){await ns(ka)}}(e,t,n+l,{headers:r,noResolveJson:null===s||void 0===s?void 0:s.noResolveJson},{},null===s||void 0===s?void 0:s.body);return(null===s||void 0===s?void 0:s.xform)?null===s||void 0===s?void 0:s.xform(o):{data:Object.assign({},o),error:null}}function as(e){var t;let n=null;var s;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=(s=e.expires_in,Math.round(Date.now()/1e3)+s)));return{data:{session:n,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function rs(e){const t=as(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function is(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function ls(e){return{data:e,error:null}}function os(e){const{action_link:t,email_otp:n,hashed_token:s,redirect_to:a,verification_type:r}=e,i=Zn(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:n,hashed_token:s,redirect_to:a,verification_type:r},user:Object.assign({},i)},error:null}}function cs(e){return e}const ds=["global","local","others"];var us=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(n[s[a]]=e[s[a]])}return n};class hs{constructor(e){let{url:t="",headers:n={},fetch:s}=e;this.url=t,this.headers=n,this.fetch=Fn(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ds[0];if(ds.indexOf(t)<0)throw new Error("@supabase/auth-js: Parameter scope must be one of ".concat(ds.join(", ")));try{return await ss(this.fetch,"POST","".concat(this.url,"/logout?scope=").concat(t),{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(mn(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await ss(this.fetch,"POST","".concat(this.url,"/invite"),{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:is})}catch(n){if(mn(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=us(e,["options"]),s=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(s.new_email=null===n||void 0===n?void 0:n.newEmail,delete s.newEmail),await ss(this.fetch,"POST","".concat(this.url,"/admin/generate_link"),{body:s,headers:this.headers,xform:os,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(mn(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await ss(this.fetch,"POST","".concat(this.url,"/admin/users"),{body:e,headers:this.headers,xform:is})}catch(t){if(mn(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,s,a,r,i,l;try{const o={nextPage:null,lastPage:0,total:0},c=await ss(this.fetch,"GET","".concat(this.url,"/admin/users"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(n=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",per_page:null!==(a=null===(s=null===e||void 0===e?void 0:e.perPage)||void 0===s?void 0:s.toString())&&void 0!==a?a:""},xform:cs});if(c.error)throw c.error;const d=await c.json(),u=null!==(r=c.headers.get("x-total-count"))&&void 0!==r?r:0,h=null!==(l=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==l?l:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),n=JSON.parse(e.split(";")[1].split("=")[1]);o["".concat(n,"Page")]=t}),o.total=parseInt(u)),{data:Object.assign(Object.assign({},d),o),error:null}}catch(o){if(mn(o))return{data:{users:[]},error:o};throw o}}async getUserById(e){Qn(e);try{return await ss(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,xform:is})}catch(t){if(mn(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Qn(e);try{return await ss(this.fetch,"PUT","".concat(this.url,"/admin/users/").concat(e),{body:t,headers:this.headers,xform:is})}catch(n){if(mn(n))return{data:{user:null},error:n};throw n}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Qn(e);try{return await ss(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,body:{should_soft_delete:t},xform:is})}catch(n){if(mn(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Qn(e.userId);try{const{data:t,error:n}=await ss(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e.userId,"/factors"),{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:n}}catch(t){if(mn(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Qn(e.userId),Qn(e.id);try{return{data:await ss(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e.userId,"/factors/").concat(e.id),{headers:this.headers}),error:null}}catch(t){if(mn(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,n,s,a,r,i,l;try{const o={nextPage:null,lastPage:0,total:0},c=await ss(this.fetch,"GET","".concat(this.url,"/admin/oauth/clients"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(n=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",per_page:null!==(a=null===(s=null===e||void 0===e?void 0:e.perPage)||void 0===s?void 0:s.toString())&&void 0!==a?a:""},xform:cs});if(c.error)throw c.error;const d=await c.json(),u=null!==(r=c.headers.get("x-total-count"))&&void 0!==r?r:0,h=null!==(l=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==l?l:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),n=JSON.parse(e.split(";")[1].split("=")[1]);o["".concat(n,"Page")]=t}),o.total=parseInt(u)),{data:Object.assign(Object.assign({},d),o),error:null}}catch(o){if(mn(o))return{data:{clients:[]},error:o};throw o}}async _createOAuthClient(e){try{return await ss(this.fetch,"POST","".concat(this.url,"/admin/oauth/clients"),{body:e,headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(mn(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await ss(this.fetch,"GET","".concat(this.url,"/admin/oauth/clients/").concat(e),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(mn(t))return{data:null,error:t};throw t}}async _deleteOAuthClient(e){try{return await ss(this.fetch,"DELETE","".concat(this.url,"/admin/oauth/clients/").concat(e),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(mn(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await ss(this.fetch,"POST","".concat(this.url,"/admin/oauth/clients/").concat(e,"/regenerate_secret"),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(mn(t))return{data:null,error:t};throw t}}}function ms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}const fs=!!(globalThis&&Un()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class ps extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class gs extends ps{}async function vs(e,t,n){fs&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),fs&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async s=>{if(!s){if(0===t)throw fs&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new gs('Acquiring an exclusive Navigator LockManager lock "'.concat(e,'" immediately failed'));if(fs)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(ka){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",ka)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}fs&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await n()}finally{fs&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}))}function ys(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error('@supabase/auth-js: Address "'.concat(e,'" is invalid.'));return e.toLowerCase()}function bs(e){const t=(new TextEncoder).encode(e);return"0x"+Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")}class xs extends Error{constructor(e){let{message:t,code:n,cause:s,name:a}=e;var r;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=null!==(r=null!==a&&void 0!==a?a:s instanceof Error?s.name:void 0)&&void 0!==r?r:"Unknown Error",this.code=n}}class js extends xs{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function ws(e){let{error:t,options:n}=e;var s,a,r;const{publicKey:i}=n;if(!i)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(n.signal instanceof AbortSignal)return new xs({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if("ConstraintError"===t.name){if(!0===(null===(s=i.authenticatorSelection)||void 0===s?void 0:s.requireResidentKey))return new xs({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if("conditional"===n.mediation&&"required"===(null===(a=i.authenticatorSelection)||void 0===a?void 0:a.userVerification))return new xs({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if("required"===(null===(r=i.authenticatorSelection)||void 0===r?void 0:r.userVerification))return new xs({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if("InvalidStateError"===t.name)return new xs({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if("NotAllowedError"===t.name)return new xs({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("NotSupportedError"===t.name){return 0===i.pubKeyCredParams.filter(e=>"public-key"===e.type).length?new xs({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new xs({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t})}if("SecurityError"===t.name){const e=window.location.hostname;if(!Ps(e))return new xs({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(i.rp.id!==e)return new xs({message:'The RP ID "'.concat(i.rp.id,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("TypeError"===t.name){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new xs({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if("UnknownError"===t.name)return new xs({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new xs({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Ns(e){let{error:t,options:n}=e;const{publicKey:s}=n;if(!s)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(n.signal instanceof AbortSignal)return new xs({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if("NotAllowedError"===t.name)return new xs({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("SecurityError"===t.name){const e=window.location.hostname;if(!Ps(e))return new xs({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(s.rpId!==e)return new xs({message:'The RP ID "'.concat(s.rpId,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("UnknownError"===t.name)return new xs({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new xs({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}var Ss=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(n[s[a]]=e[s[a]])}return n};const ks=new class{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}};function Cs(e){if(!e)throw new Error("Credential creation options are required");if("undefined"!==typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"===typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:n,excludeCredentials:s}=e,a=Ss(e,["challenge","user","excludeCredentials"]),r=In(t).buffer,i=Object.assign(Object.assign({},n),{id:In(n.id).buffer}),l=Object.assign(Object.assign({},a),{challenge:r,user:i});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let e=0;e<s.length;e++){const t=s[e];l.excludeCredentials[e]=Object.assign(Object.assign({},t),{id:In(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return l}function _s(e){if(!e)throw new Error("Credential request options are required");if("undefined"!==typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"===typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:n}=e,s=Ss(e,["challenge","allowCredentials"]),a=In(t).buffer,r=Object.assign(Object.assign({},s),{challenge:a});if(n&&n.length>0){r.allowCredentials=new Array(n.length);for(let e=0;e<n.length;e++){const t=n[e];r.allowCredentials[e]=Object.assign(Object.assign({},t),{id:In(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return r}function Es(e){var t;if("toJSON"in e&&"function"===typeof e.toJSON)return e.toJSON();const n=e;return{id:e.id,rawId:e.id,response:{attestationObject:Ln(new Uint8Array(e.response.attestationObject)),clientDataJSON:Ln(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:null!==(t=n.authenticatorAttachment)&&void 0!==t?t:void 0}}function Ts(e){var t;if("toJSON"in e&&"function"===typeof e.toJSON)return e.toJSON();const n=e,s=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Ln(new Uint8Array(a.authenticatorData)),clientDataJSON:Ln(new Uint8Array(a.clientDataJSON)),signature:Ln(new Uint8Array(a.signature)),userHandle:a.userHandle?Ln(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:null!==(t=n.authenticatorAttachment)&&void 0!==t?t:void 0}}function Ps(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function Os(){var e,t;return!!(Dn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"===typeof(null===(e=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===e?void 0:e.create)&&"function"===typeof(null===(t=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===t?void 0:t.get))}const Rs={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},As={userVerification:"preferred",hints:["security-key"]};function Is(){const e=e=>null!==e&&"object"===typeof e&&!Array.isArray(e),t=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),n={};for(var s=arguments.length,a=new Array(s),r=0;r<s;r++)a[r]=arguments[r];for(const i of a)if(i)for(const s in i){const a=i[s];if(void 0!==a)if(Array.isArray(a))n[s]=a;else if(t(a))n[s]=a;else if(e(a)){const t=n[s];e(t)?n[s]=Is(t,a):n[s]=Is(a)}else n[s]=a}return n}class Ls{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge(e,t){let{factorId:n,webauthn:s,friendlyName:a,signal:r}=e;try{const{data:e,error:i}=await this.client.mfa.challenge({factorId:n,webauthn:s});if(!e)return{data:null,error:i};const l=null!==r&&void 0!==r?r:ks.createNewAbortSignal();if("create"===e.webauthn.type){const{user:t}=e.webauthn.credential_options.publicKey;t.name||(t.name="".concat(t.id,":").concat(a)),t.displayName||(t.displayName=t.name)}switch(e.webauthn.type){case"create":{const s=function(e,t){return Is(Rs,e,t||{})}(e.webauthn.credential_options.publicKey,null===t||void 0===t?void 0:t.create),{data:a,error:r}=await async function(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new js("Browser returned unexpected credential type",t)}:{data:null,error:new js("Empty credential response",t)}}catch(t){return{data:null,error:ws({error:t,options:e})}}}({publicKey:s,signal:l});return a?{data:{factorId:n,challengeId:e.id,webauthn:{type:e.webauthn.type,credential_response:a}},error:null}:{data:null,error:r}}case"request":{const s=function(e,t){return Is(As,e,t||{})}(e.webauthn.credential_options.publicKey,null===t||void 0===t?void 0:t.request),{data:a,error:r}=await async function(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new js("Browser returned unexpected credential type",t)}:{data:null,error:new js("Empty credential response",t)}}catch(t){return{data:null,error:Ns({error:t,options:e})}}}(Object.assign(Object.assign({},e.webauthn.credential_options),{publicKey:s,signal:l}));return a?{data:{factorId:n,challengeId:e.id,webauthn:{type:e.webauthn.type,credential_response:a}},error:null}:{data:null,error:r}}}}catch(i){return mn(i)?{data:null,error:i}:{data:null,error:new pn("Unexpected error in challenge",i)}}}async _verify(e){let{challengeId:t,factorId:n,webauthn:s}=e;return this.client.mfa.verify({factorId:n,challengeId:t,webauthn:s})}async _authenticate(e,t){let{factorId:n,webauthn:{rpId:s=("undefined"!==typeof window?window.location.hostname:void 0),rpOrigins:a=("undefined"!==typeof window?[window.location.origin]:void 0),signal:r}}=e;if(!s)return{data:null,error:new hn("rpId is required for WebAuthn authentication")};try{if(!Os())return{data:null,error:new pn("Browser does not support WebAuthn",null)};const{data:e,error:i}=await this.challenge({factorId:n,webauthn:{rpId:s,rpOrigins:a},signal:r},{request:t});if(!e)return{data:null,error:i};const{webauthn:l}=e;return this._verify({factorId:n,challengeId:e.challengeId,webauthn:{type:l.type,rpId:s,rpOrigins:a,credential_response:l.credential_response}})}catch(i){return mn(i)?{data:null,error:i}:{data:null,error:new pn("Unexpected error in authenticate",i)}}}async _register(e,t){let{friendlyName:n,rpId:s=("undefined"!==typeof window?window.location.hostname:void 0),rpOrigins:a=("undefined"!==typeof window?[window.location.origin]:void 0),signal:r}=e;if(!s)return{data:null,error:new hn("rpId is required for WebAuthn registration")};try{if(!Os())return{data:null,error:new pn("Browser does not support WebAuthn",null)};const{data:e,error:i}=await this._enroll({friendlyName:n});if(!e)return await this.client.mfa.listFactors().then(e=>{var t;return null===(t=e.data)||void 0===t?void 0:t.all.find(e=>"webauthn"===e.factor_type&&e.friendly_name===n&&"unverified"!==e.status)}).then(e=>e?this.client.mfa.unenroll({factorId:null===e||void 0===e?void 0:e.id}):void 0),{data:null,error:i};const{data:l,error:o}=await this._challenge({factorId:e.id,friendlyName:e.friendly_name,webauthn:{rpId:s,rpOrigins:a},signal:r},{create:t});return l?this._verify({factorId:e.id,challengeId:l.challengeId,webauthn:{rpId:s,rpOrigins:a,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:o}}catch(i){return mn(i)?{data:null,error:i}:{data:null,error:new pn("Unexpected error in register",i)}}}}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(ka){"undefined"!==typeof self&&(self.globalThis=self)}}();const Ds={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:on,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Bs(e,t,n){return await n()}const Us={};class Fs{get jwks(){var e,t;return null!==(t=null===(e=Us[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){Us[this.storageKey]=Object.assign(Object.assign({},Us[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=Us[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Us[this.storageKey]=Object.assign(Object.assign({},Us[this.storageKey]),{cachedAt:e})}constructor(e){var t,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Fs.nextInstanceID,Fs.nextInstanceID+=1,this.instanceID>0&&Dn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},Ds),e);if(this.logDebugMessages=!!s.debug,"function"===typeof s.debug&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new hs({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Fn(s.fetch),this.lock=s.lock||Bs,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Dn()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=vs:this.lock=Bs,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Ls(this)},this.persistSession?(s.storage?this.storage=s.storage:Un()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ms(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=ms(this.memoryStorage)),Dn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(ka){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",ka)}null===(n=this.broadcastChannel)||void 0===n||n.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger("GoTrueClient@".concat(this.instanceID," (").concat(an,") ").concat((new Date).toISOString()),...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},n=new URL(e);if(n.hash&&"#"===n.hash[0])try{new URLSearchParams(n.hash.substring(1)).forEach((e,n)=>{t[n]=e})}catch(ka){}return n.searchParams.forEach((e,n)=>{t[n]=e}),t}(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),Dn()&&this.detectSessionInUrl&&"none"!==n){const{data:s,error:a}=await this._getSessionFromURL(t,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),function(e){return mn(e)&&"AuthImplicitGrantRedirectError"===e.name}(a)){const t=null===(e=a.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:a}}return await this._removeSession(),{error:a}}const{session:r,redirectType:i}=s;return this._debug("#_initialize()","detected session in URL",r,"redirect type",i),await this._saveSession(r),setTimeout(async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",r):await this._notifyAllSubscribers("SIGNED_IN",r)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return mn(t)?{error:t}:{error:new pn("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,s;try{const a=await ss(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{data:null!==(n=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==n?n:{},gotrue_meta_security:{captcha_token:null===(s=null===e||void 0===e?void 0:e.options)||void 0===s?void 0:s.captchaToken}},xform:as}),{data:r,error:i}=a;if(i||!r)return{data:{user:null,session:null},error:i};const l=r.session,o=r.user;return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:o,session:l},error:null}}catch(a){if(mn(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,n,s;try{let a;if("email"in e){const{email:n,password:s,options:r}=e;let i=null,l=null;"pkce"===this.flowType&&([i,l]=await $n(this.storage,this.storageKey)),a=await ss(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,redirectTo:null===r||void 0===r?void 0:r.emailRedirectTo,body:{email:n,password:s,data:null!==(t=null===r||void 0===r?void 0:r.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken},code_challenge:i,code_challenge_method:l},xform:as})}else{if(!("phone"in e))throw new bn("You must provide either an email or phone number and a password");{const{phone:t,password:r,options:i}=e;a=await ss(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{phone:t,password:r,data:null!==(n=null===i||void 0===i?void 0:i.data)&&void 0!==n?n:{},channel:null!==(s=null===i||void 0===i?void 0:i.channel)&&void 0!==s?s:"sms",gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},xform:as})}}const{data:r,error:i}=a;if(i||!r)return{data:{user:null,session:null},error:i};const l=r.session,o=r.user;return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:o,session:l},error:null}}catch(a){if(mn(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:n,password:s,options:a}=e;t=await ss(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{email:n,password:s,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:rs})}else{if(!("phone"in e))throw new bn("You must provide either an email or phone number and a password");{const{phone:n,password:s,options:a}=e;t=await ss(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{phone:n,password:s,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:rs})}}const{data:n,error:s}=t;return s?{data:{user:null,session:null},error:s}:n&&n.session&&n.user?(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s}):{data:{user:null,session:null},error:new yn}}catch(t){if(mn(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,s,a;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(s=e.options)||void 0===s?void 0:s.queryParams,skipBrowserRedirect:null===(a=e.options)||void 0===a?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error('@supabase/auth-js: Unsupported chain "'.concat(t,'"'))}}async signInWithEthereum(e){var t,n,s,a,r,i,l,o,c,d,u;let h,m;if("message"in e)h=e.message,m=e.signature;else{const{chain:d,wallet:u,statement:f,options:p}=e;let g;if(Dn())if("object"===typeof u)g=u;else{const e=window;if(!("ethereum"in e)||"object"!==typeof e.ethereum||!("request"in e.ethereum)||"function"!==typeof e.ethereum.request)throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.");g=e.ethereum}else{if("object"!==typeof u||!(null===p||void 0===p?void 0:p.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=u}const v=new URL(null!==(t=null===p||void 0===p?void 0:p.url)&&void 0!==t?t:window.location.href),y=await g.request({method:"eth_requestAccounts"}).then(e=>e).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!y||0===y.length)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const b=ys(y[0]);let x=null===(n=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===n?void 0:n.chainId;if(!x){const e=await g.request({method:"eth_chainId"});x=parseInt(e,16)}h=function(e){var t;const{chainId:n,domain:s,expirationTime:a,issuedAt:r=new Date,nonce:i,notBefore:l,requestId:o,resources:c,scheme:d,uri:u,version:h}=e;if(!Number.isInteger(n))throw new Error('@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: '.concat(n));if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error('@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: '.concat(i));if(!u)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==h)throw new Error("@supabase/auth-js: Invalid SIWE message field \"version\". Version must be '1'. Provided value: ".concat(h));if(null===(t=e.statement)||void 0===t?void 0:t.includes("\n"))throw new Error("@supabase/auth-js: Invalid SIWE message field \"statement\". Statement must not include '\\n'. Provided value: ".concat(e.statement));const m=ys(e.address),f=d?"".concat(d,"://").concat(s):s,p=e.statement?"".concat(e.statement,"\n"):"",g="".concat(f," wants you to sign in with your Ethereum account:\n").concat(m,"\n\n").concat(p);let v="URI: ".concat(u,"\nVersion: ").concat(h,"\nChain ID: ").concat(n).concat(i?"\nNonce: ".concat(i):"","\nIssued At: ").concat(r.toISOString());if(a&&(v+="\nExpiration Time: ".concat(a.toISOString())),l&&(v+="\nNot Before: ".concat(l.toISOString())),o&&(v+="\nRequest ID: ".concat(o)),c){let e="\nResources:";for(const t of c){if(!t||"string"!==typeof t)throw new Error('@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: '.concat(t));e+="\n- ".concat(t)}v+=e}return"".concat(g,"\n").concat(v)}({domain:v.host,address:b,statement:f,uri:v.href,version:"1",chainId:x,nonce:null===(s=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===s?void 0:s.nonce,issuedAt:null!==(r=null===(a=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===a?void 0:a.issuedAt)&&void 0!==r?r:new Date,expirationTime:null===(i=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===i?void 0:i.expirationTime,notBefore:null===(l=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===l?void 0:l.notBefore,requestId:null===(o=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===o?void 0:o.requestId,resources:null===(c=null===p||void 0===p?void 0:p.signInWithEthereum)||void 0===c?void 0:c.resources}),m=await g.request({method:"personal_sign",params:[bs(h),b]})}try{const{data:t,error:n}=await ss(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:m},(null===(d=e.options)||void 0===d?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:null===(u=e.options)||void 0===u?void 0:u.captchaToken}}:null),xform:as});if(n)throw n;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:n}):{data:{user:null,session:null},error:new yn}}catch(f){if(mn(f))return{data:{user:null,session:null},error:f};throw f}}async signInWithSolana(e){var t,n,s,a,r,i,l,o,c,d,u,h;let m,f;if("message"in e)m=e.message,f=e.signature;else{const{chain:u,wallet:h,statement:p,options:g}=e;let v;if(Dn())if("object"===typeof h)v=h;else{const e=window;if(!("solana"in e)||"object"!==typeof e.solana||!("signIn"in e.solana&&"function"===typeof e.solana.signIn||"signMessage"in e.solana&&"function"===typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");v=e.solana}else{if("object"!==typeof h||!(null===g||void 0===g?void 0:g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=h}const y=new URL(null!==(t=null===g||void 0===g?void 0:g.url)&&void 0!==t?t:window.location.href);if("signIn"in v&&v.signIn){const e=await v.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null===g||void 0===g?void 0:g.signInWithSolana),{version:"1",domain:y.host,uri:y.href}),p?{statement:p}:null));let t;if(Array.isArray(e)&&e[0]&&"object"===typeof e[0])t=e[0];else{if(!(e&&"object"===typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"===typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");m="string"===typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),f=t.signature}else{if(!("signMessage"in v)||"function"!==typeof v.signMessage||!("publicKey"in v)||"object"!==typeof v||!v.publicKey||!("toBase58"in v.publicKey)||"function"!==typeof v.publicKey.toBase58)throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=["".concat(y.host," wants you to sign in with your Solana account:"),v.publicKey.toBase58(),...p?["",p,""]:[""],"Version: 1","URI: ".concat(y.href),"Issued At: ".concat(null!==(s=null===(n=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===n?void 0:n.issuedAt)&&void 0!==s?s:(new Date).toISOString()),...(null===(a=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===a?void 0:a.notBefore)?["Not Before: ".concat(g.signInWithSolana.notBefore)]:[],...(null===(r=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===r?void 0:r.expirationTime)?["Expiration Time: ".concat(g.signInWithSolana.expirationTime)]:[],...(null===(i=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===i?void 0:i.chainId)?["Chain ID: ".concat(g.signInWithSolana.chainId)]:[],...(null===(l=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===l?void 0:l.nonce)?["Nonce: ".concat(g.signInWithSolana.nonce)]:[],...(null===(o=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===o?void 0:o.requestId)?["Request ID: ".concat(g.signInWithSolana.requestId)]:[],...(null===(d=null===(c=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===d?void 0:d.length)?["Resources",...g.signInWithSolana.resources.map(e=>"- ".concat(e))]:[]].join("\n");const e=await v.signMessage((new TextEncoder).encode(m),"utf8");if(!e||!(e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");f=e}}try{const{data:t,error:n}=await ss(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:Ln(f)},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:as});if(n)throw n;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:n}):{data:{user:null,session:null},error:new yn}}catch(p){if(mn(p))return{data:{user:null,session:null},error:p};throw p}}async _exchangeCodeForSession(e){const t=await Mn(this.storage,"".concat(this.storageKey,"-code-verifier")),[n,s]=(null!==t&&void 0!==t?t:"").split("/");try{const{data:t,error:a}=await ss(this.fetch,"POST","".concat(this.url,"/token?grant_type=pkce"),{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:as});if(await Wn(this.storage,"".concat(this.storageKey,"-code-verifier")),a)throw a;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!==s&&void 0!==s?s:null}),error:a}):{data:{user:null,session:null,redirectType:null},error:new yn}}catch(a){if(mn(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:n,token:s,access_token:a,nonce:r}=e,i=await ss(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:r,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:as}),{data:l,error:o}=i;return o?{data:{user:null,session:null},error:o}:l&&l.session&&l.user?(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:o}):{data:{user:null,session:null},error:new yn}}catch(t){if(mn(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,s,a,r;try{if("email"in e){const{email:s,options:a}=e;let r=null,i=null;"pkce"===this.flowType&&([r,i]=await $n(this.storage,this.storageKey));const{error:l}=await ss(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{email:s,data:null!==(t=null===a||void 0===a?void 0:a.data)&&void 0!==t?t:{},create_user:null===(n=null===a||void 0===a?void 0:a.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken},code_challenge:r,code_challenge_method:i},redirectTo:null===a||void 0===a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:l}}if("phone"in e){const{phone:t,options:n}=e,{data:i,error:l}=await ss(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{phone:t,data:null!==(s=null===n||void 0===n?void 0:n.data)&&void 0!==s?s:{},create_user:null===(a=null===n||void 0===n?void 0:n.shouldCreateUser)||void 0===a||a,gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken},channel:null!==(r=null===n||void 0===n?void 0:n.channel)&&void 0!==r?r:"sms"}});return{data:{user:null,session:null,messageId:null===i||void 0===i?void 0:i.message_id},error:l}}throw new bn("You must provide either an email or phone number.")}catch(i){if(mn(i))return{data:{user:null,session:null},error:i};throw i}}async verifyOtp(e){var t,n;try{let s,a;"options"in e&&(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo,a=null===(n=e.options)||void 0===n?void 0:n.captchaToken);const{data:r,error:i}=await ss(this.fetch,"POST","".concat(this.url,"/verify"),{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:as});if(i)throw i;if(!r)throw new Error("An error occurred on token verification.");const l=r.session,o=r.user;return(null===l||void 0===l?void 0:l.access_token)&&(await this._saveSession(l),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:o,session:l},error:null}}catch(s){if(mn(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,n,s;try{let a=null,r=null;return"pkce"===this.flowType&&([a,r]=await $n(this.storage,this.storageKey)),await ss(this.fetch,"POST","".concat(this.url,"/sso"),{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==n?n:void 0}),(null===(s=null===e||void 0===e?void 0:e.options)||void 0===s?void 0:s.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:r}),headers:this.headers,xform:ls})}catch(a){if(mn(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new vn;const{error:s}=await ss(this.fetch,"GET","".concat(this.url,"/reauthenticate"),{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(mn(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t="".concat(this.url,"/resend");if("email"in e){const{email:n,type:s,options:a}=e,{error:r}=await ss(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},redirectTo:null===a||void 0===a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:r}}if("phone"in e){const{phone:n,type:s,options:a}=e,{data:r,error:i}=await ss(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:null===r||void 0===r?void 0:r.message_id},error:i}}throw new bn("You must provide either an email or phone number and a type")}catch(t){if(mn(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch(ka){}})()),n}return await this.lock("lock:".concat(this.storageKey),e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(ka){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await Mn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=!!e.expires_at&&1e3*e.expires_at-Date.now()<ln;if(this._debug("#__loadSession()","session has".concat(n?"":" not"," expired"),"expires_at",e.expires_at),!n){if(this.userStorage){const t=await Mn(this.userStorage,this.storageKey+"-user");(null===t||void 0===t?void 0:t.user)?e.user=t.user:e.user=Yn()}if(this.storage.isServer&&e.user){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,n,s)=>(t||"user"!==n||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,n,s))})}return{data:{session:e},error:null}}const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,async()=>await this._getUser())}async _getUser(e){try{return e?await ss(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:e,xform:is}):await this._useSession(async e=>{var t,n,s;const{data:a,error:r}=e;if(r)throw r;return(null===(t=a.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await ss(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:null!==(s=null===(n=a.session)||void 0===n?void 0:n.access_token)&&void 0!==s?s:void 0,xform:is}):{data:{user:null},error:new vn}})}catch(t){if(mn(t))return function(e){return mn(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await Wn(this.storage,"".concat(this.storageKey,"-code-verifier"))),{data:{user:null},error:t};throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new vn;const r=s.session;let i=null,l=null;"pkce"===this.flowType&&null!=e.email&&([i,l]=await $n(this.storage,this.storageKey));const{data:o,error:c}=await ss(this.fetch,"PUT","".concat(this.url,"/user"),{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:l}),jwt:r.access_token,xform:is});if(c)throw c;return r.user=o.user,await this._saveSession(r),await this._notifyAllSubscribers("USER_UPDATED",r),{data:{user:r.user},error:null}})}catch(n){if(mn(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new vn;const t=Date.now()/1e3;let n=t,s=!0,a=null;const{payload:r}=Hn(e.access_token);if(r.exp&&(n=r.exp,s=n<=t),s){const{data:t,error:n}=await this._callRefreshToken(e.refresh_token);if(n)return{data:{user:null,session:null},error:n};if(!t)return{data:{user:null,session:null},error:null};a=t}else{const{data:s,error:r}=await this._getUser(e.access_token);if(r)throw r;a={access_token:e.access_token,refresh_token:e.refresh_token,user:s.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(mn(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:s,error:a}=t;if(a)throw a;e=null!==(n=s.session)&&void 0!==n?n:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new vn;const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(mn(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Dn())throw new xn("No browser detected.");if(e.error||e.error_description||e.error_code)throw new xn(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new jn("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new xn("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new jn("No code detected.");const{data:t,error:n}=await this._exchangeCodeForSession(e.code);if(n)throw n;const s=new URL(window.location.href);return s.searchParams.delete("code"),window.history.replaceState(window.history.state,"",s.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:r,expires_in:i,expires_at:l,token_type:o}=e;if(!a||!i||!r||!o)throw new xn("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(i);let u=c+d;l&&(u=parseInt(l));const h=u-c;1e3*h<=rn&&console.warn("@supabase/gotrue-js: Session as retrieved from URL expires in ".concat(h,"s, should have been closer to ").concat(d,"s"));const m=u-d;c-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,u,c):c-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,u,c);const{data:f,error:p}=await this._getUser(a);if(p)throw p;const g={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:d,expires_at:u,refresh_token:r,token_type:o,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(n){if(mn(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Mn(this.storage,"".concat(this.storageKey,"-code-verifier"));return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession(async t=>{var n;const{data:s,error:a}=t;if(a)return{error:a};const r=null===(n=s.session)||void 0===n?void 0:n.access_token;if(r){const{error:t}=await this.admin.signOut(r,e);if(t&&(!function(e){return mn(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await Wn(this.storage,"".concat(this.storageKey,"-code-verifier"))),{error:null}})}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,s;try{const{data:{session:s},error:a}=t;if(a)throw a;await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(a){await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,s=null;"pkce"===this.flowType&&([n,s]=await $n(this.storage,this.storageKey,!0));try{return await ss(this.fetch,"POST","".concat(this.url,"/recover"),{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(mn(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(mn(t))return{data:null,error:t};throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:n,error:s}=await this._useSession(async t=>{var n,s,a,r,i;const{data:l,error:o}=t;if(o)throw o;const c=await this._getUrlForProvider("".concat(this.url,"/user/identities/authorize"),e.provider,{redirectTo:null===(n=e.options)||void 0===n?void 0:n.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(a=e.options)||void 0===a?void 0:a.queryParams,skipBrowserRedirect:!0});return await ss(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(i=null===(r=l.session)||void 0===r?void 0:r.access_token)&&void 0!==i?i:void 0})});if(s)throw s;return Dn()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===n||void 0===n?void 0:n.url),{data:{provider:e.provider,url:null===n||void 0===n?void 0:n.url},error:null}}catch(n){if(mn(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var n;try{const{error:s,data:{session:a}}=t;if(s)throw s;const{options:r,provider:i,token:l,access_token:o,nonce:c}=e,d=await ss(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,jwt:null!==(n=null===a||void 0===a?void 0:a.access_token)&&void 0!==n?n:void 0,body:{provider:i,id_token:l,access_token:o,nonce:c,link_identity:!0,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},xform:as}),{data:u,error:h}=d;return h?{data:{user:null,session:null},error:h}:u&&u.session&&u.user?(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("USER_UPDATED",u.session)),{data:u,error:h}):{data:{user:null,session:null},error:new yn}}catch(s){if(mn(s))return{data:{user:null,session:null},error:s};throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,s;const{data:a,error:r}=t;if(r)throw r;return await ss(this.fetch,"DELETE","".concat(this.url,"/user/identities/").concat(e.identity_id),{headers:this.headers,jwt:null!==(s=null===(n=a.session)||void 0===n?void 0:n.access_token)&&void 0!==s?s:void 0})})}catch(t){if(mn(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t="#_refreshAccessToken(".concat(e.substring(0,5),"...)");this._debug(t,"begin");try{const a=Date.now();return await(n=async n=>(n>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await ss(this.fetch,"POST","".concat(this.url,"/token?grant_type=refresh_token"),{body:{refresh_token:e},headers:this.headers,xform:as})),s=(e,t)=>{const n=200*Math.pow(2,e);return t&&Nn(t)&&Date.now()+n-a<rn},new Promise((e,t)=>{(async()=>{for(let a=0;a<1/0;a++)try{const t=await n(a);if(!s(a,null,t))return void e(t)}catch(ka){if(!s(a,ka))return void t(ka)}})()}))}catch(a){if(this._debug(t,"error",a),mn(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(t,"end")}var n,s}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider("".concat(this.url,"/authorize"),e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),Dn()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Mn(this.storage,this.storageKey);if(a&&this.userStorage){let t=await Mn(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:a.user},await zn(this.userStorage,this.storageKey+"-user",t)),a.user=null!==(e=null===t||void 0===t?void 0:t.user)&&void 0!==e?e:Yn()}else if(a&&!a.user&&!a.user){const e=await Mn(this.storage,this.storageKey+"-user");e&&(null===e||void 0===e?void 0:e.user)?(a.user=e.user,await Wn(this.storage,this.storageKey+"-user"),await zn(this.storage,this.storageKey,a)):a.user=Yn()}if(this._debug(n,"session from storage",a),!this._isValidSession(a))return this._debug(n,"session is not valid"),void(null!==a&&await this._removeSession());const r=1e3*(null!==(t=a.expires_at)&&void 0!==t?t:1/0)-Date.now()<ln;if(this._debug(n,"session has".concat(r?"":" not"," expired with margin of ").concat(ln,"s")),r){if(this.autoRefreshToken&&a.refresh_token){const{error:e}=await this._callRefreshToken(a.refresh_token);e&&(console.error(e),Nn(e)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(a.user&&!0===a.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(a.access_token);!t&&(null===e||void 0===e?void 0:e.user)?(a.user=e.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(s){console.error("Error getting user data:",s),this._debug(n,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){return this._debug(n,"error",a),void console.error(a)}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new vn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s="#_callRefreshToken(".concat(e.substring(0,5),"...)");this._debug(s,"begin");try{this.refreshingDeferred=new qn;const{data:t,error:n}=await this._refreshAccessToken(e);if(n)throw n;if(!t.session)throw new vn;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const s={data:t.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(a){if(this._debug(s,"error",a),mn(a)){const e={data:null,error:a};return Nn(a)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(n=this.refreshingDeferred)||void 0===n||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const s="#_notifyAllSubscribers(".concat(e,")");this._debug(s,"begin",t,"broadcast = ".concat(n));try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async n=>{try{await n.callback(e,t)}catch(ka){s.push(ka)}});if(await Promise.all(a),s.length>0){for(let e=0;e<s.length;e+=1)console.error(s[e]);throw s[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),n=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!n&&t.user&&await zn(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const s=Xn(e);await zn(this.storage,this.storageKey,s)}else{const e=Xn(t);await zn(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),await Wn(this.storage,this.storageKey),await Wn(this.storage,this.storageKey+"-code-verifier"),await Wn(this.storage,this.storageKey+"-user"),this.userStorage&&await Wn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Dn()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(ka){console.error("removing visibilitychange callback failed",ka)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),rn);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const s=Math.floor((1e3*n.expires_at-e)/rn);this._debug("#_autoRefreshTokenTick()","access token expires in ".concat(s," ticks, a tick lasts ").concat(rn,"ms, refresh threshold is ").concat(3," ticks")),s<=3&&await this._callRefreshToken(n.refresh_token)})}catch(ka){console.error("Auto refresh tick failed with error. This is likely a transient error.",ka)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(ka){if(!(ka.isAcquireTimeout||ka instanceof ps))throw ka;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Dn()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t="#_onVisibilityChanged(".concat(e,")");this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const s=["provider=".concat(encodeURIComponent(t))];if((null===n||void 0===n?void 0:n.redirectTo)&&s.push("redirect_to=".concat(encodeURIComponent(n.redirectTo))),(null===n||void 0===n?void 0:n.scopes)&&s.push("scopes=".concat(encodeURIComponent(n.scopes))),"pkce"===this.flowType){const[e,t]=await $n(this.storage,this.storageKey),n=new URLSearchParams({code_challenge:"".concat(encodeURIComponent(e)),code_challenge_method:"".concat(encodeURIComponent(t))});s.push(n.toString())}if(null===n||void 0===n?void 0:n.queryParams){const e=new URLSearchParams(n.queryParams);s.push(e.toString())}return(null===n||void 0===n?void 0:n.skipBrowserRedirect)&&s.push("skip_http_redirect=".concat(n.skipBrowserRedirect)),"".concat(e,"?").concat(s.join("&"))}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:s,error:a}=t;return a?{data:null,error:a}:await ss(this.fetch,"DELETE","".concat(this.url,"/factors/").concat(e.factorId),{headers:this.headers,jwt:null===(n=null===s||void 0===s?void 0:s.session)||void 0===n?void 0:n.access_token})})}catch(t){if(mn(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,s;const{data:a,error:r}=t;if(r)return{data:null,error:r};const i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:"totp"===e.factorType?{issuer:e.issuer}:{}),{data:l,error:o}=await ss(this.fetch,"POST","".concat(this.url,"/factors"),{body:i,headers:this.headers,jwt:null===(n=null===a||void 0===a?void 0:a.session)||void 0===n?void 0:n.access_token});return o?{data:null,error:o}:("totp"===e.factorType&&"totp"===l.type&&(null===(s=null===l||void 0===l?void 0:l.totp)||void 0===s?void 0:s.qr_code)&&(l.totp.qr_code="data:image/svg+xml;utf-8,".concat(l.totp.qr_code)),{data:l,error:null})})}catch(t){if(mn(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:a}=t;if(a)return{data:null,error:a};const r=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:"create"===e.webauthn.type?Es(e.webauthn.credential_response):Ts(e.webauthn.credential_response)})}:{code:e.code}),{data:i,error:l}=await ss(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/verify"),{body:r,headers:this.headers,jwt:null===(n=null===s||void 0===s?void 0:s.session)||void 0===n?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:l})})}catch(t){if(mn(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:a}=t;if(a)return{data:null,error:a};const r=await ss(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/challenge"),{body:e,headers:this.headers,jwt:null===(n=null===s||void 0===s?void 0:s.session)||void 0===n?void 0:n.access_token});if(r.error)return r;const{data:i}=r;if("webauthn"!==i.type)return{data:i,error:null};switch(i.webauthn.type){case"create":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:Cs(i.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:_s(i.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(mn(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const a of null!==(e=null===t||void 0===t?void 0:t.factors)&&void 0!==e?e:[])s.all.push(a),"verified"===a.status&&s[a.factor_type].push(a);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,n;const{data:{session:s},error:a}=e;if(a)return{data:null,error:a};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:r}=Hn(s.access_token);let i=null;r.aal&&(i=r.aal);let l=i;(null!==(n=null===(t=s.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==n?n:[]).length>0&&(l="aal2");return{data:{currentLevel:i,nextLevel:l,currentAuthenticationMethods:r.amr||[]},error:null}}))}async fetchJwk(e){let t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]}).keys.find(t=>t.kid===e);if(t)return t;const n=Date.now();if(t=this.jwks.keys.find(t=>t.kid===e),t&&this.jwks_cached_at+6e5>n)return t;const{data:s,error:a}=await ss(this.fetch,"GET","".concat(this.url,"/.well-known/jwks.json"),{headers:this.headers});if(a)throw a;return s.keys&&0!==s.keys.length?(this.jwks=s,this.jwks_cached_at=n,t=s.keys.find(t=>t.kid===e),t||null):null}async getClaims(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let n=e;if(!n){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};n=e.session.access_token}const{header:s,payload:a,signature:r,raw:{header:i,payload:l}}=Hn(n);(null===t||void 0===t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(a.exp);const o=s.alg&&!s.alg.startsWith("HS")&&s.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(s.kid,(null===t||void 0===t?void 0:t.keys)?{keys:t.keys}:null===t||void 0===t?void 0:t.jwks):null;if(!o){const{error:e}=await this.getUser(n);if(e)throw e;return{data:{claims:a,header:s,signature:r},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(s.alg),d=await crypto.subtle.importKey("jwk",o,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,r,function(e){const t=[];return An(e,e=>t.push(e)),new Uint8Array(t)}("".concat(i,".").concat(l))))throw new kn("Invalid JWT signature");return{data:{claims:a,header:s,signature:r},error:null}}catch(n){if(mn(n))return{data:null,error:n};throw n}}}Fs.nextInstanceID=0;const zs=Fs;class Ms extends zs{constructor(e){super(e)}}var Ws=function(e,t,n,s){return new(n||(n=Promise))(function(a,r){function i(e){try{o(s.next(e))}catch(ka){r(ka)}}function l(e){try{o(s.throw(e))}catch(ka){r(ka)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,l)}o((s=s.apply(e,t||[])).next())})};class qs{constructor(e,t,n){var s,a,r;this.supabaseUrl=e,this.supabaseKey=t;const i=function(e){const t=null===e||void 0===e?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL((n=t).endsWith("/")?n:n+"/")}catch(s){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}var n}(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const l="sb-".concat(i.hostname.split(".")[0],"-auth-token"),o=function(e,t){var n,s;const{db:a,auth:r,realtime:i,global:l}=e,{db:o,auth:c,realtime:d,global:u}=t,h={db:Object.assign(Object.assign({},o),a),auth:Object.assign(Object.assign({},c),r),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},u),l),{headers:Object.assign(Object.assign({},null!==(n=null===u||void 0===u?void 0:u.headers)&&void 0!==n?n:{}),null!==(s=null===l||void 0===l?void 0:l.headers)&&void 0!==s?s:{})}),accessToken:()=>sn(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!==n&&void 0!==n?n:{},{db:Qt,realtime:Xt,auth:Object.assign(Object.assign({},Yt),{storageKey:l}),global:Gt});this.storageKey=null!==(s=o.auth.storageKey)&&void 0!==s?s:"",this.headers=null!==(a=o.global.headers)&&void 0!==a?a:{},o.accessToken?(this.accessToken=o.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error("@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.".concat(String(t)," is not possible"))}})):this.auth=this._initSupabaseAuthClient(null!==(r=o.auth)&&void 0!==r?r:{},this.headers,o.global.fetch),this.fetch=nn(t,this._getAccessToken.bind(this),o.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},o.realtime)),this.rest=new Ie(new URL("rest/v1",i).href,{headers:this.headers,schema:o.db.schema,fetch:this.fetch}),this.storage=new $t(this.storageUrl.href,this.headers,this.fetch,null===n||void 0===n?void 0:n.storage),o.accessToken||this._listenForAuthEvents()}get functions(){return new Re(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.rest.rpc(e,t,n)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return Ws(this,void 0,void 0,function*(){var e,t;if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return null!==(t=null===(e=n.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:this.supabaseKey})}_initSupabaseAuthClient(e,t,n){let{autoRefreshToken:s,persistSession:a,detectSessionInUrl:r,storage:i,userStorage:l,storageKey:o,flowType:c,lock:d,debug:u}=e;const h={Authorization:"Bearer ".concat(this.supabaseKey),apikey:"".concat(this.supabaseKey)};return new Ms({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),t),storageKey:o,autoRefreshToken:s,persistSession:a,detectSessionInUrl:r,storage:i,userStorage:l,flowType:c,lock:d,debug:u,fetch:n,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new bt(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)})}_handleTokenChanged(e,t,n){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===n?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.changedAccessToken=n,this.realtime.setAuth(n))}}(function(){if("undefined"!==typeof window)return!1;if("undefined"===typeof process)return!1;const e=process.version;if(void 0===e||null===e)return!1;const t=e.match(/^v(\d+)\./);return!!t&&parseInt(t[1],10)<=18})()&&console.warn("\u26a0\ufe0f  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Hs=((e,t,n)=>new qs(e,t,n))("https://rzyrhnupwzppwiudfuxk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ6eXJobnVwd3pwcHdpdWRmdXhrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE4ODA5NjksImV4cCI6MjA2NzQ1Njk2OX0.aq0cp84sxMjLPvr_8E4btcQLjhT9zZSUEPgr0bqHMUs"),Vs=["password"],Ks=["password"],$s={async login(e,t){try{const{data:n,error:s}=await Hs.from("users").select("*").eq("email",e).eq("status","active").single();if(s){if("PGRST116"===s.code)throw new Error("Invalid email or password");throw new Error("Login failed: "+s.message)}if(!n)throw new Error("Invalid email or password");if(!(t===n.password))throw new Error("Invalid email or password");await Hs.from("users").update({lastlogin:(new Date).toISOString()}).eq("userid",n.userid);const{password:a}=n;return{success:!0,user:ke(n,Vs)}}catch(n){return{success:!1,error:n.message}}},setUserSession(e){localStorage.setItem("user",JSON.stringify(e)),window.dispatchEvent(new Event("authChange"))},getUserSession(){const e=localStorage.getItem("user");return e?JSON.parse(e):null},logout(){localStorage.removeItem("user"),window.dispatchEvent(new Event("authChange"))},isAuthenticated(){return null!==this.getUserSession()},async updateProfile(e,t){try{const{data:n,error:s}=await Hs.from("users").update({firstname:t.firstname,lastname:t.lastname,email:t.email,phone:t.phone,address:t.address}).eq("userid",e).select().single();if(s)throw s;const{password:a}=n,r=ke(n,Ks);return this.setUserSession(r),{success:!0,data:r}}catch(n){return console.error("Error updating profile:",n),{success:!1,error:n.message}}},async changePassword(e,t,n){try{const{data:s,error:a}=await Hs.from("users").select("password").eq("userid",e).single();if(a)throw a;if(s.password!==t)return{success:!1,error:"Current password is incorrect"};const{error:r}=await Hs.from("users").update({password:n}).eq("userid",e);if(r)throw r;return{success:!0}}catch(s){return console.error("Error changing password:",s),{success:!1,error:s.message}}}};var Js=n(579);const Gs=e=>{let{onLoginSuccess:t}=e;const[n,s]=(0,a.useState)(""),[r,i]=(0,a.useState)(""),[l,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(""),u=ne();return(0,Js.jsxs)("div",{className:"login-container",children:[(0,Js.jsx)("div",{className:"login-left",children:(0,Js.jsxs)("div",{className:"login-branding",children:[(0,Js.jsxs)("div",{className:"logo-section",children:[(0,Js.jsx)("div",{className:"logo-icon",children:(0,Js.jsx)("i",{className:"fas fa-building"})}),(0,Js.jsxs)("div",{className:"logo-text",children:[(0,Js.jsx)("h1",{className:"system-title",children:"Water Billing System"}),(0,Js.jsx)("p",{className:"system-subtitle",children:"Local Government Unit"}),(0,Js.jsx)("p",{className:"system-location",children:"Concepcion, Romblon"})]})]}),(0,Js.jsxs)("div",{className:"login-features",children:[(0,Js.jsxs)("div",{className:"feature-item",children:[(0,Js.jsx)("i",{className:"fas fa-shield-alt"}),(0,Js.jsx)("span",{children:"Secure Access"})]}),(0,Js.jsxs)("div",{className:"feature-item",children:[(0,Js.jsx)("i",{className:"fas fa-users"}),(0,Js.jsx)("span",{children:"Customer Management"})]}),(0,Js.jsxs)("div",{className:"feature-item",children:[(0,Js.jsx)("i",{className:"fas fa-file-invoice-dollar"}),(0,Js.jsx)("span",{children:"Billing & Payments"})]})]})]})}),(0,Js.jsx)("div",{className:"login-right",children:(0,Js.jsxs)("div",{className:"login-form-container",children:[(0,Js.jsxs)("div",{className:"form-header",children:[(0,Js.jsx)("h2",{className:"form-title",children:"Sign In"}),(0,Js.jsx)("p",{className:"form-subtitle",children:"Access your account to continue"})]}),(0,Js.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),o(!0),d(""),!n||!r)return d("Please fill in all fields"),void o(!1);try{const e=await $s.login(n,r);e.success?($s.setUserSession(e.user),t&&t(),u("/dashboard",{replace:!0})):d(e.error)}catch(s){d("An unexpected error occurred")}finally{o(!1)}},className:"professional-form",children:[c&&(0,Js.jsxs)("div",{className:"error-message",children:[(0,Js.jsx)("i",{className:"fas fa-exclamation-circle"}),(0,Js.jsx)("span",{children:c}),(0,Js.jsx)("button",{className:"error-close",onClick:()=>d(""),type:"button",children:(0,Js.jsx)("i",{className:"fas fa-times"})})]}),(0,Js.jsxs)("div",{className:"form-group",children:[(0,Js.jsx)("label",{className:"form-label",children:"Email Address"}),(0,Js.jsxs)("div",{className:"input-wrapper",children:[(0,Js.jsx)("input",{className:"form-input",type:"email",placeholder:"Enter your email address",value:n,onChange:e=>s(e.target.value),disabled:l,required:!0}),(0,Js.jsx)("i",{className:"fas fa-envelope input-icon"})]})]}),(0,Js.jsxs)("div",{className:"form-group",children:[(0,Js.jsx)("label",{className:"form-label",children:"Password"}),(0,Js.jsxs)("div",{className:"input-wrapper",children:[(0,Js.jsx)("input",{className:"form-input",type:"password",placeholder:"Enter your password",value:r,onChange:e=>i(e.target.value),disabled:l,required:!0}),(0,Js.jsx)("i",{className:"fas fa-lock input-icon"})]})]}),(0,Js.jsx)("button",{className:"login-button ".concat(l?"loading":""),type:"submit",disabled:l,children:l?(0,Js.jsxs)(Js.Fragment,{children:[(0,Js.jsx)("i",{className:"fas fa-spinner fa-spin"}),(0,Js.jsx)("span",{children:"Signing In..."})]}):(0,Js.jsxs)(Js.Fragment,{children:[(0,Js.jsx)("i",{className:"fas fa-sign-in-alt"}),(0,Js.jsx)("span",{children:"Sign In"})]})})]}),(0,Js.jsx)("div",{className:"form-footer",children:(0,Js.jsx)("p",{children:"\xa9 2024 LGU Concepcion, Romblon. All rights reserved."})})]})})]})};function Qs(e){return Qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qs(e)}function Ys(e){var t=function(e,t){if("object"!=Qs(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=Qs(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Qs(t)?t:t+""}function Xs(e,t,n){return(t=Ys(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,s)}return n}function ea(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zs(Object(n),!0).forEach(function(t){Xs(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zs(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const ta={async testConnection(){try{console.log("Testing Supabase connection..."),console.log("Supabase URL:",Hs.supabaseUrl),console.log("Auth status:",await Hs.auth.getSession());const{data:e,error:t,count:n}=await Hs.from("customers").select("*",{count:"exact"}).range(0,99999);return console.log("Connection test result:",{data:e,error:t,count:n}),t?(console.error("Possible RLS issue. Error details:",t),{success:!1,error:"".concat(t.message,". This might be a Row Level Security (RLS) issue. Check console for details.")}):{success:!0,message:"Connection successful! Found ".concat(n," records in database.")}}catch(e){return console.error("Connection test failed:",e),{success:!1,error:e.message}}},async getCustomers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{console.log("Fetching customers with filters:",e);let t=Hs.from("customers").select("*").order("date_added",{ascending:!1});if(e.search){const n=e.search.trim();if(n){const e=/^\d+$/.test(n);console.log("Search term:",n,"Is numeric:",e),e?(console.log("Searching both name and customerid for:",n),t=t.or("name.ilike.%".concat(n,"%,customerid.eq.").concat(n))):(console.log("Searching only name for:",n),t=t.ilike("name","%".concat(n,"%")))}}e.barangay&&"all"!==e.barangay&&(console.log("Filtering by barangay (case-insensitive):",e.barangay),t=t.ilike("barangay",e.barangay)),e.type&&"all"!==e.type&&(console.log("Filtering by type (case-insensitive):",e.type),t=t.ilike("type",e.type)),e.status&&"all"!==e.status&&(console.log("Filtering by status (case-insensitive):",e.status),t=t.ilike("status",e.status));const n=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=[],s=0,a=!0;for(;a;){console.log("Fetching batch starting at ".concat(s,"..."));const{data:r,error:i}=await e.range(s,s+t-1);if(i)throw i;r&&r.length>0?(n=[...n,...r],console.log("Fetched ".concat(r.length," records, total so far: ").concat(n.length)),r.length<t?a=!1:s+=t):a=!1}return n}(t);return console.log("Successfully fetched ALL customers:",n.length,"records (truly unlimited)"),{success:!0,data:n}}catch(t){return console.error("Error in getCustomers:",t),{success:!1,error:t.message}}},async getCustomerById(e){try{const{data:t,error:n}=await Hs.from("customers").select("*").eq("customerid",e).single();if(n)throw n;return{success:!0,data:t}}catch(t){return{success:!1,error:t.message}}},async generateCustomerId(){try{const{data:e,error:t}=await Hs.from("customers").select("customerid").order("customerid",{ascending:!1}).limit(1);if(t)throw t;return{success:!0,data:(e.length>0?e[0].customerid:0)+1}}catch(e){return{success:!1,error:e.message}}},async addCustomer(e){try{const{data:t,error:n}=await Hs.from("customers").insert([ea(ea({},e),{},{date_added:(new Date).toISOString().split("T")[0],status:e.status||"Active"})]).select();if(n)throw n;return{success:!0,data:t[0]}}catch(t){return{success:!1,error:t.message}}},async updateCustomer(e,t){try{const{data:n,error:s}=await Hs.from("customers").update(t).eq("customerid",e).select();if(s)throw s;return{success:!0,data:n[0]}}catch(n){return{success:!1,error:n.message}}},async deleteCustomer(e){try{const{error:t}=await Hs.from("customers").delete().eq("customerid",e);if(t)throw t;return{success:!0}}catch(t){return{success:!1,error:t.message}}},async updateCustomerStatus(e,t,n,s){try{const a={status:t,remarks:n||null};"Disconnected"===t?(a.disconnection_date=(new Date).toISOString().split("T")[0],a.disconnected_by=s):"Active"===t&&(a.disconnection_date=null,a.disconnected_by=null);const{data:r,error:i}=await Hs.from("customers").update(a).eq("customerid",e).select();if(i)throw i;return{success:!0,data:r[0]}}catch(a){return{success:!1,error:a.message}}},async getCustomerStats(){try{let e=[],t=0;const n=1e3;let s=!0;for(;s;){const{data:a,error:r}=await Hs.from("customers").select("status").range(t,t+n-1);if(r)throw r;a&&a.length>0?(e=[...e,...a],a.length<n?s=!1:t+=n):s=!1}const a={total:e.length,active:e.filter(e=>e.status&&"active"===e.status.toLowerCase()).length,disconnected:e.filter(e=>e.status&&"disconnected"===e.status.toLowerCase()).length};return console.log("Stats calculated from",e.length,"total records"),{success:!0,data:a}}catch(e){return{success:!1,error:e.message,data:[]}}},async getCustomerTypes(){try{const{data:e,error:t}=await Hs.from("customer_type").select("type, rate1, rate2").order("type",{ascending:!0}).limit(1e4);if(t)throw t;return{success:!0,data:e||[]}}catch(e){return console.error("Error getting customer types:",e),{success:!1,error:e.message,data:[]}}},async getDiscounts(){try{const{data:e,error:t}=await Hs.from("discount").select("type, discountpercentage").order("type",{ascending:!0}).limit(1e4);if(t)throw t;return{success:!0,data:e||[]}}catch(e){return console.error("Error getting discounts:",e),{success:!1,error:e.message,data:[]}}},async getBarangays(){try{const{data:e,error:t}=await Hs.from("barangays").select("*").order("barangay",{ascending:!0}).limit(1e4);if(t)throw t;return{success:!0,data:e||[]}}catch(e){return console.error("Error getting barangays:",e),{success:!1,error:e.message,data:[]}}},exportToCSV(e){const t=[["Customer ID","Name","Type","Barangay","Discount %","Status","Date Added","Added By","Credit Balance","Disconnection Date","Disconnected By","Remarks"].join(","),...e.map(e=>[e.customerid,'"'.concat(e.name||"",'"'),'"'.concat(e.type||"",'"'),'"'.concat(e.barangay||"",'"'),e.discount||0,'"'.concat(e.status||"",'"'),e.date_added||"",'"'.concat(e.added_by||"",'"'),e.credit_balance||0,e.disconnection_date||"",'"'.concat(e.disconnected_by||"",'"'),'"'.concat(e.remarks||"",'"')].join(","))].join("\n"),n=new Blob([t],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),a=URL.createObjectURL(n);s.setAttribute("href",a),s.setAttribute("download","customers_".concat((new Date).toISOString().split("T")[0],".csv")),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)},async getRecentCustomers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;try{const{data:t,error:n}=await Hs.from("customers").select("*").order("date_added",{ascending:!1}).limit(e);if(n)throw n;return{success:!0,data:t||[]}}catch(t){return console.error("Error getting recent customers:",t),{success:!1,error:t.message,data:[]}}}},na=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=[],s=0,a=!0;for(;a;){console.log("Fetching batch starting at ".concat(s,"..."));const{data:r,error:i}=await e.range(s,s+t-1);if(i)throw i;r&&r.length>0?(n=[...n,...r],console.log("Fetched ".concat(r.length," records, total so far: ").concat(n.length)),r.length<t?a=!1:s+=t):a=!1}return n},sa={async getBills(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"billedmonth",s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{const a=(e-1)*t,r=a+t-1,{data:i,error:l,count:o}=await Hs.from("bills").select("*",{count:"exact"}).order(n,{ascending:s}).range(a,r);if(l)throw l;const c=[...new Set(i.map(e=>e.customerid).filter(e=>e))],{data:d}=await Hs.from("customers").select("customerid, name, type, barangay").in("customerid",c).limit(1e4),u={};d&&d.forEach(e=>{u[e.customerid]=e});return{success:!0,data:i.map(e=>ea(ea({},e),{},{customers:u[e.customerid]||null})),count:o}}catch(a){return console.error("Error getting bills:",a),{success:!1,error:a.message,data:[],count:0}}},async getCustomerTypes(){try{const{data:e,error:t}=await Hs.from("customer_type").select("type, rate1, rate2").order("type",{ascending:!0}).limit(1e4);if(t)throw t;return{success:!0,data:e||[]}}catch(e){return console.error("Error getting customer types:",e),{success:!1,error:e.message,data:[]}}},async getLastBill(e){try{const{data:t,error:n}=await Hs.from("bills").select("*").eq("customerid",e).order("billedmonth",{ascending:!1}).limit(1).single();if(n&&"PGRST116"!==n.code)throw n;return{success:!0,data:t||null}}catch(t){return console.error("Error getting last bill:",t),{success:!1,error:t.message,data:null}}},async checkDuplicateBill(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{let s=Hs.from("bills").select("billid").eq("customerid",e).eq("billedmonth",t);n&&(s=s.neq("billid",n));const{data:a,error:r}=await s;if(r)throw r;return{success:!0,exists:a&&a.length>0}}catch(s){return console.error("Error checking duplicate bill:",s),{success:!1,error:s.message,exists:!1}}},async checkBillIdExists(e){try{const{data:t,error:n}=await Hs.from("bills").select("billid").eq("billid",e).maybeSingle();if(n)throw n;return{success:!0,data:{exists:null!==t}}}catch(t){return console.error("Error checking bill ID exists:",t),{success:!1,error:t.message,data:{exists:!1}}}},calculateBasicAmount(e,t){if(!t)return 0;const n=parseFloat(t.rate1||0),s=parseFloat(t.rate2||0);let a=0;return a=0===e?n:e<=3?e*n:3*n+(e-3)*s,parseFloat(a.toFixed(2))},calculateDiscountAmount:(e,t)=>!t||t<=0?0:e*t/100,async addBill(e){try{const{data:t,error:n}=await Hs.from("bills").insert([e]).select().single();if(n)throw n;return{success:!0,data:t}}catch(t){return console.error("Error adding bill:",t),{success:!1,error:t.message}}},async updateBill(e,t){try{const{data:n,error:s}=await Hs.from("bills").update(t).eq("billid",e).select().single();if(s)throw s;return{success:!0,data:n}}catch(n){return console.error("Error updating bill:",n),{success:!1,error:n.message}}},async deleteBill(e){try{const{error:t}=await Hs.from("bills").delete().eq("billid",e);if(t)throw t;return{success:!0}}catch(t){return console.error("Error deleting bill:",t),{success:!1,error:t.message}}},async getCustomerBills(e){try{const{data:t,error:n}=await Hs.from("bills").select("*").eq("customerid",e).order("billedmonth",{ascending:!1}).limit(1e4);if(n)throw n;return{success:!0,data:t||[]}}catch(t){return console.error("Error getting customer bills:",t),{success:!1,error:t.message,data:[]}}},async getBillsByMonth(e){try{const t=e+"-01";let n=[],s=0;const a=1e3;let r=!0;for(;r;){const{data:e,error:i}=await Hs.from("bills").select("*").eq("billedmonth",t).order("customerid",{ascending:!0}).range(s,s+a-1);if(i)throw i;e&&e.length>0?(n=[...n,...e],e.length<a?r=!1:s+=a):r=!1}if(0===n.length)return{success:!0,data:[]};const i=[...new Set(n.map(e=>e.customerid).filter(e=>e))];let l=[];for(s=0,r=!0;r;){const e=i.slice(s,s+a);if(0===e.length)break;const{data:t,error:n}=await Hs.from("customers").select("customerid, name, type, barangay, status").in("customerid",e);if(n)throw n;t&&t.length>0&&(l=[...l,...t]),s+=a,e.length<a&&(r=!1)}const o={};l.forEach(e=>{o[e.customerid]=e});return{success:!0,data:n.map(e=>{const t=o[e.customerid];return{billid:e.billid,customerid:e.customerid,name:(null===t||void 0===t?void 0:t.name)||"Unknown",type:(null===t||void 0===t?void 0:t.type)||"Unknown",barangay:(null===t||void 0===t?void 0:t.barangay)||"Unknown",status:(null===t||void 0===t?void 0:t.status)||"Unknown",billedmonth:e.billedmonth,previousreading:e.previousreading,currentreading:e.currentreading,consumption:e.consumption}})}}catch(t){return console.error("Error getting bills by month:",t),{success:!1,error:t.message,data:[]}}},async getEncodingStats(e){try{let t=[],n=0;const s=1e3;let a=!0;for(;a;){const{data:e,error:r}=await Hs.from("customers").select("customerid, name, barangay, type, status").order("barangay",{ascending:!0}).range(n,n+s-1);if(r)throw r;e&&e.length>0?(t=[...t,...e],e.length<s?a=!1:n+=s):a=!1}let r=[];for(n=0,a=!0;a;){const{data:t,error:i}=await Hs.from("bills").select("customerid").eq("billedmonth",e).range(n,n+s-1);if(i)throw i;t&&t.length>0?(r=[...r,...t],t.length<s?a=!1:n+=s):a=!1}const i=new Set(r.map(e=>e.customerid));console.log("Encoding Stats: Fetched ".concat(t.length," total customers and ").concat(r.length," bills for ").concat(e));const l={};return t.forEach(e=>{const t=e.barangay||"Unknown";l[t]||(l[t]={barangay:t,totalCustomers:0,encodedCount:0,allCustomers:[],notEncodedCustomers:[]});const n={customerid:e.customerid,name:e.name,type:e.type,status:e.status,isEncoded:i.has(e.customerid)};l[t].allCustomers.push(n),l[t].totalCustomers++,i.has(e.customerid)?l[t].encodedCount++:l[t].notEncodedCustomers.push({customerid:e.customerid,name:e.name,type:e.type,status:e.status})}),{success:!0,data:Object.values(l).sort((e,t)=>e.barangay.localeCompare(t.barangay))}}catch(t){return console.error("Error getting encoding stats:",t),{success:!1,error:t.message,data:[]}}},async getCustomersWithUnpaidBills(){try{const e=Hs.from("bills").select("billid, customerid, billedmonth, basicamount, surchargeamount, totalbillamount").eq("paymentstatus","Unpaid").order("customerid",{ascending:!0}).order("billedmonth",{ascending:!0}),t=await na(e);if(!t||0===t.length)return{success:!0,data:[],totalCustomers:0};const n=[...new Set(t.map(e=>e.customerid).filter(e=>e))],s=Hs.from("customers").select("customerid, name, barangay, type, status").in("customerid",n),a=await na(s),r={};a&&a.forEach(e=>{r[e.customerid]=e});const i={};t.forEach(e=>{const t=e.customerid,n=r[t];i[t]||(i[t]={customerid:t,name:(null===n||void 0===n?void 0:n.name)||"Unknown",barangay:(null===n||void 0===n?void 0:n.barangay)||"",type:(null===n||void 0===n?void 0:n.type)||"",status:(null===n||void 0===n?void 0:n.status)||"",unpaidBills:[],totalBasicAmount:0,totalSurcharge:0,totalBilledAmount:0,billCount:0,earliestMonth:e.billedmonth,latestMonth:e.billedmonth});const s=i[t];s.unpaidBills.push(e),s.totalBasicAmount+=parseFloat(e.basicamount||0),s.totalSurcharge+=parseFloat(e.surchargeamount||0),s.totalBilledAmount+=parseFloat(e.totalbillamount||0),s.billCount++,e.billedmonth<s.earliestMonth&&(s.earliestMonth=e.billedmonth),e.billedmonth>s.latestMonth&&(s.latestMonth=e.billedmonth)});const l=Object.values(i).map(e=>ea(ea({},e),{},{billScope:e.earliestMonth===e.latestMonth?e.earliestMonth:"".concat(e.earliestMonth," to ").concat(e.latestMonth)}));return{success:!0,data:l,totalCustomers:l.length}}catch(e){return console.error("Error getting customers with unpaid bills:",e),{success:!1,error:e.message,data:[]}}},async getRecentBills(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;try{const{data:t,error:n}=await Hs.from("bills").select("*").order("dateencoded",{ascending:!1}).limit(e);if(n)throw n;const s=[...new Set(t.map(e=>e.customerid).filter(e=>e))],{data:a}=await Hs.from("customers").select("customerid, name, type, barangay").in("customerid",s),r={};a&&a.forEach(e=>{r[e.customerid]=e});return{success:!0,data:t.map(e=>ea(ea({},e),{},{customers:r[e.customerid]||null}))}}catch(t){return console.error("Error getting recent bills:",t),{success:!1,error:t.message,data:[]}}},exportToCSV(e){const t=e.map(e=>{var t,n;return[e.billid,e.customerid,(null===(t=e.customers)||void 0===t?void 0:t.name)||"",(null===(n=e.customers)||void 0===n?void 0:n.barangay)||"",e.billedmonth,e.previousreading||0,e.currentreading||0,e.consumption||0,e.basicamount||0,e.surchargeamount||0,e.discountamount||0,e.totalbillamount||0,e.paymentstatus||""]});return[["Bill ID","Customer ID","Customer Name","Barangay","Billed Month","Previous Reading","Current Reading","Consumption","Basic Amount","Surcharge","Discount","Total Bill","Payment Status"].join(","),...t.map(e=>e.join(","))].join("\n")}},aa={async searchCustomers(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let n=Hs.from("customers").select("*").order("name",{ascending:!0});if(e){n=/^\d+$/.test(e.trim())?n.or("customerid.eq.".concat(e,",name.ilike.%").concat(e,"%")):n.ilike("name","%".concat(e,"%"))}t.barangay&&(n=n.ilike("barangay",t.barangay)),t.type&&(n=n.ilike("type",t.type)),t.status&&(n=n.ilike("status",t.status)),n=n.limit(1e4);const{data:s,error:a}=await n;if(a)throw a;return{success:!0,data:s}}catch(n){return console.error("Error searching customers:",n),{success:!1,error:n.message}}},async getBarangays(){try{const{data:e,error:t}=await Hs.from("barangays").select("*").order("barangay",{ascending:!0}).limit(1e4);if(t)throw t;return{success:!0,data:e||[]}}catch(e){return console.error("Error getting barangays:",e),{success:!1,error:e.message,data:[]}}},async getCustomerDetails(e){try{const{data:t,error:n}=await Hs.from("customers").select("*").eq("customerid",e).single();if(n)throw n;return{success:!0,data:t}}catch(t){return console.error("Error getting customer details:",t),{success:!1,error:t.message}}},async getCustomerDetails(e){try{const{data:t,error:n}=await Hs.from("customers").select("customerid, name, barangay, type, status, credit_balance, discount").eq("customerid",e).single();if(n)throw n;return{success:!0,data:t}}catch(t){return console.error("Error getting customer details:",t),{success:!1,error:t.message}}},async getUnpaidBills(e){try{const{data:t,error:n}=await Hs.from("bills").select("*").eq("customerid",e).or("paymentstatus.eq.Unpaid,paymentstatus.eq.Partial").order("billedmonth",{ascending:!0});if(n)throw n;return{success:!0,data:t||[]}}catch(t){return console.error("Error getting unpaid bills:",t),{success:!1,error:t.message}}},async getPaymentHistory(e){try{const{data:t,error:n}=await Hs.from("bills").select("*").eq("customerid",e).eq("paymentstatus","Paid").order("billedmonth",{ascending:!1}).limit(10);if(n)throw n;return{success:!0,data:t||[]}}catch(t){return console.error("Error getting payment history:",t),{success:!1,error:t.message}}},async getSurchargeSettings(){try{const{data:e,error:t}=await Hs.from("surcharge_settings").select("*").limit(1).single();if(t)throw t;return{success:!0,data:e}}catch(e){return console.error("Error getting surcharge settings:",e),{success:!0,data:{due_day:10,first_surcharge_percent:10,second_surcharge_percent:15}}}},calculateSurcharge(e,t){if(!e||!e.billedmonth||!e.basicamount)return{surchargeAmount:0,firstSurcharge:0,secondSurcharge:0,daysOverdue:0,surchargeType:null};const n=new Date,s=new Date(e.billedmonth),a=new Date(s.getFullYear(),s.getMonth()+1,t.due_day),r=Math.floor((n-a)/864e5);if(r<=0)return{surchargeAmount:0,firstSurcharge:0,secondSurcharge:0,daysOverdue:0,surchargeType:null,dueDate:a};const i=parseFloat(e.basicamount),l=new Date(a.getFullYear(),a.getMonth()+1,0),o=n>l;let c=0,d=0,u=null;if(r>=1&&(c=i*t.first_surcharge_percent/100,u="first"),o){d=(i+c)*t.second_surcharge_percent/100,u="both"}const h=c+d;return{surchargeAmount:Math.round(100*h)/100,firstSurcharge:Math.round(100*c)/100,secondSurcharge:Math.round(100*d)/100,daysOverdue:r,surchargeType:u,dueDate:a,endOfDueMonth:l,firstSurchargePercent:t.first_surcharge_percent,secondSurchargePercent:t.second_surcharge_percent}},calculateTotalWithSurcharge(e,t){const n=parseFloat(e.basicamount||0),s=parseFloat(e.discountamount||0),a=parseFloat(e.surchargeamount||0);return n+(t?t.surchargeAmount:a)-s},async processPayment(e,t){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;try{const s=e.map(e=>Hs.from("bills").update({paymentstatus:"Paid",paidby:t,datepaid:(new Date).toISOString(),basicamount:e.basicamount||0,surchargeamount:e.surchargeamount||0,discountamount:e.discountamount||0,totalbillamount:e.totalbillamount||0,advancepaymentamount:e.advancepaymentamount||0}).eq("billid",e.billid)),a=await Promise.all(s);if(a.some(e=>e.error))throw new Error("Some bills failed to update");if(0!==n&&e.length>0){const{data:t,error:s}=await Hs.from("bills").select("customerid").eq("billid",e[0].billid).single();if(!s&&t){const{data:e,error:s}=await Hs.from("customers").select("credit_balance").eq("customerid",t.customerid).single();if(!s&&e){const s=parseFloat(e.credit_balance||0)+n;await Hs.from("customers").update({credit_balance:s}).eq("customerid",t.customerid)}}}return{success:!0,data:{paidCount:e.length,creditApplied:n}}}catch(s){return console.error("Error processing payment:",s),{success:!1,error:s.message}}},async getPaymentStats(){try{const e=new Date;e.setHours(0,0,0,0);const t=new Date;t.setDate(1),t.setHours(0,0,0,0);const{data:n,error:s}=await Hs.from("bills").select("totalbillamount").eq("paymentstatus","Paid").gte("datepaid",e.toISOString()),{data:a,error:r}=await Hs.from("bills").select("totalbillamount").eq("paymentstatus","Paid").gte("datepaid",t.toISOString());if(s||r)throw new Error("Error fetching statistics");const i=n.reduce((e,t)=>e+parseFloat(t.totalbillamount||0),0),l=a.reduce((e,t)=>e+parseFloat(t.totalbillamount||0),0);return{success:!0,data:{todayCollection:i,todayCount:n.length,monthCollection:l,monthCount:a.length}}}catch(e){return console.error("Error getting payment stats:",e),{success:!1,error:e.message}}},async getRecentPayments(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;try{const{data:t,error:n}=await Hs.from("bills").select("*").eq("paymentstatus","Paid").not("datepaid","is",null).order("datepaid",{ascending:!1}).limit(e);if(n)throw n;const s=[...new Set(t.map(e=>e.customerid))],{data:a,error:r}=await Hs.from("customers").select("customerid, name, type, barangay").in("customerid",s).limit(1e4);if(r)throw r;return{success:!0,data:t.map(e=>ea(ea({},e),{},{customer:a.find(t=>t.customerid===e.customerid)}))}}catch(t){return console.error("Error getting recent payments:",t),{success:!1,error:t.message,data:[]}}},async markBillAsUnpaid(e){try{const{data:t,error:n}=await Hs.from("bills").select("customerid, advancepaymentamount").eq("billid",e).single();if(n)throw n;if(t.advancepaymentamount&&parseFloat(t.advancepaymentamount)>0){const e=parseFloat(t.advancepaymentamount),{data:n,error:s}=await Hs.from("customers").select("credit_balance").eq("customerid",t.customerid).single();if(!s&&n){const s=parseFloat(n.credit_balance||0)+e;await Hs.from("customers").update({credit_balance:s}).eq("customerid",t.customerid)}}const{error:s}=await Hs.from("bills").update({paymentstatus:"Unpaid",paidby:null,datepaid:null,advancepaymentamount:null}).eq("billid",e);if(s)throw s;return{success:!0,message:"Bill marked as unpaid successfully"}}catch(t){return console.error("Error marking bill as unpaid:",t),{success:!1,error:t.message}}}},ra=e=>{var t,n,s,r,i,l,o,c,d;let{user:u}=e;const h=ne(),[m,f]=(0,a.useState)([]),[p,g]=(0,a.useState)([]),[v,y]=(0,a.useState)([]),[b,x]=(0,a.useState)(!0),[j,w]=(0,a.useState)(!0),[N,S]=(0,a.useState)(null),[k,C]=(0,a.useState)(null),[_,E]=(0,a.useState)(null),[T,P]=(0,a.useState)({totalCustomers:0,activeCustomers:0,monthlyRevenue:0,pendingBills:0,overdueAccounts:0,todayCollection:0});(0,a.useEffect)(()=>{O(),R()},[]);const O=async()=>{x(!0);try{const[e,t,n]=await Promise.all([ta.getRecentCustomers(5),sa.getRecentBills(5),aa.getRecentPayments(5)]);e.success&&f(e.data||[]),t.success&&g(t.data||[]),n.success&&y(n.data||[])}catch(e){console.error("Error loading recent data:",e)}x(!1)},R=async()=>{w(!0);try{var e,t,n,s,a,r;const[i,l,o]=await Promise.all([ta.getCustomerStats(),aa.getPaymentStats(),sa.getBills(1,1e4,"paymentstatus",!0)]),c={totalCustomers:(null===(e=i.data)||void 0===e?void 0:e.total)||0,activeCustomers:(null===(t=i.data)||void 0===t?void 0:t.active)||0,monthlyRevenue:(null===(n=l.data)||void 0===n?void 0:n.monthCollection)||0,todayCollection:(null===(s=l.data)||void 0===s?void 0:s.todayCollection)||0,pendingBills:(null===(a=o.data)||void 0===a?void 0:a.filter(e=>"Unpaid"===e.paymentstatus).length)||0,overdueAccounts:0},d=new Date;d.setMonth(d.getMonth()-2);const u=new Set((null===(r=o.data)||void 0===r?void 0:r.filter(e=>"Unpaid"===e.paymentstatus&&new Date(e.billedmonth)<d).map(e=>e.customerid))||[]);c.overdueAccounts=u.size,P(c)}catch(i){console.error("Error loading statistics:",i)}w(!1)};return(0,Js.jsxs)("div",{className:"dashboard-content",children:[(0,Js.jsxs)("div",{className:"page-header",children:[(0,Js.jsx)("h1",{className:"page-title",children:"Dashboard"}),(0,Js.jsxs)("p",{className:"page-subtitle",children:["Welcome back, ",u.firstname,"! Here's your system overview."]})]}),(0,Js.jsxs)("div",{className:"stats-grid",children:[(0,Js.jsxs)("div",{className:"stat-card blue",children:[(0,Js.jsx)("div",{className:"stat-icon",children:(0,Js.jsx)("i",{className:"fas fa-users"})}),(0,Js.jsxs)("div",{className:"stat-content",children:[(0,Js.jsx)("div",{className:"stat-number",children:j?(0,Js.jsx)("i",{className:"fas fa-spinner fa-pulse"}):T.totalCustomers.toLocaleString()}),(0,Js.jsx)("div",{className:"stat-label",children:"Total Customers"}),(0,Js.jsxs)("div",{className:"stat-sublabel",children:[T.activeCustomers," Active"]})]})]}),(0,Js.jsxs)("div",{className:"stat-card green",children:[(0,Js.jsx)("div",{className:"stat-icon",children:(0,Js.jsx)("i",{className:"fas fa-peso-sign"})}),(0,Js.jsxs)("div",{className:"stat-content",children:[(0,Js.jsx)("div",{className:"stat-number",children:j?(0,Js.jsx)("i",{className:"fas fa-spinner fa-pulse"}):"\u20b1".concat(T.monthlyRevenue.toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2}))}),(0,Js.jsx)("div",{className:"stat-label",children:"Monthly Revenue"}),(0,Js.jsxs)("div",{className:"stat-sublabel",children:["\u20b1",T.todayCollection.toLocaleString("en-PH",{minimumFractionDigits:2})," Today"]})]})]}),(0,Js.jsxs)("div",{className:"stat-card orange",children:[(0,Js.jsx)("div",{className:"stat-icon",children:(0,Js.jsx)("i",{className:"fas fa-file-invoice"})}),(0,Js.jsxs)("div",{className:"stat-content",children:[(0,Js.jsx)("div",{className:"stat-number",children:j?(0,Js.jsx)("i",{className:"fas fa-spinner fa-pulse"}):T.pendingBills.toLocaleString()}),(0,Js.jsx)("div",{className:"stat-label",children:"Pending Bills"}),(0,Js.jsx)("div",{className:"stat-sublabel",children:"Awaiting Payment"})]})]}),(0,Js.jsxs)("div",{className:"stat-card red",children:[(0,Js.jsx)("div",{className:"stat-icon",children:(0,Js.jsx)("i",{className:"fas fa-exclamation-circle"})}),(0,Js.jsxs)("div",{className:"stat-content",children:[(0,Js.jsx)("div",{className:"stat-number",children:j?(0,Js.jsx)("i",{className:"fas fa-spinner fa-pulse"}):T.overdueAccounts.toLocaleString()}),(0,Js.jsx)("div",{className:"stat-label",children:"Overdue Accounts"}),(0,Js.jsx)("div",{className:"stat-sublabel",children:"2+ Months Behind"})]})]})]}),(0,Js.jsxs)("div",{className:"box",style:{marginTop:"2rem",padding:"1.5rem"},children:[(0,Js.jsx)("h2",{className:"title is-5",style:{marginBottom:"1rem"},children:(0,Js.jsxs)("span",{className:"icon-text",children:[(0,Js.jsx)("span",{className:"icon has-text-primary",children:(0,Js.jsx)("i",{className:"fas fa-bolt"})}),(0,Js.jsx)("span",{children:"Quick Actions"})]})}),(0,Js.jsxs)("div",{className:"buttons",children:[(0,Js.jsxs)("button",{className:"button is-primary",onClick:()=>h("/dashboard/customers"),children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-user-plus"})}),(0,Js.jsx)("span",{children:"Add Customer"})]}),(0,Js.jsxs)("button",{className:"button is-info",onClick:()=>h("/dashboard/billing"),children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-file-invoice-dollar"})}),(0,Js.jsx)("span",{children:"Create Bill"})]}),(0,Js.jsxs)("button",{className:"button is-success",onClick:()=>h("/dashboard/payments"),children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-cash-register"})}),(0,Js.jsx)("span",{children:"Record Payment"})]}),(0,Js.jsxs)("button",{className:"button is-link",onClick:()=>h("/dashboard/reports"),children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-chart-line"})}),(0,Js.jsx)("span",{children:"View Reports"})]}),(0,Js.jsxs)("button",{className:"button is-warning",onClick:()=>R(),children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-sync-alt ".concat(j?"fa-spin":"")})}),(0,Js.jsx)("span",{children:"Refresh Stats"})]})]})]}),(0,Js.jsxs)("div",{className:"columns is-gapless",style:{marginTop:"2rem",gap:"0.5rem"},children:[(0,Js.jsx)("div",{className:"column is-4",children:(0,Js.jsxs)("div",{className:"card",style:{boxShadow:"0 2px 8px rgba(0,0,0,0.1)",borderRadius:"6px",overflow:"hidden"},children:[(0,Js.jsx)("header",{className:"card-header has-background-primary",children:(0,Js.jsxs)("p",{className:"card-header-title has-text-white",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-users"})}),(0,Js.jsx)("span",{children:"Recent Customers"})]})}),(0,Js.jsx)("div",{className:"card-content",style:{padding:0},children:b?(0,Js.jsx)("div",{className:"has-text-centered",style:{padding:"2rem"},children:(0,Js.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Js.jsx)("i",{className:"fas fa-spinner fa-pulse fa-2x"})})}):0===m.length?(0,Js.jsxs)("div",{className:"has-text-centered has-text-grey",style:{padding:"2rem"},children:[(0,Js.jsx)("i",{className:"fas fa-inbox",style:{fontSize:"2rem",marginBottom:"1rem",display:"block"}}),"No recent customers"]}):(0,Js.jsx)("div",{style:{width:"100%"},children:m.map((e,t)=>(0,Js.jsxs)("div",{style:{cursor:"pointer",padding:"0.875rem 0.25rem",borderBottom:t<m.length-1?"1px solid #f0f0f0":"none",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"space-between"},onClick:()=>S(e),onMouseEnter:e=>e.currentTarget.style.backgroundColor="#f8f9fa",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:[(0,Js.jsxs)("div",{style:{flex:1},children:[(0,Js.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"0.4rem"},children:[(0,Js.jsx)("span",{className:"icon has-text-primary",style:{marginRight:"0.5rem"},children:(0,Js.jsx)("i",{className:"fas fa-user"})}),(0,Js.jsx)("strong",{style:{fontSize:"0.95rem",color:"#363636"},children:e.name})]}),(0,Js.jsxs)("div",{style:{paddingLeft:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,Js.jsx)("span",{className:"tag is-primary is-light is-small",children:e.type}),(0,Js.jsxs)("span",{style:{fontSize:"0.8rem",color:"#7a7a7a"},children:[(0,Js.jsx)("i",{className:"fas fa-map-marker-alt",style:{marginRight:"0.25rem"}}),e.barangay]})]})]}),(0,Js.jsx)("span",{className:"icon has-text-grey-light",children:(0,Js.jsx)("i",{className:"fas fa-chevron-right"})})]},e.customerid))})})]})}),(0,Js.jsx)("div",{className:"column is-4",children:(0,Js.jsxs)("div",{className:"card",style:{boxShadow:"0 2px 8px rgba(0,0,0,0.1)",borderRadius:"6px",overflow:"hidden"},children:[(0,Js.jsx)("header",{className:"card-header has-background-info",children:(0,Js.jsxs)("p",{className:"card-header-title has-text-white",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-file-invoice-dollar"})}),(0,Js.jsx)("span",{children:"Recent Bills"})]})}),(0,Js.jsx)("div",{className:"card-content",style:{padding:0},children:b?(0,Js.jsx)("div",{className:"has-text-centered",style:{padding:"2rem"},children:(0,Js.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Js.jsx)("i",{className:"fas fa-spinner fa-pulse fa-2x"})})}):0===p.length?(0,Js.jsxs)("div",{className:"has-text-centered has-text-grey",style:{padding:"2rem"},children:[(0,Js.jsx)("i",{className:"fas fa-inbox",style:{fontSize:"2rem",marginBottom:"1rem",display:"block"}}),"No recent bills"]}):(0,Js.jsx)("div",{style:{width:"100%"},children:p.map((e,t)=>{var n,s;return(0,Js.jsxs)("div",{style:{cursor:"pointer",padding:"0.875rem 0.25rem",borderBottom:t<p.length-1?"1px solid #f0f0f0":"none",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"space-between"},onClick:()=>C(e),onMouseEnter:e=>e.currentTarget.style.backgroundColor="#f8f9fa",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:[(0,Js.jsxs)("div",{style:{flex:1},children:[(0,Js.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"0.4rem"},children:[(0,Js.jsx)("span",{className:"icon has-text-info",style:{marginRight:"0.5rem"},children:(0,Js.jsx)("i",{className:"fas fa-file-invoice"})}),(0,Js.jsx)("strong",{style:{fontSize:"0.95rem",color:"#363636"},children:(null===(n=e.customers)||void 0===n?void 0:n.name)||e.customername})]}),(0,Js.jsxs)("div",{style:{paddingLeft:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,Js.jsxs)("span",{style:{fontSize:"0.8rem",color:"#7a7a7a"},children:[(0,Js.jsx)("i",{className:"fas fa-calendar-alt",style:{marginRight:"0.25rem"}}),e.billedmonth]}),(0,Js.jsx)("span",{className:"tag is-small ".concat("Paid"===e.paymentstatus?"is-success":"is-warning"),children:e.paymentstatus})]})]}),(0,Js.jsx)("div",{style:{textAlign:"right"},children:(0,Js.jsxs)("div",{style:{fontSize:"1rem",fontWeight:"bold",color:"#209cee"},children:["\u20b1",null===(s=e.basicamount)||void 0===s?void 0:s.toFixed(2)]})})]},e.billid)})})})]})}),(0,Js.jsx)("div",{className:"column is-4",children:(0,Js.jsxs)("div",{className:"card",style:{boxShadow:"0 2px 8px rgba(0,0,0,0.1)",borderRadius:"6px",overflow:"hidden"},children:[(0,Js.jsx)("header",{className:"card-header has-background-success",children:(0,Js.jsxs)("p",{className:"card-header-title has-text-white",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-credit-card"})}),(0,Js.jsx)("span",{children:"Recent Payments"})]})}),(0,Js.jsx)("div",{className:"card-content",style:{padding:0},children:b?(0,Js.jsx)("div",{className:"has-text-centered",style:{padding:"2rem"},children:(0,Js.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Js.jsx)("i",{className:"fas fa-spinner fa-pulse fa-2x"})})}):0===v.length?(0,Js.jsxs)("div",{className:"has-text-centered has-text-grey",style:{padding:"2rem"},children:[(0,Js.jsx)("i",{className:"fas fa-inbox",style:{fontSize:"2rem",marginBottom:"1rem",display:"block"}}),"No recent payments"]}):(0,Js.jsx)("div",{style:{width:"100%"},children:v.map((e,t)=>{var n,s;return(0,Js.jsxs)("div",{style:{cursor:"pointer",padding:"0.875rem 0.25rem",borderBottom:t<v.length-1?"1px solid #f0f0f0":"none",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"space-between"},onClick:()=>E(e),onMouseEnter:e=>e.currentTarget.style.backgroundColor="#f8f9fa",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:[(0,Js.jsxs)("div",{style:{flex:1},children:[(0,Js.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"0.4rem"},children:[(0,Js.jsx)("span",{className:"icon has-text-success",style:{marginRight:"0.5rem"},children:(0,Js.jsx)("i",{className:"fas fa-check-circle"})}),(0,Js.jsx)("strong",{style:{fontSize:"0.95rem",color:"#363636"},children:(null===(n=e.customer)||void 0===n?void 0:n.name)||"Unknown"})]}),(0,Js.jsx)("div",{style:{paddingLeft:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:(0,Js.jsxs)("span",{style:{fontSize:"0.8rem",color:"#7a7a7a"},children:[(0,Js.jsx)("i",{className:"fas fa-clock",style:{marginRight:"0.25rem"}}),new Date(e.datepaid).toLocaleDateString()]})})]}),(0,Js.jsx)("div",{style:{textAlign:"right"},children:(0,Js.jsxs)("div",{style:{fontSize:"1rem",fontWeight:"bold",color:"#48c774"},children:["\u20b1",null===(s=e.totalbillamount)||void 0===s?void 0:s.toFixed(2)]})})]},e.billid)})})})]})})]}),N&&(0,Js.jsxs)("div",{className:"modal is-active",children:[(0,Js.jsx)("div",{className:"modal-background",onClick:()=>S(null)}),(0,Js.jsxs)("div",{className:"modal-card",children:[(0,Js.jsxs)("header",{className:"modal-card-head",children:[(0,Js.jsx)("p",{className:"modal-card-title",children:"Customer Details"}),(0,Js.jsx)("button",{className:"delete","aria-label":"close",onClick:()=>S(null)})]}),(0,Js.jsx)("section",{className:"modal-card-body",children:(0,Js.jsxs)("div",{className:"content",children:[(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Customer ID"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:N.customerid,readOnly:!0})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Name"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:N.name,readOnly:!0})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Type"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:N.type||"N/A",readOnly:!0})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Barangay"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:N.barangay||"N/A",readOnly:!0})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Status"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("span",{className:"tag ".concat("Active"===N.status?"is-success":"is-danger"),children:N.status||"N/A"})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Date Added"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:N.date_added||"N/A",readOnly:!0})})]})]})}),(0,Js.jsx)("footer",{className:"modal-card-foot",children:(0,Js.jsx)("button",{className:"button",onClick:()=>S(null),children:"Close"})})]})]}),k&&(0,Js.jsxs)("div",{className:"modal is-active",children:[(0,Js.jsx)("div",{className:"modal-background",onClick:()=>C(null)}),(0,Js.jsxs)("div",{className:"modal-card",children:[(0,Js.jsxs)("header",{className:"modal-card-head",children:[(0,Js.jsx)("p",{className:"modal-card-title",children:"Bill Details"}),(0,Js.jsx)("button",{className:"delete","aria-label":"close",onClick:()=>C(null)})]}),(0,Js.jsx)("section",{className:"modal-card-body",children:(0,Js.jsxs)("div",{className:"content",children:[(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Bill ID"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:k.billid,readOnly:!0})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Customer"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:(null===(t=k.customers)||void 0===t?void 0:t.name)||k.customername,readOnly:!0})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Billed Month"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:k.billedmonth,readOnly:!0})})]}),(0,Js.jsxs)("div",{className:"columns",children:[(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Previous Reading"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:k.previousreading||0,readOnly:!0})})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Current Reading"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:k.currentreading||0,readOnly:!0})})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Consumption"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:k.consumption||0,readOnly:!0})})]})})]}),(0,Js.jsxs)("div",{className:"columns",children:[(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Basic Amount"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:"\u20b1".concat((null===(n=k.basicamount)||void 0===n?void 0:n.toFixed(2))||"0.00"),readOnly:!0})})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Surcharge"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:"\u20b1".concat((null===(s=k.surchargeamount)||void 0===s?void 0:s.toFixed(2))||"0.00"),readOnly:!0})})]})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Total Amount"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input has-text-weight-bold",type:"text",value:"\u20b1".concat((null===(r=k.totalbillamount)||void 0===r?void 0:r.toFixed(2))||"0.00"),readOnly:!0})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Payment Status"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("span",{className:"tag ".concat("Paid"===k.paymentstatus?"is-success":"is-warning"),children:k.paymentstatus})})]})]})}),(0,Js.jsx)("footer",{className:"modal-card-foot",children:(0,Js.jsx)("button",{className:"button",onClick:()=>C(null),children:"Close"})})]})]}),_&&(0,Js.jsxs)("div",{className:"modal is-active",children:[(0,Js.jsx)("div",{className:"modal-background",onClick:()=>E(null)}),(0,Js.jsxs)("div",{className:"modal-card",children:[(0,Js.jsxs)("header",{className:"modal-card-head",children:[(0,Js.jsx)("p",{className:"modal-card-title",children:"Payment Details"}),(0,Js.jsx)("button",{className:"delete","aria-label":"close",onClick:()=>E(null)})]}),(0,Js.jsx)("section",{className:"modal-card-body",children:(0,Js.jsxs)("div",{className:"content",children:[(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Bill ID"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:_.billid,readOnly:!0})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Customer"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:(null===(i=_.customer)||void 0===i?void 0:i.name)||"Unknown",readOnly:!0})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Billed Month"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:_.billedmonth||"N/A",readOnly:!0})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Payment Date"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:_.datepaid?new Date(_.datepaid).toLocaleDateString():"N/A",readOnly:!0})})]}),(0,Js.jsxs)("div",{className:"columns",children:[(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Basic Amount"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:"\u20b1".concat((null===(l=_.basicamount)||void 0===l?void 0:l.toFixed(2))||"0.00"),readOnly:!0})})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Surcharge"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:"\u20b1".concat((null===(o=_.surchargeamount)||void 0===o?void 0:o.toFixed(2))||"0.00"),readOnly:!0})})]})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Total Amount"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input has-text-weight-bold",type:"text",value:"\u20b1".concat((null===(c=_.totalbillamount)||void 0===c?void 0:c.toFixed(2))||"0.00"),readOnly:!0})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Processed By"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:_.paidby||"N/A",readOnly:!0})})]}),_.advancepaymentamount&&_.advancepaymentamount>0&&(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Credit Applied"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:"\u20b1".concat(null===(d=_.advancepaymentamount)||void 0===d?void 0:d.toFixed(2)),readOnly:!0})})]})]})}),(0,Js.jsx)("footer",{className:"modal-card-foot",children:(0,Js.jsx)("button",{className:"button",onClick:()=>E(null),children:"Close"})})]})]})]})},ia=()=>{const[e,t]=(0,a.useState)([]),[n,s]=(0,a.useState)(!0),[r,i]=(0,a.useState)("Loading customers..."),[l,o]=(0,a.useState)(""),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)("add"),[m,f]=(0,a.useState)(null),[p,g]=(0,a.useState)(!1),[v,y]=(0,a.useState)(""),[b,x]=(0,a.useState)("all"),[j,w]=(0,a.useState)("all"),[N,S]=(0,a.useState)("all"),[k,C]=(0,a.useState)("date_added"),[_,E]=(0,a.useState)("desc"),[T,P]=(0,a.useState)(1),O=50,[R,A]=(0,a.useState)({customerid:"",name:"",type:"",barangay:"",discount:0,status:"Active",remarks:""}),[I,L]=(0,a.useState)({total:0,active:0,disconnected:0}),[D,B]=(0,a.useState)([]),[U,F]=(0,a.useState)([]),[z,M]=(0,a.useState)([]),W=$s.getUserSession(),q=()=>U.length>0?U[0].type:"",H=()=>D.length>0?D[0].barangay:"",V=()=>z.length>0?Number(z[0].discountpercentage):0;(0,a.useEffect)(()=>{K(),$(),J()},[]),(0,a.useEffect)(()=>{U.length>0&&A(e=>ea(ea({},e),{},{type:e.type||U[0].type}))},[U]),(0,a.useEffect)(()=>{D.length>0&&A(e=>ea(ea({},e),{},{barangay:e.barangay||D[0].barangay}))},[D]),(0,a.useEffect)(()=>{z.length>0&&A(e=>{var t;return ea(ea({},e),{},{discount:null!==(t=e.discount)&&void 0!==t?t:V()})})},[z]),(0,a.useEffect)(()=>{const e=setTimeout(()=>{P(1),K()},300);return()=>clearTimeout(e)},[v,b,j,N]);const K=async()=>{s(!0);try{const e=await ta.getCustomers({search:v,barangay:b,type:j,status:N});e.success?(t(e.data||[]),o("")):(e.error.includes("404")||e.error.includes('relation "public.customers" does not exist')?o("The customers table has not been created yet. Please create the customers table in your Supabase database."):o(e.error),t([]))}catch(e){console.error("Error loading customers:",e),o("Failed to load customers. Please check your database connection."),t([])}s(!1)},$=async()=>{try{const[e,t,n]=await Promise.all([ta.getBarangays(),ta.getCustomerTypes(),ta.getDiscounts()]);e.success?B(e.data||[]):B([]),t.success?F(t.data||[]):F([]),n.success?M((n.data||[]).map(e=>({type:e.type,discountpercentage:null!==e.discountpercentage?Number(e.discountpercentage):0}))):M([])}catch(e){console.error("Error loading filter options:",e),B([]),F([]),M([])}},J=async()=>{try{const e=await ta.getCustomerStats();e.success&&L(e.data||{total:0,active:0,disconnected:0})}catch(e){console.error("Error loading stats:",e),L({total:0,active:0,disconnected:0})}},G=async e=>{let t;e.preventDefault(),"add"===u?t=await ta.addCustomer(R):"edit"===u?t=await ta.updateCustomer(m.customerid,R):"status"===u&&(t=await ta.updateCustomerStatus(m.customerid,R.status,R.remarks,W.firstname+" "+W.lastname)),t.success?(K(),J(),$(),d(!1),f(null),Q()):o(t.error)},Q=()=>{A({customerid:"",name:"",type:q(),barangay:H(),discount:V(),status:"Active",remarks:""})},Y=e=>{k===e?E("asc"===_?"desc":"asc"):(C(e),E("asc"))},X=(0,a.useMemo)(()=>[...e].sort((e,t)=>{let n=e[k],s=t[k];return"string"===typeof n&&(n=n.toLowerCase(),s=s.toLowerCase()),"asc"===_?n>s?1:-1:n<s?1:-1}),[e,k,_]),Z=(0,a.useMemo)(()=>{const e=(T-1)*O;return X.slice(e,e+O)},[X,T,O]),ee=Math.ceil(X.length/O);return(0,Js.jsxs)("div",{className:"customers-page",children:[(0,Js.jsx)("div",{className:"compact-header",children:(0,Js.jsxs)("div",{className:"header-row",children:[(0,Js.jsxs)("div",{className:"title-section",children:[(0,Js.jsx)("h1",{className:"page-title",children:"Customer Management"}),(0,Js.jsxs)("div",{className:"stats-inline",children:[(0,Js.jsxs)("span",{className:"stat-item",children:[(0,Js.jsx)("i",{className:"fas fa-users"}),(0,Js.jsx)("strong",{children:I.total})," Total"]}),(0,Js.jsxs)("span",{className:"stat-item active",children:[(0,Js.jsx)("i",{className:"fas fa-check-circle"}),(0,Js.jsx)("strong",{children:I.active})," Active"]}),(0,Js.jsxs)("span",{className:"stat-item disconnected",children:[(0,Js.jsx)("i",{className:"fas fa-times-circle"}),(0,Js.jsx)("strong",{children:I.disconnected})," Disconnected"]})]})]}),(0,Js.jsxs)("div",{className:"header-actions",children:[(0,Js.jsxs)("button",{className:"button is-info",onClick:()=>{ta.exportToCSV(e)},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-download"})}),(0,Js.jsx)("span",{children:"Export"})]}),0===e.length&&!n&&(0,Js.jsxs)("button",{className:"button is-link",onClick:async()=>{const e=[{customerid:1,name:"Juan Tolentino",type:"Residential",barangay:"Poblacion",discount:0,status:"Active",added_by:W.firstname+" "+W.lastname},{customerid:2,name:"Maria Santos",type:"Commercial",barangay:"Barangay 1",discount:5,status:"Active",added_by:W.firstname+" "+W.lastname},{customerid:3,name:"Pedro Garcia",type:"Residential",barangay:"Barangay 2",discount:0,status:"Disconnected",added_by:W.firstname+" "+W.lastname},{customerid:4,name:"Ana Cruz",type:"Residential",barangay:"Poblacion",discount:10,status:"Active",added_by:W.firstname+" "+W.lastname},{customerid:5,name:"Roberto Reyes",type:"Industrial",barangay:"Barangay 3",discount:0,status:"Active",added_by:W.firstname+" "+W.lastname}];try{for(const t of e)await ta.addCustomer(t);K(),J(),o("")}catch(t){o("Failed to create sample data: "+t.message)}},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-database"})}),(0,Js.jsx)("span",{children:"Sample Data"})]}),(0,Js.jsxs)("button",{className:"button is-primary",onClick:async()=>{if(!W)return void o("Your session has expired. Please log in again to add customers.");if(0===U.length)return void o("No customer types are configured. Please add customer types before creating a customer.");if(0===D.length)return void o("No barangays are configured. Please add barangays before creating a customer.");if(0===z.length)return void o("No discounts are configured. Please add discount options before creating a customer.");const e=await ta.generateCustomerId();if(!e.success)return void o(e.error||"Failed to generate a new customer ID. Please try again.");const{firstname:t="",lastname:n=""}=W,s="".concat(t," ").concat(n).trim()||"Unknown User";A({customerid:e.data,name:"",type:q(),barangay:H(),discount:V(),status:"Active",remarks:"",added_by:s}),h("add"),d(!0)},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-plus"})}),(0,Js.jsx)("span",{children:"Add Customer"})]})]})]})}),(()=>{if(!c)return null;const e="view"===u,t="status"===u,n="add"===u,s="edit"===u,a=()=>{d(!1),f(null),Q()};return(0,Js.jsxs)("div",{className:"modal ".concat(c?"is-active":""),children:[(0,Js.jsx)("div",{className:"modal-background",onClick:a}),(0,Js.jsxs)("div",{className:"modal-card",children:[(0,Js.jsxs)("header",{className:"modal-card-head",children:[(0,Js.jsxs)("p",{className:"modal-card-title",children:[n&&"Add Customer",s&&"Edit Customer",e&&"Customer Details",t&&"Update Customer Status"]}),(0,Js.jsx)("button",{className:"delete","aria-label":"close",onClick:a})]}),(0,Js.jsx)("section",{className:"modal-card-body",children:e?(0,Js.jsxs)("div",{className:"content",children:[(0,Js.jsxs)("p",{children:[(0,Js.jsx)("strong",{children:"ID:"})," ",R.customerid]}),(0,Js.jsxs)("p",{children:[(0,Js.jsx)("strong",{children:"Name:"})," ",R.name]}),(0,Js.jsxs)("p",{children:[(0,Js.jsx)("strong",{children:"Type:"})," ",R.type]}),(0,Js.jsxs)("p",{children:[(0,Js.jsx)("strong",{children:"Barangay:"})," ",R.barangay]}),(0,Js.jsxs)("p",{children:[(0,Js.jsx)("strong",{children:"Status:"})," ",R.status]}),(0,Js.jsxs)("p",{children:[(0,Js.jsx)("strong",{children:"Discount:"})," ",R.discount,"%"]}),(0,Js.jsxs)("p",{children:[(0,Js.jsx)("strong",{children:"Remarks:"})," ",R.remarks]})]}):(0,Js.jsxs)("form",{onSubmit:G,children:[(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Customer ID"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:R.customerid,readOnly:!0})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Name"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",value:R.name,onChange:e=>A(ea(ea({},R),{},{name:e.target.value})),required:!0,disabled:t})})]}),!t&&(0,Js.jsxs)(Js.Fragment,{children:[(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Type"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsx)("select",{value:R.type,onChange:e=>A(ea(ea({},R),{},{type:e.target.value})),disabled:t,children:U.map(e=>(0,Js.jsx)("option",{value:e.type,children:e.type},e.type))})})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Barangay"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:R.barangay,onChange:e=>A(ea(ea({},R),{},{barangay:e.target.value})),children:[D.map(e=>(0,Js.jsx)("option",{value:e.barangay,children:e.barangay},e.barangay)),R.barangay&&!D.some(e=>e.barangay===R.barangay)&&(0,Js.jsx)("option",{value:R.barangay,children:R.barangay})]})})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Discount (%)"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:R.discount,onChange:e=>A(ea(ea({},R),{},{discount:Number(e.target.value)})),children:[z.map(e=>(0,Js.jsxs)("option",{value:e.discountpercentage,children:[e.type," (",e.discountpercentage,"%)"]},e.type)),"number"===typeof R.discount&&!z.some(e=>e.discountpercentage===Number(R.discount))&&(0,Js.jsxs)("option",{value:R.discount,children:[R.discount,"%"]})]})})})]})]}),(n||s)&&(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Remarks"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("textarea",{className:"textarea",value:R.remarks,onChange:e=>A(ea(ea({},R),{},{remarks:e.target.value}))})})]}),t&&(0,Js.jsxs)(Js.Fragment,{children:[(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Status"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:R.status,onChange:e=>A(ea(ea({},R),{},{status:e.target.value})),children:[(0,Js.jsx)("option",{value:"Active",children:"Active"}),(0,Js.jsx)("option",{value:"Disconnected",children:"Disconnected"})]})})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Remarks"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("textarea",{className:"textarea",value:R.remarks,onChange:e=>A(ea(ea({},R),{},{remarks:e.target.value})),placeholder:"Reason for status change"})})]})]}),(0,Js.jsxs)("footer",{className:"modal-card-foot",children:[(0,Js.jsxs)("button",{type:"submit",className:"button is-primary",children:[n&&"Save Customer",s&&"Update Customer",t&&"Update Status"]}),(0,Js.jsx)("button",{type:"button",className:"button",onClick:a,children:"Cancel"})]})]})})]})]})})(),(0,Js.jsxs)("div",{className:"compact-filters",children:[(0,Js.jsx)("div",{className:"search-input",children:(0,Js.jsxs)("div",{className:"control has-icons-left",children:[(0,Js.jsx)("input",{className:"input",type:"text",placeholder:"Search customers...",value:v,onChange:e=>y(e.target.value)}),(0,Js.jsx)("span",{className:"icon is-small is-left",children:(0,Js.jsx)("i",{className:"fas fa-search"})})]})}),(0,Js.jsxs)("div",{className:"filter-row",children:[(0,Js.jsx)("div",{className:"filter-group",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:b,onChange:e=>x(e.target.value),children:[(0,Js.jsx)("option",{value:"all",children:"All Barangays"}),D.map(e=>(0,Js.jsx)("option",{value:e.barangay,children:e.barangay},e.barangay))]})})}),(0,Js.jsx)("div",{className:"filter-group",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:j,onChange:e=>w(e.target.value),children:[(0,Js.jsx)("option",{value:"all",children:"All Types"}),U.map(e=>(0,Js.jsx)("option",{value:e.type,children:e.type},e.type))]})})}),(0,Js.jsx)("div",{className:"filter-group",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:N,onChange:e=>S(e.target.value),children:[(0,Js.jsx)("option",{value:"all",children:"All Status"}),(0,Js.jsx)("option",{value:"Active",children:"Active"}),(0,Js.jsx)("option",{value:"Disconnected",children:"Disconnected"})]})})})]})]}),l&&(0,Js.jsxs)("div",{className:"notification is-warning",children:[(0,Js.jsx)("button",{className:"delete",onClick:()=>o("")}),(0,Js.jsxs)("div",{children:[(0,Js.jsx)("strong",{children:"Database Setup Required:"}),(0,Js.jsx)("p",{children:l}),l.includes("customers table")&&(0,Js.jsxs)("div",{className:"mt-3",children:[(0,Js.jsx)("p",{children:(0,Js.jsx)("strong",{children:"To fix this issue:"})}),(0,Js.jsxs)("ol",{children:[(0,Js.jsx)("li",{children:"Go to your Supabase Dashboard"}),(0,Js.jsx)("li",{children:"Navigate to SQL Editor"}),(0,Js.jsx)("li",{children:"Run the SQL provided in the console or documentation"}),(0,Js.jsx)("li",{children:"Refresh this page"})]}),(0,Js.jsxs)("div",{className:"buttons",children:[(0,Js.jsxs)("button",{className:"button is-small is-info",onClick:()=>{console.log("\nCREATE TABLE public.customers (\n  customerid bigint not null,\n  name text not null,\n  type text null,\n  barangay text null,\n  discount numeric null,\n  date_added date null default CURRENT_DATE,\n  remarks text null,\n  credit_balance numeric null,\n  status text null,\n  disconnection_date date null,\n  added_by text null,\n  disconnected_by text null,\n  constraint customers_pkey primary key (customerid)\n);\n                      "),alert("SQL command copied to console. Check browser console for the CREATE TABLE statement.")},children:[(0,Js.jsx)("i",{className:"fas fa-copy"}),"Show SQL in Console"]}),(0,Js.jsxs)("button",{className:"button is-small is-primary",onClick:()=>{o(""),K(),J(),$()},children:[(0,Js.jsx)("i",{className:"fas fa-sync"}),"Retry Connection"]}),(0,Js.jsxs)("button",{className:"button is-small is-success",onClick:async()=>{const e=await ta.testConnection();e.success?alert("Connection successful! Check console for details."):alert("Connection failed: "+e.error)},children:[(0,Js.jsx)("i",{className:"fas fa-plug"}),"Test Connection"]})]})]})]})]}),(0,Js.jsx)("div",{className:"table-container",children:n?(0,Js.jsxs)("div",{className:"loading-container",children:[(0,Js.jsxs)("div",{className:"loading-message",children:[(0,Js.jsx)("div",{className:"loading-spinner"}),(0,Js.jsx)("h3",{className:"title is-5",children:r}),(0,Js.jsx)("p",{className:"has-text-grey",children:"Fetching all customer records from database..."})]}),(0,Js.jsx)("div",{className:"loading-skeleton",children:[...Array(5)].map((e,t)=>(0,Js.jsxs)("div",{className:"skeleton-row",children:[(0,Js.jsx)("div",{className:"skeleton-avatar"}),(0,Js.jsx)("div",{className:"skeleton-text"}),(0,Js.jsx)("div",{className:"skeleton-text short"}),(0,Js.jsx)("div",{className:"skeleton-text"}),(0,Js.jsx)("div",{className:"skeleton-badge"})]},t))})]}):(0,Js.jsxs)(Js.Fragment,{children:[(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"Customer"}),(0,Js.jsxs)("th",{onClick:()=>Y("customerid"),className:"sortable",children:["ID ","customerid"===k&&(0,Js.jsx)("i",{className:"fas fa-sort-".concat("asc"===_?"up":"down")})]}),(0,Js.jsxs)("th",{onClick:()=>Y("type"),className:"sortable",children:["Type ","type"===k&&(0,Js.jsx)("i",{className:"fas fa-sort-".concat("asc"===_?"up":"down")})]}),(0,Js.jsxs)("th",{onClick:()=>Y("barangay"),className:"sortable",children:["Barangay ","barangay"===k&&(0,Js.jsx)("i",{className:"fas fa-sort-".concat("asc"===_?"up":"down")})]}),(0,Js.jsxs)("th",{onClick:()=>Y("status"),className:"sortable",children:["Status ","status"===k&&(0,Js.jsx)("i",{className:"fas fa-sort-".concat("asc"===_?"up":"down")})]}),(0,Js.jsxs)("th",{onClick:()=>Y("date_added"),className:"sortable",children:["Date Added ","date_added"===k&&(0,Js.jsx)("i",{className:"fas fa-sort-".concat("asc"===_?"up":"down")})]}),(0,Js.jsx)("th",{children:"Actions"})]})}),(0,Js.jsx)("tbody",{children:Z.length>0?Z.map(e=>{return(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{children:(0,Js.jsxs)("div",{className:"customer-info",children:[(0,Js.jsx)("div",{className:"customer-avatar",children:(t=e.name,t.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2))}),(0,Js.jsxs)("div",{children:[(0,Js.jsx)("div",{className:"customer-name",children:e.name}),(0,Js.jsx)("div",{className:"customer-discount",children:e.discount>0&&"".concat(e.discount,"% discount")})]})]})}),(0,Js.jsx)("td",{children:e.customerid}),(0,Js.jsx)("td",{children:e.type}),(0,Js.jsx)("td",{children:e.barangay}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag ".concat(e.status&&"active"===e.status.toLowerCase()?"is-success":"is-danger"),children:e.status})}),(0,Js.jsx)("td",{children:new Date(e.date_added).toLocaleDateString()}),(0,Js.jsx)("td",{children:(0,Js.jsxs)("div",{className:"buttons are-small",children:[(0,Js.jsx)("button",{className:"button is-info is-small",onClick:()=>(e=>{f(e),h("view"),d(!0)})(e),title:"View Customer",children:(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-eye"})})}),(0,Js.jsx)("button",{className:"button is-link is-small",onClick:()=>(e=>{A(e),f(e),h("edit"),d(!0)})(e),title:"Edit Customer",children:(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-edit"})})}),(0,Js.jsx)("button",{className:"button is-warning is-small",onClick:()=>(e=>{f(e),A(ea(ea({},e),{},{remarks:""})),h("status"),d(!0)})(e),title:"Change Status",children:(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-power-off"})})}),(0,Js.jsx)("button",{className:"button is-danger is-small",onClick:()=>(e=>{f(e),g(!0)})(e),title:"Delete Customer",children:(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-trash"})})})]})})]},e.customerid);var t}):(0,Js.jsx)("tr",{children:(0,Js.jsx)("td",{colSpan:"7",className:"has-text-centered",style:{padding:"3rem"},children:(0,Js.jsxs)("div",{className:"empty-state",children:[(0,Js.jsx)("i",{className:"fas fa-users fa-3x has-text-grey-light"}),(0,Js.jsx)("h3",{className:"title is-5 has-text-grey mt-4",children:"No customers found"}),(0,Js.jsx)("p",{className:"has-text-grey",children:l?"Please check the error message above.":v||"all"!==b||"all"!==j||"all"!==N?"Try adjusting your search or filters.":"Start by adding your first customer."})]})})})})]}),ee>1&&(0,Js.jsxs)("div",{className:"pagination-container",children:[(0,Js.jsxs)("div",{className:"pagination-info",children:[(0,Js.jsxs)("span",{children:["Showing ",(T-1)*O+1," to ",Math.min(T*O,X.length)," of ",X.length," customers"]}),ee>5&&(0,Js.jsxs)("div",{className:"page-jump",children:[(0,Js.jsx)("span",{children:"Go to page:"}),(0,Js.jsx)("input",{type:"number",min:"1",max:ee,value:T,onChange:e=>{const t=parseInt(e.target.value);t>=1&&t<=ee&&P(t)},className:"page-input"}),(0,Js.jsxs)("span",{children:["of ",ee]})]})]}),(0,Js.jsxs)("nav",{className:"pagination is-centered",role:"navigation",children:[(0,Js.jsxs)("button",{className:"pagination-previous",disabled:1===T,onClick:()=>P(T-1),children:[(0,Js.jsx)("i",{className:"fas fa-chevron-left"}),"Previous"]}),(0,Js.jsxs)("button",{className:"pagination-next",disabled:T===ee,onClick:()=>P(T+1),children:["Next",(0,Js.jsx)("i",{className:"fas fa-chevron-right"})]}),(0,Js.jsxs)("ul",{className:"pagination-list",children:[T>3&&(0,Js.jsxs)(Js.Fragment,{children:[(0,Js.jsx)("li",{children:(0,Js.jsx)("button",{className:"pagination-link",onClick:()=>P(1),children:"1"})}),T>4&&(0,Js.jsx)("li",{children:(0,Js.jsx)("span",{className:"pagination-ellipsis",children:"\u2026"})})]}),[...Array(ee)].map((e,t)=>{const n=t+1;return n===T||n>=T-2&&n<=T+2||T<=3&&n<=5||T>=ee-2&&n>=ee-4?(0,Js.jsx)("li",{children:(0,Js.jsx)("button",{className:"pagination-link ".concat(T===n?"is-current":""),onClick:()=>P(n),children:n})},t):null}),T<ee-2&&(0,Js.jsxs)(Js.Fragment,{children:[T<ee-3&&(0,Js.jsx)("li",{children:(0,Js.jsx)("span",{className:"pagination-ellipsis",children:"\u2026"})}),(0,Js.jsx)("li",{children:(0,Js.jsx)("button",{className:"pagination-link",onClick:()=>P(ee),children:ee})})]})]})]})]})]})})]})},la=e=>{let{isOpen:t,onClose:n,mode:s,bill:r,preSelectedCustomer:i,onSuccess:l,customerTypes:o,surchargeSettings:c}=e;const[d,u]=(0,a.useState)(!1),[h,m]=(0,a.useState)(""),[f,p]=(0,a.useState)(!1),[g,v]=(0,a.useState)(""),[y,b]=(0,a.useState)([]),[x,j]=(0,a.useState)(null),[w,N]=(0,a.useState)(null),[S,k]=(0,a.useState)([]),[C,_]=(0,a.useState)(!1),[E,T]=(0,a.useState)(null),[P,O]=(0,a.useState)({customerid:"",billedmonth:"",previousreading:0,currentreading:0,consumption:0,basicamount:0});(0,a.useEffect)(()=>{t&&("edit"===s&&r?R():"add"===s&&i?A():I())},[t,s,r,i]);const R=async()=>{var e,t,n,s;const a={customerid:r.customerid,name:(null===(e=r.customers)||void 0===e?void 0:e.name)||"",type:(null===(t=r.customers)||void 0===t?void 0:t.type)||"",barangay:(null===(n=r.customers)||void 0===n?void 0:n.barangay)||"",discount:(null===(s=r.customers)||void 0===s?void 0:s.discount)||0};j(a),O({customerid:r.customerid,billedmonth:r.billedmonth.substring(0,7),previousreading:r.previousreading,currentreading:r.currentreading,consumption:r.consumption,basicamount:r.basicamount});const i=await sa.getCustomerBills(r.customerid);i.success&&k(i.data)},A=async()=>{await B(i)},I=()=>{j(null),b([]),v(""),N(null),k([]),m(""),O({customerid:"",billedmonth:L(),previousreading:0,currentreading:0,consumption:0,basicamount:0})},L=()=>{const e=new Date;return"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"))},D=async()=>{if(!g.trim())return void m("Please enter customer name or ID");u(!0),m("");const e=await aa.searchCustomers(g);e.success?(b(e.data),0===e.data.length&&m("No customers found")):m(e.error),u(!1)},B=async e=>{var t;j(e),b([]),v("");const n=await sa.getLastBill(e.customerid);n.success&&n.data?(N(n.data),O(e=>ea(ea({},e),{},{previousreading:n.data.currentreading||0}))):(N(null),O(e=>ea(ea({},e),{},{previousreading:0})));const s=await sa.getCustomerBills(e.customerid);s.success&&k(s.data);const a=U(null===(t=n.data)||void 0===t?void 0:t.billedmonth);O(t=>ea(ea({},t),{},{customerid:e.customerid,billedmonth:a}))},U=e=>{if(!e)return L();const t=e.substring(0,7),n=new Date(t+"-01");return n.setMonth(n.getMonth()+1),"".concat(n.getFullYear(),"-").concat(String(n.getMonth()+1).padStart(2,"0"))},F=(e,t)=>{const n=ea(ea({},P),{},{[e]:t});if("previousreading"===e||"currentreading"===e){const s=parseFloat("previousreading"===e?t:n.previousreading)||0,a=parseFloat("currentreading"===e?t:n.currentreading)||0;n.consumption=Math.max(0,a-s)}if("consumption"===e||"previousreading"===e||"currentreading"===e){const e=o.find(e=>e.type===(null===x||void 0===x?void 0:x.type));e&&n.consumption>=0&&(n.basicamount=sa.calculateBasicAmount(n.consumption,e))}O(n)},z=e=>"\u20b1".concat(parseFloat(e||0).toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})),M=e=>e?new Date(e).toLocaleDateString("en-PH",{year:"numeric",month:"long"}):"N/A";return t?(0,Js.jsxs)("div",{className:"modal is-active",children:[(0,Js.jsx)("div",{className:"modal-background",onClick:n}),(0,Js.jsxs)("div",{className:"modal-card",style:{width:"90vw",maxWidth:"1000px"},children:[(0,Js.jsxs)("header",{className:"modal-card-head",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:[(0,Js.jsxs)("p",{className:"modal-card-title",style:{color:"white",fontSize:"1.25rem",fontWeight:"600"},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-file-invoice-dollar"})}),(0,Js.jsx)("span",{children:"add"===s?"Add New Bill":"Edit Bill"})]}),(0,Js.jsx)("button",{className:"delete",onClick:n})]}),(0,Js.jsxs)("section",{className:"modal-card-body",style:{maxHeight:"75vh",overflowY:"auto",padding:"1.5rem"},children:[h&&(0,Js.jsxs)("div",{className:"notification is-danger",children:[(0,Js.jsx)("button",{className:"delete",onClick:()=>m("")}),h]}),!x&&"add"===s&&(0,Js.jsxs)("div",{className:"box",children:[(0,Js.jsx)("h3",{className:"title is-5",children:"Select Customer"}),(0,Js.jsxs)("div",{className:"field has-addons",children:[(0,Js.jsx)("div",{className:"control is-expanded",children:(0,Js.jsx)("input",{className:"input",type:"text",placeholder:"Search by customer name or ID...",value:g,onChange:e=>v(e.target.value),onKeyPress:e=>"Enter"===e.key&&D()})}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("button",{className:"button is-primary ".concat(d?"is-loading":""),onClick:D,children:"Search"})})]}),y.length>0&&(0,Js.jsx)("div",{className:"table-container mt-3",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"ID"}),(0,Js.jsx)("th",{children:"Name"}),(0,Js.jsx)("th",{children:"Type"}),(0,Js.jsx)("th",{children:"Barangay"}),(0,Js.jsx)("th",{children:"Action"})]})}),(0,Js.jsx)("tbody",{children:y.map(e=>(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{children:e.customerid}),(0,Js.jsx)("td",{children:(0,Js.jsx)("strong",{children:e.name})}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag is-info",children:e.type})}),(0,Js.jsx)("td",{children:e.barangay}),(0,Js.jsx)("td",{children:(0,Js.jsx)("button",{className:"button is-small is-primary",onClick:()=>B(e),children:"Select"})})]},e.customerid))})]})})]}),x&&(0,Js.jsxs)(Js.Fragment,{children:[(0,Js.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea15 0%, #764ba215 100%)",border:"1px solid #e0e0e0",borderRadius:"8px",padding:"1.25rem",marginBottom:"1.5rem"},children:[(0,Js.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"1rem"},children:[(0,Js.jsx)("span",{className:"icon has-text-primary",style:{fontSize:"1.5rem",marginRight:"0.5rem"},children:(0,Js.jsx)("i",{className:"fas fa-user-circle"})}),(0,Js.jsx)("h3",{style:{fontSize:"1.1rem",fontWeight:"600",margin:0},children:"Customer Information"})]}),(0,Js.jsxs)("div",{className:"columns is-multiline is-mobile",style:{marginBottom:"0"},children:[(0,Js.jsxs)("div",{className:"column is-3",children:[(0,Js.jsx)("p",{style:{fontSize:"0.75rem",color:"#7a7a7a",marginBottom:"0.25rem",textTransform:"uppercase",fontWeight:"600"},children:"ID"}),(0,Js.jsx)("p",{style:{fontSize:"1rem",fontWeight:"600",color:"#363636"},children:x.customerid})]}),(0,Js.jsxs)("div",{className:"column is-3",children:[(0,Js.jsx)("p",{style:{fontSize:"0.75rem",color:"#7a7a7a",marginBottom:"0.25rem",textTransform:"uppercase",fontWeight:"600"},children:"Name"}),(0,Js.jsx)("p",{style:{fontSize:"1rem",fontWeight:"600",color:"#363636"},children:x.name})]}),(0,Js.jsxs)("div",{className:"column is-3",children:[(0,Js.jsx)("p",{style:{fontSize:"0.75rem",color:"#7a7a7a",marginBottom:"0.25rem",textTransform:"uppercase",fontWeight:"600"},children:"Type"}),(0,Js.jsx)("span",{className:"tag is-info is-light",style:{fontWeight:"600"},children:x.type})]}),(0,Js.jsxs)("div",{className:"column is-3",children:[(0,Js.jsx)("p",{style:{fontSize:"0.75rem",color:"#7a7a7a",marginBottom:"0.25rem",textTransform:"uppercase",fontWeight:"600"},children:"Barangay"}),(0,Js.jsx)("p",{style:{fontSize:"1rem",fontWeight:"600",color:"#363636"},children:x.barangay})]}),w&&(0,Js.jsx)("div",{className:"column is-full",children:(0,Js.jsxs)("div",{style:{background:"#fff",padding:"0.75rem",borderRadius:"6px",border:"1px solid #e0e0e0",marginTop:"0.5rem"},children:[(0,Js.jsxs)("p",{style:{fontSize:"0.75rem",color:"#7a7a7a",marginBottom:"0.25rem",textTransform:"uppercase",fontWeight:"600"},children:[(0,Js.jsx)("i",{className:"fas fa-history"})," Last Reading"]}),(0,Js.jsxs)("p",{style:{fontSize:"1rem",fontWeight:"600",color:"#3273dc"},children:[w.currentreading," cu.m ",(0,Js.jsxs)("span",{style:{color:"#7a7a7a",fontWeight:"400"},children:["(",M(w.billedmonth),")"]})]})]})})]})]}),(0,Js.jsxs)("div",{style:{background:"white",border:"1px solid #e0e0e0",borderRadius:"8px",padding:"1.25rem",marginBottom:"1.5rem"},children:[(0,Js.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"1.25rem"},children:[(0,Js.jsx)("span",{className:"icon has-text-link",style:{fontSize:"1.5rem",marginRight:"0.5rem"},children:(0,Js.jsx)("i",{className:"fas fa-file-invoice"})}),(0,Js.jsx)("h3",{style:{fontSize:"1.1rem",fontWeight:"600",margin:0},children:"Bill Details"})]}),(0,Js.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,Js.jsxs)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#363636",marginBottom:"0.5rem"},children:[(0,Js.jsx)("i",{className:"fas fa-calendar-alt",style:{marginRight:"0.5rem",color:"#667eea"}}),"Billing Month *"]}),(0,Js.jsx)("input",{className:"input",type:"month",value:P.billedmonth,onChange:e=>F("billedmonth",e.target.value),style:{fontSize:"1rem",borderRadius:"6px",borderColor:"#e0e0e0"}}),(0,Js.jsx)("p",{className:"help",style:{fontSize:"0.75rem",color:"#7a7a7a",marginTop:"0.25rem"},children:"Select month and year for billing"})]}),(0,Js.jsxs)("div",{style:{background:"#f9fafb",padding:"1rem",borderRadius:"6px",border:"1px solid #e5e7eb"},children:[(0,Js.jsxs)("p",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#4b5563",marginBottom:"0.75rem"},children:[(0,Js.jsx)("i",{className:"fas fa-tachometer-alt",style:{marginRight:"0.5rem"}}),"Meter Readings & Amount"]}),(0,Js.jsxs)("div",{className:"columns",style:{marginBottom:"0"},children:[(0,Js.jsxs)("div",{className:"column is-3",children:[(0,Js.jsx)("label",{style:{display:"block",fontSize:"0.75rem",fontWeight:"600",color:"#6b7280",marginBottom:"0.5rem"},children:"Previous Reading *"}),(0,Js.jsx)("input",{className:"input",type:"number",step:"0.01",value:P.previousreading,onChange:e=>F("previousreading",e.target.value),style:{borderRadius:"6px",fontSize:"1rem",fontWeight:"500"}}),w&&(0,Js.jsxs)("p",{className:"help is-info",style:{fontSize:"0.7rem",marginTop:"0.25rem"},children:[(0,Js.jsx)("i",{className:"fas fa-info-circle"})," Last: ",w.currentreading," cu.m"]})]}),(0,Js.jsxs)("div",{className:"column is-3",children:[(0,Js.jsx)("label",{style:{display:"block",fontSize:"0.75rem",fontWeight:"600",color:"#6b7280",marginBottom:"0.5rem"},children:"Current Reading *"}),(0,Js.jsx)("input",{className:"input",type:"number",step:"0.01",value:P.currentreading,onChange:e=>F("currentreading",e.target.value),style:{borderRadius:"6px",fontSize:"1rem",fontWeight:"500"}})]}),(0,Js.jsxs)("div",{className:"column is-3",children:[(0,Js.jsx)("label",{style:{display:"block",fontSize:"0.75rem",fontWeight:"600",color:"#6b7280",marginBottom:"0.5rem"},children:"Consumption"}),(0,Js.jsx)("input",{className:"input",type:"number",step:"0.01",value:P.consumption,readOnly:!0,style:{borderRadius:"6px",fontSize:"1rem",fontWeight:"700",background:"#fff",color:"#667eea",borderColor:"#667eea"}}),(0,Js.jsx)("p",{className:"help",style:{fontSize:"0.7rem",color:"#9ca3af",marginTop:"0.25rem"},children:"Auto-calculated"})]}),(0,Js.jsxs)("div",{className:"column is-3",children:[(0,Js.jsxs)("label",{style:{display:"block",fontSize:"0.75rem",fontWeight:"600",color:"#6b7280",marginBottom:"0.5rem"},children:[(0,Js.jsx)("i",{className:"fas fa-coins",style:{marginRight:"0.25rem"}}),"Basic Amount"]}),(0,Js.jsx)("input",{className:"input",type:"number",step:"0.01",value:P.basicamount,readOnly:!0,style:{borderRadius:"6px",fontSize:"1rem",fontWeight:"700",background:"#fff",color:"#667eea",borderColor:"#667eea"}}),(0,Js.jsx)("p",{className:"help",style:{fontSize:"0.7rem",color:"#9ca3af",marginTop:"0.25rem"},children:"Auto-calculated"})]})]})]})]}),S.length>0&&(0,Js.jsxs)("div",{style:{background:"white",border:"1px solid #e0e0e0",borderRadius:"8px",padding:"1.25rem"},children:[(0,Js.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"1rem"},children:[(0,Js.jsx)("span",{className:"icon has-text-info",style:{fontSize:"1.5rem",marginRight:"0.5rem"},children:(0,Js.jsx)("i",{className:"fas fa-history"})}),(0,Js.jsx)("h3",{style:{fontSize:"1.1rem",fontWeight:"600",margin:0},children:"Recent Billing History"})]}),(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-narrow is-striped is-hoverable",style:{fontSize:"0.9rem"},children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"Month"}),(0,Js.jsx)("th",{children:"Reading"}),(0,Js.jsx)("th",{children:"Consumption"}),(0,Js.jsx)("th",{children:"Basic Amount"}),(0,Js.jsx)("th",{children:"Status"}),(0,Js.jsx)("th",{width:"120",children:"Actions"})]})}),(0,Js.jsx)("tbody",{children:S.slice(0,5).map(e=>(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{children:M(e.billedmonth)}),(0,Js.jsxs)("td",{children:[e.previousreading," \u2192 ",e.currentreading]}),(0,Js.jsxs)("td",{children:[e.consumption," cu.m"]}),(0,Js.jsx)("td",{children:z(e.basicamount)}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag is-small ".concat("Paid"===e.paymentstatus?"is-success":"Partial"===e.paymentstatus?"is-warning":"is-danger"),children:e.paymentstatus})}),(0,Js.jsx)("td",{children:(0,Js.jsxs)("div",{style:{display:"flex",gap:"0.25rem"},children:[(0,Js.jsx)("button",{className:"button is-small is-info is-light",onClick:()=>{const t=ea(ea({},e),{},{customers:x});n(),setTimeout(()=>{window.dispatchEvent(new CustomEvent("editBill",{detail:t}))},100)},title:"Edit this bill",style:{borderRadius:"4px"},children:(0,Js.jsx)("span",{className:"icon is-small",children:(0,Js.jsx)("i",{className:"fas fa-edit"})})}),(0,Js.jsx)("button",{className:"button is-small is-danger is-light",onClick:()=>{T(e),_(!0)},title:"Delete this bill",style:{borderRadius:"4px"},children:(0,Js.jsx)("span",{className:"icon is-small",children:(0,Js.jsx)("i",{className:"fas fa-trash"})})})]})})]},e.billid))})]})})]})]})]}),(0,Js.jsxs)("footer",{className:"modal-card-foot",style:{background:"#f9fafb",borderTop:"1px solid #e5e7eb",padding:"1.25rem 1.5rem",display:"flex",justifyContent:"space-between",gap:"0.75rem"},children:[(0,Js.jsxs)("div",{style:{display:"flex",gap:"0.75rem"},children:[(0,Js.jsxs)("button",{className:"button",onClick:n,style:{borderRadius:"6px",fontWeight:"600",padding:"0.75rem 1.5rem"},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-times"})}),(0,Js.jsx)("span",{children:"Cancel"})]}),x&&(0,Js.jsxs)("button",{className:"button is-info ".concat(f?"is-loading":""),onClick:()=>{x?(p(!0),sessionStorage.setItem("preSelectedCustomerForPayment",JSON.stringify(x)),window.dispatchEvent(new CustomEvent("navigateToPayments",{detail:{customer:x}})),n()):m("Please select a customer first")},disabled:f,style:{borderRadius:"6px",fontWeight:"600",padding:"0.75rem 1.5rem"},title:"Process payment for this customer",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-credit-card"})}),(0,Js.jsx)("span",{children:"Process Payment"})]})]}),(0,Js.jsxs)("button",{className:"button is-primary ".concat(d?"is-loading":""),onClick:async()=>{if(await(async()=>{if(!x)return m("Please select a customer"),!1;if(!P.billedmonth)return m("Please select billing month"),!1;if(parseFloat(P.currentreading)<parseFloat(P.previousreading))return m("Current reading cannot be less than previous reading"),!1;const e=P.billedmonth+"-01";return!(await sa.checkDuplicateBill(P.customerid,e,"edit"===s?null===r||void 0===r?void 0:r.billid:null)).exists||(m("A bill for this customer and month already exists"),!1)})()){u(!0),m("");try{const e=$s.getUserSession(),t={customerid:P.customerid,billedmonth:P.billedmonth+"-01",previousreading:parseFloat(P.previousreading)||0,currentreading:parseFloat(P.currentreading)||0,consumption:parseFloat(P.consumption)||0,basicamount:parseFloat(P.basicamount)||0,surchargeamount:0,discountamount:0,totalbillamount:0,paymentstatus:"Unpaid",encodedby:e?"".concat(e.firstname," ").concat(e.lastname):"Unknown"};let a;if("add"===s){const e=await(async()=>{const e=()=>Math.floor(1e7+9e7*Math.random());let t=e(),n=0;for(;n<10;){const{data:s,error:a}=await sa.checkBillIdExists(t);if(a)throw new Error("Error checking bill ID: "+a);if(!s.exists)return t;t=e(),n++}throw new Error("Could not generate unique bill ID after 10 attempts")})();t.billid=e,a=await sa.addBill(t)}else a=await sa.updateBill(r.billid,t);a.success?(l("Bill ".concat("add"===s?"added":"updated"," successfully!")),n()):m(a.error)}catch(h){m(h.message)}u(!1)}},disabled:!x,style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"6px",fontWeight:"600",padding:"0.75rem 2rem",boxShadow:"0 4px 6px rgba(102, 126, 234, 0.25)"},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-save"})}),(0,Js.jsx)("span",{children:"add"===s?"Add Bill":"Update Bill"})]})]})]}),C&&E&&(0,Js.jsx)("div",{className:"dialog-overlay",children:(0,Js.jsxs)("div",{style:{background:"white",borderRadius:"12px",padding:"2rem",maxWidth:"450px",width:"90%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",animation:"fadeIn 0.2s ease-out"},children:[(0,Js.jsxs)("div",{style:{textAlign:"center",marginBottom:"1.5rem"},children:[(0,Js.jsx)("div",{style:{width:"64px",height:"64px",borderRadius:"50%",background:"linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem",boxShadow:"0 8px 16px rgba(255, 107, 107, 0.3)"},children:(0,Js.jsx)("i",{className:"fas fa-exclamation-triangle",style:{fontSize:"2rem",color:"white"}})}),(0,Js.jsx)("h3",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#363636",marginBottom:"0.5rem"},children:"Delete Bill?"}),(0,Js.jsx)("p",{style:{fontSize:"0.95rem",color:"#7a7a7a"},children:"This action cannot be undone"})]}),(0,Js.jsxs)("div",{style:{background:"#f9fafb",padding:"1rem",borderRadius:"8px",marginBottom:"1.5rem",border:"1px solid #e5e7eb"},children:[(0,Js.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,Js.jsx)("span",{style:{color:"#7a7a7a",fontSize:"0.875rem"},children:"Billing Month:"}),(0,Js.jsx)("span",{style:{fontWeight:"600",color:"#363636"},children:M(E.billedmonth)})]}),(0,Js.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,Js.jsx)("span",{style:{color:"#7a7a7a",fontSize:"0.875rem"},children:"Consumption:"}),(0,Js.jsxs)("span",{style:{fontWeight:"600",color:"#363636"},children:[E.consumption," cu.m"]})]}),(0,Js.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,Js.jsx)("span",{style:{color:"#7a7a7a",fontSize:"0.875rem"},children:"Amount:"}),(0,Js.jsx)("span",{style:{fontWeight:"600",color:"#667eea"},children:z(E.basicamount)})]})]}),(0,Js.jsxs)("div",{style:{display:"flex",gap:"0.75rem"},children:[(0,Js.jsxs)("button",{className:"button is-light",onClick:()=>{_(!1),T(null)},style:{flex:1,borderRadius:"8px",fontWeight:"600",padding:"0.75rem 1.5rem",border:"2px solid #e5e7eb"},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-times"})}),(0,Js.jsx)("span",{children:"Cancel"})]}),(0,Js.jsxs)("button",{className:"button is-danger",onClick:()=>{n(),_(!1),setTimeout(()=>{const e=ea(ea({},E),{},{customers:x});window.dispatchEvent(new CustomEvent("deleteBill",{detail:e}))},100),T(null)},style:{flex:1,background:"linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%)",border:"none",borderRadius:"8px",fontWeight:"600",padding:"0.75rem 1.5rem",boxShadow:"0 4px 12px rgba(255, 107, 107, 0.3)"},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-trash"})}),(0,Js.jsx)("span",{children:"Delete"})]})]})]})})]}):null},oa=e=>{let{onCustomerClick:t}=e;const[n,s]=(0,a.useState)(""),[r,i]=(0,a.useState)([]),[l,o]=(0,a.useState)([]),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(""),[m,f]=(0,a.useState)(""),[p,g]=(0,a.useState)(""),[v,y]=(0,a.useState)(""),[b,x]=(0,a.useState)([]),[j,w]=(0,a.useState)([]);(0,a.useEffect)(()=>{s(N())},[]);const N=()=>{const e=new Date;return"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"))},S=function(){let e=[...arguments.length>0&&void 0!==arguments[0]?arguments[0]:r];m&&(e=e.filter(e=>{var t;return(null===(t=e.barangay)||void 0===t?void 0:t.toLowerCase())===m.toLowerCase()})),(p||v)&&(e=e.map(e=>{const t=(e.allCustomers||[]).filter(e=>{var t,n;const s=!p||(null===(t=e.type)||void 0===t?void 0:t.toLowerCase())===p.toLowerCase(),a=!v||(null===(n=e.status)||void 0===n?void 0:n.toLowerCase())===v.toLowerCase();return s&&a}),n=t.filter(e=>e.isEncoded).length,s=t.filter(e=>!e.isEncoded);return ea(ea({},e),{},{totalCustomers:t.length,encodedCount:n,notEncodedCustomers:s})})),o(e)};(0,a.useEffect)(()=>{r.length>0&&S()},[m,p,v,r]);return(0,Js.jsxs)("div",{className:"encoding-stats",children:[u&&(0,Js.jsxs)("div",{className:"notification is-danger is-light py-3",children:[(0,Js.jsx)("button",{className:"delete",onClick:()=>h("")}),u]}),(0,Js.jsx)("div",{className:"box",style:{marginBottom:"1rem",padding:"1.5rem"},children:(0,Js.jsxs)("div",{className:"level",style:{marginBottom:"0"},children:[(0,Js.jsx)("div",{className:"level-left",children:(0,Js.jsx)("div",{className:"level-item",children:(0,Js.jsxs)("div",{className:"field has-addons",style:{marginBottom:"0"},children:[(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"month",value:n,onChange:e=>s(e.target.value)})}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsxs)("button",{className:"button is-primary ".concat(c?"is-loading":""),onClick:async()=>{if(!n)return;d(!0),h("");const e="".concat(n,"-01"),t=await sa.getEncodingStats(e);t.success?(i(t.data),S(t.data)):h(t.error),d(!1)},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-search"})}),(0,Js.jsx)("span",{children:"Load Stats"})]})})]})})}),(0,Js.jsx)("div",{className:"level-right",children:r.length>0&&(0,Js.jsxs)(Js.Fragment,{children:[(0,Js.jsx)("div",{className:"level-item",children:(0,Js.jsxs)("button",{className:"button is-info",onClick:()=>{const e=r.map(e=>[e.barangay,e.totalCustomers,e.encodedCount,e.notEncodedCustomers.length,e.notEncodedCustomers.map(e=>"".concat(e.customerid,": ").concat(e.name)).join("; ")]),t=[["Barangay","Total Customers","Encoded","Not Encoded","Not Encoded List"].join(","),...e.map(e=>e.join(","))].join("\n"),s=new Blob([t],{type:"text/csv"}),a=window.URL.createObjectURL(s),i=document.createElement("a");i.href=a,i.download="encoding_stats_".concat(n,".csv"),i.click(),window.URL.revokeObjectURL(a)},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-file-excel"})}),(0,Js.jsx)("span",{children:"Export"})]})}),(0,Js.jsx)("div",{className:"level-item",children:(0,Js.jsxs)("button",{className:"button is-link",onClick:()=>{const e='\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <title>Encoding Stats Report</title>\n        <style>\n          body { font-family: Arial, sans-serif; padding: 20px; }\n          h1 { text-align: center; color: #333; }\n          h2 { color: #666; margin-top: 30px; border-bottom: 2px solid #ddd; padding-bottom: 5px; }\n          h3 { color: #888; margin-top: 20px; }\n          table { width: 100%; border-collapse: collapse; margin-top: 10px; }\n          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n          th { background-color: #f2f2f2; font-weight: bold; }\n          .summary { background-color: #f9f9f9; padding: 15px; margin: 20px 0; border-radius: 5px; }\n          .stat-box { display: inline-block; padding: 10px 15px; margin: 5px; background: #e8f4f8; border-radius: 5px; }\n          .no-print { margin-top: 30px; text-align: center; }\n          @media print {\n            .no-print { display: none; }\n          }\n        </style>\n      </head>\n      <body>\n        <h1>\ud83d\udcca Billing Encoding Statistics Report</h1>\n        <div class="summary">\n          <p><strong>Report Period:</strong> '.concat(new Date(n+"-01").toLocaleDateString("en-PH",{year:"numeric",month:"long"}),"</p>\n          <p><strong>Generated:</strong> ").concat((new Date).toLocaleString("en-PH"),"</p>\n          <p><strong>Total Barangays:</strong> ").concat(r.length,"</p>\n        </div>\n        \n        ").concat(r.map(e=>"\n          <h2>\ud83c\udfd8\ufe0f ".concat(e.barangay,'</h2>\n          <div style="margin: 10px 0;">\n            <div class="stat-box">\n              <strong>Total Customers:</strong> ').concat(e.totalCustomers,'\n            </div>\n            <div class="stat-box" style="background: #d4edda;">\n              <strong>Encoded Bills:</strong> ').concat(e.encodedCount,'\n            </div>\n            <div class="stat-box" style="background: ').concat(e.notEncodedCustomers.length>0?"#f8d7da":"#d4edda",';">\n              <strong>Not Encoded:</strong> ').concat(e.notEncodedCustomers.length,'\n            </div>\n            <div class="stat-box" style="background: #d1ecf1;">\n              <strong>Completion:</strong> ').concat((e.encodedCount/e.totalCustomers*100).toFixed(1),"%\n            </div>\n          </div>\n          \n          ").concat(e.notEncodedCustomers.length>0?"\n            <h3>\u26a0\ufe0f Customers Without Bills (".concat(e.notEncodedCustomers.length,')</h3>\n            <table>\n              <thead>\n                <tr>\n                  <th style="width: 20%;">Customer ID</th>\n                  <th>Customer Name</th>\n                </tr>\n              </thead>\n              <tbody>\n                ').concat(e.notEncodedCustomers.map(e=>"\n                  <tr>\n                    <td><strong>".concat(e.customerid,"</strong></td>\n                    <td>").concat(e.name,"</td>\n                  </tr>\n                ")).join(""),"\n              </tbody>\n            </table>\n          "):'<p style="color: #28a745; font-weight: bold;">\u2705 All customers in this barangay have been encoded!</p>',"\n        ")).join(""),'\n        \n        <div class="summary" style="margin-top: 40px;">\n          <h3>\ud83d\udcc8 Overall Summary</h3>\n          <p><strong>Total Customers:</strong> ').concat(r.reduce((e,t)=>e+t.totalCustomers,0),"</p>\n          <p><strong>Total Encoded:</strong> ").concat(r.reduce((e,t)=>e+t.encodedCount,0),"</p>\n          <p><strong>Total Not Encoded:</strong> ").concat(r.reduce((e,t)=>e+t.notEncodedCustomers.length,0),"</p>\n          <p><strong>Overall Completion:</strong> ").concat((r.reduce((e,t)=>e+t.encodedCount,0)/r.reduce((e,t)=>e+t.totalCustomers,0)*100).toFixed(1),'%</p>\n        </div>\n        \n        <div class="no-print">\n          <button onclick="window.print()" style="padding: 10px 20px; font-size: 16px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 5px; margin-right: 10px;">\n            \ud83d\udda8\ufe0f Print Report\n          </button>\n          <button onclick="window.close()" style="padding: 10px 20px; font-size: 16px; cursor: pointer; background: #6c757d; color: white; border: none; border-radius: 5px;">\n            \u274c Close\n          </button>\n        </div>\n      </body>\n      </html>\n    '),t=window.open("","_blank");t.document.write(e),t.document.close()},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-print"})}),(0,Js.jsx)("span",{children:"Print"})]})})]})})]})}),r.length>0&&(0,Js.jsxs)("div",{className:"box",style:{marginBottom:"1rem",padding:"1.5rem"},children:[(0,Js.jsxs)("h3",{className:"title is-6 mb-3",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-filter"})}),"Filters"]}),(0,Js.jsxs)("div",{className:"columns",style:{marginBottom:"0"},children:[(0,Js.jsx)("div",{className:"column is-3",children:(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:m,onChange:e=>f(e.target.value),children:[(0,Js.jsx)("option",{value:"",children:"All Barangays"}),r.map(e=>(0,Js.jsx)("option",{value:e.barangay,children:e.barangay},e.barangay))]})})})}),(0,Js.jsx)("div",{className:"column is-3",children:(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:p,onChange:e=>g(e.target.value),children:[(0,Js.jsx)("option",{value:"",children:"All Types"}),(0,Js.jsx)("option",{value:"Residential",children:"Residential"}),(0,Js.jsx)("option",{value:"Commercial",children:"Commercial"}),(0,Js.jsx)("option",{value:"Industrial",children:"Industrial"})]})})})}),(0,Js.jsx)("div",{className:"column is-3",children:(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:v,onChange:e=>y(e.target.value),children:[(0,Js.jsx)("option",{value:"",children:"All Status"}),(0,Js.jsx)("option",{value:"Active",children:"Active"}),(0,Js.jsx)("option",{value:"Disconnected",children:"Disconnected"})]})})})}),(0,Js.jsx)("div",{className:"column is-3",children:(0,Js.jsx)("div",{className:"control",children:(0,Js.jsxs)("button",{className:"button is-light is-fullwidth",onClick:()=>{f(""),g(""),y(""),o(r)},disabled:!m&&!p&&!v,children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-times"})}),(0,Js.jsx)("span",{children:"Clear Filters"})]})})})]})]}),c?(0,Js.jsx)("div",{className:"has-text-centered",style:{padding:"2rem"},children:(0,Js.jsx)("button",{className:"button is-loading is-large is-ghost"})}):0===r.length?(0,Js.jsxs)("div",{className:"has-text-centered",style:{padding:"2rem"},children:[(0,Js.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Js.jsx)("i",{className:"fas fa-chart-bar fa-3x"})}),(0,Js.jsx)("p",{className:"has-text-grey mt-4",children:'Select a month and click "Load Stats" to view encoding statistics'})]}):(0,Js.jsxs)(Js.Fragment,{children:[(0,Js.jsxs)("div",{className:"box has-background-info-light mb-3 p-4",children:[(0,Js.jsx)("h3",{className:"title is-6 mb-3",children:"Overall Summary"}),(0,Js.jsxs)("div",{className:"columns is-mobile",children:[(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"notification is-info is-light p-3",children:[(0,Js.jsx)("p",{className:"heading",children:"Total Customers"}),(0,Js.jsx)("p",{className:"title is-4",children:l.reduce((e,t)=>e+t.totalCustomers,0)})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"notification is-success is-light p-3",children:[(0,Js.jsx)("p",{className:"heading",children:"Encoded Bills"}),(0,Js.jsx)("p",{className:"title is-4",children:l.reduce((e,t)=>e+t.encodedCount,0)})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"notification is-danger is-light p-3",children:[(0,Js.jsx)("p",{className:"heading",children:"Not Encoded"}),(0,Js.jsx)("p",{className:"title is-4",children:l.reduce((e,t)=>e+t.notEncodedCustomers.length,0)})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"notification is-primary is-light p-3",children:[(0,Js.jsx)("p",{className:"heading",children:"Completion Rate"}),(0,Js.jsxs)("p",{className:"title is-4",children:[l.reduce((e,t)=>e+t.totalCustomers,0)>0?(l.reduce((e,t)=>e+t.encodedCount,0)/l.reduce((e,t)=>e+t.totalCustomers,0)*100).toFixed(1):0,"%"]})]})})]})]}),l.map(e=>{const n=(e.allCustomers||[]).filter(e=>e.isEncoded);return(0,Js.jsxs)("div",{className:"box mb-3 p-3",children:[(0,Js.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:(0,Js.jsxs)("h3",{className:"title is-5",style:{marginBottom:"0"},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-map-marker-alt"})}),e.barangay]})}),(0,Js.jsxs)("div",{className:"columns is-mobile",children:[(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"notification is-info is-light p-2",children:[(0,Js.jsx)("p",{className:"heading",children:"Total Customers"}),(0,Js.jsx)("p",{className:"title is-5",children:e.totalCustomers})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsx)("div",{className:"notification is-success is-light p-2",children:(0,Js.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Js.jsxs)("div",{children:[(0,Js.jsx)("p",{className:"heading",children:"Encoded Bills"}),(0,Js.jsx)("p",{className:"title is-5",children:e.encodedCount})]}),e.encodedCount>0&&(0,Js.jsx)("button",{className:"button is-small is-success",onClick:()=>{return t=e.barangay,void x(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},title:"View encoded customers",children:(0,Js.jsx)("span",{className:"icon is-small",children:(0,Js.jsx)("i",{className:"fas fa-chevron-".concat(b.includes(e.barangay)?"up":"down")})})})]})})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsx)("div",{className:"notification is-danger is-light p-2",children:(0,Js.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Js.jsxs)("div",{children:[(0,Js.jsx)("p",{className:"heading",children:"Not Encoded"}),(0,Js.jsx)("p",{className:"title is-5",children:e.notEncodedCustomers.length})]}),e.notEncodedCustomers.length>0&&(0,Js.jsx)("button",{className:"button is-small is-danger",onClick:()=>{return t=e.barangay,void w(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},title:"View not encoded customers",children:(0,Js.jsx)("span",{className:"icon is-small",children:(0,Js.jsx)("i",{className:"fas fa-chevron-".concat(j.includes(e.barangay)?"up":"down")})})})]})})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"notification is-primary is-light p-2",children:[(0,Js.jsx)("p",{className:"heading",children:"Completion"}),(0,Js.jsxs)("p",{className:"title is-5",children:[(e.encodedCount/e.totalCustomers*100).toFixed(1),"%"]})]})})]}),e.encodedCount>0&&b.includes(e.barangay)&&(0,Js.jsxs)(Js.Fragment,{children:[(0,Js.jsxs)("h4",{className:"title is-6 has-text-success mb-2 mt-3",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-check-circle"})}),"Encoded Customers (",e.encodedCount,")"]}),(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-narrow is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{width:"150",children:"Customer ID"}),(0,Js.jsx)("th",{children:"Customer Name"}),(0,Js.jsx)("th",{width:"120",children:"Type"}),(0,Js.jsx)("th",{width:"120",children:"Status"})]})}),(0,Js.jsx)("tbody",{children:n.map(e=>(0,Js.jsxs)("tr",{onClick:()=>t&&t(e),style:{cursor:t?"pointer":"default"},title:t?"Click to add bill for this customer":"",children:[(0,Js.jsx)("td",{className:"has-text-weight-bold",children:e.customerid}),(0,Js.jsx)("td",{children:e.name}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag is-info is-light",children:e.type})}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag ".concat("Active"===e.status?"is-success":"is-warning"," is-light"),children:e.status})})]},e.customerid))})]})})]}),e.notEncodedCustomers.length>0&&j.includes(e.barangay)&&(0,Js.jsxs)(Js.Fragment,{children:[(0,Js.jsxs)("h4",{className:"title is-6 has-text-danger mb-2 mt-3",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-exclamation-triangle"})}),"Customers Without Bills (",e.notEncodedCustomers.length,")"]}),(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-narrow is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{width:"150",children:"Customer ID"}),(0,Js.jsx)("th",{children:"Customer Name"}),(0,Js.jsx)("th",{width:"120",children:"Type"}),(0,Js.jsx)("th",{width:"120",children:"Status"})]})}),(0,Js.jsx)("tbody",{children:e.notEncodedCustomers.map(e=>(0,Js.jsxs)("tr",{onClick:()=>t&&t(e),style:{cursor:t?"pointer":"default"},title:t?"Click to add bill for this customer":"",children:[(0,Js.jsx)("td",{className:"has-text-weight-bold",children:e.customerid}),(0,Js.jsx)("td",{children:e.name}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag is-info is-light",children:e.type})}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag ".concat("Active"===e.status?"is-success":"is-warning"," is-light"),children:e.status})})]},e.customerid))})]})})]}),0===e.notEncodedCustomers.length&&(0,Js.jsxs)("div",{className:"notification is-success is-light p-2 mt-3",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-check-circle"})}),(0,Js.jsx)("strong",{children:"All customers in this barangay have been encoded!"})]})]},e.barangay)})]})]})},ca=e=>{let{isOpen:t,onClose:n,onConfirm:s,title:a,message:r,subMessage:i,confirmText:l="Confirm",cancelText:o="Cancel",type:c="info",loading:d=!1,icon:u=null}=e;if(!t)return null;return(0,Js.jsx)("div",{className:"confirmation-dialog-overlay",children:(0,Js.jsxs)("div",{className:"confirmation-dialog-content ".concat(c),children:[(0,Js.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,Js.jsxs)("h3",{className:"title is-5 mb-3",children:[(0,Js.jsx)("span",{className:"icon ".concat((()=>{switch(c){case"danger":return"has-text-danger";case"warning":return"has-text-warning";case"success":return"has-text-success";default:return"has-text-info"}})()),style:{marginRight:"0.5rem"},children:(()=>{if(u)return u;switch(c){case"danger":return(0,Js.jsx)("i",{className:"fas fa-exclamation-triangle"});case"warning":return(0,Js.jsx)("i",{className:"fas fa-exclamation-circle"});case"success":return(0,Js.jsx)("i",{className:"fas fa-check-circle"});default:return(0,Js.jsx)("i",{className:"fas fa-info-circle"})}})()}),a]}),(0,Js.jsx)("p",{className:"mb-3",style:{fontSize:"1rem",color:"#4a5568"},children:r}),i&&(0,Js.jsx)("p",{className:"has-text-grey is-size-7",children:i})]}),(0,Js.jsxs)("div",{className:"buttons is-right",style:{marginBottom:"0"},children:[(0,Js.jsx)("button",{className:"button",onClick:n,disabled:d,children:o}),(0,Js.jsxs)("button",{className:"button ".concat((()=>{switch(c){case"danger":return"is-danger";case"warning":return"is-warning";case"success":return"is-success";default:return"is-primary"}})()," ").concat(d?"is-loading":""),onClick:s,disabled:d,children:[(0,Js.jsxs)("span",{className:"icon",children:["danger"===c&&(0,Js.jsx)("i",{className:"fas fa-trash"}),"success"===c&&(0,Js.jsx)("i",{className:"fas fa-check"}),"warning"===c&&(0,Js.jsx)("i",{className:"fas fa-exclamation"}),"info"===c&&(0,Js.jsx)("i",{className:"fas fa-info"})]}),(0,Js.jsx)("span",{children:l})]})]})]})})},da=()=>{var e;const[t,n]=(0,a.useState)("management"),[s,r]=(0,a.useState)([]),[i,l]=(0,a.useState)([]),[o,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(!1),[h,m]=(0,a.useState)(""),[f,p]=(0,a.useState)(""),[g,v]=(0,a.useState)(1),[y,b]=(0,a.useState)(0),[x]=(0,a.useState)(50),[j,w]=(0,a.useState)(!1),[N,S]=(0,a.useState)("add"),[k,C]=(0,a.useState)(null),[_,E]=(0,a.useState)(null),[T,P]=(0,a.useState)(""),[O,R]=(0,a.useState)([]),[A,I]=(0,a.useState)(!1),[L,D]=(0,a.useState)(""),[B,U]=(0,a.useState)(""),[F,z]=(0,a.useState)(""),[M,W]=(0,a.useState)([]),[q,H]=(0,a.useState)(!1),[V,K]=(0,a.useState)(null);(0,a.useEffect)(()=>{$(),J(),G(),Q();const e=e=>{const t=e.detail;ee(t)},t=e=>{const t=e.detail,n="object"===typeof t?t:s.find(e=>e.billid===t);n&&te(n)};return window.addEventListener("editBill",e),window.addEventListener("deleteBill",t),()=>{window.removeEventListener("editBill",e),window.removeEventListener("deleteBill",t)}},[]),(0,a.useEffect)(()=>{if(!(""!==T.trim())&&!(L||B||F))return void R([]);const e=setTimeout(()=>{Y()},500);return()=>clearTimeout(e)},[T,L,B,F]);const $=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;u(!0);const t=await sa.getBills(e,x,"dateencoded",!1);t.success?(r(t.data),b(t.count),v(e)):m(t.error),u(!1)},J=async()=>{const e=await sa.getCustomerTypes();e.success&&l(e.data)},G=async()=>{const e=await aa.getSurchargeSettings();e.success&&c(e.data)},Q=async()=>{const e=await aa.getBarangays();e.success&&W(e.data)},Y=async()=>{I(!0),m("");const e=await aa.searchCustomers(T||"",{barangay:L,type:B,status:F});e.success?(R(e.data),0===e.data.length&&m("No customers found matching your criteria")):m(e.error),I(!1)},X=e=>{E(e),Z()},Z=()=>{S("add"),C(null),w(!0)},ee=e=>{S("edit"),C(e),w(!0)},te=e=>{K(e),H(!0)},ne=Math.ceil(y/x);return(0,Js.jsxs)("div",{className:"billing-page",style:{padding:"0"},children:[(0,Js.jsxs)("div",{className:"level mb-3",children:[(0,Js.jsx)("div",{className:"level-left",children:(0,Js.jsx)("div",{className:"level-item",children:(0,Js.jsxs)("h1",{className:"title is-4 mb-0",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-file-invoice-dollar"})}),"Billing Management"]})})}),(0,Js.jsx)("div",{className:"level-right",children:(0,Js.jsx)("div",{className:"level-item",children:s.length>0&&"management"===t&&(0,Js.jsxs)("button",{className:"button is-info",onClick:()=>{const e=sa.exportToCSV(s),t=new Blob([e],{type:"text/csv"}),n=window.URL.createObjectURL(t),a=document.createElement("a");a.href=n,a.download="bills_".concat((new Date).toISOString().split("T")[0],".csv"),a.click(),window.URL.revokeObjectURL(n)},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-file-csv"})}),(0,Js.jsx)("span",{children:"Export CSV"})]})})})]}),h&&(0,Js.jsxs)("div",{className:"notification is-danger is-light py-3",children:[(0,Js.jsx)("button",{className:"delete",onClick:()=>m("")}),h]}),f&&(0,Js.jsxs)("div",{className:"notification is-success is-light py-3",children:[(0,Js.jsx)("button",{className:"delete",onClick:()=>p("")}),f]}),(0,Js.jsx)("div",{className:"tabs is-boxed",children:(0,Js.jsxs)("ul",{children:[(0,Js.jsx)("li",{className:"management"===t?"is-active":"",onClick:()=>n("management"),children:(0,Js.jsxs)("a",{children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-file-invoice"})}),(0,Js.jsx)("span",{children:"Bill Management"})]})}),(0,Js.jsx)("li",{className:"stats"===t?"is-active":"",onClick:()=>n("stats"),children:(0,Js.jsxs)("a",{children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-chart-bar"})}),(0,Js.jsx)("span",{children:"Encoding Stats"})]})})]})}),"management"===t&&(0,Js.jsx)("div",{style:{width:"100%"},children:(0,Js.jsxs)("div",{className:"box",style:{marginBottom:"0",padding:"1.5rem",borderRadius:"0"},children:[(0,Js.jsxs)("h3",{className:"title is-6 mb-3",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-user-plus"})}),"Add New Bill - Search Customer"]}),(0,Js.jsxs)("div",{className:"columns",style:{marginBottom:"0"},children:[(0,Js.jsx)("div",{className:"column is-4",children:(0,Js.jsxs)("div",{className:"field has-addons",style:{marginBottom:"0"},children:[(0,Js.jsx)("div",{className:"control is-expanded",children:(0,Js.jsx)("input",{className:"input",type:"text",placeholder:"Search by customer name or ID...",value:T,onChange:e=>P(e.target.value),onKeyPress:e=>"Enter"===e.key&&Y()})}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsxs)("button",{className:"button is-primary ".concat(A?"is-loading":""),onClick:Y,children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-search"})}),(0,Js.jsx)("span",{children:"Search"})]})})]})}),(0,Js.jsx)("div",{className:"column is-2",children:(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:L,onChange:e=>D(e.target.value),children:[(0,Js.jsx)("option",{value:"",children:"All Barangays"}),M.map(e=>(0,Js.jsx)("option",{value:e.barangay,children:e.barangay},e.barangay))]})})})}),(0,Js.jsx)("div",{className:"column is-2",children:(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:B,onChange:e=>U(e.target.value),children:[(0,Js.jsx)("option",{value:"",children:"All Types"}),i.map(e=>(0,Js.jsx)("option",{value:e.type,children:e.type},e.type))]})})})}),(0,Js.jsx)("div",{className:"column is-2",children:(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:F,onChange:e=>z(e.target.value),children:[(0,Js.jsx)("option",{value:"",children:"All Status"}),(0,Js.jsx)("option",{value:"Active",children:"Active"}),(0,Js.jsx)("option",{value:"Disconnected",children:"Disconnected"})]})})})}),(0,Js.jsx)("div",{className:"column is-2",children:(0,Js.jsx)("div",{className:"control",children:(0,Js.jsxs)("button",{className:"button is-light is-fullwidth",onClick:()=>{P(""),D(""),U(""),z(""),R([])},disabled:!T&&!L&&!B&&!F,title:"Clear all filters",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-times"})}),(0,Js.jsx)("span",{children:"Clear"})]})})})]}),O.length>0&&(0,Js.jsx)("div",{className:"table-container mt-3",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable is-narrow",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"Customer ID"}),(0,Js.jsx)("th",{children:"Name"}),(0,Js.jsx)("th",{children:"Type"}),(0,Js.jsx)("th",{children:"Barangay"}),(0,Js.jsx)("th",{children:"Status"}),(0,Js.jsx)("th",{width:"100",children:"Action"})]})}),(0,Js.jsx)("tbody",{children:O.map(e=>(0,Js.jsxs)("tr",{onClick:()=>X(e),style:{cursor:"pointer"},title:"Click to add bill for this customer",children:[(0,Js.jsx)("td",{className:"has-text-weight-bold",children:e.customerid}),(0,Js.jsx)("td",{children:(0,Js.jsx)("strong",{children:e.name})}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag is-info is-light",children:e.type})}),(0,Js.jsx)("td",{children:e.barangay}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag is-small ".concat("Active"===e.status?"is-success":"is-danger"),children:e.status})}),(0,Js.jsx)("td",{children:(0,Js.jsxs)("button",{className:"button is-small is-primary",onClick:t=>{t.stopPropagation(),X(e)},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-plus"})}),(0,Js.jsx)("span",{children:"Add Bill"})]})})]},e.customerid))})]})}),(0,Js.jsxs)("div",{className:"mt-4",children:[(0,Js.jsx)("hr",{}),(0,Js.jsxs)("h3",{className:"title is-6 mb-3 mt-3",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-clock"})}),"Recent Bills Added"]}),d?(0,Js.jsxs)("div",{className:"has-text-centered py-5",children:[(0,Js.jsx)("span",{className:"icon is-large",children:(0,Js.jsx)("i",{className:"fas fa-spinner fa-pulse fa-2x"})}),(0,Js.jsx)("p",{className:"mt-3",children:"Loading bills..."})]}):0===s.length?(0,Js.jsxs)("div",{className:"notification is-light has-text-centered",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-info-circle"})}),(0,Js.jsx)("span",{children:"No bills found"})]}):(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable is-narrow",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"Bill ID"}),(0,Js.jsx)("th",{children:"Customer ID"}),(0,Js.jsx)("th",{children:"Customer Name"}),(0,Js.jsx)("th",{children:"Barangay"}),(0,Js.jsx)("th",{children:"Billing Month"}),(0,Js.jsx)("th",{children:"Consumption"}),(0,Js.jsx)("th",{children:"Basic Amount"}),(0,Js.jsx)("th",{children:"Status"}),(0,Js.jsx)("th",{children:"Encoded By"}),(0,Js.jsx)("th",{width:"120",children:"Actions"})]})}),(0,Js.jsx)("tbody",{children:s.slice(0,10).map(e=>{var t,n,s,a;return(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{className:"has-text-weight-bold",children:e.billid}),(0,Js.jsx)("td",{children:e.customerid}),(0,Js.jsx)("td",{children:(0,Js.jsx)("strong",{children:(null===(t=e.customers)||void 0===t?void 0:t.name)||"N/A"})}),(0,Js.jsx)("td",{children:(null===(n=e.customers)||void 0===n?void 0:n.barangay)||"N/A"}),(0,Js.jsx)("td",{children:(a=e.billedmonth,a?new Date(a).toLocaleDateString("en-PH",{year:"numeric",month:"long"}):"N/A")}),(0,Js.jsxs)("td",{children:[e.consumption," cu.m"]}),(0,Js.jsx)("td",{children:(s=e.basicamount,"\u20b1".concat(parseFloat(s||0).toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})))}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag is-small ".concat("Paid"===e.paymentstatus?"is-success":"Partial"===e.paymentstatus?"is-warning":"is-danger"),children:e.paymentstatus})}),(0,Js.jsx)("td",{children:e.encodedby||"N/A"}),(0,Js.jsx)("td",{children:(0,Js.jsxs)("div",{className:"buttons are-small",children:[(0,Js.jsx)("button",{className:"button is-info is-small",onClick:()=>ee(e),title:"Edit bill",children:(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-edit"})})}),(0,Js.jsx)("button",{className:"button is-danger is-small",onClick:()=>te(e),title:"Delete bill",children:(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-trash"})})})]})})]},e.billid)})})]})}),s.length>0&&ne>1&&(0,Js.jsxs)("nav",{className:"pagination is-small mt-3",role:"navigation",children:[(0,Js.jsx)("button",{className:"button is-small",onClick:()=>$(g-1),disabled:1===g,children:"Previous"}),(0,Js.jsx)("button",{className:"button is-small",onClick:()=>$(g+1),disabled:g===ne,children:"Next"}),(0,Js.jsx)("ul",{className:"pagination-list",children:(0,Js.jsx)("li",{children:(0,Js.jsxs)("span",{className:"pagination-ellipsis",children:["Page ",g," of ",ne]})})})]})]})]})}),"stats"===t&&(0,Js.jsx)("div",{style:{width:"100%"},children:(0,Js.jsx)(oa,{onCustomerClick:X})}),(0,Js.jsx)(la,{isOpen:j,onClose:()=>{w(!1),E(null)},mode:N,bill:k,preSelectedCustomer:_,onSuccess:e=>{p(e),$(g),E(null);(L||B||F||""!==T.trim())&&Y()},customerTypes:i,surchargeSettings:o}),(0,Js.jsx)(ca,{isOpen:q&&null!==V,onClose:()=>{H(!1),K(null)},onConfirm:async()=>{if(!V)return;u(!0);const e=await sa.deleteBill(V.billid);e.success?(p("Bill deleted successfully"),$(g),setTimeout(()=>p(""),3e3)):m(e.error),u(!1),H(!1),K(null)},title:"Confirm Delete",message:V?"Are you sure you want to delete bill #".concat(V.billid,"?"):"",subMessage:V?"Customer: ".concat((null===(e=V.customers)||void 0===e?void 0:e.name)||"N/A"," | Month: ").concat(new Date(V.billedmonth).toLocaleDateString("en-PH",{year:"numeric",month:"long"})):"",confirmText:"Delete Bill",cancelText:"Cancel",type:"danger",loading:d})]})},ua=e=>{let{isOpen:t,onClose:n,onConfirm:s,billCount:r,grandTotal:i,creditBalance:l=0,loading:o=!1,totalSurcharge:c=0}=e;const[d,u]=(0,a.useState)(""),[h,m]=(0,a.useState)(""),[f,p]=(0,a.useState)(!1),g=f?i-c:i,v=Math.min(l,g),y=g-v,b=l-v;(0,a.useEffect)(()=>{t&&(u(y.toFixed(2)),m(""))},[t,y]);if(!t)return null;const x=parseFloat(d||0)-y,j=x>0;return(0,Js.jsx)("div",{className:"confirmation-dialog-overlay",children:(0,Js.jsxs)("div",{className:"confirmation-dialog-content success",style:{maxWidth:"550px"},children:[(0,Js.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,Js.jsxs)("h3",{className:"title is-5 mb-3",children:[(0,Js.jsx)("span",{className:"icon has-text-success",style:{marginRight:"0.5rem"},children:(0,Js.jsx)("i",{className:"fas fa-cash-register"})}),"Confirm Payment Processing"]}),(0,Js.jsxs)("div",{className:"box",style:{background:"#f0f9ff",border:"2px solid #3b82f6",marginBottom:"1rem"},children:[(0,Js.jsxs)("div",{style:{marginBottom:"0.75rem"},children:[(0,Js.jsx)("span",{className:"has-text-grey",children:"Number of Bills:"}),(0,Js.jsx)("strong",{style:{float:"right",fontSize:"1.1rem"},children:r})]}),(0,Js.jsxs)("div",{style:{borderTop:"1px solid #ddd",paddingTop:"0.75rem",marginBottom:"0.75rem"},children:[(0,Js.jsx)("span",{className:"has-text-grey",children:"Grand Total:"}),(0,Js.jsxs)("strong",{style:{float:"right",fontSize:"1.2rem",color:"#059669"},children:["\u20b1",i.toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),c>0&&f&&(0,Js.jsxs)("div",{style:{borderTop:"1px solid #ddd",paddingTop:"0.75rem",marginBottom:"0.75rem"},children:[(0,Js.jsx)("span",{className:"has-text-grey",children:"Surcharge Waived:"}),(0,Js.jsxs)("strong",{style:{float:"right",fontSize:"1.2rem",color:"#dc2626"},children:["-\u20b1",c.toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),v>0&&(0,Js.jsxs)("div",{style:{borderTop:"1px solid #ddd",paddingTop:"0.75rem",marginBottom:"0.75rem"},children:[(0,Js.jsx)("span",{className:"has-text-grey",children:"Credit Applied:"}),(0,Js.jsxs)("strong",{style:{float:"right",fontSize:"1.2rem",color:"#d97706"},children:["-\u20b1",v.toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,Js.jsxs)("div",{style:{borderTop:"2px solid #3b82f6",paddingTop:"0.75rem",background:"#dbeafe",margin:"-1rem",marginTop:"0.75rem",padding:"1rem"},children:[(0,Js.jsx)("span",{className:"has-text-grey has-text-weight-bold",children:"Amount to Pay:"}),(0,Js.jsxs)("strong",{style:{float:"right",fontSize:"1.5rem",color:"#059669"},children:["\u20b1",y.toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),c>0&&(0,Js.jsx)("div",{className:"field",style:{marginBottom:"1rem"},children:(0,Js.jsxs)("label",{className:"checkbox",children:[(0,Js.jsx)("input",{type:"checkbox",checked:f,onChange:e=>p(e.target.checked),disabled:o})," ","Waive Surcharge (\u20b1",c.toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2}),") - Remove late payment penalty"]})}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsxs)("label",{className:"label",children:["Amount Received ",(0,Js.jsx)("span",{className:"has-text-danger",children:"*"})]}),(0,Js.jsxs)("div",{className:"control has-icons-left",children:[(0,Js.jsx)("input",{className:"input ".concat(h?"is-danger":""),type:"number",step:"0.01",placeholder:"Enter amount received",value:d,onChange:e=>{u(e.target.value),m("")},autoFocus:!0,disabled:o}),(0,Js.jsx)("span",{className:"icon is-small is-left",children:(0,Js.jsx)("i",{className:"fas fa-peso-sign"})})]}),h&&(0,Js.jsx)("p",{className:"help is-danger",children:h}),!h&&j&&(0,Js.jsxs)("p",{className:"help is-success",children:[(0,Js.jsx)("i",{className:"fas fa-info-circle"})," New credit from overpayment: \u20b1",x.toFixed(2)]})]}),v>0&&(0,Js.jsx)("div",{className:"notification is-warning is-light",style:{padding:"0.75rem 1rem",marginBottom:"1rem"},children:(0,Js.jsxs)("p",{className:"is-size-7",children:[(0,Js.jsxs)("strong",{children:[(0,Js.jsx)("i",{className:"fas fa-piggy-bank"})," Credit Auto-Applied:"]}),(0,Js.jsx)("br",{}),"\u20b1",v.toFixed(2)," from available credit balance has been automatically applied to this payment.",b>0&&" Remaining credit: \u20b1".concat(b.toFixed(2))]})}),j&&!h&&(0,Js.jsx)("div",{className:"notification is-success is-light",style:{padding:"0.75rem 1rem"},children:(0,Js.jsxs)("p",{className:"is-size-7",children:[(0,Js.jsxs)("strong",{children:[(0,Js.jsx)("i",{className:"fas fa-coins"})," Overpayment Detected:"]}),(0,Js.jsx)("br",{}),"The excess amount of ",(0,Js.jsxs)("strong",{children:["\u20b1",x.toFixed(2)]})," will be saved as credit and automatically applied to future bills."]})})]}),(0,Js.jsxs)("div",{className:"buttons is-right",style:{marginBottom:"0"},children:[(0,Js.jsx)("button",{className:"button",onClick:n,disabled:o,children:"Cancel"}),(0,Js.jsxs)("button",{className:"button is-success ".concat(o?"is-loading":""),onClick:()=>{const e=parseFloat(d);if(isNaN(e)||e<0)return void m("Please enter a valid amount");if(e<y)return void m("Amount received (\u20b1".concat(e.toFixed(2),") is less than required (\u20b1").concat(y.toFixed(2),")"));s(e,v,e-y,f)},disabled:o,children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-check-circle"})}),(0,Js.jsx)("span",{children:"Confirm Payment"})]})]})]})})},ha=()=>{const[e,t]=(0,a.useState)("search"),[n,s]=(0,a.useState)(""),[r,i]=(0,a.useState)([]),[l,o]=(0,a.useState)([]),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(""),[m,f]=(0,a.useState)(""),[p,g]=(0,a.useState)("all"),[v,y]=(0,a.useState)("all"),[b,x]=(0,a.useState)("all"),[j,w]=(0,a.useState)([]),[N,S]=(0,a.useState)([]),[k,C]=(0,a.useState)(null),[_,E]=(0,a.useState)({todayCollection:0,todayCount:0,monthCollection:0,monthCount:0}),[T,P]=(0,a.useState)([]),[O,R]=(0,a.useState)(!1),[A,I]=(0,a.useState)(!1),[L,D]=(0,a.useState)(null),[B,U]=(0,a.useState)(""),[F,z]=(0,a.useState)(!1),[M,W]=(0,a.useState)(null),q=$s.getUserSession();(0,a.useEffect)(()=>{H(),V(),K(),$();const e=sessionStorage.getItem("preSelectedCustomerForPayment");if(e)try{const t=JSON.parse(e);Y(t),sessionStorage.removeItem("preSelectedCustomerForPayment")}catch(u){console.error("Error parsing preselected customer:",u)}},[]),(0,a.useEffect)(()=>{if(!n.trim())return void i([]);const e=setTimeout(()=>{Q()},500);return()=>clearTimeout(e)},[n,p,v,b]);const H=async()=>{const e=await aa.getPaymentStats();e.success&&E(e.data)},V=async()=>{try{const{data:e}=await aa.searchCustomers("");if(e){const t=[...new Set(e.map(e=>e.barangay).filter(Boolean))];w(t.map(e=>({barangay:e})));const n=[...new Set(e.map(e=>e.type).filter(Boolean))];S(n.map(e=>({type:e})))}}catch(u){console.error("Error loading filter options:",u)}},K=async()=>{const e=await aa.getSurchargeSettings();e.success&&C(e.data)},$=async()=>{R(!0);const e=await aa.getRecentPayments(10);e.success&&P(e.data),R(!1)},J=()=>l.find(t=>t.customer.customerid===e),G=(e,t)=>k?e.map(e=>{const n=aa.calculateSurcharge(e,k),s=parseFloat(e.basicamount||0);let a=0;if(e.discountamount&&parseFloat(e.discountamount)>0)a=parseFloat(e.discountamount);else if(t&&t.discount){a=s*parseFloat(t.discount)/100}const r=s+(n?n.surchargeAmount:parseFloat(e.surchargeamount||0))-a;return ea(ea({},e),{},{surchargeInfo:n,calculatedDiscountAmount:a,calculatedTotal:r})}):e,Q=async()=>{if(!n.trim())return void h("Please enter a customer name or ID");d(!0),h("");const e=await aa.searchCustomers(n);if(e.success){let t=e.data;"all"!==p&&(t=t.filter(e=>{var t;return(null===(t=e.barangay)||void 0===t?void 0:t.toLowerCase())===p.toLowerCase()})),"all"!==v&&(t=t.filter(e=>{var t;return(null===(t=e.type)||void 0===t?void 0:t.toLowerCase())===v.toLowerCase()})),"all"!==b&&(t=t.filter(e=>{var t;return(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())===b.toLowerCase()})),i(t),0===t.length&&h('No customers found matching "'.concat(n,'" with current filters.'))}else h("Search error: ".concat(e.error));d(!1)},Y=async e=>{if(l.find(t=>t.customer.customerid===e.customerid))return void t(e.customerid);d(!0),h("");const n=await aa.getCustomerDetails(e.customerid),s=n.success?n.data:e,a=await aa.getUnpaidBills(e.customerid),r=a.success?a.data:[],i=await aa.getPaymentHistory(e.customerid),c={customer:s,unpaidBills:r,paymentHistory:i.success?i.data:[],billsWithSurcharge:G(r,s),selectedBills:[],creditBalance:parseFloat(s.credit_balance||0)};o([...l,c]),t(e.customerid),d(!1)},X=t=>{o(n=>n.map(n=>n.customer.customerid===e?ea(ea({},n),{},{selectedBills:t}):n))},Z=async e=>{const t=await aa.getCustomerDetails(e),n=await aa.getUnpaidBills(e),s=await aa.getPaymentHistory(e),a=n.success?n.data:[],r=t.success?t.data:null,i=G(a,r);o(t=>t.map(t=>t.customer.customerid===e?ea(ea({},t),{},{customer:r||t.customer,unpaidBills:a,paymentHistory:s.success?s.data:[],billsWithSurcharge:i,creditBalance:r?parseFloat(r.credit_balance||0):0,selectedBills:[]}):t))},ee=e=>"\u20b1".concat(parseFloat(e||0).toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})),te=e=>e?new Date(e).toLocaleDateString("en-PH",{year:"numeric",month:"long"}):"N/A";return(0,Js.jsxs)("div",{className:"customers-page",children:[(0,Js.jsx)("div",{className:"compact-header",children:(0,Js.jsxs)("div",{className:"header-row",children:[(0,Js.jsxs)("div",{className:"title-section",children:[(0,Js.jsx)("h1",{className:"page-title",children:"Payment Processing"}),(0,Js.jsxs)("div",{className:"stats-inline",children:[(0,Js.jsxs)("span",{className:"stat-item",children:[(0,Js.jsx)("i",{className:"fas fa-cash-register"}),(0,Js.jsx)("strong",{children:ee(_.todayCollection)})," Today"]}),(0,Js.jsxs)("span",{className:"stat-item active",children:[(0,Js.jsx)("i",{className:"fas fa-calendar-alt"}),(0,Js.jsx)("strong",{children:ee(_.monthCollection)})," This Month"]}),(0,Js.jsxs)("span",{className:"stat-item",children:[(0,Js.jsx)("i",{className:"fas fa-receipt"}),(0,Js.jsx)("strong",{children:_.todayCount+_.monthCount})," Transactions"]})]})]}),(0,Js.jsx)("div",{className:"header-actions",children:l.length>0&&(0,Js.jsxs)("button",{className:"button is-info",onClick:()=>t("search"),children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-search"})}),(0,Js.jsx)("span",{children:"Search Customers"})]})})]})}),u&&(0,Js.jsxs)("div",{className:"notification is-warning",children:[(0,Js.jsx)("button",{className:"delete",onClick:()=>h("")}),u]}),m&&(0,Js.jsxs)("div",{className:"notification is-success",children:[(0,Js.jsx)("button",{className:"delete",onClick:()=>f("")}),m]}),(0,Js.jsx)("div",{className:"tabs is-boxed",children:(0,Js.jsxs)("ul",{children:[(0,Js.jsx)("li",{className:"search"===e?"is-active":"",onClick:()=>t("search"),children:(0,Js.jsxs)("a",{children:[(0,Js.jsx)("span",{className:"icon is-small",children:(0,Js.jsx)("i",{className:"fas fa-search"})}),(0,Js.jsx)("span",{children:"Customer Search"})]})}),l.map(n=>(0,Js.jsxs)("li",{className:e===n.customer.customerid?"is-active":"",style:{position:"relative"},children:[(0,Js.jsxs)("a",{onClick:()=>t(n.customer.customerid),style:{paddingRight:"2rem"},children:[(0,Js.jsx)("span",{className:"icon is-small",children:(0,Js.jsx)("i",{className:"fas fa-money-check-alt"})}),(0,Js.jsx)("span",{children:n.customer.name})]}),(0,Js.jsx)("button",{className:"delete is-small",onClick:s=>{s.stopPropagation(),(n=>{const s=l.filter(e=>e.customer.customerid!==n);o(s),e===n&&(s.length>0?t(s[s.length-1].customer.customerid):t("search"))})(n.customer.customerid)},style:{position:"absolute",top:"8px",right:"8px",zIndex:10},title:"Close tab"})]},n.customer.customerid))]})}),"search"===e&&(0,Js.jsxs)("div",{children:[(0,Js.jsxs)("div",{className:"compact-filters",children:[(0,Js.jsx)("div",{className:"search-input",children:(0,Js.jsxs)("div",{className:"control has-icons-left",children:[(0,Js.jsx)("input",{className:"input",type:"text",placeholder:"Search customer name or ID...",value:n,onChange:e=>s(e.target.value),onKeyPress:e=>"Enter"===e.key&&Q()}),(0,Js.jsx)("span",{className:"icon is-small is-left",children:(0,Js.jsx)("i",{className:"fas fa-search"})})]})}),(0,Js.jsxs)("div",{className:"filter-row",children:[(0,Js.jsx)("div",{className:"filter-group",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:p,onChange:e=>g(e.target.value),children:[(0,Js.jsx)("option",{value:"all",children:"All Barangays"}),j.map(e=>(0,Js.jsx)("option",{value:e.barangay,children:e.barangay},e.barangay))]})})}),(0,Js.jsx)("div",{className:"filter-group",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:v,onChange:e=>y(e.target.value),children:[(0,Js.jsx)("option",{value:"all",children:"All Types"}),N.map(e=>(0,Js.jsx)("option",{value:e.type,children:e.type},e.type))]})})}),(0,Js.jsx)("div",{className:"filter-group",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:b,onChange:e=>x(e.target.value),children:[(0,Js.jsx)("option",{value:"all",children:"All Status"}),(0,Js.jsx)("option",{value:"Active",children:"Active"}),(0,Js.jsx)("option",{value:"Disconnected",children:"Disconnected"})]})})}),(0,Js.jsxs)("button",{className:"button is-primary ".concat(c?"is-loading":""),onClick:Q,disabled:c,children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-search"})}),(0,Js.jsx)("span",{children:"Search"})]}),(0,Js.jsxs)("button",{className:"button is-info ".concat(c?"is-loading":""),onClick:async()=>{d(!0),h(""),s("");const e=await aa.searchCustomers("");if(e.success){let t=e.data;"all"!==p&&(t=t.filter(e=>{var t;return(null===(t=e.barangay)||void 0===t?void 0:t.toLowerCase())===p.toLowerCase()})),"all"!==v&&(t=t.filter(e=>{var t;return(null===(t=e.type)||void 0===t?void 0:t.toLowerCase())===v.toLowerCase()})),"all"!==b&&(t=t.filter(e=>{var t;return(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())===b.toLowerCase()})),i(t),0===t.length&&h("No customers found with current filters.")}else h("Error loading customers: ".concat(e.error));d(!1)},disabled:c,children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-list"})}),(0,Js.jsx)("span",{children:"Browse All"})]})]})]}),r.length>0&&(0,Js.jsxs)("div",{className:"box",style:{marginTop:"1rem",padding:"1.5rem"},children:[(0,Js.jsxs)("h3",{className:"title is-6 mb-3",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-users"})}),"Search Results"]}),(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"Customer ID"}),(0,Js.jsx)("th",{children:"Name"}),(0,Js.jsx)("th",{children:"Type"}),(0,Js.jsx)("th",{children:"Barangay"}),(0,Js.jsx)("th",{children:"Status"}),(0,Js.jsx)("th",{width:"100",children:"Action"})]})}),(0,Js.jsx)("tbody",{children:r.map(e=>(0,Js.jsxs)("tr",{onClick:()=>Y(e),style:{cursor:"pointer"},title:"Click to select customer",children:[(0,Js.jsx)("td",{children:e.customerid}),(0,Js.jsx)("td",{children:(0,Js.jsx)("strong",{children:e.name})}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag is-info is-light",children:e.type})}),(0,Js.jsx)("td",{children:e.barangay}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag ".concat("Active"===e.status?"is-success":"is-danger"),children:e.status})}),(0,Js.jsx)("td",{children:(0,Js.jsxs)("button",{className:"button is-small is-primary",onClick:t=>{t.stopPropagation(),Y(e)},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-arrow-right"})}),(0,Js.jsx)("span",{children:"Select"})]})})]},e.customerid))})]})})]}),T.length>0&&(0,Js.jsxs)("div",{className:"box",style:{marginTop:"1rem",padding:"1.5rem"},children:[(0,Js.jsxs)("h3",{className:"title is-6 mb-3",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-clock"})}),"Recent Payments"]}),(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-narrow is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"Date Paid"}),(0,Js.jsx)("th",{children:"Customer ID"}),(0,Js.jsx)("th",{children:"Customer Name"}),(0,Js.jsx)("th",{children:"Barangay"}),(0,Js.jsx)("th",{children:"Billed Month"}),(0,Js.jsx)("th",{children:"Amount Paid"})]})}),(0,Js.jsx)("tbody",{children:T.map(e=>{var t,n;return(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{children:(0,Js.jsxs)("span",{className:"icon-text",children:[(0,Js.jsx)("span",{className:"icon has-text-success",children:(0,Js.jsx)("i",{className:"fas fa-check-circle"})}),(0,Js.jsx)("span",{children:new Date(e.datepaid).toLocaleDateString("en-PH",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})}),(0,Js.jsx)("td",{className:"has-text-weight-bold",children:e.customerid}),(0,Js.jsx)("td",{children:(null===(t=e.customer)||void 0===t?void 0:t.name)||"N/A"}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag is-light",children:(null===(n=e.customer)||void 0===n?void 0:n.barangay)||"N/A"})}),(0,Js.jsx)("td",{children:new Date(e.billedmonth).toLocaleDateString("en-PH",{year:"numeric",month:"long"})}),(0,Js.jsxs)("td",{className:"has-text-weight-bold has-text-success",children:["\u20b1",parseFloat(e.totalbillamount||0).toLocaleString("en-PH",{minimumFractionDigits:2})]})]},e.billid)})})]})})]}),0===r.length&&!c&&0===T.length&&(0,Js.jsxs)("div",{className:"has-text-centered",style:{padding:"3rem"},children:[(0,Js.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Js.jsx)("i",{className:"fas fa-search fa-3x"})}),(0,Js.jsx)("p",{className:"has-text-grey mt-4",children:"Search for customers to process payments"})]})]}),"search"!==e&&J()&&(()=>{const e=J(),{customer:t,unpaidBills:n,paymentHistory:s,billsWithSurcharge:a,selectedBills:r}=e;return(0,Js.jsxs)("div",{children:[(0,Js.jsx)("div",{className:"box",style:{background:"#f5f5f5",marginBottom:"1rem"},children:(0,Js.jsx)("div",{className:"level is-mobile",children:(0,Js.jsxs)("div",{className:"level-left",children:[(0,Js.jsx)("div",{className:"level-item",children:(0,Js.jsxs)("div",{children:[(0,Js.jsx)("p",{className:"heading",children:"Customer"}),(0,Js.jsx)("p",{className:"title is-5",children:t.name})]})}),(0,Js.jsx)("div",{className:"level-item",children:(0,Js.jsxs)("div",{children:[(0,Js.jsx)("p",{className:"heading",children:"ID"}),(0,Js.jsx)("p",{className:"title is-6",children:t.customerid})]})}),(0,Js.jsx)("div",{className:"level-item",children:(0,Js.jsxs)("div",{children:[(0,Js.jsx)("p",{className:"heading",children:"Type"}),(0,Js.jsx)("p",{children:(0,Js.jsx)("span",{className:"tag is-info",children:t.type})})]})}),(0,Js.jsx)("div",{className:"level-item",children:(0,Js.jsxs)("div",{children:[(0,Js.jsx)("p",{className:"heading",children:"Barangay"}),(0,Js.jsx)("p",{className:"title is-6",children:t.barangay})]})}),(0,Js.jsx)("div",{className:"level-item",children:(0,Js.jsxs)("div",{children:[(0,Js.jsx)("p",{className:"heading",children:"Discount"}),(0,Js.jsxs)("p",{className:"title is-6",children:[t.discount||0,"%"]})]})}),(0,Js.jsx)("div",{className:"level-item",children:(0,Js.jsxs)("div",{children:[(0,Js.jsx)("p",{className:"heading",children:"Status"}),(0,Js.jsx)("p",{children:(0,Js.jsx)("span",{className:"tag ".concat("Active"===t.status?"is-success":"is-danger"),children:t.status})})]})}),(0,Js.jsx)("div",{className:"level-item",children:(0,Js.jsxs)("div",{children:[(0,Js.jsx)("p",{className:"heading",children:"Credit Balance"}),(0,Js.jsx)("p",{className:"title is-6 has-text-success",children:ee(e.creditBalance||0)})]})})]})})}),(0,Js.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,Js.jsxs)("h2",{className:"title is-5",children:[(0,Js.jsx)("i",{className:"fas fa-file-invoice-dollar"})," Unpaid Bills",n.length>0&&(0,Js.jsx)("span",{className:"tag is-danger ml-2",children:n.length})]}),c?(0,Js.jsx)("div",{className:"has-text-centered",style:{padding:"2rem"},children:(0,Js.jsx)("button",{className:"button is-loading is-large is-ghost"})}):0===n.length?(0,Js.jsxs)("div",{className:"notification is-success is-light has-text-centered",children:[(0,Js.jsx)("i",{className:"fas fa-check-circle fa-2x"}),(0,Js.jsx)("p",{className:"mt-2",children:"No unpaid bills"})]}):(0,Js.jsxs)(Js.Fragment,{children:[(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{width:"50",children:(0,Js.jsx)("label",{className:"checkbox",children:(0,Js.jsx)("input",{type:"checkbox",checked:r.length===a.length&&a.length>0,onChange:e=>{e.target.checked?X(a.map(e=>e.billid)):X([])}})})}),(0,Js.jsx)("th",{children:"Bill ID"}),(0,Js.jsx)("th",{children:"Billing Month"}),(0,Js.jsx)("th",{children:"Previous"}),(0,Js.jsx)("th",{children:"Current"}),(0,Js.jsx)("th",{children:"Consumption"}),(0,Js.jsx)("th",{children:"Basic Amount"}),(0,Js.jsx)("th",{children:"Surcharge"}),(0,Js.jsx)("th",{children:"Discount"}),(0,Js.jsx)("th",{children:"Total Bill"}),(0,Js.jsx)("th",{children:"Status"})]})}),(0,Js.jsx)("tbody",{children:a.map(e=>{const t=e.surchargeInfo&&e.surchargeInfo.daysOverdue>0;return(0,Js.jsxs)("tr",{className:r.includes(e.billid)?"is-selected":"",children:[(0,Js.jsx)("td",{children:(0,Js.jsx)("label",{className:"checkbox",children:(0,Js.jsx)("input",{type:"checkbox",checked:r.includes(e.billid),onChange:t=>{t.target.checked?X([...r,e.billid]):X(r.filter(t=>t!==e.billid))}})})}),(0,Js.jsx)("td",{children:(0,Js.jsx)("strong",{children:e.billid})}),(0,Js.jsxs)("td",{children:[(0,Js.jsx)("div",{children:te(e.billedmonth)}),t&&(0,Js.jsxs)("small",{className:"has-text-danger",children:[(0,Js.jsx)("i",{className:"fas fa-exclamation-triangle"})," ",e.surchargeInfo.daysOverdue," days overdue"]})]}),(0,Js.jsx)("td",{children:e.previousreading||0}),(0,Js.jsx)("td",{children:e.currentreading||0}),(0,Js.jsx)("td",{children:(0,Js.jsxs)("strong",{children:[e.consumption," cu.m"]})}),(0,Js.jsx)("td",{children:ee(e.basicamount)}),(0,Js.jsx)("td",{children:e.surchargeInfo&&e.surchargeInfo.surchargeAmount>0?(0,Js.jsx)("span",{className:"has-text-danger has-text-weight-bold",children:ee(e.surchargeInfo.surchargeAmount)}):(0,Js.jsx)("span",{className:"has-text-grey",children:"-"})}),(0,Js.jsx)("td",{className:"has-text-success",children:e.calculatedDiscountAmount>0?"-".concat(ee(e.calculatedDiscountAmount)):"-"}),(0,Js.jsx)("td",{className:"has-text-weight-bold is-size-5",children:ee(e.calculatedTotal||e.totalbillamount)}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag ".concat("Unpaid"===e.paymentstatus?"is-danger":"Partial"===e.paymentstatus?"is-warning":"is-info"),children:e.paymentstatus})})]},e.billid)})}),(0,Js.jsx)("tfoot",{children:(0,Js.jsxs)("tr",{className:"has-background-light",children:[(0,Js.jsx)("td",{className:"has-text-centered has-text-weight-bold",children:r.length}),(0,Js.jsx)("td",{colSpan:"5",className:"has-text-right has-text-weight-bold",children:"Selected Bills:"}),(0,Js.jsxs)("td",{className:"has-text-weight-bold",children:[(0,Js.jsx)("div",{className:"heading",children:"Total Basic Amount"}),(0,Js.jsx)("div",{className:"is-size-5",children:ee(a.filter(e=>r.includes(e.billid)).reduce((e,t)=>e+parseFloat(t.basicamount||0),0))})]}),(0,Js.jsxs)("td",{className:"has-text-weight-bold",children:[(0,Js.jsx)("div",{className:"heading",children:"Total Surcharge"}),(0,Js.jsx)("div",{className:"is-size-5 has-text-danger",children:ee(a.filter(e=>r.includes(e.billid)).reduce((e,t)=>{var n;return e+parseFloat((null===(n=t.surchargeInfo)||void 0===n?void 0:n.surchargeAmount)||0)},0))})]}),(0,Js.jsxs)("td",{className:"has-text-weight-bold",children:[(0,Js.jsx)("div",{className:"heading",children:"Total Discount"}),(0,Js.jsxs)("div",{className:"is-size-5 has-text-success",children:["-",ee(a.filter(e=>r.includes(e.billid)).reduce((e,t)=>e+parseFloat(t.calculatedDiscountAmount||0),0))]})]}),(0,Js.jsxs)("td",{className:"has-text-weight-bold",children:[(0,Js.jsx)("div",{className:"heading",children:"Grand Total"}),(0,Js.jsx)("div",{className:"is-size-4 has-text-success",children:ee(a.filter(e=>r.includes(e.billid)).reduce((e,t)=>e+parseFloat(t.calculatedTotal||t.totalbillamount||0),0))})]}),(0,Js.jsx)("td",{})]})})]})}),r.length>0&&(0,Js.jsxs)("div",{className:"buttons is-right mt-3",children:[(0,Js.jsxs)("button",{className:"button is-small is-light",onClick:()=>X([]),children:[(0,Js.jsx)("span",{className:"icon is-small",children:(0,Js.jsx)("i",{className:"fas fa-times"})}),(0,Js.jsx)("span",{children:"Clear"})]}),(0,Js.jsxs)("button",{className:"button is-success",onClick:()=>{const n=a.filter(e=>r.includes(e.billid)),s=n.reduce((e,t)=>e+parseFloat(t.calculatedTotal||t.totalbillamount||0),0),i=n.reduce((e,t)=>{var n;return e+parseFloat((null===(n=t.surchargeInfo)||void 0===n?void 0:n.surchargeAmount)||0)},0);D({bills:r,customerid:t.customerid,count:r.length,totalAmount:s,totalSurcharge:i,creditBalance:e.creditBalance||0}),U(""),I(!0)},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-check-circle"})}),(0,Js.jsx)("span",{children:"Process Payment"})]})]})]})]}),(0,Js.jsxs)("div",{style:{marginTop:"1.5rem"},children:[(0,Js.jsxs)("h2",{className:"title is-5",children:[(0,Js.jsx)("i",{className:"fas fa-history"})," Payment History",s.length>0&&(0,Js.jsx)("span",{className:"tag is-info ml-2",children:s.length})]}),c?(0,Js.jsx)("div",{className:"has-text-centered",style:{padding:"2rem"},children:(0,Js.jsx)("button",{className:"button is-loading is-large is-ghost"})}):0===s.length?(0,Js.jsxs)("div",{className:"notification is-light has-text-centered",children:[(0,Js.jsx)("i",{className:"fas fa-history fa-2x has-text-grey-light"}),(0,Js.jsx)("p",{className:"has-text-grey mt-2",children:"No payment history"})]}):(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"Bill ID"}),(0,Js.jsx)("th",{children:"Billing Month"}),(0,Js.jsx)("th",{children:"Previous"}),(0,Js.jsx)("th",{children:"Current"}),(0,Js.jsx)("th",{children:"Consumption"}),(0,Js.jsx)("th",{children:"Amount Paid"}),(0,Js.jsx)("th",{children:"Date Paid"}),(0,Js.jsx)("th",{children:"Paid By"}),(0,Js.jsx)("th",{children:"Status"}),(0,Js.jsx)("th",{width:"120",children:"Actions"})]})}),(0,Js.jsx)("tbody",{children:s.map(e=>{return(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{children:(0,Js.jsx)("strong",{children:e.billid})}),(0,Js.jsx)("td",{children:te(e.billedmonth)}),(0,Js.jsx)("td",{children:e.previousreading||0}),(0,Js.jsx)("td",{children:e.currentreading||0}),(0,Js.jsx)("td",{children:(0,Js.jsxs)("strong",{children:[e.consumption," cu.m"]})}),(0,Js.jsx)("td",{className:"has-text-weight-bold",children:ee(e.totalbillamount)}),(0,Js.jsx)("td",{children:(t=e.datepaid,t?new Date(t).toLocaleDateString("en-PH",{year:"numeric",month:"short",day:"numeric"}):"N/A")}),(0,Js.jsx)("td",{children:e.paidby}),(0,Js.jsx)("td",{children:(0,Js.jsxs)("span",{className:"tag is-success",children:[(0,Js.jsx)("i",{className:"fas fa-check"})," ",e.paymentstatus]})}),(0,Js.jsx)("td",{children:(0,Js.jsxs)("button",{className:"button is-warning is-small",onClick:()=>{W(e),z(!0)},title:"Mark as Unpaid",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-undo"})}),(0,Js.jsx)("span",{children:"Unpaid"})]})})]},e.billid);var t})})]})})]})]})})(),(0,Js.jsx)(ua,{isOpen:A&&null!==L,onClose:()=>{I(!1),D(null)},onConfirm:async function(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!L)return;d(!0);const a=n-t,r=J();if(!r)return h("Unable to find customer data"),void d(!1);const i=r.billsWithSurcharge.filter(e=>L.bills.includes(e.billid)).map(e=>{var n;const a=s?0:(null===(n=e.surchargeInfo)||void 0===n?void 0:n.surchargeAmount)||0,r=parseFloat(e.basicamount||0),i=e.calculatedDiscountAmount||0,l=r+a-i;return{billid:e.billid,basicamount:r,surchargeamount:a,discountamount:i,totalbillamount:l,advancepaymentamount:t>0?t/L.bills.length:0}}),l=await aa.processPayment(i,"".concat(q.firstname," ").concat(q.lastname),e,a);if(l.success){let e="Successfully processed payment for ".concat(l.data.paidCount," bill(s)!");t>0&&(e+=" Credit of \u20b1".concat(t.toFixed(2)," was applied.")),n>0&&(e+=" New credit of \u20b1".concat(n.toFixed(2)," added to account.")),f(e),await Z(L.customerid),H(),$(),setTimeout(()=>f(""),5e3)}else h(l.error);d(!1),I(!1),D(null)},billCount:(null===L||void 0===L?void 0:L.count)||0,grandTotal:(null===L||void 0===L?void 0:L.totalAmount)||0,totalSurcharge:(null===L||void 0===L?void 0:L.totalSurcharge)||0,creditBalance:(null===L||void 0===L?void 0:L.creditBalance)||0,loading:c}),(0,Js.jsx)(ca,{isOpen:F&&null!==M,onClose:()=>{z(!1),W(null)},onConfirm:async()=>{if(!M)return;d(!0);const e=await aa.markBillAsUnpaid(M.billid);e.success?(f("Bill #".concat(M.billid," marked as unpaid successfully!")),await Z(M.customerid),H(),$(),setTimeout(()=>f(""),3e3)):h(e.error),d(!1),z(!1),W(null)},title:"Mark Bill as Unpaid?",message:M?"Are you sure you want to mark Bill #".concat(M.billid," as unpaid?"):"",subMessage:"This will reverse the payment status. Use this only if the bill was accidentally marked as paid.",confirmText:"Mark as Unpaid",cancelText:"Cancel",type:"warning",loading:c})]})},ma={async getCustomersWithCredit(){try{const{data:e,error:t}=await Hs.from("customers").select("customerid, name, barangay, type, status, credit_balance").gt("credit_balance",0).order("credit_balance",{ascending:!1}).range(0,999999);if(t)throw t;return{success:!0,data:e||[]}}catch(e){return console.error("Error getting customers with credit:",e),{success:!1,error:e.message,data:[]}}},async getCreditStats(){try{const{data:e,error:t}=await Hs.from("customers").select("credit_balance").range(0,999999);if(t)throw t;const n=e.filter(e=>parseFloat(e.credit_balance||0)>0),s=e.reduce((e,t)=>e+parseFloat(t.credit_balance||0),0);return{success:!0,data:{totalCustomers:e.length,customersWithCredit:n.length,totalCreditAmount:s,averageCredit:n.length>0?s/n.length:0}}}catch(e){return console.error("Error getting credit stats:",e),{success:!1,error:e.message}}},async searchCustomers(e){try{let t=Hs.from("customers").select("customerid, name, barangay, type, status, credit_balance").range(0,999999);if(e){t=/^\d+$/.test(e)?t.or("name.ilike.%".concat(e,"%,customerid.eq.").concat(e)):t.ilike("name","%".concat(e,"%"))}t=t.order("name",{ascending:!0});const{data:n,error:s}=await t;if(s)throw s;return{success:!0,data:n||[]}}catch(t){return console.error("Error searching customers:",t),{success:!1,error:t.message,data:[]}}},async adjustCredit(e,t,n,s){try{const{data:a,error:r}=await Hs.from("customers").select("credit_balance, name").eq("customerid",e).single();if(r)throw r;const i=parseFloat(a.credit_balance||0);let l;if("add"===n)l=i+parseFloat(t);else{if("deduct"!==n)return{success:!1,error:"Invalid adjustment type"};if(l=i-parseFloat(t),l<0)return{success:!1,error:"Cannot deduct more than available credit balance"}}const{error:o}=await Hs.from("customers").update({credit_balance:l}).eq("customerid",e);if(o)throw o;return{success:!0,data:{customerid:e,customerName:a.name,previousBalance:i,adjustment:"add"===n?t:-t,newBalance:l,remarks:s}}}catch(a){return console.error("Error adjusting credit:",a),{success:!1,error:a.message}}},async getUnpaidBills(e){try{const{data:t,error:n}=await Hs.from("bills").select("*").eq("customerid",e).eq("paymentstatus","Unpaid").order("billedmonth",{ascending:!0}).range(0,999999);if(n)throw n;return{success:!0,data:t||[]}}catch(t){return console.error("Error getting unpaid bills:",t),{success:!1,error:t.message,data:[]}}},async applyCreditToBills(e,t,n,s){try{const{data:a,error:r}=await Hs.from("customers").select("credit_balance").eq("customerid",e).single();if(r)throw r;const i=parseFloat(a.credit_balance||0);if(n>i)return{success:!1,error:"Insufficient credit balance"};const l=t.map(e=>{let{billid:t,amount:n}=e;return Hs.from("bills").update({paymentstatus:"Paid",advancepaymentamount:n,paidby:s,datepaid:(new Date).toISOString()}).eq("billid",t)}),o=await Promise.all(l);if(o.some(e=>e.error))throw new Error("Some bills failed to update");const c=i-n;return await Hs.from("customers").update({credit_balance:c}).eq("customerid",e),{success:!0,data:{billsPaid:t.length,creditUsed:n,remainingCredit:c}}}catch(a){return console.error("Error applying credit to bills:",a),{success:!1,error:a.message}}}},fa=()=>{const[e,t]=(0,a.useState)("overview"),[n,s]=(0,a.useState)([]),[r,i]=(0,a.useState)({totalCustomers:0,customersWithCredit:0,totalCreditAmount:0,averageCredit:0}),[l,o]=(0,a.useState)(""),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(""),[m,f]=(0,a.useState)(""),[p,g]=(0,a.useState)(!1),[v,y]=(0,a.useState)(null),[b,x]=(0,a.useState)("add"),[j,w]=(0,a.useState)(""),[N,S]=(0,a.useState)(""),[k,C]=(0,a.useState)(!1),[_,E]=(0,a.useState)([]),[T,P]=(0,a.useState)([]),[O,R]=(0,a.useState)(!1),[A,I]=(0,a.useState)(null),L=$s.getUserSession();(0,a.useEffect)(()=>{D()},[]),(0,a.useEffect)(()=>{if(l.trim()){const e=setTimeout(()=>{B()},500);return()=>clearTimeout(e)}D()},[l]);const D=async()=>{d(!0);const[e,t]=await Promise.all([ma.getCustomersWithCredit(),ma.getCreditStats()]);e.success?s(e.data):h(e.error),t.success&&i(t.data),d(!1)},B=async()=>{d(!0);const e=await ma.searchCustomers(l);e.success?s(e.data):h(e.error),d(!1)},U=e=>"\u20b1".concat(parseFloat(e||0).toLocaleString("en-PH",{minimumFractionDigits:2}));return(0,Js.jsxs)("div",{className:"credit-management-page",style:{padding:"0"},children:[(0,Js.jsx)("div",{className:"level mb-3",children:(0,Js.jsx)("div",{className:"level-left",children:(0,Js.jsx)("div",{className:"level-item",children:(0,Js.jsxs)("h1",{className:"title is-4 mb-0",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-piggy-bank"})}),"Credit Management"]})})})}),u&&(0,Js.jsxs)("div",{className:"notification is-danger is-light py-3",children:[(0,Js.jsx)("button",{className:"delete",onClick:()=>h("")}),u]}),m&&(0,Js.jsxs)("div",{className:"notification is-success is-light py-3",children:[(0,Js.jsx)("button",{className:"delete",onClick:()=>f("")}),m]}),(0,Js.jsxs)("div",{className:"columns mb-3",children:[(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-info-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Total Customers"}),(0,Js.jsx)("p",{className:"title is-4",children:r.totalCustomers.toLocaleString()})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-success-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Customers with Credit"}),(0,Js.jsx)("p",{className:"title is-4",children:r.customersWithCredit.toLocaleString()})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-warning-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Total Credit Amount"}),(0,Js.jsx)("p",{className:"title is-4",children:U(r.totalCreditAmount)})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-primary-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Average Credit"}),(0,Js.jsx)("p",{className:"title is-4",children:U(r.averageCredit)})]})})]}),(0,Js.jsx)("div",{className:"box",style:{marginBottom:"1rem",padding:"1.5rem"},children:(0,Js.jsxs)("div",{className:"field has-addons",children:[(0,Js.jsx)("div",{className:"control is-expanded",children:(0,Js.jsx)("input",{className:"input",type:"text",placeholder:"Search customer by name or ID...",value:l,onChange:e=>o(e.target.value)})}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsxs)("button",{className:"button is-primary ".concat(c?"is-loading":""),onClick:B,children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-search"})}),(0,Js.jsx)("span",{children:"Search"})]})})]})}),(0,Js.jsx)("div",{className:"box",style:{padding:"0"},children:c&&0===n.length?(0,Js.jsx)("div",{className:"has-text-centered",style:{padding:"3rem"},children:(0,Js.jsx)("button",{className:"button is-loading is-large is-ghost"})}):0===n.length?(0,Js.jsxs)("div",{className:"has-text-centered",style:{padding:"3rem"},children:[(0,Js.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Js.jsx)("i",{className:"fas fa-piggy-bank fa-3x"})}),(0,Js.jsx)("p",{className:"has-text-grey mt-4",children:"No customers found"})]}):(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"Customer ID"}),(0,Js.jsx)("th",{children:"Customer Name"}),(0,Js.jsx)("th",{children:"Barangay"}),(0,Js.jsx)("th",{children:"Type"}),(0,Js.jsx)("th",{children:"Status"}),(0,Js.jsx)("th",{children:"Credit Balance"}),(0,Js.jsx)("th",{width:"200",children:"Actions"})]})}),(0,Js.jsx)("tbody",{children:n.map(e=>(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{className:"has-text-weight-bold",children:e.customerid}),(0,Js.jsx)("td",{children:e.name}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag is-light",children:e.barangay})}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag is-info is-light",children:e.type})}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag ".concat("Active"===e.status?"is-success":"is-warning"," is-light"),children:e.status})}),(0,Js.jsx)("td",{className:"has-text-weight-bold has-text-success",children:U(e.credit_balance)}),(0,Js.jsx)("td",{children:(0,Js.jsxs)("div",{className:"buttons are-small",children:[(0,Js.jsxs)("button",{className:"button is-info is-small",onClick:()=>(e=>{y(e),x("add"),w(""),S(""),g(!0)})(e),title:"Adjust Credit",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-edit"})}),(0,Js.jsx)("span",{children:"Adjust"})]}),parseFloat(e.credit_balance||0)>0&&(0,Js.jsxs)("button",{className:"button is-success is-small",onClick:()=>(async e=>{y(e),d(!0);const t=await ma.getUnpaidBills(e.customerid);t.success?(E(t.data),P([]),C(!0)):h(t.error),d(!1)})(e),title:"Apply Credit to Bills",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-check-circle"})}),(0,Js.jsx)("span",{children:"Apply"})]})]})})]},e.customerid))})]})})}),p&&v&&(0,Js.jsxs)("div",{className:"modal is-active",children:[(0,Js.jsx)("div",{className:"modal-background",onClick:()=>g(!1)}),(0,Js.jsxs)("div",{className:"modal-card",children:[(0,Js.jsxs)("header",{className:"modal-card-head",children:[(0,Js.jsxs)("p",{className:"modal-card-title",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-coins"})}),"Adjust Credit - ",v.name]}),(0,Js.jsx)("button",{className:"delete",onClick:()=>g(!1)})]}),(0,Js.jsxs)("section",{className:"modal-card-body",children:[(0,Js.jsxs)("div",{className:"notification is-info is-light mb-3",children:[(0,Js.jsx)("strong",{children:"Current Credit Balance:"})," ",U(v.credit_balance)]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Adjustment Type"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:b,onChange:e=>x(e.target.value),children:[(0,Js.jsx)("option",{value:"add",children:"Add Credit"}),(0,Js.jsx)("option",{value:"deduct",children:"Deduct Credit"})]})})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsxs)("label",{className:"label",children:["Amount ",(0,Js.jsx)("span",{className:"has-text-danger",children:"*"})]}),(0,Js.jsxs)("div",{className:"control has-icons-left",children:[(0,Js.jsx)("input",{className:"input",type:"number",step:"0.01",placeholder:"Enter amount",value:j,onChange:e=>w(e.target.value)}),(0,Js.jsx)("span",{className:"icon is-small is-left",children:(0,Js.jsx)("i",{className:"fas fa-peso-sign"})})]})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Remarks"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("textarea",{className:"textarea",placeholder:"Enter remarks (optional)",value:N,onChange:e=>S(e.target.value),rows:"3"})})]}),j&&(0,Js.jsxs)("div",{className:"notification ".concat("add"===b?"is-success":"is-warning"," is-light"),children:[(0,Js.jsx)("strong",{children:"New Balance:"})," ",U(parseFloat(v.credit_balance||0)+("add"===b?1:-1)*parseFloat(j||0))]})]}),(0,Js.jsxs)("footer",{className:"modal-card-foot",children:[(0,Js.jsxs)("button",{className:"button is-success ".concat(c?"is-loading":""),onClick:async()=>{if(!v||!j)return void h("Please fill in all required fields");const e=parseFloat(j);if(isNaN(e)||e<=0)return void h("Please enter a valid amount");d(!0);const t=await ma.adjustCredit(v.customerid,e,b,N);t.success?(f("Credit ".concat("add"===b?"added":"deducted"," successfully!")),g(!1),D(),setTimeout(()=>f(""),3e3)):h(t.error),d(!1)},disabled:c,children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-check"})}),(0,Js.jsx)("span",{children:"Confirm Adjustment"})]}),(0,Js.jsx)("button",{className:"button",onClick:()=>g(!1),children:"Cancel"})]})]})]}),k&&v&&(0,Js.jsxs)("div",{className:"modal is-active",children:[(0,Js.jsx)("div",{className:"modal-background",onClick:()=>C(!1)}),(0,Js.jsxs)("div",{className:"modal-card",style:{width:"900px"},children:[(0,Js.jsxs)("header",{className:"modal-card-head",children:[(0,Js.jsxs)("p",{className:"modal-card-title",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-money-check-alt"})}),"Apply Credit - ",v.name]}),(0,Js.jsx)("button",{className:"delete",onClick:()=>C(!1)})]}),(0,Js.jsxs)("section",{className:"modal-card-body",children:[(0,Js.jsx)("div",{className:"notification is-info is-light mb-3",children:(0,Js.jsxs)("div",{className:"columns is-mobile",children:[(0,Js.jsxs)("div",{className:"column",children:[(0,Js.jsx)("strong",{children:"Available Credit:"})," ",U(v.credit_balance)]}),(0,Js.jsxs)("div",{className:"column",children:[(0,Js.jsx)("strong",{children:"Selected Total:"})," ",U(T.reduce((e,t)=>e+t.amount,0))]})]})}),0===_.length?(0,Js.jsxs)("div",{className:"has-text-centered",style:{padding:"2rem"},children:[(0,Js.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Js.jsx)("i",{className:"fas fa-check-circle fa-2x"})}),(0,Js.jsx)("p",{className:"has-text-grey mt-3",children:"No unpaid bills found"})]}):(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable is-narrow",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{width:"50"}),(0,Js.jsx)("th",{children:"Bill ID"}),(0,Js.jsx)("th",{children:"Billed Month"}),(0,Js.jsx)("th",{children:"Consumption"}),(0,Js.jsx)("th",{children:"Amount"})]})}),(0,Js.jsx)("tbody",{children:_.map(e=>{return(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{children:(0,Js.jsx)("input",{type:"checkbox",checked:T.some(t=>t.billid===e.billid),onChange:()=>(e=>{const t=parseFloat(e.totalbillamount||0),n=T.findIndex(t=>t.billid===e.billid);P(n>=0?t=>t.filter(t=>t.billid!==e.billid):n=>[...n,{billid:e.billid,amount:t}])})(e)})}),(0,Js.jsx)("td",{children:e.billid}),(0,Js.jsx)("td",{children:(t=e.billedmonth,new Date(t).toLocaleDateString("en-PH",{year:"numeric",month:"long"}))}),(0,Js.jsxs)("td",{children:[e.consumption," cu.m"]}),(0,Js.jsx)("td",{className:"has-text-weight-bold",children:U(e.totalbillamount)})]},e.billid);var t})})]})})]}),(0,Js.jsxs)("footer",{className:"modal-card-foot",children:[(0,Js.jsxs)("button",{className:"button is-success ".concat(c?"is-loading":""),onClick:async()=>{if(0===T.length)return void h("Please select at least one bill");const e=T.reduce((e,t)=>e+parseFloat(t.amount),0);if(e>parseFloat(v.credit_balance||0))return void h("Total amount exceeds available credit");d(!0);const t=await ma.applyCreditToBills(v.customerid,T,e,"".concat(L.firstname," ").concat(L.lastname));t.success?(f("Credit applied to ".concat(t.data.billsPaid," bill(s) successfully!")),C(!1),D(),setTimeout(()=>f(""),3e3)):h(t.error),d(!1)},disabled:c||0===T.length,children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-check-circle"})}),(0,Js.jsxs)("span",{children:["Apply Credit to ",T.length," Bill(s)"]})]}),(0,Js.jsx)("button",{className:"button",onClick:()=>C(!1),children:"Cancel"})]})]})]})]})},pa={async getWaterUsageReport(e,t){try{const{data:n,error:s}=await Hs.from("bills").select("billedmonth, consumption, customerid, customername, barangay").gte("billedmonth",e).lte("billedmonth",t).order("billedmonth",{ascending:!0}).range(0,999999);if(s)throw s;const a=n.reduce((e,t)=>e+parseFloat(t.consumption||0),0),r=n.length>0?a/n.length:0,i={};n.forEach(e=>{const t=e.billedmonth;i[t]||(i[t]={month:t,consumption:0,count:0}),i[t].consumption+=parseFloat(e.consumption||0),i[t].count++});const l={};return n.forEach(e=>{const t=e.barangay||"Unknown";l[t]||(l[t]={barangay:t,consumption:0,count:0}),l[t].consumption+=parseFloat(e.consumption||0),l[t].count++}),{success:!0,data:{totalConsumption:a,averageConsumption:r,billCount:n.length,byMonth:Object.values(i),byBarangay:Object.values(l).sort((e,t)=>t.consumption-e.consumption),rawData:n}}}catch(n){return console.error("Error getting water usage report:",n),{success:!1,error:n.message}}},async getRevenueReport(e,t){try{const{data:n,error:s}=await Hs.from("bills").select("billedmonth, totalbillamount, paymentstatus, datepaid, basicamount, surchargeamount, discountamount, barangay").gte("billedmonth",e).lte("billedmonth",t).range(0,999999);if(s)throw s;const a=n.reduce((e,t)=>e+parseFloat(t.totalbillamount||0),0),r=n.filter(e=>"Paid"===e.paymentstatus).reduce((e,t)=>e+parseFloat(t.totalbillamount||0),0),i=n.filter(e=>"Unpaid"===e.paymentstatus).reduce((e,t)=>e+parseFloat(t.totalbillamount||0),0),l=n.reduce((e,t)=>e+parseFloat(t.surchargeamount||0),0),o=n.reduce((e,t)=>e+parseFloat(t.discountamount||0),0),c=n.filter(e=>"Paid"===e.paymentstatus).length,d=n.filter(e=>"Unpaid"===e.paymentstatus).length,u=n.length>0?c/n.length*100:0,h={};n.forEach(e=>{const t=e.billedmonth;h[t]||(h[t]={month:t,billed:0,paid:0,unpaid:0}),h[t].billed+=parseFloat(e.totalbillamount||0),"Paid"===e.paymentstatus?h[t].paid+=parseFloat(e.totalbillamount||0):h[t].unpaid+=parseFloat(e.totalbillamount||0)});const m={};return n.forEach(e=>{const t=e.barangay||"Unknown";m[t]||(m[t]={barangay:t,billed:0,paid:0,unpaid:0,billCount:0}),m[t].billed+=parseFloat(e.totalbillamount||0),m[t].billCount++,"Paid"===e.paymentstatus?m[t].paid+=parseFloat(e.totalbillamount||0):m[t].unpaid+=parseFloat(e.totalbillamount||0)}),{success:!0,data:{totalBilled:a,totalPaid:r,totalUnpaid:i,totalSurcharge:l,totalDiscount:o,paidCount:c,unpaidCount:d,collectionRate:u,byMonth:Object.values(h),byBarangay:Object.values(m).sort((e,t)=>t.billed-e.billed)}}}catch(n){return console.error("Error getting revenue report:",n),{success:!1,error:n.message}}},async getCollectionReport(e,t){try{const{data:n,error:s}=await Hs.from("bills").select("datepaid, totalbillamount, paidby, customername, barangay").eq("paymentstatus","Paid").gte("datepaid",e).lte("datepaid",t).order("datepaid",{ascending:!0}).range(0,999999);if(s)throw s;const a=n.reduce((e,t)=>e+parseFloat(t.totalbillamount||0),0),r={};n.forEach(e=>{const t=e.datepaid.split("T")[0];r[t]||(r[t]={date:t,amount:0,count:0}),r[t].amount+=parseFloat(e.totalbillamount||0),r[t].count++});const i={};return n.forEach(e=>{const t=e.paidby||"Unknown";i[t]||(i[t]={collector:t,amount:0,count:0}),i[t].amount+=parseFloat(e.totalbillamount||0),i[t].count++}),{success:!0,data:{totalCollected:a,collectionCount:n.length,byDate:Object.values(r),byCollector:Object.values(i).sort((e,t)=>t.amount-e.amount)}}}catch(n){return console.error("Error getting collection report:",n),{success:!1,error:n.message}}},async getTopConsumers(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{const{data:s,error:a}=await Hs.from("bills").select("customerid, customername, consumption, barangay").gte("billedmonth",e).lte("billedmonth",t).range(0,999999);if(a)throw a;const r={};s.forEach(e=>{const t=e.customerid;r[t]||(r[t]={customerid:t,customername:e.customername,barangay:e.barangay,totalConsumption:0,billCount:0}),r[t].totalConsumption+=parseFloat(e.consumption||0),r[t].billCount++});return{success:!0,data:Object.values(r).sort((e,t)=>t.totalConsumption-e.totalConsumption).slice(0,n)}}catch(s){return console.error("Error getting top consumers:",s),{success:!1,error:s.message}}}},ga=()=>{const[e,t]=(0,a.useState)("water"),[n,s]=(0,a.useState)(""),[r,i]=(0,a.useState)(""),[l,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(""),[u,h]=(0,a.useState)(null),[m,f]=(0,a.useState)(null),[p,g]=(0,a.useState)(null),[v,y]=(0,a.useState)([]);(0,a.useEffect)(()=>{const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),n=new Date(e.getFullYear(),e.getMonth()+1,0);s(t.toISOString().split("T")[0]),i(n.toISOString().split("T")[0])},[]),(0,a.useEffect)(()=>{n&&r&&b()},[n,r]);const b=async()=>{o(!0),d("");try{const[e,t,s,a]=await Promise.all([pa.getWaterUsageReport(n,r),pa.getRevenueReport(n,r),pa.getCollectionReport(n,r),pa.getTopConsumers(n,r,10)]);e.success&&h(e.data),t.success&&f(t.data),s.success&&g(s.data),a.success&&y(a.data),e.success&&t.success&&s.success||d("Some reports failed to load")}catch(e){d("Failed to load reports")}o(!1)},x=e=>"\u20b1".concat(parseFloat(e||0).toLocaleString("en-PH",{minimumFractionDigits:2})),j=e=>parseFloat(e||0).toLocaleString("en-PH",{minimumFractionDigits:2}),w=e=>new Date(e).toLocaleDateString("en-PH",{year:"numeric",month:"long"}),N=(e,t)=>{const s=e.map(e=>Object.values(e).join(",")).join("\n"),a=new Blob([s],{type:"text/csv"}),i=window.URL.createObjectURL(a),l=document.createElement("a");l.href=i,l.download="".concat(t,"_").concat(n,"_").concat(r,".csv"),l.click(),window.URL.revokeObjectURL(i)};return(0,Js.jsxs)("div",{className:"reports-page",style:{padding:"0"},children:[(0,Js.jsxs)("div",{className:"level mb-3",children:[(0,Js.jsx)("div",{className:"level-left",children:(0,Js.jsx)("div",{className:"level-item",children:(0,Js.jsxs)("h1",{className:"title is-4 mb-0",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-chart-bar"})}),"Reports & Analytics"]})})}),(0,Js.jsx)("div",{className:"level-right",children:(0,Js.jsx)("div",{className:"level-item",children:(0,Js.jsxs)("button",{className:"button is-info",onClick:b,disabled:l,children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-sync"})}),(0,Js.jsx)("span",{children:"Refresh"})]})})})]}),c&&(0,Js.jsxs)("div",{className:"notification is-danger is-light py-3",children:[(0,Js.jsx)("button",{className:"delete",onClick:()=>d("")}),c]}),(0,Js.jsx)("div",{className:"box",style:{marginBottom:"1rem",padding:"1.5rem"},children:(0,Js.jsxs)("div",{className:"columns",children:[(0,Js.jsx)("div",{className:"column is-4",children:(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Start Date"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"date",value:n,onChange:e=>s(e.target.value)})})]})}),(0,Js.jsx)("div",{className:"column is-4",children:(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"End Date"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"date",value:r,onChange:e=>i(e.target.value)})})]})}),(0,Js.jsx)("div",{className:"column is-4",children:(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"\xa0"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsxs)("div",{className:"buttons",children:[(0,Js.jsx)("button",{className:"button is-light is-small",onClick:()=>{const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),n=new Date(e.getFullYear(),e.getMonth()+1,0);s(t.toISOString().split("T")[0]),i(n.toISOString().split("T")[0])},children:"This Month"}),(0,Js.jsx)("button",{className:"button is-light is-small",onClick:()=>{const e=new Date,t=new Date(e.getFullYear(),0,1),n=new Date(e.getFullYear(),11,31);s(t.toISOString().split("T")[0]),i(n.toISOString().split("T")[0])},children:"This Year"})]})})]})})]})}),(0,Js.jsx)("div",{className:"tabs is-boxed",children:(0,Js.jsxs)("ul",{children:[(0,Js.jsx)("li",{className:"water"===e?"is-active":"",children:(0,Js.jsxs)("a",{onClick:()=>t("water"),children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-tint"})}),(0,Js.jsx)("span",{children:"Water Usage"})]})}),(0,Js.jsx)("li",{className:"revenue"===e?"is-active":"",children:(0,Js.jsxs)("a",{onClick:()=>t("revenue"),children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-dollar-sign"})}),(0,Js.jsx)("span",{children:"Revenue"})]})}),(0,Js.jsx)("li",{className:"collections"===e?"is-active":"",children:(0,Js.jsxs)("a",{onClick:()=>t("collections"),children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-hand-holding-usd"})}),(0,Js.jsx)("span",{children:"Collections"})]})})]})}),l?(0,Js.jsxs)("div",{className:"has-text-centered",style:{padding:"3rem"},children:[(0,Js.jsx)("button",{className:"button is-loading is-large is-ghost"}),(0,Js.jsx)("p",{className:"has-text-grey mt-3",children:"Loading reports..."})]}):(0,Js.jsxs)(Js.Fragment,{children:["water"===e&&u&&(0,Js.jsxs)("div",{children:[(0,Js.jsxs)("div",{className:"columns mb-3",children:[(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-info-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Total Consumption"}),(0,Js.jsxs)("p",{className:"title is-4",children:[j(u.totalConsumption)," cu.m"]})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-success-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Average Consumption"}),(0,Js.jsxs)("p",{className:"title is-4",children:[j(u.averageConsumption)," cu.m"]})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-warning-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Total Bills"}),(0,Js.jsx)("p",{className:"title is-4",children:u.billCount.toLocaleString()})]})})]}),(0,Js.jsxs)("div",{className:"box",style:{marginBottom:"1rem"},children:[(0,Js.jsxs)("div",{className:"level",children:[(0,Js.jsx)("div",{className:"level-left",children:(0,Js.jsx)("h2",{className:"title is-5 mb-3",children:"Monthly Consumption"})}),(0,Js.jsx)("div",{className:"level-right",children:(0,Js.jsxs)("button",{className:"button is-small is-info",onClick:()=>N(u.byMonth,"monthly_consumption"),children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-download"})}),(0,Js.jsx)("span",{children:"Export"})]})})]}),(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"Month"}),(0,Js.jsx)("th",{children:"Total Consumption"}),(0,Js.jsx)("th",{children:"Bill Count"}),(0,Js.jsx)("th",{children:"Average"})]})}),(0,Js.jsx)("tbody",{children:u.byMonth.map(e=>(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{children:w(e.month)}),(0,Js.jsxs)("td",{className:"has-text-weight-bold",children:[j(e.consumption)," cu.m"]}),(0,Js.jsx)("td",{children:e.count.toLocaleString()}),(0,Js.jsxs)("td",{children:[j(e.consumption/e.count)," cu.m"]})]},e.month))})]})})]}),(0,Js.jsxs)("div",{className:"box",style:{marginBottom:"1rem"},children:[(0,Js.jsx)("h2",{className:"title is-5 mb-3",children:"Consumption by Barangay"}),(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"Barangay"}),(0,Js.jsx)("th",{children:"Total Consumption"}),(0,Js.jsx)("th",{children:"Customer Count"}),(0,Js.jsx)("th",{children:"Average per Customer"})]})}),(0,Js.jsx)("tbody",{children:u.byBarangay.map(e=>(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{className:"has-text-weight-bold",children:e.barangay}),(0,Js.jsxs)("td",{children:[j(e.consumption)," cu.m"]}),(0,Js.jsx)("td",{children:e.count.toLocaleString()}),(0,Js.jsxs)("td",{children:[j(e.consumption/e.count)," cu.m"]})]},e.barangay))})]})})]}),(0,Js.jsxs)("div",{className:"box",children:[(0,Js.jsx)("h2",{className:"title is-5 mb-3",children:"Top 10 Consumers"}),(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"#"}),(0,Js.jsx)("th",{children:"Customer ID"}),(0,Js.jsx)("th",{children:"Customer Name"}),(0,Js.jsx)("th",{children:"Barangay"}),(0,Js.jsx)("th",{children:"Total Consumption"}),(0,Js.jsx)("th",{children:"Average per Bill"})]})}),(0,Js.jsx)("tbody",{children:v.map((e,t)=>(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{className:"has-text-weight-bold",children:t+1}),(0,Js.jsx)("td",{children:e.customerid}),(0,Js.jsx)("td",{children:e.customername}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag is-light",children:e.barangay})}),(0,Js.jsxs)("td",{className:"has-text-weight-bold has-text-danger",children:[j(e.totalConsumption)," cu.m"]}),(0,Js.jsxs)("td",{children:[j(e.totalConsumption/e.billCount)," cu.m"]})]},e.customerid))})]})})]})]}),"revenue"===e&&m&&(0,Js.jsxs)("div",{children:[(0,Js.jsxs)("div",{className:"columns mb-3",children:[(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-info-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Total Billed"}),(0,Js.jsx)("p",{className:"title is-4",children:x(m.totalBilled)})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-success-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Total Paid"}),(0,Js.jsx)("p",{className:"title is-4",children:x(m.totalPaid)})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-danger-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Total Unpaid"}),(0,Js.jsx)("p",{className:"title is-4",children:x(m.totalUnpaid)})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-primary-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Collection Rate"}),(0,Js.jsxs)("p",{className:"title is-4",children:[m.collectionRate.toFixed(1),"%"]})]})})]}),(0,Js.jsxs)("div",{className:"columns mb-3",children:[(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-warning-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Total Surcharges"}),(0,Js.jsx)("p",{className:"title is-5",children:x(m.totalSurcharge)})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-success-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Total Discounts"}),(0,Js.jsx)("p",{className:"title is-5",children:x(m.totalDiscount)})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-info-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Paid Bills"}),(0,Js.jsx)("p",{className:"title is-5",children:m.paidCount.toLocaleString()})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-danger-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Unpaid Bills"}),(0,Js.jsx)("p",{className:"title is-5",children:m.unpaidCount.toLocaleString()})]})})]}),(0,Js.jsxs)("div",{className:"box",style:{marginBottom:"1rem"},children:[(0,Js.jsxs)("div",{className:"level",children:[(0,Js.jsx)("div",{className:"level-left",children:(0,Js.jsx)("h2",{className:"title is-5 mb-3",children:"Monthly Revenue"})}),(0,Js.jsx)("div",{className:"level-right",children:(0,Js.jsxs)("button",{className:"button is-small is-info",onClick:()=>N(m.byMonth,"monthly_revenue"),children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-download"})}),(0,Js.jsx)("span",{children:"Export"})]})})]}),(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"Month"}),(0,Js.jsx)("th",{children:"Billed Amount"}),(0,Js.jsx)("th",{children:"Paid Amount"}),(0,Js.jsx)("th",{children:"Unpaid Amount"}),(0,Js.jsx)("th",{children:"Collection %"})]})}),(0,Js.jsx)("tbody",{children:m.byMonth.map(e=>(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{children:w(e.month)}),(0,Js.jsx)("td",{children:x(e.billed)}),(0,Js.jsx)("td",{className:"has-text-success has-text-weight-bold",children:x(e.paid)}),(0,Js.jsx)("td",{className:"has-text-danger has-text-weight-bold",children:x(e.unpaid)}),(0,Js.jsxs)("td",{children:[e.billed>0?(e.paid/e.billed*100).toFixed(1):0,"%"]})]},e.month))})]})})]}),(0,Js.jsxs)("div",{className:"box",children:[(0,Js.jsx)("h2",{className:"title is-5 mb-3",children:"Revenue by Barangay"}),(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"Barangay"}),(0,Js.jsx)("th",{children:"Bills"}),(0,Js.jsx)("th",{children:"Billed Amount"}),(0,Js.jsx)("th",{children:"Paid Amount"}),(0,Js.jsx)("th",{children:"Unpaid Amount"}),(0,Js.jsx)("th",{children:"Collection %"})]})}),(0,Js.jsx)("tbody",{children:m.byBarangay.map(e=>(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{className:"has-text-weight-bold",children:e.barangay}),(0,Js.jsx)("td",{children:e.billCount.toLocaleString()}),(0,Js.jsx)("td",{children:x(e.billed)}),(0,Js.jsx)("td",{className:"has-text-success",children:x(e.paid)}),(0,Js.jsx)("td",{className:"has-text-danger",children:x(e.unpaid)}),(0,Js.jsxs)("td",{children:[e.billed>0?(e.paid/e.billed*100).toFixed(1):0,"%"]})]},e.barangay))})]})})]})]}),"collections"===e&&p&&(0,Js.jsxs)("div",{children:[(0,Js.jsxs)("div",{className:"columns mb-3",children:[(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-success-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Total Collected"}),(0,Js.jsx)("p",{className:"title is-4",children:x(p.totalCollected)})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-info-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Collection Count"}),(0,Js.jsx)("p",{className:"title is-4",children:p.collectionCount.toLocaleString()})]})}),(0,Js.jsx)("div",{className:"column",children:(0,Js.jsxs)("div",{className:"box has-background-primary-light",children:[(0,Js.jsx)("p",{className:"heading",children:"Average per Collection"}),(0,Js.jsx)("p",{className:"title is-4",children:x(p.totalCollected/p.collectionCount)})]})})]}),(0,Js.jsxs)("div",{className:"box",style:{marginBottom:"1rem"},children:[(0,Js.jsxs)("div",{className:"level",children:[(0,Js.jsx)("div",{className:"level-left",children:(0,Js.jsx)("h2",{className:"title is-5 mb-3",children:"Daily Collections"})}),(0,Js.jsx)("div",{className:"level-right",children:(0,Js.jsxs)("button",{className:"button is-small is-info",onClick:()=>N(p.byDate,"daily_collections"),children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-download"})}),(0,Js.jsx)("span",{children:"Export"})]})})]}),(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"Date"}),(0,Js.jsx)("th",{children:"Amount Collected"}),(0,Js.jsx)("th",{children:"Collection Count"}),(0,Js.jsx)("th",{children:"Average"})]})}),(0,Js.jsx)("tbody",{children:p.byDate.map(e=>(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{children:new Date(e.date).toLocaleDateString("en-PH")}),(0,Js.jsx)("td",{className:"has-text-weight-bold has-text-success",children:x(e.amount)}),(0,Js.jsx)("td",{children:e.count.toLocaleString()}),(0,Js.jsx)("td",{children:x(e.amount/e.count)})]},e.date))})]})})]}),(0,Js.jsxs)("div",{className:"box",children:[(0,Js.jsx)("h2",{className:"title is-5 mb-3",children:"Collections by Collector"}),(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"Collector"}),(0,Js.jsx)("th",{children:"Amount Collected"}),(0,Js.jsx)("th",{children:"Collection Count"}),(0,Js.jsx)("th",{children:"Average per Collection"})]})}),(0,Js.jsx)("tbody",{children:p.byCollector.map(e=>(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{className:"has-text-weight-bold",children:e.collector}),(0,Js.jsx)("td",{className:"has-text-success has-text-weight-bold",children:x(e.amount)}),(0,Js.jsx)("td",{children:e.count.toLocaleString()}),(0,Js.jsx)("td",{children:x(e.amount/e.count)})]},e.collector))})]})})]})]})]})]})},va={async getAllUsers(){try{const{data:e,error:t}=await Hs.from("users").select("*").order("firstname",{ascending:!0}).limit(1e4);if(t)throw t;return{success:!0,data:e||[]}}catch(e){return console.error("Error getting users:",e),{success:!1,error:e.message,data:[]}}},async searchUsers(e){try{const{data:t,error:n}=await Hs.from("users").select("*").or("firstname.ilike.%".concat(e,"%,lastname.ilike.%").concat(e,"%")).order("firstname",{ascending:!0}).limit(1e4);if(n)throw n;return{success:!0,data:t||[]}}catch(t){return console.error("Error searching users:",t),{success:!1,error:t.message,data:[]}}},async addUser(e){try{const t={userid:crypto.randomUUID(),firstname:e.firstname,lastname:e.lastname,email:e.email,password:"admin",department:e.department,position:e.position,role:e.role,status:e.status||"Active"},{data:n,error:s}=await Hs.from("users").insert([t]).select();if(s)throw s;return{success:!0,data:n[0]}}catch(t){return console.error("Error adding user:",t),{success:!1,error:t.message}}},async updateUser(e,t){try{const n={firstname:t.firstname,lastname:t.lastname,department:t.department,position:t.position,role:t.role,status:t.status},{data:s,error:a}=await Hs.from("users").update(n).eq("userid",e).select();if(a)throw a;return{success:!0,data:s[0]}}catch(n){return console.error("Error updating user:",n),{success:!1,error:n.message}}},async deleteUser(e){try{const{error:t}=await Hs.from("users").delete().eq("userid",e);if(t)throw t;return{success:!0}}catch(t){return console.error("Error deleting user:",t),{success:!1,error:t.message}}},async getUserById(e){try{const{data:t,error:n}=await Hs.from("users").select("*").eq("userid",e).single();if(n)throw n;return{success:!0,data:t}}catch(t){return console.error("Error getting user:",t),{success:!1,error:t.message}}}},ya=()=>{const[e,t]=(0,a.useState)([]),[n,s]=(0,a.useState)([]),[r,i]=(0,a.useState)(""),[l,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(""),[u,h]=(0,a.useState)(""),[m,f]=(0,a.useState)(!1),[p,g]=(0,a.useState)("add"),[v,y]=(0,a.useState)(null),[b,x]=(0,a.useState)({firstname:"",lastname:"",email:"",department:"",position:"",role:"Reader",status:"Active"}),[j,w]=(0,a.useState)(!1),[N,S]=(0,a.useState)(null);(0,a.useEffect)(()=>{k()},[]),(0,a.useEffect)(()=>{C()},[r,e]);const k=async()=>{o(!0);const e=await va.getAllUsers();e.success?(t(e.data),s(e.data)):d(e.error),o(!1)},C=()=>{if(!r.trim())return void s(e);const t=e.filter(e=>"".concat(e.firstname," ").concat(e.lastname).toLowerCase().includes(r.toLowerCase())||e.firstname.toLowerCase().includes(r.toLowerCase())||e.lastname.toLowerCase().includes(r.toLowerCase()));s(t)},_=async()=>{if(!r.trim())return void s(e);o(!0);const t=await va.searchUsers(r);t.success?s(t.data):d(t.error),o(!1)},E=()=>{f(!1),y(null),x({firstname:"",lastname:"",email:"",department:"",position:"",role:"Reader",status:"Active"})},T=(e,t)=>{x(n=>ea(ea({},n),{},{[e]:t}))},P=()=>{S(null),w(!1)},O=e=>{switch(e){case"Admin":return"is-danger";case"Manager":return"is-warning";case"Collector":return"is-info";default:return"is-light"}};return(0,Js.jsxs)("div",{className:"users-page",style:{padding:"0"},children:[(0,Js.jsxs)("div",{className:"level mb-3",children:[(0,Js.jsx)("div",{className:"level-left",children:(0,Js.jsx)("div",{className:"level-item",children:(0,Js.jsxs)("h1",{className:"title is-4 mb-0",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-users"})}),"User Management"]})})}),(0,Js.jsx)("div",{className:"level-right",children:(0,Js.jsx)("div",{className:"level-item",children:(0,Js.jsxs)("button",{className:"button is-primary",onClick:()=>{g("add"),y(null),x({firstname:"",lastname:"",email:"",department:"",position:"",role:"Reader",status:"Active"}),f(!0)},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-user-plus"})}),(0,Js.jsx)("span",{children:"Add User"})]})})})]}),c&&(0,Js.jsxs)("div",{className:"notification is-danger is-light py-3",children:[(0,Js.jsx)("button",{className:"delete",onClick:()=>d("")}),c]}),u&&(0,Js.jsxs)("div",{className:"notification is-success is-light py-3",children:[(0,Js.jsx)("button",{className:"delete",onClick:()=>h("")}),u]}),(0,Js.jsx)("div",{className:"box",style:{marginBottom:"1rem",padding:"1.5rem"},children:(0,Js.jsxs)("div",{className:"field has-addons",children:[(0,Js.jsx)("div",{className:"control is-expanded",children:(0,Js.jsx)("input",{className:"input",type:"text",placeholder:"Search by first name or last name...",value:r,onChange:e=>i(e.target.value),onKeyPress:e=>"Enter"===e.key&&_()})}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsxs)("button",{className:"button is-primary ".concat(l?"is-loading":""),onClick:_,children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-search"})}),(0,Js.jsx)("span",{children:"Search"})]})})]})}),(0,Js.jsx)("div",{className:"box",style:{padding:"0"},children:l&&0===n.length?(0,Js.jsx)("div",{className:"has-text-centered",style:{padding:"3rem"},children:(0,Js.jsx)("button",{className:"button is-loading is-large is-ghost"})}):0===n.length?(0,Js.jsxs)("div",{className:"has-text-centered",style:{padding:"3rem"},children:[(0,Js.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Js.jsx)("i",{className:"fas fa-users fa-3x"})}),(0,Js.jsx)("p",{className:"has-text-grey mt-4",children:"No users found"})]}):(0,Js.jsx)("div",{className:"table-container",children:(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"Name"}),(0,Js.jsx)("th",{children:"Email"}),(0,Js.jsx)("th",{children:"Role"}),(0,Js.jsx)("th",{children:"Department"}),(0,Js.jsx)("th",{children:"Position"}),(0,Js.jsx)("th",{children:"Status"}),(0,Js.jsx)("th",{width:"150",children:"Actions"})]})}),(0,Js.jsx)("tbody",{children:n.map(e=>{return(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{children:(0,Js.jsxs)("strong",{children:[e.firstname," ",e.lastname]})}),(0,Js.jsx)("td",{children:e.email}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag ".concat(O(e.role)),children:e.role})}),(0,Js.jsx)("td",{children:e.department||"-"}),(0,Js.jsx)("td",{children:e.position||"-"}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag ".concat((t=e.status,"Active"===t?"is-success":"is-danger")),children:e.status})}),(0,Js.jsx)("td",{children:(0,Js.jsxs)("div",{className:"buttons are-small",children:[(0,Js.jsx)("button",{className:"button is-info is-small",onClick:()=>(e=>{g("edit"),y(e),x({firstname:e.firstname,lastname:e.lastname,email:e.email,department:e.department||"",position:e.position||"",role:e.role,status:e.status}),f(!0)})(e),title:"Edit User",children:(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-edit"})})}),(0,Js.jsx)("button",{className:"button is-danger is-small",onClick:()=>(e=>{S(e),w(!0)})(e),title:"Delete User",children:(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-trash"})})})]})})]},e.userid);var t})})]})})}),m&&(0,Js.jsxs)("div",{className:"modal is-active",children:[(0,Js.jsx)("div",{className:"modal-background",onClick:E}),(0,Js.jsxs)("div",{className:"modal-card",style:{width:"600px"},children:[(0,Js.jsxs)("header",{className:"modal-card-head",children:[(0,Js.jsxs)("p",{className:"modal-card-title",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-user-".concat("add"===p?"plus":"edit")})}),"add"===p?"Add New User":"Edit User"]}),(0,Js.jsx)("button",{className:"delete","aria-label":"close",onClick:E})]}),(0,Js.jsxs)("section",{className:"modal-card-body",children:[(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsxs)("label",{className:"label",children:["First Name ",(0,Js.jsx)("span",{className:"has-text-danger",children:"*"})]}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",placeholder:"Enter first name",value:b.firstname,onChange:e=>T("firstname",e.target.value)})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsxs)("label",{className:"label",children:["Last Name ",(0,Js.jsx)("span",{className:"has-text-danger",children:"*"})]}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",placeholder:"Enter last name",value:b.lastname,onChange:e=>T("lastname",e.target.value)})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsxs)("label",{className:"label",children:["Email ",(0,Js.jsx)("span",{className:"has-text-danger",children:"*"})]}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"email",placeholder:"Enter email",value:b.email,onChange:e=>T("email",e.target.value),disabled:"edit"===p})}),"edit"===p&&(0,Js.jsx)("p",{className:"help",children:"Email cannot be edited"})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Department"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",placeholder:"Enter department",value:b.department,onChange:e=>T("department",e.target.value)})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Position"}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"text",placeholder:"Enter position",value:b.position,onChange:e=>T("position",e.target.value)})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsxs)("label",{className:"label",children:["Role ",(0,Js.jsx)("span",{className:"has-text-danger",children:"*"})]}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:b.role,onChange:e=>T("role",e.target.value),children:[(0,Js.jsx)("option",{value:"Admin",children:"Admin"}),(0,Js.jsx)("option",{value:"Manager",children:"Manager"}),(0,Js.jsx)("option",{value:"Collector",children:"Collector"}),(0,Js.jsx)("option",{value:"Reader",children:"Reader"})]})})})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsxs)("label",{className:"label",children:["Status ",(0,Js.jsx)("span",{className:"has-text-danger",children:"*"})]}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:b.status,onChange:e=>T("status",e.target.value),children:[(0,Js.jsx)("option",{value:"Active",children:"Active"}),(0,Js.jsx)("option",{value:"Inactive",children:"Inactive"})]})})})]}),"add"===p&&(0,Js.jsx)("div",{className:"notification is-info is-light",children:(0,Js.jsxs)("p",{className:"is-size-7",children:[(0,Js.jsx)("strong",{children:"Note:"})," Default password will be set to ",(0,Js.jsx)("strong",{children:'"admin"'})]})})]}),(0,Js.jsxs)("footer",{className:"modal-card-foot",children:[(0,Js.jsxs)("button",{className:"button is-success ".concat(l?"is-loading":""),onClick:async()=>{if(!b.firstname.trim()||!b.lastname.trim()||!b.email.trim())return void d("Please fill in all required fields (First Name, Last Name, Email)");let e;o(!0),d(""),e="add"===p?await va.addUser(b):await va.updateUser(v.userid,b),e.success?(h("User ".concat("add"===p?"added":"updated"," successfully!")),E(),k(),setTimeout(()=>h(""),3e3)):d(e.error),o(!1)},disabled:l,children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-save"})}),(0,Js.jsx)("span",{children:"add"===p?"Add User":"Save Changes"})]}),(0,Js.jsx)("button",{className:"button",onClick:E,children:"Cancel"})]})]})]}),(0,Js.jsx)(ca,{isOpen:j&&null!==N,onClose:P,onConfirm:async()=>{if(!N)return;o(!0);const e=await va.deleteUser(N.userid);e.success?(h("User deleted successfully!"),P(),k(),setTimeout(()=>h(""),3e3)):d(e.error),o(!1)},title:"Confirm Delete",message:N?"Are you sure you want to delete user ".concat(N.firstname," ").concat(N.lastname,"?"):"",subMessage:"This action cannot be undone.",confirmText:"Delete User",cancelText:"Cancel",type:"danger",loading:l})]})},ba=()=>{const[e,t]=(0,a.useState)("rpt-calculator"),[n,s]=(0,a.useState)(""),[r,i]=(0,a.useState)([]),[l,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(""),[u,h]=(0,a.useState)("all"),[m,f]=(0,a.useState)("all"),[p,g]=(0,a.useState)("all"),[v,y]=(0,a.useState)([]),[b,x]=(0,a.useState)([]),[j,w]=(0,a.useState)([]),[N,S]=(0,a.useState)(!1),[k,C]=(0,a.useState)(""),[_,E]=(0,a.useState)("all"),[T,P]=(0,a.useState)("all"),[O,R]=(0,a.useState)("all"),[A,I]=(0,a.useState)(null),[L,D]=(0,a.useState)(null),[B,U]=(0,a.useState)(!1),[F,z]=(0,a.useState)(""),[M,W]=(0,a.useState)("200");(0,a.useEffect)(()=>{const e=new Date,t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0");s("".concat(t,"-").concat(n))},[]),(0,a.useEffect)(()=>{"generate-reading-sheets"!==e&&"generate-notice"!==e||V()},[e]),(0,a.useEffect)(()=>{"generate-notice"===e&&(q(),H())},[e]),(0,a.useEffect)(()=>{"generate-notice"===e&&A&&$()},[A,e]);const q=async()=>{const e=await aa.getSurchargeSettings();e.success&&I(e.data)},H=async()=>{try{const{data:e,error:t}=await Hs.from("users").select("firstname, lastname, position, status").ilike("position","%Municipal Treasurer%").limit(10);if(t)return void console.error("Error loading Municipal Treasurer:",t);if(e&&e.length>0){const t=e.find(e=>{var t;return"active"===(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())})||e[0];D(t),console.log("Municipal Treasurer loaded:",t)}else console.log("No Municipal Treasurer found in users table")}catch(e){console.error("Error loading Municipal Treasurer:",e)}};(0,a.useEffect)(()=>{"generate-reading-sheets"===e&&n&&K()},[n,e]);const V=async()=>{try{const[e,t]=await Promise.all([ta.getBarangays(),ta.getCustomerTypes()]);e.success&&y(e.data||[]),t.success&&x(t.data||[])}catch(e){console.error("Error loading filter options:",e)}},K=async()=>{if(n){o(!0);try{const e=await sa.getBillsByMonth(n);e.success&&i(e.data||[])}catch(e){console.error("Error loading reading data:",e)}o(!1)}},$=async()=>{S(!0);try{const e=await sa.getCustomersWithUnpaidBills();if(e.success&&A){const t=(e.data||[]).map(e=>{const t=e.unpaidBills||[];let n=0,s=0;return t.forEach(e=>{const t=parseFloat(e.basicamount||0);n+=t;const a=aa.calculateSurcharge(e,A);s+=a.surchargeAmount}),ea(ea({},e),{},{totalBasicAmount:n,totalSurcharge:s,totalBilledAmount:n+s})});w(t)}else e.success&&w(e.data||[])}catch(e){console.error("Error loading customers with unpaid bills:",e)}S(!1)},J=()=>{H(),$()},G=r.filter(e=>{var t,n,s,a;const r=!c||(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(c.toLowerCase()))||String(e.customerid).includes(c),i="all"===u||(null===(n=e.barangay)||void 0===n?void 0:n.toLowerCase())===u.toLowerCase(),l="all"===m||(null===(s=e.type)||void 0===s?void 0:s.toLowerCase())===m.toLowerCase(),o="all"===p||(null===(a=e.status)||void 0===a?void 0:a.toLowerCase())===p.toLowerCase();return r&&i&&l&&o}),Q=j.filter(e=>{var t,n,s,a,r;const i=!k||(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(k.toLowerCase()))||String(e.customerid).includes(k)||(null===(n=e.barangay)||void 0===n?void 0:n.toLowerCase().includes(k.toLowerCase())),l="all"===_||(null===(s=e.barangay)||void 0===s?void 0:s.toLowerCase())===_.toLowerCase(),o="all"===T||(null===(a=e.type)||void 0===a?void 0:a.toLowerCase())===T.toLowerCase(),c="all"===O||(null===(r=e.status)||void 0===r?void 0:r.toLowerCase())===O.toLowerCase();return i&&l&&o&&c}),Y=()=>{0!==Q.length?U(!0):alert("No customers to generate notices for.")},X=e=>{const t=e=>{if(!e)return"";let t;if(e.includes("-")){t=2===e.split("-").length?new Date(e+"-01"):new Date(e)}else t=new Date(e);return isNaN(t.getTime())?e:t.toLocaleDateString("en-US",{month:"long",year:"numeric"})};if(e&&e.includes(" to ")){const[n,s]=e.split(" to ");return"".concat(t(n.trim())," to ").concat(t(s.trim()))}return t(e)},Z=()=>{const e=[["Customer ID","Name","Type","Barangay","Status","Previous Reading","Current Reading","Consumption","Billed Month"].join(","),...G.map(e=>[e.customerid,'"'.concat(e.name||"",'"'),'"'.concat(e.type||"",'"'),'"'.concat(e.barangay||"",'"'),'"'.concat(e.status||"",'"'),e.previousreading||0,e.currentreading||0,e.consumption||0,e.billedmonth||""].join(","))].join("\n"),t=new Blob([e],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),a=URL.createObjectURL(t);s.setAttribute("href",a),s.setAttribute("download","reading_sheets_".concat(n,".csv")),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)};return(0,Js.jsxs)("div",{children:[(0,Js.jsx)("div",{className:"level",children:(0,Js.jsx)("div",{className:"level-left",children:(0,Js.jsx)("div",{className:"level-item",children:(0,Js.jsx)("h1",{className:"title",children:"System Tools & Utilities"})})})}),(0,Js.jsx)("div",{className:"tabs is-boxed",children:(0,Js.jsx)("ul",{children:[{id:"rpt-calculator",name:"RPT Calculator",icon:"fas fa-calculator"},{id:"generate-notice",name:"Generate Notice",icon:"fas fa-file-invoice"},{id:"generate-reading-sheets",name:"Generate Reading Sheets",icon:"fas fa-file-alt"}].map(n=>(0,Js.jsx)("li",{className:e===n.id?"is-active":"",children:(0,Js.jsxs)("a",{onClick:()=>t(n.id),children:[(0,Js.jsx)("span",{className:"icon is-small",children:(0,Js.jsx)("i",{className:n.icon})}),(0,Js.jsx)("span",{children:n.name})]})},n.id))})}),(()=>{switch(e){case"rpt-calculator":return(0,Js.jsx)("div",{className:"card",children:(0,Js.jsx)("div",{className:"card-content",children:(0,Js.jsx)("div",{className:"iframe-container",children:(0,Js.jsx)("iframe",{src:"https://script.google.com/macros/s/AKfycbzdhU6lDW5kd9w28hE3inteCV1zdz_VLUOOD_RAWwUlyIyNCTsoMfklGIbOKsf5TX96qg/exec",title:"RPT Calculator",className:"responsive-iframe",frameBorder:"0",allowFullScreen:!0})})})});case"generate-notice":return(0,Js.jsxs)("div",{className:"customers-page",children:[(0,Js.jsx)("div",{className:"compact-header",children:(0,Js.jsxs)("div",{className:"header-row",children:[(0,Js.jsxs)("div",{className:"title-section",children:[(0,Js.jsx)("h1",{className:"page-title",children:"Generate Notice"}),(0,Js.jsxs)("div",{className:"stats-inline",children:[(0,Js.jsxs)("span",{className:"stat-item",children:[(0,Js.jsx)("i",{className:"fas fa-users"}),(0,Js.jsx)("strong",{children:Q.length})," Customers"]}),(0,Js.jsxs)("span",{className:"stat-item",children:[(0,Js.jsx)("i",{className:"fas fa-exclamation-circle"}),(0,Js.jsx)("strong",{children:Q.reduce((e,t)=>e+t.billCount,0)})," Unpaid Bills"]})]})]}),(0,Js.jsxs)("div",{className:"header-actions",children:[(0,Js.jsxs)("button",{className:"button is-danger",onClick:Y,disabled:N||0===Q.length,title:"Generate disconnection notices for filtered customers",children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-print"})}),(0,Js.jsx)("span",{children:"Generate Notices"})]}),(0,Js.jsxs)("button",{className:"button is-info",onClick:J,disabled:N,children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-sync-alt"})}),(0,Js.jsx)("span",{children:"Refresh"})]})]})]})}),(0,Js.jsx)("div",{className:"compact-filters",children:(0,Js.jsxs)("div",{className:"filter-row",style:{display:"flex",gap:"0.75rem",flexWrap:"nowrap"},children:[(0,Js.jsx)("div",{style:{flex:"1",minWidth:"200px"},children:(0,Js.jsxs)("div",{className:"control has-icons-left",children:[(0,Js.jsx)("input",{className:"input",type:"text",placeholder:"Search customer...",value:k,onChange:e=>C(e.target.value)}),(0,Js.jsx)("span",{className:"icon is-left",children:(0,Js.jsx)("i",{className:"fas fa-search"})})]})}),(0,Js.jsx)("div",{className:"select",style:{minWidth:"150px"},children:(0,Js.jsxs)("select",{value:_,onChange:e=>E(e.target.value),children:[(0,Js.jsx)("option",{value:"all",children:"All Barangays"}),v.map(e=>(0,Js.jsx)("option",{value:e.barangay,children:e.barangay},e.barangay))]})}),(0,Js.jsx)("div",{className:"select",style:{minWidth:"150px"},children:(0,Js.jsxs)("select",{value:T,onChange:e=>P(e.target.value),children:[(0,Js.jsx)("option",{value:"all",children:"All Types"}),b.map(e=>(0,Js.jsx)("option",{value:e.type,children:e.type},e.type))]})}),(0,Js.jsx)("div",{className:"select",style:{minWidth:"130px"},children:(0,Js.jsxs)("select",{value:O,onChange:e=>R(e.target.value),children:[(0,Js.jsx)("option",{value:"all",children:"All Status"}),(0,Js.jsx)("option",{value:"Active",children:"Active"}),(0,Js.jsx)("option",{value:"Inactive",children:"Inactive"}),(0,Js.jsx)("option",{value:"Disconnected",children:"Disconnected"})]})})]})}),(0,Js.jsx)("div",{className:"table-container",children:N?(0,Js.jsxs)("div",{className:"has-text-centered",style:{padding:"3rem"},children:[(0,Js.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Js.jsx)("i",{className:"fas fa-spinner fa-pulse fa-3x"})}),(0,Js.jsx)("p",{className:"subtitle has-text-grey mt-4",children:"Loading customers with unpaid bills..."})]}):0===Q.length?(0,Js.jsxs)("div",{className:"has-text-centered",style:{padding:"3rem"},children:[(0,Js.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Js.jsx)("i",{className:"fas fa-check-circle fa-3x"})}),(0,Js.jsx)("p",{className:"subtitle has-text-grey mt-4",children:0===j.length?"No customers with unpaid bills found!":"No customers match your search criteria"})]}):(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"Customer ID"}),(0,Js.jsx)("th",{children:"Name"}),(0,Js.jsx)("th",{children:"Barangay"}),(0,Js.jsx)("th",{children:"Type"}),(0,Js.jsx)("th",{children:"Bill Period"}),(0,Js.jsx)("th",{className:"has-text-right",children:"Bills"}),(0,Js.jsx)("th",{className:"has-text-right",children:"Basic Amount"}),(0,Js.jsx)("th",{className:"has-text-right",children:"Surcharge"}),(0,Js.jsx)("th",{className:"has-text-right",children:"Total Due"})]})}),(0,Js.jsx)("tbody",{children:Q.map(e=>(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{children:e.customerid}),(0,Js.jsx)("td",{children:(0,Js.jsx)("strong",{children:e.name})}),(0,Js.jsx)("td",{children:e.barangay}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag is-light",children:e.type})}),(0,Js.jsx)("td",{className:"is-size-7",children:X(e.billScope)}),(0,Js.jsx)("td",{className:"has-text-right",children:(0,Js.jsx)("span",{className:"tag is-warning",children:e.billCount})}),(0,Js.jsxs)("td",{className:"has-text-right",children:["\u20b1",e.totalBasicAmount.toFixed(2)]}),(0,Js.jsxs)("td",{className:"has-text-right",children:["\u20b1",e.totalSurcharge.toFixed(2)]}),(0,Js.jsx)("td",{className:"has-text-right",children:(0,Js.jsxs)("strong",{children:["\u20b1",e.totalBilledAmount.toFixed(2)]})})]},e.customerid))})]})})]});case"generate-reading-sheets":return(0,Js.jsxs)("div",{className:"customers-page",children:[(0,Js.jsx)("div",{className:"compact-header",children:(0,Js.jsxs)("div",{className:"header-row",children:[(0,Js.jsxs)("div",{className:"title-section",children:[(0,Js.jsx)("h1",{className:"page-title",children:"Reading Sheets"}),(0,Js.jsxs)("div",{className:"stats-inline",children:[(0,Js.jsxs)("span",{className:"stat-item",children:[(0,Js.jsx)("i",{className:"fas fa-file-alt"}),(0,Js.jsx)("strong",{children:G.length})," Records"]}),(0,Js.jsxs)("span",{className:"stat-item",children:[(0,Js.jsx)("i",{className:"fas fa-calendar"}),(0,Js.jsx)("strong",{children:n||"N/A"})]})]})]}),(0,Js.jsx)("div",{className:"header-actions",children:(0,Js.jsxs)("button",{className:"button is-success",onClick:Z,disabled:0===G.length,children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-file-excel"})}),(0,Js.jsx)("span",{children:"Export to Excel"})]})})]})}),(0,Js.jsx)("div",{className:"compact-filters",children:(0,Js.jsxs)("div",{className:"filter-row",style:{gap:"0.75rem"},children:[(0,Js.jsx)("div",{className:"filter-group",style:{minWidth:"160px"},children:(0,Js.jsx)("input",{className:"input",type:"month",value:n,onChange:e=>s(e.target.value),title:"Select Billed Month"})}),(0,Js.jsx)("div",{className:"search-input",style:{flex:"1",minWidth:"200px"},children:(0,Js.jsxs)("div",{className:"control has-icons-left",children:[(0,Js.jsx)("input",{className:"input",type:"text",placeholder:"Search customer...",value:c,onChange:e=>d(e.target.value)}),(0,Js.jsx)("span",{className:"icon is-small is-left",children:(0,Js.jsx)("i",{className:"fas fa-search"})})]})}),(0,Js.jsx)("div",{className:"filter-group",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:u,onChange:e=>h(e.target.value),children:[(0,Js.jsx)("option",{value:"all",children:"All Barangays"}),v.map(e=>(0,Js.jsx)("option",{value:e.barangay,children:e.barangay},e.barangay))]})})}),(0,Js.jsx)("div",{className:"filter-group",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:m,onChange:e=>f(e.target.value),children:[(0,Js.jsx)("option",{value:"all",children:"All Types"}),b.map(e=>(0,Js.jsx)("option",{value:e.type,children:e.type},e.type))]})})}),(0,Js.jsx)("div",{className:"filter-group",children:(0,Js.jsx)("div",{className:"select is-fullwidth",children:(0,Js.jsxs)("select",{value:p,onChange:e=>g(e.target.value),children:[(0,Js.jsx)("option",{value:"all",children:"All Status"}),(0,Js.jsx)("option",{value:"Active",children:"Active"}),(0,Js.jsx)("option",{value:"Disconnected",children:"Disconnected"})]})})})]})}),(0,Js.jsx)("div",{className:"table-container",children:l?(0,Js.jsx)("div",{className:"loading-container",children:(0,Js.jsxs)("div",{className:"loading-message",children:[(0,Js.jsx)("div",{className:"loading-spinner"}),(0,Js.jsx)("h3",{className:"title is-5",children:"Loading Reading Sheets"}),(0,Js.jsxs)("p",{className:"has-text-grey",children:["Fetching customer reading data for ",n,"..."]})]})}):0===G.length?(0,Js.jsxs)("div",{className:"has-text-centered",style:{padding:"4rem 2rem"},children:[(0,Js.jsx)("span",{className:"icon is-large has-text-grey-light",children:(0,Js.jsx)("i",{className:"fas fa-inbox fa-3x"})}),(0,Js.jsx)("h3",{className:"title is-5 has-text-grey mt-4",children:"No reading data found"}),(0,Js.jsx)("p",{className:"has-text-grey",children:c||"all"!==u||"all"!==m||"all"!==p?"Try adjusting your search or filters.":"No bills found for the selected month."})]}):(0,Js.jsxs)("table",{className:"table is-fullwidth is-striped is-hoverable",children:[(0,Js.jsx)("thead",{children:(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("th",{children:"Customer ID"}),(0,Js.jsx)("th",{children:"Name"}),(0,Js.jsx)("th",{children:"Type"}),(0,Js.jsx)("th",{children:"Barangay"}),(0,Js.jsx)("th",{children:"Status"}),(0,Js.jsx)("th",{style:{textAlign:"right"},children:"Previous"}),(0,Js.jsx)("th",{style:{textAlign:"right"},children:"Current"}),(0,Js.jsx)("th",{style:{textAlign:"right"},children:"Consumption"})]})}),(0,Js.jsx)("tbody",{children:G.map(e=>(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{style:{fontWeight:"600",color:"#2563eb"},children:e.customerid})}),(0,Js.jsx)("td",{children:e.name}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag is-info is-light",children:e.type})}),(0,Js.jsx)("td",{children:e.barangay}),(0,Js.jsx)("td",{children:(0,Js.jsx)("span",{className:"tag ".concat("Active"===e.status?"is-success":"is-danger"),children:e.status})}),(0,Js.jsx)("td",{style:{textAlign:"right"},children:(0,Js.jsx)("span",{style:{color:"#6b7280"},children:e.previousreading||0})}),(0,Js.jsx)("td",{style:{textAlign:"right"},children:(0,Js.jsx)("strong",{style:{color:"#059669"},children:e.currentreading||0})}),(0,Js.jsx)("td",{style:{textAlign:"right"},children:(0,Js.jsx)("strong",{children:e.consumption||0})})]},e.billid||e.customerid))})]})})]});default:return null}})(),B&&(0,Js.jsxs)("div",{className:"modal is-active",children:[(0,Js.jsx)("div",{className:"modal-background",onClick:()=>U(!1)}),(0,Js.jsxs)("div",{className:"modal-card",children:[(0,Js.jsxs)("header",{className:"modal-card-head",children:[(0,Js.jsx)("p",{className:"modal-card-title",children:"Generate Disconnection Notices"}),(0,Js.jsx)("button",{className:"delete","aria-label":"close",onClick:()=>U(!1)})]}),(0,Js.jsxs)("section",{className:"modal-card-body",children:[(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsxs)("label",{className:"label",children:["Preferred Disconnection Date ",(0,Js.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("input",{className:"input",type:"date",value:F,onChange:e=>z(e.target.value),required:!0})}),(0,Js.jsx)("p",{className:"help",children:"The date when water service will be disconnected if payment is not received"})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Reconnection Fee"}),(0,Js.jsxs)("div",{className:"control has-icons-left",children:[(0,Js.jsx)("span",{className:"icon is-small is-left",children:(0,Js.jsx)("i",{className:"fas fa-peso-sign"})}),(0,Js.jsx)("input",{className:"input",type:"number",step:"0.01",min:"0",value:M,onChange:e=>W(e.target.value),placeholder:"200.00"})]}),(0,Js.jsx)("p",{className:"help",children:"Fee required for reconnection (default: \u20b1200.00)"})]}),(0,Js.jsxs)("div",{className:"notification is-info is-light",children:[(0,Js.jsx)("p",{children:(0,Js.jsx)("strong",{children:"Summary:"})}),(0,Js.jsxs)("p",{children:["\u2022 Total notices to generate: ",(0,Js.jsx)("strong",{children:Q.length})]}),(0,Js.jsxs)("p",{children:["\u2022 Disconnection date: ",(0,Js.jsx)("strong",{children:F?new Date(F).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not set"})]}),(0,Js.jsxs)("p",{children:["\u2022 Reconnection fee: ",(0,Js.jsxs)("strong",{children:["\u20b1",parseFloat(M||0).toFixed(2)]})]})]})]}),(0,Js.jsxs)("footer",{className:"modal-card-foot",children:[(0,Js.jsxs)("button",{className:"button is-danger",onClick:()=>{if(!F)return void alert("Please enter a disconnection date.");console.log("Generating notices with Municipal Treasurer:",L),console.log("Disconnection Date:",F),console.log("Reconnection Fee:",M),U(!1);const e=Q.map((e,t)=>'\n      <div class="notice-box" style="'.concat((t+1)%2===0?"page-break-after: always;":""," padding: 0.75rem; font-family: Arial, sans-serif; font-size: 12px; height: ").concat(t%2===0?"6.75in":"5.5in","; ").concat(t%2!==0?"margin-top: 0.25in;":""," box-sizing: border-box; ").concat(t%2===0?"border-bottom: 2px dashed #999;":"",'">\n        <div style="text-align: center; margin-bottom: 0.6rem;">\n          <p style="margin: 0; font-size: 11px; line-height: 1.4;">Republic of the Philippines</p>\n          <p style="margin: 0; font-size: 11px; line-height: 1.4;">Province of Romblon</p>\n          <p style="margin: 0; font-size: 11px; line-height: 1.4;">Municipality of Concepcion</p>\n          <p style="margin: 0.4rem 0 0 0; font-size: 12px; font-weight: bold; line-height: 1.4;">OFFICE OF THE MUNICIPAL TREASURER</p>\n        </div>\n        \n        <div style="text-align: center; margin-bottom: 0.75rem; border-bottom: 3px solid #dc2626; padding-bottom: 0.5rem;">\n          <h1 style="color: #dc2626; margin: 0; font-size: 18px; font-weight: bold;">\u26a0\ufe0f NOTICE OF WATER DISCONNECTION \u26a0\ufe0f</h1>\n        </div>\n\n        <div style="margin-bottom: 0.65rem; font-size: 11px;">\n          <p style="margin: 0;"><strong>Date:</strong> ').concat((new Date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),'</p>\n        </div>\n\n        <div style="display: flex; gap: 0.6rem; margin-bottom: 0.65rem;">\n          \x3c!-- Customer Information Column --\x3e\n          <div style="flex: 1; background: #fef2f2; border-left: 3px solid #dc2626; padding: 0.6rem;">\n            <h3 style="margin: 0 0 0.5rem 0; color: #991b1b; font-size: 13px; font-weight: bold;">Customer Information</h3>\n            <table style="width: 100%; border-collapse: collapse; font-size: 12px;">\n              <tr>\n                <td style="padding: 0.3rem 0; width: 40%;"><strong>ID:</strong></td>\n                <td style="padding: 0.3rem 0;">').concat(e.customerid,'</td>\n              </tr>\n              <tr>\n                <td style="padding: 0.3rem 0;"><strong>Name:</strong></td>\n                <td style="padding: 0.3rem 0;">').concat(e.name,'</td>\n              </tr>\n              <tr>\n                <td style="padding: 0.3rem 0;"><strong>Barangay:</strong></td>\n                <td style="padding: 0.3rem 0;">').concat(e.barangay,'</td>\n              </tr>\n              <tr>\n                <td style="padding: 0.3rem 0;"><strong>Type:</strong></td>\n                <td style="padding: 0.3rem 0;">').concat(e.type,'</td>\n              </tr>\n            </table>\n          </div>\n\n          \x3c!-- Outstanding Balance Column --\x3e\n          <div style="flex: 1;">\n            <h3 style="color: #991b1b; margin: 0 0 0.5rem 0; font-size: 13px; font-weight: bold;">Outstanding Balance</h3>\n            <table style="width: 100%; border-collapse: collapse; border: 1px solid #999; font-size: 12px;">\n              <tbody>\n                <tr style="background: #f9fafb;">\n                  <td style="padding: 0.45rem; border: 1px solid #999;">Unpaid Bills</td>\n                  <td style="padding: 0.45rem; text-align: right; border: 1px solid #999; font-weight: bold;">').concat(e.billCount,'</td>\n                </tr>\n                <tr>\n                  <td style="padding: 0.45rem; border: 1px solid #999; font-size: 11px;">Period</td>\n                  <td style="padding: 0.45rem; text-align: right; border: 1px solid #999; font-size: 11px;">').concat(X(e.billScope),'</td>\n                </tr>\n                <tr style="background: #f9fafb;">\n                  <td style="padding: 0.45rem; border: 1px solid #999;">Basic</td>\n                  <td style="padding: 0.45rem; text-align: right; border: 1px solid #999;">\u20b1').concat(e.totalBasicAmount.toFixed(2),'</td>\n                </tr>\n                <tr>\n                  <td style="padding: 0.45rem; border: 1px solid #999;">Surcharge</td>\n                  <td style="padding: 0.45rem; text-align: right; border: 1px solid #999;">\u20b1').concat(e.totalSurcharge.toFixed(2),'</td>\n                </tr>\n                <tr style="background: #fee2e2; font-weight: bold;">\n                  <td style="padding: 0.5rem; border: 1px solid #999; font-size: 12px;">TOTAL DUE</td>\n                  <td style="padding: 0.5rem; text-align: right; border: 1px solid #999; color: #dc2626; font-size: 13px;">\u20b1').concat(e.totalBilledAmount.toFixed(2),'</td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        <div style="background: #fef2f2; border: 2px solid #dc2626; padding: 0.65rem; margin-bottom: 0.65rem;">\n          <h3 style="color: #991b1b; margin: 0 0 0.4rem 0; font-size: 12px; font-weight: bold;">\u26a0\ufe0f DISCONNECTION WARNING</h3>\n          <p style="line-height: 1.5; margin: 0.2rem 0; font-size: 11px;">This is to inform you that your water service account has <strong>OVERDUE BILLS</strong> that remain unpaid.</p>\n          <p style="line-height: 1.5; margin: 0.2rem 0; font-size: 11px;">If payment is not received on or before <strong style="color: #dc2626;">').concat(new Date(F).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),'</strong>, your water service will be <strong style="color: #dc2626;">DISCONNECTED</strong> without further notice.</p>\n          <p style="line-height: 1.5; margin: 0.2rem 0; font-size: 11px;">Reconnection will require payment of all outstanding balances plus applicable reconnection fees which is <strong>\u20b1').concat(parseFloat(M).toFixed(2),'</strong>.</p>\n        </div>\n\n        <div style="margin-bottom: 0.4rem;">\n          <h4 style="margin: 0 0 0.3rem 0; font-size: 12px; font-weight: bold;">Payment Instructions:</h4>\n          <ul style="line-height: 1.4; margin: 0; padding-left: 1.3rem; font-size: 11px;">\n            <li style="margin-bottom: 0.15rem;">Please settle your account immediately to avoid service interruption</li>\n            <li style="margin-bottom: 0.15rem;">Payment can be made at our office during business hours</li>\n            <li>For inquiries, please contact our office or visit during office hours</li>\n          </ul>\n        </div>\n\n        <div style="margin-top: 0.25rem; padding-bottom: 0.5rem; display: flex; justify-content: space-between; align-items: flex-start;">\n          <div style="flex: 1;">\n            <p style="margin: 0; font-size: 10px; color: #6b7280; font-style: italic;">This is an official notice. Please keep for your records.</p>\n          </div>\n          <div style="flex: 1; text-align: center;">\n            <p style="margin: 0 0 0.1rem 0; font-size: 11px;">By Authority of:</p>\n            <p style="margin: 0.8rem 0 0.08rem 0; font-size: 12px; font-weight: bold; border-bottom: 1px solid #333; padding-bottom: 0.08rem; display: inline-block; min-width: 180px;">').concat(L?"".concat(L.firstname.toUpperCase()," ").concat(L.lastname.toUpperCase()):"___________________________",'</p>\n            <p style="margin: 0; font-size: 11px;">').concat(L?L.position:"Municipal Treasurer","</p>\n          </div>\n        </div>\n      </div>\n    ")).join(""),t=window.open("","_blank");t.document.write("\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>Water Disconnection Notices - ".concat((new Date).toLocaleDateString(),'</title>\n          <meta charset="UTF-8">\n          <style>\n            * {\n              box-sizing: border-box;\n            }\n            body { \n              margin: 0; \n              padding: 0;\n            }\n            .notice-box { \n              width: 100%;\n              box-sizing: border-box;\n            }\n            @page {\n              size: legal portrait;\n              margin: 0.25in 0;\n            }\n            @media print {\n              body { \n                margin: 0; \n                padding: 0;\n              }\n              .notice-box {\n                height: 6.25in;\n              }\n            }\n          </style>\n        </head>\n        <body>\n          ').concat(e,"\n          <script>\n            window.onload = function() {\n              window.print();\n            }\n          <\/script>\n        </body>\n      </html>\n    ")),t.document.close()},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-print"})}),(0,Js.jsx)("span",{children:"Generate & Print"})]}),(0,Js.jsx)("button",{className:"button",onClick:()=>U(!1),children:"Cancel"})]})]})]})]})},xa=e=>{var t,n;let{user:s,isOpen:r,onClose:i,onUpdate:l}=e;const[o,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1),[h,m]=(0,a.useState)(""),[f,p]=(0,a.useState)(""),[g,v]=(0,a.useState)({firstname:s.firstname||"",lastname:s.lastname||"",email:s.email||"",phone:s.phone||"",address:s.address||""});if(!r)return null;const y=(e,t)=>{v(n=>ea(ea({},n),{},{[e]:t})),m("")},b=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";return(0,Js.jsxs)("div",{className:"modal is-active",children:[(0,Js.jsx)("div",{className:"modal-background",onClick:i}),(0,Js.jsxs)("div",{className:"modal-card",style:{width:"600px",maxWidth:"90vw"},children:[(0,Js.jsxs)("header",{className:"modal-card-head",children:[(0,Js.jsxs)("p",{className:"modal-card-title",children:[(0,Js.jsx)("i",{className:"fas fa-user-circle"})," My Profile"]}),(0,Js.jsx)("button",{className:"delete","aria-label":"close",onClick:i})]}),(0,Js.jsxs)("section",{className:"modal-card-body",children:[h&&(0,Js.jsxs)("div",{className:"notification is-danger is-light",children:[(0,Js.jsx)("button",{className:"delete",onClick:()=>m("")}),h]}),f&&(0,Js.jsxs)("div",{className:"notification is-success is-light",children:[(0,Js.jsx)("button",{className:"delete",onClick:()=>p("")}),f]}),(0,Js.jsxs)("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[(0,Js.jsxs)("div",{style:{width:"100px",height:"100px",borderRadius:"50%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"2.5rem",color:"white",fontWeight:"bold",marginBottom:"1rem"},children:[null===(t=s.firstname)||void 0===t?void 0:t.charAt(0),null===(n=s.lastname)||void 0===n?void 0:n.charAt(0)]}),(0,Js.jsxs)("h3",{className:"title is-4",style:{marginBottom:"0.25rem"},children:[s.firstname," ",s.lastname]}),(0,Js.jsxs)("p",{className:"subtitle is-6",style:{color:"#7a7a7a"},children:[(0,Js.jsx)("i",{className:"fas fa-shield-alt"})," ",s.role]})]}),(0,Js.jsx)("div",{className:"box",style:{background:"#f9fafb",padding:"1.5rem"},children:(0,Js.jsxs)("div",{className:"columns is-multiline",children:[(0,Js.jsxs)("div",{className:"column is-6",children:[(0,Js.jsx)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:"First Name"}),o?(0,Js.jsx)("input",{className:"input",type:"text",value:g.firstname,onChange:e=>y("firstname",e.target.value)}):(0,Js.jsx)("p",{style:{fontSize:"1rem",fontWeight:"500",marginTop:"0.5rem"},children:s.firstname})]}),(0,Js.jsxs)("div",{className:"column is-6",children:[(0,Js.jsx)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:"Last Name"}),o?(0,Js.jsx)("input",{className:"input",type:"text",value:g.lastname,onChange:e=>y("lastname",e.target.value)}):(0,Js.jsx)("p",{style:{fontSize:"1rem",fontWeight:"500",marginTop:"0.5rem"},children:s.lastname})]}),(0,Js.jsxs)("div",{className:"column is-12",children:[(0,Js.jsxs)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,Js.jsx)("i",{className:"fas fa-envelope"})," Email Address"]}),o?(0,Js.jsx)("input",{className:"input",type:"email",value:g.email,onChange:e=>y("email",e.target.value)}):(0,Js.jsx)("p",{style:{fontSize:"1rem",fontWeight:"500",marginTop:"0.5rem"},children:s.email})]}),(0,Js.jsxs)("div",{className:"column is-6",children:[(0,Js.jsxs)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,Js.jsx)("i",{className:"fas fa-phone"})," Phone Number"]}),o?(0,Js.jsx)("input",{className:"input",type:"text",value:g.phone,onChange:e=>y("phone",e.target.value),placeholder:"Enter phone number"}):(0,Js.jsx)("p",{style:{fontSize:"1rem",fontWeight:"500",marginTop:"0.5rem"},children:s.phone||"Not provided"})]}),(0,Js.jsxs)("div",{className:"column is-6",children:[(0,Js.jsxs)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,Js.jsx)("i",{className:"fas fa-user-tag"})," User ID"]}),(0,Js.jsx)("p",{style:{fontSize:"1rem",fontWeight:"500",marginTop:"0.5rem",color:"#2563eb"},children:s.userid})]}),(0,Js.jsxs)("div",{className:"column is-12",children:[(0,Js.jsxs)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,Js.jsx)("i",{className:"fas fa-map-marker-alt"})," Address"]}),o?(0,Js.jsx)("textarea",{className:"textarea",value:g.address,onChange:e=>y("address",e.target.value),placeholder:"Enter address",rows:"2"}):(0,Js.jsx)("p",{style:{fontSize:"1rem",fontWeight:"500",marginTop:"0.5rem"},children:s.address||"Not provided"})]}),(0,Js.jsxs)("div",{className:"column is-6",children:[(0,Js.jsxs)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,Js.jsx)("i",{className:"fas fa-calendar-plus"})," Account Created"]}),(0,Js.jsx)("p",{style:{fontSize:"0.875rem",color:"#6b7280",marginTop:"0.5rem"},children:b(s.datecreated)})]}),(0,Js.jsxs)("div",{className:"column is-6",children:[(0,Js.jsxs)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,Js.jsx)("i",{className:"fas fa-clock"})," Last Login"]}),(0,Js.jsx)("p",{style:{fontSize:"0.875rem",color:"#6b7280",marginTop:"0.5rem"},children:b(s.lastlogin)})]}),(0,Js.jsxs)("div",{className:"column is-12",children:[(0,Js.jsxs)("label",{className:"label",style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,Js.jsx)("i",{className:"fas fa-toggle-on"})," Account Status"]}),(0,Js.jsx)("span",{className:"tag ".concat("active"===s.status?"is-success":"is-danger"),children:s.status})]})]})})]}),(0,Js.jsx)("footer",{className:"modal-card-foot",style:{justifyContent:"flex-end",gap:"0.5rem"},children:o?(0,Js.jsxs)(Js.Fragment,{children:[(0,Js.jsx)("button",{className:"button",onClick:()=>{v({firstname:s.firstname||"",lastname:s.lastname||"",email:s.email||"",phone:s.phone||"",address:s.address||""}),c(!1),m(""),p("")},disabled:d,children:"Cancel"}),(0,Js.jsxs)("button",{className:"button is-primary ".concat(d?"is-loading":""),onClick:async()=>{u(!0),m(""),p("");try{const e=await $s.updateProfile(s.userid,g);e.success?(p("Profile updated successfully!"),c(!1),l(ea(ea({},s),g)),setTimeout(()=>{p("")},2e3)):m(e.error||"Failed to update profile")}catch(e){m("An error occurred while updating profile")}u(!1)},disabled:d,children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-save"})}),(0,Js.jsx)("span",{children:"Save Changes"})]})]}):(0,Js.jsxs)(Js.Fragment,{children:[(0,Js.jsx)("button",{className:"button",onClick:i,children:"Close"}),(0,Js.jsxs)("button",{className:"button is-info",onClick:()=>c(!0),children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-edit"})}),(0,Js.jsx)("span",{children:"Edit Profile"})]})]})})]})]})},ja=e=>{let{user:t,isOpen:n,onClose:s}=e;const[r,i]=(0,a.useState)("security"),[l,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(""),[u,h]=(0,a.useState)(""),[m,f]=(0,a.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[p,g]=(0,a.useState)({emailNotifications:!0,browserNotifications:!1,theme:"light"});if(!n)return null;const v=(e,t)=>{f(n=>ea(ea({},n),{},{[e]:t})),d("")};return(0,Js.jsxs)("div",{className:"modal is-active",children:[(0,Js.jsx)("div",{className:"modal-background",onClick:s}),(0,Js.jsxs)("div",{className:"modal-card",style:{width:"700px",maxWidth:"90vw"},children:[(0,Js.jsxs)("header",{className:"modal-card-head",children:[(0,Js.jsxs)("p",{className:"modal-card-title",children:[(0,Js.jsx)("i",{className:"fas fa-cog"})," Settings"]}),(0,Js.jsx)("button",{className:"delete","aria-label":"close",onClick:s})]}),(0,Js.jsxs)("section",{className:"modal-card-body",style:{minHeight:"400px"},children:[(0,Js.jsx)("div",{className:"tabs is-boxed",children:(0,Js.jsxs)("ul",{children:[(0,Js.jsx)("li",{className:"security"===r?"is-active":"",children:(0,Js.jsxs)("a",{onClick:()=>i("security"),children:[(0,Js.jsx)("span",{className:"icon is-small",children:(0,Js.jsx)("i",{className:"fas fa-lock"})}),(0,Js.jsx)("span",{children:"Security"})]})}),(0,Js.jsx)("li",{className:"preferences"===r?"is-active":"",children:(0,Js.jsxs)("a",{onClick:()=>i("preferences"),children:[(0,Js.jsx)("span",{className:"icon is-small",children:(0,Js.jsx)("i",{className:"fas fa-sliders-h"})}),(0,Js.jsx)("span",{children:"Preferences"})]})}),(0,Js.jsx)("li",{className:"about"===r?"is-active":"",children:(0,Js.jsxs)("a",{onClick:()=>i("about"),children:[(0,Js.jsx)("span",{className:"icon is-small",children:(0,Js.jsx)("i",{className:"fas fa-info-circle"})}),(0,Js.jsx)("span",{children:"About"})]})})]})}),c&&(0,Js.jsxs)("div",{className:"notification is-danger is-light",children:[(0,Js.jsx)("button",{className:"delete",onClick:()=>d("")}),c]}),u&&(0,Js.jsxs)("div",{className:"notification is-success is-light",children:[(0,Js.jsx)("button",{className:"delete",onClick:()=>h("")}),u]}),"security"===r&&(0,Js.jsxs)("div",{children:[(0,Js.jsxs)("h3",{className:"title is-5",children:[(0,Js.jsx)("i",{className:"fas fa-key"})," Change Password"]}),(0,Js.jsx)("p",{className:"subtitle is-6",style:{color:"#7a7a7a",marginBottom:"1.5rem"},children:"Keep your account secure by using a strong password"}),(0,Js.jsxs)("div",{className:"box",style:{background:"#f9fafb"},children:[(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Current Password"}),(0,Js.jsxs)("div",{className:"control has-icons-left",children:[(0,Js.jsx)("input",{className:"input",type:"password",placeholder:"Enter current password",value:m.currentPassword,onChange:e=>v("currentPassword",e.target.value)}),(0,Js.jsx)("span",{className:"icon is-small is-left",children:(0,Js.jsx)("i",{className:"fas fa-lock"})})]})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"New Password"}),(0,Js.jsxs)("div",{className:"control has-icons-left",children:[(0,Js.jsx)("input",{className:"input",type:"password",placeholder:"Enter new password",value:m.newPassword,onChange:e=>v("newPassword",e.target.value)}),(0,Js.jsx)("span",{className:"icon is-small is-left",children:(0,Js.jsx)("i",{className:"fas fa-key"})})]}),(0,Js.jsx)("p",{className:"help",children:"Password must be at least 6 characters long"})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("label",{className:"label",children:"Confirm New Password"}),(0,Js.jsxs)("div",{className:"control has-icons-left",children:[(0,Js.jsx)("input",{className:"input",type:"password",placeholder:"Confirm new password",value:m.confirmPassword,onChange:e=>v("confirmPassword",e.target.value)}),(0,Js.jsx)("span",{className:"icon is-small is-left",children:(0,Js.jsx)("i",{className:"fas fa-check-circle"})})]})]}),(0,Js.jsx)("div",{className:"field",style:{marginTop:"1.5rem"},children:(0,Js.jsx)("div",{className:"control",children:(0,Js.jsxs)("button",{className:"button is-primary ".concat(l?"is-loading":""),onClick:async()=>{if(d(""),h(""),m.currentPassword&&m.newPassword&&m.confirmPassword)if(m.newPassword.length<6)d("New password must be at least 6 characters long");else if(m.newPassword===m.confirmPassword){o(!0);try{const e=await $s.changePassword(t.userid,m.currentPassword,m.newPassword);e.success?(h("Password changed successfully!"),f({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>h(""),3e3)):d(e.error||"Failed to change password")}catch(e){d("An error occurred while changing password")}o(!1)}else d("New passwords do not match");else d("All password fields are required")},disabled:l,children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-save"})}),(0,Js.jsx)("span",{children:"Update Password"})]})})})]}),(0,Js.jsxs)("div",{className:"notification is-info is-light",style:{marginTop:"1.5rem"},children:[(0,Js.jsx)("strong",{children:"Security Tips:"}),(0,Js.jsxs)("ul",{style:{marginTop:"0.5rem",paddingLeft:"1.5rem"},children:[(0,Js.jsx)("li",{children:"Use a unique password for this account"}),(0,Js.jsx)("li",{children:"Include uppercase, lowercase, numbers, and symbols"}),(0,Js.jsx)("li",{children:"Avoid using personal information in your password"}),(0,Js.jsx)("li",{children:"Change your password regularly"})]})]})]}),"preferences"===r&&(0,Js.jsxs)("div",{children:[(0,Js.jsxs)("h3",{className:"title is-5",children:[(0,Js.jsx)("i",{className:"fas fa-sliders-h"})," Application Preferences"]}),(0,Js.jsx)("p",{className:"subtitle is-6",style:{color:"#7a7a7a",marginBottom:"1.5rem"},children:"Customize your experience"}),(0,Js.jsxs)("div",{className:"box",style:{background:"#f9fafb"},children:[(0,Js.jsxs)("div",{className:"field",style:{marginBottom:"1.5rem"},children:[(0,Js.jsxs)("label",{className:"label",children:[(0,Js.jsx)("i",{className:"fas fa-bell"})," Notifications"]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("input",{id:"emailNotif",type:"checkbox",className:"switch is-rounded is-success",checked:p.emailNotifications,onChange:e=>g(t=>ea(ea({},t),{},{emailNotifications:e.target.checked}))}),(0,Js.jsx)("label",{htmlFor:"emailNotif",children:"Enable email notifications"})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsx)("input",{id:"browserNotif",type:"checkbox",className:"switch is-rounded is-info",checked:p.browserNotifications,onChange:e=>g(t=>ea(ea({},t),{},{browserNotifications:e.target.checked}))}),(0,Js.jsx)("label",{htmlFor:"browserNotif",children:"Enable browser notifications"})]})]}),(0,Js.jsxs)("div",{className:"field",children:[(0,Js.jsxs)("label",{className:"label",children:[(0,Js.jsx)("i",{className:"fas fa-palette"})," Theme (Coming Soon)"]}),(0,Js.jsx)("div",{className:"control",children:(0,Js.jsx)("div",{className:"select is-fullwidth",disabled:!0,children:(0,Js.jsxs)("select",{value:p.theme,onChange:e=>g(t=>ea(ea({},t),{},{theme:e.target.value})),disabled:!0,children:[(0,Js.jsx)("option",{value:"light",children:"Light Mode"}),(0,Js.jsx)("option",{value:"dark",children:"Dark Mode"}),(0,Js.jsx)("option",{value:"auto",children:"Auto (System)"})]})})}),(0,Js.jsx)("p",{className:"help",children:"Theme customization will be available in a future update"})]}),(0,Js.jsx)("div",{className:"field",style:{marginTop:"1.5rem"},children:(0,Js.jsx)("div",{className:"control",children:(0,Js.jsxs)("button",{className:"button is-primary",onClick:()=>{h("Preferences saved successfully!"),setTimeout(()=>h(""),2e3)},children:[(0,Js.jsx)("span",{className:"icon",children:(0,Js.jsx)("i",{className:"fas fa-save"})}),(0,Js.jsx)("span",{children:"Save Preferences"})]})})})]})]}),"about"===r&&(0,Js.jsxs)("div",{children:[(0,Js.jsxs)("h3",{className:"title is-5",children:[(0,Js.jsx)("i",{className:"fas fa-info-circle"})," About This System"]}),(0,Js.jsxs)("div",{className:"box",style:{background:"#f9fafb",textAlign:"center",padding:"2rem"},children:[(0,Js.jsx)("div",{style:{width:"80px",height:"80px",borderRadius:"16px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"2rem",color:"white",marginBottom:"1rem"},children:(0,Js.jsx)("i",{className:"fas fa-building"})}),(0,Js.jsx)("h3",{className:"title is-4",children:"Water Billing System"}),(0,Js.jsx)("p",{className:"subtitle is-6",style:{color:"#7a7a7a"},children:"LGU Concepcion, Romblon"})]}),(0,Js.jsx)("div",{className:"content",style:{marginTop:"1.5rem"},children:(0,Js.jsx)("table",{className:"table is-fullwidth is-striped",children:(0,Js.jsxs)("tbody",{children:[(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{children:(0,Js.jsx)("strong",{children:"Version"})}),(0,Js.jsx)("td",{children:"2.0.0"})]}),(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{children:(0,Js.jsx)("strong",{children:"Build Date"})}),(0,Js.jsx)("td",{children:"October 2025"})]}),(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{children:(0,Js.jsx)("strong",{children:"Technology"})}),(0,Js.jsx)("td",{children:"React.js + Supabase"})]}),(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{children:(0,Js.jsx)("strong",{children:"Database"})}),(0,Js.jsx)("td",{children:"PostgreSQL (Supabase)"})]}),(0,Js.jsxs)("tr",{children:[(0,Js.jsx)("td",{children:(0,Js.jsx)("strong",{children:"UI Framework"})}),(0,Js.jsx)("td",{children:"Bulma CSS"})]})]})})}),(0,Js.jsxs)("div",{className:"notification is-link is-light",children:[(0,Js.jsx)("p",{children:(0,Js.jsx)("strong",{children:"Need Help?"})}),(0,Js.jsx)("p",{style:{marginTop:"0.5rem"},children:"Contact your system administrator or IT support team for assistance with this application."})]})]})]}),(0,Js.jsx)("footer",{className:"modal-card-foot",style:{justifyContent:"flex-end"},children:(0,Js.jsx)("button",{className:"button",onClick:s,children:"Close"})})]})]})},wa=e=>{let{onLogout:t}=e;const[n,s]=(0,a.useState)(null),[r,i]=(0,a.useState)(!1),[l,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(!1),m=ne(),f=ee(),p=[{name:"Dashboard",icon:"fas fa-tachometer-alt",path:"/dashboard"},{name:"Customers",icon:"fas fa-users",path:"/dashboard/customers"},{name:"Billing",icon:"fas fa-file-invoice-dollar",path:"/dashboard/billing"},{name:"Payments",icon:"fas fa-credit-card",path:"/dashboard/payments"},{name:"Credit Management",icon:"fas fa-chart-line",path:"/dashboard/credit-management"},{name:"Reports",icon:"fas fa-chart-bar",path:"/dashboard/reports"},{name:"Users",icon:"fas fa-user-cog",path:"/dashboard/users"},{name:"Tools",icon:"fas fa-tools",path:"/dashboard/tools"}],g=(()=>{const e=f.pathname,t=p.find(t=>t.path===e);return t?t.name:"Dashboard"})();(0,a.useEffect)(()=>{const e=$s.getUserSession();e?s(e):m("/login")},[m]),(0,a.useEffect)(()=>{const e=()=>{const e=document.querySelector(".dashboard-header"),t=document.querySelector(".content-container"),n=t?t.scrollTop>10:window.scrollY>10;e&&(n?e.classList.add("scrolled"):e.classList.remove("scrolled"))},t=document.querySelector(".content-container");return t?(t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)):(window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e))},[]),(0,a.useEffect)(()=>{"/dashboard"===f.pathname&&m("/dashboard",{replace:!0})},[f.pathname,m]),(0,a.useEffect)(()=>{const e=e=>{const t=document.querySelector(".user-dropdown");t&&!t.contains(e.target)&&o(!1)};if(l)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[l]),(0,a.useEffect)(()=>{const e=e=>{m("/dashboard/payments")};return window.addEventListener("navigateToPayments",e),()=>window.removeEventListener("navigateToPayments",e)},[m]);const v=e=>{const t=p.find(t=>t.name===e);t&&m(t.path),i(!1)};return n?(0,Js.jsxs)("div",{className:"dashboard-container",children:[(0,Js.jsxs)("header",{className:"dashboard-header",children:[(0,Js.jsxs)("div",{className:"header-content",children:[(0,Js.jsxs)("div",{className:"header-left",children:[(0,Js.jsx)("div",{className:"brand-icon",children:(0,Js.jsx)("i",{className:"fas fa-building"})}),(0,Js.jsxs)("div",{className:"brand-text",children:[(0,Js.jsx)("h1",{className:"brand-title",children:"Water Billing System"}),(0,Js.jsx)("p",{className:"brand-subtitle",children:"LGU Concepcion, Romblon"})]})]}),(0,Js.jsx)("nav",{className:"header-center",children:(0,Js.jsx)("div",{className:"nav-menu",children:p.map(e=>(0,Js.jsxs)("button",{className:"nav-item ".concat(g===e.name?"active":""),onClick:()=>v(e.name),children:[(0,Js.jsx)("i",{className:e.icon}),(0,Js.jsx)("span",{children:e.name})]},e.name))})}),(0,Js.jsxs)("div",{className:"header-right",children:[(0,Js.jsxs)("div",{className:"user-info",children:[(0,Js.jsxs)("span",{className:"user-name",children:[n.firstname," ",n.lastname]}),(0,Js.jsx)("span",{className:"user-role",children:n.role})]}),(0,Js.jsxs)("div",{className:"user-dropdown ".concat(l?"is-active":""),children:[(0,Js.jsxs)("button",{className:"user-button",onClick:()=>o(!l),children:[(0,Js.jsx)("div",{className:"user-avatar",children:(0,Js.jsx)("i",{className:"fas fa-user"})}),(0,Js.jsx)("i",{className:"fas fa-chevron-down"})]}),(0,Js.jsxs)("div",{className:"dropdown-menu",children:[(0,Js.jsxs)("a",{className:"dropdown-item",onClick:()=>{d(!0),o(!1)},children:[(0,Js.jsx)("i",{className:"fas fa-user-edit"}),(0,Js.jsx)("span",{children:"Profile"})]}),(0,Js.jsxs)("a",{className:"dropdown-item",onClick:()=>{h(!0),o(!1)},children:[(0,Js.jsx)("i",{className:"fas fa-cog"}),(0,Js.jsx)("span",{children:"Settings"})]}),(0,Js.jsx)("hr",{className:"dropdown-divider"}),(0,Js.jsxs)("a",{className:"dropdown-item",onClick:()=>{$s.logout(),t&&t(),m("/login",{replace:!0})},children:[(0,Js.jsx)("i",{className:"fas fa-sign-out-alt"}),(0,Js.jsx)("span",{children:"Logout"})]})]})]})]}),(0,Js.jsxs)("button",{className:"mobile-menu-toggle ".concat(r?"active":""),onClick:()=>i(!r),children:[(0,Js.jsx)("span",{}),(0,Js.jsx)("span",{}),(0,Js.jsx)("span",{})]})]}),(0,Js.jsx)("div",{className:"mobile-nav ".concat(r?"active":""),children:p.map(e=>(0,Js.jsxs)("button",{className:"mobile-nav-item ".concat(g===e.name?"active":""),onClick:()=>v(e.name),children:[(0,Js.jsx)("i",{className:e.icon}),(0,Js.jsx)("span",{children:e.name})]},e.name))})]}),(0,Js.jsx)("main",{className:"dashboard-main",children:(0,Js.jsx)("div",{className:"content-container",children:(0,Js.jsxs)(be,{children:[(0,Js.jsx)(ve,{index:!0,element:(0,Js.jsx)(ra,{user:n})}),(0,Js.jsx)(ve,{path:"customers",element:(0,Js.jsx)(ia,{})}),(0,Js.jsx)(ve,{path:"billing",element:(0,Js.jsx)(da,{})}),(0,Js.jsx)(ve,{path:"payments",element:(0,Js.jsx)(ha,{})}),(0,Js.jsx)(ve,{path:"credit-management",element:(0,Js.jsx)(fa,{})}),(0,Js.jsx)(ve,{path:"reports",element:(0,Js.jsx)(ga,{})}),(0,Js.jsx)(ve,{path:"users",element:(0,Js.jsx)(ya,{})}),(0,Js.jsx)(ve,{path:"tools",element:(0,Js.jsx)(ba,{})})]})})}),(0,Js.jsx)(xa,{user:n,isOpen:c,onClose:()=>d(!1),onUpdate:e=>{s(e),$s.setUserSession(e)}}),(0,Js.jsx)(ja,{user:n,isOpen:u,onClose:()=>h(!1)})]}):(0,Js.jsx)("div",{className:"container",children:(0,Js.jsx)("div",{className:"section",children:(0,Js.jsx)("div",{className:"has-text-centered",children:(0,Js.jsx)("button",{className:"button is-loading is-large",children:"Loading"})})})})},Na=e=>{let{children:t}=e;return $s.isAuthenticated()?t:(0,Js.jsx)(ge,{to:"/login",replace:!0})};const Sa=function(){const[e,t]=(0,a.useState)($s.isAuthenticated());return(0,a.useEffect)(()=>{const e=()=>{t($s.isAuthenticated())};return e(),window.addEventListener("storage",e),window.addEventListener("authChange",e),()=>{window.removeEventListener("storage",e),window.removeEventListener("authChange",e)}},[]),(0,Js.jsx)(we,{children:(0,Js.jsx)("div",{className:"App",children:(0,Js.jsxs)(be,{children:[(0,Js.jsx)(ve,{path:"/",element:e?(0,Js.jsx)(ge,{to:"/dashboard",replace:!0}):(0,Js.jsx)(ge,{to:"/login",replace:!0})}),(0,Js.jsx)(ve,{path:"/login",element:e?(0,Js.jsx)(ge,{to:"/dashboard",replace:!0}):(0,Js.jsx)(Gs,{onLoginSuccess:()=>t(!0)})}),(0,Js.jsx)(ve,{path:"/dashboard/*",element:(0,Js.jsx)(Na,{children:(0,Js.jsx)(wa,{onLogout:()=>t(!1)})})}),(0,Js.jsx)(ve,{path:"*",element:(0,Js.jsx)(ge,{to:"/",replace:!0})})]})})})};i.createRoot(document.getElementById("root")).render((0,Js.jsx)(a.StrictMode,{children:(0,Js.jsx)(Sa,{})}))})();
//# sourceMappingURL=main.336cd9f8.js.map